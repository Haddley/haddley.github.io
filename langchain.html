<!DOCTYPE html>
<html  >
<head>
  
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/15018162-128x128.png" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>LangChain</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  
  
  <link href="prism.css" rel="stylesheet" />
<!-- include A-Frame obviously -->
<script src="aframe.min.js"></script>
<!-- include ar.js for A-Frame -->
<script src="aframe-ar.js"></script>



  
</head>
<body>
  
  <section class="menu menu3 cid-tKi95L0tXb" once="menu" id="menu3-5px">
    
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-black text-primary display-7" href="index.html">Neil Haddley</a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="posts.html">
                            Blog Posts</a></li></ul>
                <div class="icons-menu">
                    <a class="iconfont-wrapper" href="https://www.linkedin.com/in/neil-haddley/" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-linkedin socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://github.com/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mbrib-github"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://www.npmjs.com/~haddley" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-npm socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://hub.docker.com/u/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mobi-mbri-delivery mobi-mbri"></span>
                    </a>
                </div>
                
            </div>
        </div>
    </nav>
</section>

<section class="content4 cid-tKi95LNg8x" id="content4-5py">
    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-2"><strong>Large Language Models</strong></h3>
                <h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5">LangChain</h4>
                
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKi95M2AeN" id="image3-5pz">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/chatgpt-logo.svg" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4"><a href="https://commons.wikimedia.org/wiki/File:ChatGPT_logo.svg" class="text-primary" target="_blank">This image of simple geometry is ineligible for copyright and therefore in the public domain, because it consists entirely of information that is common property and contains no original authorship.</a><a href="http://www.apache.org/licenses/LICENSE-2.0" title="Apache License, Version 2.0"><br></a>
                    
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-tKi95MdOOk" id="content5-5q0">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">LangChain</h4>
                <p class="mbr-text mbr-fonts-style display-7">LangChain is a framework built around Large Language Models. It can use it for chatbots, Generative Question-Answering (GQA), summarization, and more.<br></p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-tKyV1fSIrj" id="content5-5uk">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">streamlit</h4>
                <p class="mbr-text mbr-fonts-style display-7">Streamlit is an open-source Python library used to create web applications for data science and machine learning projects. It allows developers and data scientists to quickly turn their data scripts into interactive web applications without the need for extensive web development knowledge. Streamlit's main goal is to make the process of sharing data, models, and visualizations with others as easy and efficient as possible.<br><br>As a first step I created a hello world streamlit app.</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKyX0ftQKU" id="content7-5ul">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>app0.py</strong></h5>

<pre class="language-clike"><code><!--         
# pip install streamlit
# python -m streamlit run app0.py              

import streamlit

prompt = streamlit.text_input('Input your name')

if prompt:
    response = "Hello " + prompt
    streamlit.write(response)
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8IIJiqZ" id="image3-5t4">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/langchain-capture-0004-1473x711.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">hello world streamlit app</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-tKyXZOFkpd" id="content5-5um">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">ChatGPT</h4>
                <p class="mbr-text mbr-fonts-style display-7">I updated the hello world&nbsp;hello world streamlit app. to the OpenAI API.<br><br>I had to browse the OpenAI web site to create a secret API key.<br><br>The secret key can be stored as an environment variable.</p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8K3GfkA" id="image3-5t7">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-20-at-10.13.26-am-1836x1013.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">secret key</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKyZOHB87b" id="content7-5un">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>app1.py</strong></h5>

<pre class="language-clike"><code><!--         
# pip install langchain openai streamlit
# python -m streamlit run app.py              

# import os
from langchain.llms import OpenAI
import streamlit

# os.environ['OPENAI_API_KEY']='<insert key here>'

llm = OpenAI(temperature=0.9)

prompt = streamlit.text_input('Input your prompt')

if prompt:
    response = llm(prompt)
    streamlit.write(response)
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8KtvVmc" id="image3-5t8">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/langchain-capture-0005-1476x710.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Using&nbsp;LangChain to call the OpenAI API.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-tKz1qIgeLx" id="content5-5uo">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">pdf document pages</h4>
                <p class="mbr-text mbr-fonts-style display-7">LangChain can be used to load text from pdf documents.<br><br>LangChain can be used to return the text found on each page of a pdf separately.<br><br>I used LangChain to return the text found on each page of a sample medical report.<br><br><a href="https://www.med.unc.edu/medclerk/wp-content/uploads/sites/877/2018/10/hp4.pdf" class="text-primary" target="_blank">https://www.med.unc.edu/medclerk/wp-content/uploads/sites/877/2018/10/hp4.pdf</a><br><br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8KPn8lD" id="image3-5t9">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-5.13.17-pm-1142x740.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Running jupyter-notebook locally</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8LcM807" id="image3-5ta">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-7.54.08-pm-1536x982.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">loads in medical report&nbsp;pages<br>pages = loader.load_and_split()</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKHcOkK32z" id="content7-5uq">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>[1]</strong></h5>

<pre class="language-clike"><code><!--         
from langchain.document_loaders import PyPDFLoader

loader = PyPDFLoader('hp4.pdf')
pages = loader.load_and_split()


print (pages[0].page_content)
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8Ly6wSo" id="image3-5tb">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-7.57.22-pm-1536x997.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">break pages into paragraph "text" items</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKHdkhz1uy" id="content7-5ur">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>[2] &amp; [3]</strong></h5>

<pre class="language-clike"><code><!--         
from langchain.text_splitter import RecursiveCharacterTextSplitter

# Define chunk size, overlap and separators
text_splitter = RecursiveCharacterTextSplitter(
    # Set a really small chunk size, just to show.
    chunk_size = 1024,
    chunk_overlap  = 40,
    length_function = len,
    separators=["\n \n", " ", ""]
)

# Split the pages into texts as defined above
texts = text_splitter.split_documents(pages)

len(texts)

texts[1].page_content
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-tKHm2y8mJz" id="content5-5ux">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Chroma</h4>
                <p class="mbr-text mbr-fonts-style display-7">Chroma is a vector store and <a href="sentencesimilarity.html" class="text-primary">embeddings</a> database designed from the ground-up to make it easy to build AI applications with embeddings.<br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8LUswkt" id="image3-5tc">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-7.59.26-pm-1536x1033.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">build an embeddings vector store (save to "Chroma" folder) using the OpenAI API</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKHe7yEq9p" id="content7-5us">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>[4]</strong></h5>

<pre class="language-clike"><code><!--         
from langchain.llms import OpenAI

from langchain.embeddings import OpenAIEmbeddings

from langchain.vectorstores import Chroma

from langchain.agents.agent_toolkits import (
    create_vectorstore_agent,
    VectorStoreToolkit,
    VectorStoreInfo
)


llm = OpenAI(temperature=0.9,verbose=True)
embeddings=OpenAIEmbeddings()

save_directory = "Chroma"

store = Chroma.from_documents(texts, embeddings, collection_name='hp4', persist_directory=save_directory)
store.persist()

store.get()
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8MfF33y" id="image3-5td">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-8.03.05-pm-1536x842.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Convert&nbsp;'Does the patient smoke?' to an embedding and compare with embeddings in the vector store. What paragraphs in the document might be useful?</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKHlhEKrfS" id="content7-5uw">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>[5]</strong></h5>

<pre class="language-clike"><code><!--         
search = store.similarity_search_with_score('Does the patient smoke?')

search

--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8MEcfUm" id="image3-5te">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-8.05.23-pm-1536x784.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">(as a demonstration) retrieve the embeddings vector store from the 'Chroma' folder.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKHfqNwpjn" id="content7-5ut">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>[6]</strong></h5>

<pre class="language-clike"><code><!--         
db = Chroma(persist_directory=save_directory,collection_name='hp4',embedding_function=embeddings)

print(db._collection.count())

db.get()
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8N1Rfos" id="image3-5tf">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-8.16.41-pm-1536x867.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Pass just the "useful" paragraphs and the question to the Large Language Model. ChatGPT provides the answer as a generated sentence.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKHhD3p79D" id="content7-5uu">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>[7]</strong></h5>

<pre class="language-clike"><code><!--         
vectorstore_info = VectorStoreInfo(
    name="hp4",
    description="vectore store generate from hp4.pdf",
    vectorstore=store
)

toolkit = VectorStoreToolkit(vectorstore_info=vectorstore_info)

agent_executor = create_vectorstore_agent(
    llm=llm,
    toolkit=toolkit,
    verbose=True
)

response = agent_executor.run("Does the patient smoke?")

response
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8NpZEu7" id="image3-5tg">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-8.19.11-pm-1536x982.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">streamlit version of the code</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-tKHiIGxiSq" id="content7-5uv">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>app2.py</strong></h5>

<pre class="language-clike"><code><!--         
import streamlit as st

from langchain.llms import OpenAI

from langchain.embeddings import OpenAIEmbeddings

from langchain.vectorstores import Chroma

from langchain.agents.agent_toolkits import (
    create_vectorstore_agent,
    VectorStoreToolkit,
    VectorStoreInfo
)


llm = OpenAI(temperature=0.9,verbose=True)

embeddings=OpenAIEmbeddings()

save_directory = "Chroma"

# load embeddings from "Chroma" directory
db = Chroma(persist_directory=save_directory,collection_name='hp4',embedding_function=embeddings)

vectorstore_info = VectorStoreInfo(
    name="hp4",
    description="embeddings generated from the pdf document",
    vectorstore=db
)

toolkit = VectorStoreToolkit(vectorstore_info=vectorstore_info)

agent_executor = create_vectorstore_agent(
    llm=llm,
    toolkit=toolkit,
    verbose=True
)

prompt = st.text_input('Input your prompt')

if prompt:
    #response = llm(prompt)
    response = agent_executor.run(prompt)
    st.write(response)

    with st.expander('Document Similarity Search'):
        search = db.similarity_search_with_score(prompt)
        st.write(search)



--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-tKy8NVCujo" id="image3-5th">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2023-07-21-at-8.21.56-pm-1536x866.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Streamlit interface</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="features13 cid-tKi95PTo3P" id="features14-5qt">
    

    
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h3 class="mbr-section-title align-center mb-4 mbr-fonts-style display-2"><strong>References</strong></h3>
            </div>
            <div class="card col-12 col-md-4 col-lg-2 p-3">
                <div class="card-wrapper">
                    <div class="card-box align-center">
                        <span class="mbr-iconfont mbri-pages"></span>
                        <h4 class="card-title align-center mbr-black mbr-fonts-style display-7"><strong><a href="https://python.langchain.com/docs/get_started/quickstart" class="text-primary" target="_blank">LangChain Quickstart</a></strong></h4>
                    </div>
                </div>
            </div>
            <div class="card p-3 col-12 col-md-4 col-lg-2">
                <div class="card-wrapper">
                    <div class="card-box align-center">
                        <span class="mbr-iconfont socicon-youtube socicon"></span>
                        <h4 class="card-title align-center mbr-black mbr-fonts-style display-7"><strong><a href="https://www.youtube.com/watch?v=u8vQyTzNGVY" class="text-primary" target="_blank">I built a GPT Investment Banker using this 312 PAGE document</a></strong></h4>
                    </div>
                </div>
            </div>
            
            
            
            
        </div>
    </div>
</section>


<script src="assets/web/assets/jquery/jquery.min.js"></script>
  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/dropdown/js/nav-dropdown.js"></script>
  <script src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  
  <script src="prism.js"></script>
<script src="webcomponents/howtoTooltip.js"></script>
  
</body>
</html>