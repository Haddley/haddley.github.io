# Complete Markdown Reference

This file combines all markdown files from the content directory for reference purposes.
Generated on: 2025-10-16T06:03:47.428Z
Total files: 239

## Table of Contents

1. [3dprinting1](#3dprinting1)
2. [3dprinting2](#3dprinting2)
3. [addanitem](#addanitem)
4. [addapurchaseorder](#addapurchaseorder)
5. [al-go-pte](#al-go-pte)
6. [amazonecs](#amazonecs)
7. [amazoneks](#amazoneks)
8. [amazonfargate](#amazonfargate)
9. [angular-new](#angular-new)
10. [angular](#angular)
11. [angular1](#angular1)
12. [angularandasp.net](#angularandasp-net)
13. [angularfirebase](#angularfirebase)
14. [angularphaser](#angularphaser)
15. [api-management](#api-management)
16. [apigateway](#apigateway)
17. [applelaptop](#applelaptop)
18. [applelogo](#applelogo)
19. [ashorthistory](#ashorthistory)
20. [aspnet-5-cs](#aspnet-5-cs)
21. [aspnet-5-visual-basic](#aspnet-5-visual-basic)
22. [aspnet-core](#aspnet-core)
23. [aspnetcoreawseks](#aspnetcoreawseks)
24. [aspnetcoreunittests](#aspnetcoreunittests)
25. [ateamstabsharepointwebpartforonedrive](#ateamstabsharepointwebpartforonedrive)
26. [azure-active-directory](#azure-active-directory)
27. [azure-active-directory2](#azure-active-directory2)
28. [azure-ai-part-1](#azure-ai-part-1)
29. [azureai1-new](#azureai1-new)
30. [azureai1](#azureai1)
31. [azureopenal](#azureopenal)
32. [azurereactstaticweb-app](#azurereactstaticweb-app)
33. [azurestorage](#azurestorage)
34. [blazorwasmandasp.net](#blazorwasmandasp-net)
35. [blogcopilotstudio](#blogcopilotstudio)
36. [businesscentraladmincenter](#businesscentraladmincenter)
37. [businesscentralcanvasapps](#businesscentralcanvasapps)
38. [businesscentralintegrationtables](#businesscentralintegrationtables)
39. [businesscentralmicrosoftgraph](#businesscentralmicrosoftgraph)
40. [businesscentralpart 27 extendingstandardapis](#businesscentralpart-27-extendingstandardapis)
41. [businesscentralpart 2extendingstandardapis](#businesscentralpart-2extendingstandardapis)
42. [businesscentralpart25integratingwithdataverseusingdataflows](#businesscentralpart25integratingwithdataverseusingdataflows)
43. [businesscentralpart26integratingwithdataverseusingintegrationtables](#businesscentralpart26integratingwithdataverseusingintegrationtables)
44. [businesscentralpart26integrationtable](#businesscentralpart26integrationtable)
45. [businesscentralpart26integrationtables](#businesscentralpart26integrationtables)
46. [businesscentralpowerautomateflow](#businesscentralpowerautomateflow)
47. [businesscentralvirtualtable](#businesscentralvirtualtable)
48. [cloudflow](#cloudflow)
49. [codespacesauthentication](#codespacesauthentication)
50. [colorization](#colorization)
51. [componentframework](#componentframework)
52. [configurecopilotsinglesignonforweb](#configurecopilotsinglesignonforweb)
53. [configurecopilotwithauthentication](#configurecopilotwithauthentication)
54. [contextinjection](#contextinjection)
55. [copilotembedcode](#copilotembedcode)
56. [copilotstudiobctools](#copilotstudiobctools)
57. [createactionbasedonaflow](#createactionbasedonaflow)
58. [customcomponents](#customcomponents)
59. [customconnectorsappregistrations](#customconnectorsappregistrations)
60. [customcopilotstudio](#customcopilotstudio)
61. [customercontentvirtualtables](#customercontentvirtualtables)
62. [customercopilotstudio](#customercopilotstudio)
63. [customerpostinggroup](#customerpostinggroup)
64. [customgpt](#customgpt)
65. [customizedefaultcanvas](#customizedefaultcanvas)
66. [customtvirtualtables](#customtvirtualtables)
67. [dataverseadvancedreportssetup](#dataverseadvancedreportssetup)
68. [dataversefetchxml](#dataversefetchxml)
69. [dataversereports](#dataversereports)
70. [devopsstarterazuredevops](#devopsstarterazuredevops)
71. [devopsstartergithubactions](#devopsstartergithubactions)
72. [docker](#docker)
73. [dockerbuildx](#dockerbuildx)
74. [dotnet core part2 deleted](#dotnet-core-part2-deleted)
75. [dotnet core part3](#dotnet-core-part3)
76. [dotnet-core-part1](#dotnet-core-part1)
77. [dotnet-core-part2](#dotnet-core-part2)
78. [dynamicssales1](#dynamicssales1)
79. [dynamicssales2](#dynamicssales2)
80. [dynamicssales3](#dynamicssales3)
81. [dynamicssales4](#dynamicssales4)
82. [dynamicstrialsignup](#dynamicstrialsignup)
83. [electron](#electron)
84. [financialoperationspurchaseinvoice](#financialoperationspurchaseinvoice)
85. [finetuning](#finetuning)
86. [firebase](#firebase)
87. [generalledger](#generalledger)
88. [generalpostingsetup](#generalpostingsetup)
89. [gingerbreadhouse](#gingerbreadhouse)
90. [graphql](#graphql)
91. [hands-on-lab2.1](#hands-on-lab2-1)
92. [hands-on-lab2.2](#hands-on-lab2-2)
93. [hands-on-lab2.3](#hands-on-lab2-3)
94. [hands-on-lab3.1](#hands-on-lab3-1)
95. [hubspotquotetemplate](#hubspotquotetemplate)
96. [internetofthings1](#internetofthings1)
97. [internetofthings2](#internetofthings2)
98. [internetofthings3](#internetofthings3)
99. [ionic](#ionic)
100. [javascriptgraph](#javascriptgraph)
101. [kubernetes](#kubernetes)
102. [langchain](#langchain)
103. [langchainagents](#langchainagents)
104. [langflow1](#langflow1)
105. [leaflet](#leaflet)
106. [llamacorp](#llamacorp)
107. [lmstudio](#lmstudio)
108. [m365commandlineinterface](#m365commandlineinterface)
109. [macbook](#macbook)
110. [machinelearning](#machinelearning)
111. [machinelearning1](#machinelearning1)
112. [machinelearning2](#machinelearning2)
113. [machinelearning3](#machinelearning3)
114. [machinelearning4](#machinelearning4)
115. [machinelearning5](#machinelearning5)
116. [machinelearning6](#machinelearning6)
117. [machinelearning7](#machinelearning7)
118. [machinelearning8](#machinelearning8)
119. [machinelearning9](#machinelearning9)
120. [machinelearningwip](#machinelearningwip)
121. [macscreensharing](#macscreensharing)
122. [mapextension](#mapextension)
123. [mcpserver](#mcpserver)
124. [mcpserver2](#mcpserver2)
125. [microsoftdynamics365appforoutlook](#microsoftdynamics365appforoutlook)
126. [microsoftgraph](#microsoftgraph)
127. [modeldriven1](#modeldriven1)
128. [modeldriven2](#modeldriven2)
129. [modeldriven3](#modeldriven3)
130. [modeldriven4](#modeldriven4)
131. [modeldrivenapps](#modeldrivenapps)
132. [modeldrivenpurchaseorderlines](#modeldrivenpurchaseorderlines)
133. [modeldrivenpurchaseorders](#modeldrivenpurchaseorders)
134. [mssqlserver](#mssqlserver)
135. [mssqlserver2](#mssqlserver2)
136. [mssqlserver3](#mssqlserver3)
137. [multiplayer](#multiplayer)
138. [mysql](#mysql)
139. [nextjs1](#nextjs1)
140. [nextjs2](#nextjs2)
141. [nextjs3](#nextjs3)
142. [nextjs4](#nextjs4)
143. [nextjs5](#nextjs5)
144. [ngrx](#ngrx)
145. [ngrxdevtools](#ngrxdevtools)
146. [ngrxentity](#ngrxentity)
147. [npm](#npm)
148. [npmcc](#npmcc)
149. [nuget](#nuget)
150. [ollamadeepsekr1applemacbookinstall](#ollamadeepsekr1applemacbookinstall)
151. [opencv](#opencv)
152. [page134](#page134)
153. [page141](#page141)
154. [page152](#page152)
155. [page199](#page199)
156. [page200](#page200)
157. [page50](#page50)
158. [page55](#page55)
159. [page65](#page65)
160. [page68](#page68)
161. [page86](#page86)
162. [phaser](#phaser)
163. [phpsetup](#phpsetup)
164. [pi1](#pi1)
165. [pi2](#pi2)
166. [pluginactions](#pluginactions)
167. [postinggroups](#postinggroups)
168. [powerapps23](#powerapps23)
169. [powerapps23configurationmigrationtool](#powerapps23configurationmigrationtool)
170. [powerapps6](#powerapps6)
171. [powerappsapplication](#powerappsapplication)
172. [powerappswithrest](#powerappswithrest)
173. [powerappsxx](#powerappsxx)
174. [powerautomate](#powerautomate)
175. [powerautomatereports](#powerautomatereports)
176. [powerpages1](#powerpages1)
177. [powerpages2](#powerpages2)
178. [powerpages3](#powerpages3)
179. [promptdialog](#promptdialog)
180. [promptdialog2](#promptdialog2)
181. [promptdialog3](#promptdialog3)
182. [promptengineering](#promptengineering)
183. [promptflow1](#promptflow1)
184. [promptflow2](#promptflow2)
185. [promptflow3](#promptflow3)
186. [promptflow4](#promptflow4)
187. [promptflow5](#promptflow5)
188. [promptflow6](#promptflow6)
189. [purchaseinvoice](#purchaseinvoice)
190. [purview](#purview)
191. [pwa](#pwa)
192. [reactandasp.net](#reactandasp-net)
193. [reactusestateuseeffect](#reactusestateuseeffect)
194. [restapiservice](#restapiservice)
195. [rewardsextension](#rewardsextension)
196. [sails1](#sails1)
197. [sails2](#sails2)
198. [sails3](#sails3)
199. [salesinvoice](#salesinvoice)
200. [sentenceembeddings](#sentenceembeddings)
201. [sentencesimilarity](#sentencesimilarity)
202. [sentimentanalysis](#sentimentanalysis)
203. [sh1106](#sh1106)
204. [sharepoint2019](#sharepoint2019)
205. [sharepointsitedesignsandsitescripts](#sharepointsitedesignsandsitescripts)
206. [sharepointwebpart1](#sharepointwebpart1)
207. [sharepointwebpart2](#sharepointwebpart2)
208. [spring-boot-2](#spring-boot-2)
209. [spring-boot-3](#spring-boot-3)
210. [spring-boot-4](#spring-boot-4)
211. [spring-boot-5](#spring-boot-5)
212. [spring-boot-6](#spring-boot-6)
213. [spring-boot](#spring-boot)
214. [sprint-apps1](#sprint-apps1)
215. [stablediffusion](#stablediffusion)
216. [staticwebapp.config.json](#staticwebapp-config-json)
217. [streamlit](#streamlit)
218. [syntexautofill](#syntexautofill)
219. [taxsetup](#taxsetup)
220. [teamstoolkit](#teamstoolkit)
221. [teamstoolkitspfx](#teamstoolkitspfx)
222. [threejs](#threejs)
223. [threetier](#threetier)
224. [ticktacktoe](#ticktacktoe)
225. [topics](#topics)
226. [vbnetconsolesqlserverunittests](#vbnetconsolesqlserverunittests)
227. [vbnetwinforms](#vbnetwinforms)
228. [vendorpostinggroup](#vendorpostinggroup)
229. [voicekit](#voicekit)
230. [voicekit2](#voicekit2)
231. [warehousemanagementputaway](#warehousemanagementputaway)
232. [webcomponents](#webcomponents)
233. [webvr](#webvr)
234. [webxr](#webxr)
235. [xcode1](#xcode1)
236. [xcode2](#xcode2)
237. [xcode3](#xcode3)
238. [xcode4](#xcode4)
239. [yolo](#yolo)

---

## 3dprinting1

**Source file:** `3dprinting1.md`

---
title: "3D Printing 1"
description: "ELEGOO Mars 3 Pro 4K Resin 3D Printer"
date: "2023-07-15"
categories: []
tags: []
slug: "3dprinting1"
image: "/assets/images/wikipedia-globe-translucent-3d-printed-woodgrain-background-512x512.jpg"
---

## Tinkercad

I created a 3D .STL file using Tinkercad.

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.16.58-pm-1028x613.png)
*Create 3D Design*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.17.43-pm-1029x680.png)
*I added text*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.18.32-pm-1029x650.png)
*I updated the font. Notice that the Height was set to 10.*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.19.42-pm-1025x643.png)
*I added a block with a height of 5.*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.25.06-pm-860x643.png)
*I exported the design as .STL file*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.45.04-pm-1209x687.png)
*I downloaded CHITUBOX and added support for the "ELEGOO MARS 3 PRO"*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.45.17-pm-1208x686.png)
*Settings for the Mars 3 Pro*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.45.34-pm-1209x686.png)
*I imported the .STL file*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.46.01-pm-1207x686.png)
*I rotated the design.*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.46.13-pm-1209x689.png)
*I clicked "Slice"*

![](/assets/images/3dprinting1/screen-shot-2023-07-15-at-2.46.30-pm-1208x684.png)
*I saved the result as a .CTB file*

![](/assets/images/3dprinting1/img-3153-480x640.jpg)
*I checked that the build plate was level.*

![](/assets/images/3dprinting1/img-3145-480x640.jpg)
*I added resin to the tank*

![](/assets/images/3dprinting1/img-3170-480x640.jpg)
*I started the print*

![](/assets/images/3dprinting1/img-3172-480x640.jpg)
*The print completed in 40 minutes*

![](/assets/images/3dprinting1/img-3175-480x640.jpg)
*I removed the build plat from the printer*

![](/assets/images/3dprinting1/img-3180-480x640.jpg)
*I washed the part (still attached to the build plate)*

![](/assets/images/3dprinting1/img-3181-3-240x320.jpg)
*I dried the part (still sticky)*

![](/assets/images/3dprinting1/img-3184-240x320.jpg)
*I cured the part (with UV light)*

![](/assets/images/3dprinting1/img-3200-2-480x640.jpg)
*The final result*

---

## 3dprinting2

**Source file:** `3dprinting2.md`

---
title: "3D Printing 2"
description: "Raspberry Pi 4 and Mini Breadboard mount"
date: "2023-07-19"
categories: []
tags: []
slug: "3dprinting2"
image: "/assets/images/wikipedia-globe-translucent-3d-printed-woodgrain-background-512x512.jpg"
---

## Tinkercad

I updated an existing Tinkercad design to create a part to securely hold a Raspberry Pi 4 and small breadboard.

**Original design**
[https://www.tinkercad.com/things/8k21OQvUnlh](https://www.tinkercad.com/things/8k21OQvUnlh)

**Updated design**
[https://www.tinkercad.com/things/fQPX9bFkoC3-raspberry-pi-4-and-mini-breadboard-mount](https://www.tinkercad.com/things/fQPX9bFkoC3-raspberry-pi-4-and-mini-breadboard-mount)

![](/assets/images/3dprinting2/screen-shot-2023-07-20-at-9.19.04-am-1836x1024.png)
*Updated design*

![](/assets/images/3dprinting2/screen-shot-2023-07-20-at-9.35.25-am-1836x959.png)
*Sliced part*

![](/assets/images/3dprinting2/image3-640x480.jpg)
*M3 Tap Drill*

![](/assets/images/3dprinting2/image7-320x240.jpg)
*Finished assembly*

---

## addanitem

**Source file:** `addanitem.md`

---
title: "Add an Item"
description: "I used Patch to add a Business Central Item"
date: "2024-02-17"
categories: ["Microsoft Dynamics","Business Central","Power Platform"]
tags: []
slug: "addanitem"
image: "/assets/images/office-365-icon-500x500.png"
---

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.30.50-pm-1836x617.png)
*I opened the Business Central Configuration app*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.31.04-pm-1836x632.png)
*I made the Business Central Item table visible*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.32.22-pm-1836x947.png)
*I generated an Item Setup app with Copilot*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.33.24-pm-1836x950.png)
*I asked Copilot to remove the columns I did not need*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.34.21-pm-1836x838.png)
*I clicked the "Preview the app" button*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.34.44-pm-1836x945.png)
*I reviewed the app*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.35.10-pm-1836x251.png)
*I saved the app*

![](/assets/images/addanitem/screenshot-2024-02-17-at-4.00.08-pm-1836x749.png)
*I switched to the Data tab and clicked the + Add data button*

![](/assets/images/addanitem/screenshot-2024-02-17-at-4.01.49-pm-1836x773.png)
*I selected the Business Central Virtual Table*

![](/assets/images/addanitem/screenshot-2024-02-17-at-4.01.59-pm-1836x535.png)
*The Items table was added*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.48.48-pm-1836x943.png)
*I duplicated the delete button*

![](/assets/images/addanitem/screenshot-2024-02-17-at-1.50.12-pm-1836x774.png)
*I configured the new button to display the Publish icon*

![](/assets/images/addanitem/screenshot-2024-02-17-at-2.00.57-pm-1836x947.png)
*I updated the button's OnSelect property*

![](/assets/images/addanitem/screenshot-2024-02-17-at-2.01.46-pm-1836x812.png)
*I previewed the app*

![](/assets/images/addanitem/screenshot-2024-02-17-at-2.02.04-pm-1836x593.png)
*I selected an item and clicked the Publish button*

![](/assets/images/addanitem/screenshot-2024-02-17-at-2.02.19-pm-1836x748.png)
*The item was added to Business Central and the user is prompted to confirm a delete*

![](/assets/images/addanitem/screenshot-2024-02-17-at-2.02.31-pm-1836x718.png)
*The Item Setup record has been deleted*

![](/assets/images/addanitem/screenshot-2024-02-17-at-2.03.33-pm-1836x673.png)
*The Business Central item has been added*

---

## addapurchaseorder

**Source file:** `addapurchaseorder.md`

---
title: "Add a Purchase Order"
description: "I used Patch to add a Business Central Purchase Order and to add Purchase Order Lines"
date: "2024-02-21"
categories: ["Microsoft Dynamics","Business Central","Power Platform"]
tags: []
slug: "addapurchaseorder"
image: "/assets/images/office-365-icon-500x500.png"
---

## Summary

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.20.01-pm-1836x642.png)
*I created a Canvas app*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.20.16-pm-1836x839.png)
*I named the Canvas app "Purchase Orders App"*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.20.32-pm-1836x646.png)
*I clicked the Data tab*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.21.02-pm-1836x797.png)
*I added the Business Central "Vendors" Table*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.21.25-pm-1836x704.png)
*I added the Business Central "Items" Table*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.22.09-pm-1836x786.png)
*I added ComboBox1 allowing the user to select a Vendor*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.22.37-pm-1836x812.png)
*I added ComboBox2 allowing the user to select an Item*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.24.10-pm-1836x576.png)
*I added TextInput1 allowing the user to enter a comment*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.24.48-pm-1836x588.png)
*I added a "Create a Purchase Order" Button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.25.29-pm-1836x506.png)
*I added an "Update the Purchase Order" Button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.26.13-pm-1836x542.png)
*I added an "Add a Comment Purchase Order Line" Button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.26.57-pm-1836x541.png)
*I added an "Add an Item Purchase Order Line" Button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.31.13-pm-1836x787.png)
*I added the Business Central "Purchase Orders" Table*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.31.27-pm-1836x702.png)
*I added the Business Central "Purchase Order Lines" Table*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.42.25-pm-1836x606.png)
*I added OnSelect code to the Create a Purchase Order button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.44.22-pm-1836x586.png)
*I reviewed the purchaseOrderResultSet collection returned (the single row)*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.46.35-pm-1836x623.png)
*I added the OnSelect code to the "Update the Purchase Order" button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.46.49-pm-1836x503.png)
*I selected "First Up Consultants" and clicked the "Update the Purchase Order" button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.49.22-pm-1836x547.png)
*I added the OnSelect code to the "Add a Comment Purchase Order Line" button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.49.41-pm-1836x502.png)
*I entered "Example Comment" into the text input and clicked the "Add a Comment Purchase Order line" button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.50.19-pm-1836x684.png)
*I reviewed the Purchase Order and the Comment Purchase Order Line*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.51.50-pm-1836x568.png)
*I added the OnSelect code to the "Add an Item Purchase Order Line" button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.52.01-pm-1836x687.png)
*I selected the "ATHENS Mobile Pedestal" item*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.52.10-pm-1836x511.png)
*I clicked the "Add an Item Purchase Order Line" Button*

![](/assets/images/addapurchaseorder/screenshot-2024-02-21-at-8.52.43-pm-1836x733.png)
*I reviewed the newly created "ATHENS Mobile Pedestal" Purchase Order Line*

---

## al-go-pte

**Source file:** `al-go-pte.md`

---
title: "AL-Go-PTE"
description: "Extensions"
date: "2023-08-26"
categories: ["Microsoft Dynamics","Business Central","DevOps","Microsoft Dynamics"]
tags: []
slug: "al-go-pte"
image: "/assets/images/dynamics365-color.svg"
---

You can change Business Central by installing apps that add functionality, change behaviour, or give you access to 3rd party online services.

[AL-Go for GitHub](https://github.com/microsoft/AL-Go) is a set of GitHub templates and actions, which can be used to setup and maintain DevOps processes for your Business Central AL projects

I used [AL-Go for GitHub](https://github.com/microsoft/AL-Go) to [create a Business Central per-tenant extension (PTE) with VS Code](https://github.com/microsoft/AL-Go/blob/main/Scenarios/GetStarted.md).

(Notice that you can upload a Per Tenant Extension (PTE) to Microsoft Dynamics Business Central using the Business Central Extension Management page.)


I used the [AL-Go-PTE](https://github.com/microsoft/AL-Go-PTE) GitHub template repository https://github.com/microsoft/AL-Go-PTE

Prerequisites: A GitHub account, A Windows machine, VS-Code (with AL and PowerShell extensions installed), and Docker installed locally.

![](/assets/images/al-go-pte/screen-shot-2023-08-26-at-9.27.59-am-1836x1062.png)
*Create a new repository using the AL-Go-PTE GitHub template repository*

![](/assets/images/al-go-pte/screen-shot-2023-08-26-at-10.11.22-am-1836x1320.png)
*haddley-al-go-pte*


## Windows laptop

I installed Docker Desktop, Windows Subsystem for Linux, Git, GitHub Desktop, and Visual Studio Code on a Windows 10 laptop.

![](/assets/images/al-go-pte/20230826image01-940x681.png)
*Docker Desktop*

![](/assets/images/al-go-pte/20230826image19-856x376.png)
*Windows Subsystem for Linux*

![](/assets/images/al-go-pte/20230826image14-951x674.png)
*Git*

![](/assets/images/al-go-pte/20230826image05-1061x672.png)
*GitHub Desktop*

![](/assets/images/al-go-pte/20230826image16-1060x671.png)
*Visual Studio Code*

![](/assets/images/al-go-pte/20230826image02-957x658.png)
*I used GitHub Desktop to clone the haddley-al-go-pte repository*

![](/assets/images/al-go-pte/20230826image24-320x519.png)
*I switched Docker to support Windows container (rather than Linux containers)*

Enable-WindowsOptionalFeature -Online -FeatureName containers –All
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V –All

https://stackoverflow.com/questions/57431890/error-response-from-daemon-hcsshimcreatecomputesystem-the-virtual-machine-co

![](/assets/images/al-go-pte/20230826image11-855x251.png)
*I navigated to the .AL-Go folder and ran the localDevEnv.ps1 PowerShell script*

![](/assets/images/al-go-pte/20230826image18-859x720.png)
*I entered a username:admin and password:<password>*

![](/assets/images/al-go-pte/20230826image21-856x718.png)
*Downloading the business central docker image*

![](/assets/images/al-go-pte/20230826image22-856x721.png)
*Creating the docker image*

![](/assets/images/al-go-pte/20230826image23-1270x716.png)
*Docker desktop displays the Business Central image*

![](/assets/images/al-go-pte/20230826image24-1269x719.png)
*Docker desktop displays the Business Central container*

![](/assets/images/al-go-pte/20230826image26-1373x878.png)
*The container is configured*

![](/assets/images/al-go-pte/20230826image27-1265x717.png)
*Laptop folders are available inside the container*

![](/assets/images/al-go-pte/20230826image28-1266x719.png)
*I needed to navigate to http://bcserver/BC/tenant=default*

![](/assets/images/al-go-pte/20230826image29-1162x703.png)
*I re-entered my username:admin and password:<password> (see above)*

![](/assets/images/al-go-pte/20230826image30-1160x705.png)
*Business Central running in the local Docker container*

![](/assets/images/al-go-pte/20230826image31-857x719.png)
*Publishing the hello world extension (the settings are copied to launch.json)*

![](/assets/images/al-go-pte/20230826image32-929x677.png)
*The sample extension has been deployed. Navigating to the customers page triggers the message*

![](/assets/images/al-go-pte/20230826image33-1022x310.png)
*Installing AL Language Extention*

![](/assets/images/al-go-pte/20230826imag34-1365x989.png)
*I updated the trigger's MessageI ran AL: Download Symbols (entering my username:admin and password:<password>); and I clicked the Run | Start Debugging menu item*

## References

- [Getting started with AL Go! for Github and Business Central](https://youtu.be/XoXGbcUxw-c?si=jITPYm9le2NaPhki)

---

## amazonecs

**Source file:** `amazonecs.md`

---
title: "Amazon Elastic Container Service"
description: "Deploying to Amazon ECS"
date: "2021-09-20"
categories: ["AWS","DevOps","AI"]
tags: []
slug: "amazonecs"
image: "/assets/images/amazonecs/amazon-web-services-logo.svg"
---

Amazon Elastic Kubernetes Service (Amazon EKS) makes it possible to deploy, manage, and scale [containerized](docker.html) applications using [Kubernetes](kubernetes.html) on AWS. 

https://logz.io/blog/aws-eks-vs-ecs-vs-fargate-understand-differences/

Notice that Amazon also offer Amazon Elastic Container Service (Amazon ECS) and Amazon Fargate.

Since Amazon EKS is based on the open-source tool Kubernetes, all applications managed by Amazon EKS are fully compatible with applications managed by any standard Kubernetes environment.

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.20.10-pm-1836x1075.png)
*Login to aws.amazon.com*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.21.06-pm-1836x1048.png)
*AWS Management Console*


## Docker desktop

To demonstrate that it is possible to use the same kubectl client to deploy containers to a laptop or the AWS cloud consider this Docker desktop example.

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.16.52-pm-1836x1039.png)
*No containers running*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.17.46-pm-1836x1182.png)
*kutectl apply -f ./blog.yaml*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.18.30-pm-1836x1041.png)
*The cluster is running*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.18.57-pm-1836x1076.png)
*Accessing the Docker desktop cluster*


## aws cli

The aws command line tool is used to manage the Amazon Web Services cloud.

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-8.06.57-pm-1836x758.png)
*Creating a New AWS Access Key*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-8.07.09-pm-1472x456.png)
*Access Key Created*


## aws configure

aws configure is used to set credentials

```bash
% aws configure
```

AWS Access Key ID [None]: AKIAYLZDACM7MNDENQV4
AWS Secret Access Key [None]: iBXYnPPUTp+enyaVU2xvXXXXXXXXXXXXXXXXXXXX
Default region name [None]: 
Default output format [None]:


## eksctl

eksctl is a simple CLI tool for creating clusters on EKS - Amazon's managed Kubernetes service for EC2.

[https://github.com/weaveworks/eksctl](https://github.com/weaveworks/eksctl)

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.29.15-pm-1836x1016.png)
*eksctl documentation on the AWS site*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.48.33-pm-1836x1091.png)
*ekctl project on github*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.48.04-pm-1138x738.png)
*installing eksctl*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-7.52.44-pm-1836x934.png)
*No clusters*


## eksctl create cluster

```bash
% eksctl create cluster \
```

--name blog-cluster \
--node-type t2.nano \
--nodes 2

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-8.41.19-pm-1836x1185.png)
*using eskctl to create a cluster (node type t2.nano)*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-8.43.21-pm-1836x953.png)
*blog-cluster is being created*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.03.14-pm-1836x951.png)
*blog-cluster active*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.03.31-pm-1836x954.png)
*blog-cluster Elastic Cloud Compute (EC2) nodes created*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.03.56-pm-1836x1188.png)
*eksctl command finished*


## kubectl apply

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.06.36-pm-1836x1180.png)
*Using kubectl apply command to deploy containers*


## eksctl delete cluster

using ekctl delete to remove the cluster

```bash
% eksctl delete cluster \
```

--name blog-cluster

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.38.35-pm-1836x1181.png)
*eksctl delete cluster*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.40.30-pm-1836x954.png)
*The cluster has been deleted*


## Deleting an AWS Access Key

Publishing AWS Access Keys is not a great idea.

This is how Keys are deleted.

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.47.55-pm-1836x956.png)
*Select the Delete link*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.48.09-pm-1836x953.png)
*Click the Deactivate button*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.49.34-pm-1836x955.png)
*Confirm the access key name and click the Delete button*

![](/assets/images/amazonecs/screen-shot-2021-08-12-at-9.49.50-pm-1836x956.png)
*The Access key has been deleted*

---

## amazoneks

**Source file:** `amazoneks.md`

---
title: "Amazon Elastic Kubernetes Service"
description: "Deploying to Amazon EKS"
date: "2021-08-12"
categories: ["AWS","DevOps"]
tags: []
slug: "amazoneks"
image: "/assets/images/amazon-web-services-logo.svg"
---


Amazon Elastic Kubernetes Service (Amazon EKS) makes it possible to deploy, manage, and scale [containerized](docker.html) applications using [Kubernetes](kubernetes.html) on AWS. 

Since Amazon EKS is based on the open-source tool [Kubernetes](kubernetes.html), applications managed by Amazon EKS are compatible with applications managed by other Kubernetes environments.

Notice that Amazon also offer the Amazon Elastic Container Service (Amazon ECS).


## Docker desktop

To demonstrate that it is possible to use the same kubectl client to deploy containers to a laptop or Amazon EKS consider this Docker desktop example.

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.16.52-pm-1836x1039.png)
*No containers running*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.17.46-pm-1836x1182.png)
*kutectl apply -f ./blog.yaml*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.18.30-pm-1836x1041.png)
*The cluster is running*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.18.57-pm-1836x1076.png)
*Accessing the Docker desktop cluster*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.20.10-pm-1836x1075.png)
*Login to aws.amazon.com*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.21.06-pm-1836x1048.png)
*AWS Management Console*


## aws cli

The aws command line tool is used to manage the Amazon Web Services cloud.

![](/assets/images/amazoneks/screen-shot-2021-08-16-at-8.07.43-pm-902x618.png)
*My Security Credentials*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-8.06.57-pm-1836x758.png)
*Creating a New AWS Access Key*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-8.07.09-pm-1472x456.png)
*Access Key Created*


## aws configure

aws configure is used to set credentials

```bash
% aws configure
```

AWS Access Key ID [None]: AKIAYLZDACM7MNDENQV4
AWS Secret Access Key [None]: iBXYnPPUTp+enyaVU2xvXXXXXXXXXXXXXXXXXXXX
Default region name [None]: 
Default output format [None]:


## eksctl

eksctl is a simple CLI tool for creating clusters on Amazon EKS.

[https://github.com/weaveworks/eksctl](https://github.com/weaveworks/eksctl)

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.29.15-pm-1836x1016.png)
*eksctl documentation on the AWS site*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.48.33-pm-1836x1091.png)
*ekctl project on github*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.48.04-pm-1138x738.png)
*installing eksctl*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-7.52.44-pm-1836x934.png)
*No clusters*


## eksctl create cluster

```bash
% eksctl create cluster \
--name blog-cluster 
```

optional arguments:

**--node-type t2.nano \
--nodes 2**

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-8.41.19-pm-1836x1185.png)
*using eskctl to create a cluster (node type t2.nano)*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-8.43.21-pm-1836x953.png)
*blog-cluster is being created*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.03.14-pm-1836x951.png)
*blog-cluster active*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.03.31-pm-1836x954.png)
*blog-cluster Elastic Cloud Compute (EC2) nodes created*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.03.56-pm-1836x1188.png)
*~/neilhaddley/.kube/config file has been updated*


## kubectl apply

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.06.36-pm-1836x1180.png)
*Using kubectl apply command to deploy containers*

![](/assets/images/amazoneks/screen-shot-2021-08-15-at-2.48.29-pm-1836x924.png)
*cluster workloads*


## kubectl get

Get information about blog-service

kubectl [get service/blog-service](https://aws.amazon.com/premiumsupport/knowledge-center/eks-kubernetes-services-cluster/) |  awk {'print $1" " $2 " " $4 " " $5'} | column -t

![](/assets/images/amazoneks/screen-shot-2021-08-15-at-2.44.50-pm-1836x258.png)
*load balancer url*

![](/assets/images/amazoneks/screen-shot-2021-08-15-at-2.45.19-pm-1836x1158.png)
*Accessing the Amazon EKS cluster*


## eksctl delete cluster

using ekctl delete to remove the cluster

```bash
% eksctl delete cluster \
```

--name blog-cluster

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.38.35-pm-1836x1181.png)
*eksctl delete cluster*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.40.30-pm-1836x954.png)
*The cluster has been deleted*


## kubectl config use-context

To switch back to using Docker Desktop

```bash
% kubectl config use-context docker-desktop
```


![](/assets/images/amazoneks/screen-shot-2021-08-15-at-2.10.40-pm-1836x1036.png)
*switch back to docker-desktop*


## Deleting an AWS Access Key

Publishing AWS Access Keys is not a great idea.

This is how Keys are deleted.

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.47.55-pm-1836x956.png)
*Select the Delete link*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.48.09-pm-1836x953.png)
*Click the Deactivate button*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.49.34-pm-1836x955.png)
*Confirm the access key name and click the Delete button*

![](/assets/images/amazoneks/screen-shot-2021-08-12-at-9.49.50-pm-1836x956.png)
*The Access key has been deleted*

---

## amazonfargate

**Source file:** `amazonfargate.md`

---
title: "Amazon Fargate"
description: "Pay-as-you-go"
date: "2021-09-20"
categories: ["AWS","DevOps"]
tags: []
slug: "amazonfargate"
image: "/assets/images/amazonfargate/amazon-web-services-logo.svg"
---

AWS Fargate is a serverless, pay-as-you-go compute engine that simplifies running containers on Amazon Elastic Container Service (ECS) and Amazon Elastic Kubernetes Service (EKS)

Amazon Elastic Kubernetes Service (Amazon EKS) makes it possible to deploy, manage, and scale [containerized](docker.html) applications using [Kubernetes](kubernetes.html) on AWS. 

Notice that Amazon also offer Amazon Elastic Container Service (Amazon ECS) and Amazon Fargate.

Since Amazon EKS is based on the open-source tool Kubernetes, all applications managed by Amazon EKS are fully compatible with applications managed by any standard Kubernetes environment.

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.20.10-pm-1836x1075.png)
*Login to aws.amazon.com*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.21.06-pm-1836x1048.png)
*AWS Management Console*


## Docker desktop

To demonstrate that it is possible to use the same kubectl client to deploy containers to a laptop or the AWS cloud consider this Docker desktop example.

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.16.52-pm-1836x1039.png)
*No containers running*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.17.46-pm-1836x1182.png)
*kutectl apply -f ./blog.yaml*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.18.30-pm-1836x1041.png)
*The cluster is running*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.18.57-pm-1836x1076.png)
*Accessing the Docker desktop cluster*


## aws cli

The aws command line tool is used to manage the Amazon Web Services cloud.

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-8.06.57-pm-1836x758.png)
*Creating a New AWS Access Key*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-8.07.09-pm-1472x456.png)
*Access Key Created*


## aws configure

aws configure is used to set credentials

```bash
% aws configure
```

AWS Access Key ID [None]: AKIAYLZDACM7MNDENQV4
AWS Secret Access Key [None]: iBXYnPPUTp+enyaVU2xvXXXXXXXXXXXXXXXXXXXX
Default region name [None]: 
Default output format [None]:


## eksctl

eksctl is a simple CLI tool for creating clusters on EKS - Amazon's managed Kubernetes service for EC2.

[https://github.com/weaveworks/eksctl](https://github.com/weaveworks/eksctl)

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.29.15-pm-1836x1016.png)
*eksctl documentation on the AWS site*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.48.33-pm-1836x1091.png)
*ekctl project on github*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.48.04-pm-1138x738.png)
*installing eksctl*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-7.52.44-pm-1836x934.png)
*No clusters*


## eksctl create cluster

```bash
% eksctl create cluster \
```

--name blog-cluster \
--node-type t2.nano \
--nodes 2

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-8.41.19-pm-1836x1185.png)
*using eskctl to create a cluster (node type t2.nano)*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-8.43.21-pm-1836x953.png)
*blog-cluster is being created*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.03.14-pm-1836x951.png)
*blog-cluster active*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.03.31-pm-1836x954.png)
*blog-cluster Elastic Cloud Compute (EC2) nodes created*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.03.56-pm-1836x1188.png)
*eksctl command finished*


## kubectl apply

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.06.36-pm-1836x1180.png)
*Using kubectl apply command to deploy containers*


## eksctl delete cluster

using ekctl delete to remove the cluster

```bash
% eksctl delete cluster \
```

--name blog-cluster

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.38.35-pm-1836x1181.png)
*eksctl delete cluster*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.40.30-pm-1836x954.png)
*The cluster has been deleted*


## Deleting an AWS Access Key

Publishing AWS Access Keys is not a great idea.

This is how Keys are deleted.

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.47.55-pm-1836x956.png)
*Select the Delete link*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.48.09-pm-1836x953.png)
*Click the Deactivate button*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.49.34-pm-1836x955.png)
*Confirm the access key name and click the Delete button*

![](/assets/images/amazonfargate/screen-shot-2021-08-12-at-9.49.50-pm-1836x956.png)
*The Access key has been deleted*

---

## angular-new

**Source file:** `angular-new.md`

---
title: "Angular"
description: "A platform for building mobile and desktop web applications"
date: "2025-09-20"
categories: ["Web Development"]
image: "/assets/images/angular"
tags: ["angular","ai","ml"]
hidden: true
slug: "angular-new"
---

An Angular application is defined by a set of NgModules. 

An application always has at least one (root) module that enables bootstrapping.

An application typically has many feature modules.

Components define views (sets of screen elements).

Components use services (functionality not directly related to views).

Service providers can be injected into components as dependencies
.
Modules, components and services are classes (with decorators)


## Getting started

I installed the Angular command line interface using [npm](npm.html)

```bash
% npm i -g @angular/cli
```

I created a new Angular project using "ng new"

```bash
% ng new haddley-angular
```

![](/assets/images/angular/screen-shot-2022-06-18-at-5.38.07-pm-1174x746.png)
*npm i -g @angular/cli*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.39.27-pm-1178x738.png)
*I skipped Angular routing (I can add that later)*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.39.54-pm-1172x746.png)
*I select CSS (no preprocessor required)*


## Running the application locally

I started running the new Angular project by changing to the project directory and  using "ng serve"

```bash
% cd haddley-angular
% ng serve
```

![](/assets/images/angular/screen-shot-2022-06-18-at-5.43.13-pm-1162x744.png)
*I changed to the new project folder and ran "ng serve"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.43.39-pm-1176x740.png)
*The app is running on localhost:4200*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.44.14-pm-1836x1119.png)
*The out of the box home page*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.47.55-pm-1836x862.png)
*app.component.html is the home page component's "template"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.49.06-pm-1836x853.png)
*app.component.ts contains the home page component's class*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.49.27-pm-1836x858.png)
*app.component.css contains the home page component's styling (initially empty)*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.49.18-pm-1836x863.png)
*The app.component.spec.ts file provides unit tests that can be run using "ng test"*

![](/assets/images/angular/screen-shot-2022-06-19-at-11.05.45-am-1836x749.png)
*Running unit tests with "ng test"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.53.50-pm-1836x854.png)
*Updated app.component.html template*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.53.58-pm-1836x1117.png)
*The web page updates*


## Adding a component

I used "ng generate" component to add a component (in a new components folder)

```bash
% ng generate component components/header
```

![](/assets/images/angular/screen-shot-2022-06-18-at-5.55.46-pm-1836x855.png)
*ng generate*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.56.41-pm-1836x855.png)
*The new component has a class. The selector is "app-header"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.57.15-pm-1836x856.png)
*I updated the app.component's template to use the new component/selector*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.57.22-pm-1836x1117.png)
*The header component is rendered and the title text is discarded*

![](/assets/images/angular/screen-shot-2022-06-18-at-6.07.05-pm-1836x856.png)
*ng-content is used to render the "contents" provided by the parent.*

![](/assets/images/angular/screen-shot-2022-06-18-at-6.03.51-pm-1836x854.png)
*I updated the example to provide the title value to the child component as an attribute*

![](/assets/images/angular/screen-shot-2022-06-18-at-6.04.20-pm-1836x852.png)
*I added @Input() title: string to the header component allowing the header component to accept the "title" attribute*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*



---

## angular

**Source file:** `angular.md`

---
title: "Angular"
description: "A platform for building mobile and desktop web applications"
date: "2025-09-20"
categories: ["Web Development"]
image: "/assets/images/angular/hero.png"
tags: ["angular","ai","ml"]
hidden: true
slug: "angular"
---

An Angular application is defined by a set of NgModules. 

An application always has at least one (root) module that enables bootstrapping.

An application typically has many feature modules.

Components define views (sets of screen elements).

Components use services (functionality not directly related to views).

Service providers can be injected into components as dependencies
.
Modules, components and services are classes (with decorators)


## Getting started

I installed the Angular command line interface using [npm](npm.html)

```bash
% npm i -g @angular/cli
```

I created a new Angular project using "ng new"

```bash
% ng new haddley-angular
```

![](/assets/images/angular/screen-shot-2022-06-18-at-5.38.07-pm-1174x746.png)
*npm i -g @angular/cli*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.39.27-pm-1178x738.png)
*I skipped Angular routing (I can add that later)*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.39.54-pm-1172x746.png)
*I select CSS (no preprocessor required)*


## Running the application locally

I started running the new Angular project by changing to the project directory and  using "ng serve"

```bash
% cd haddley-angular
% ng serve
```

![](/assets/images/angular/screen-shot-2022-06-18-at-5.43.13-pm-1162x744.png)
*I changed to the new project folder and ran "ng serve"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.43.39-pm-1176x740.png)
*The app is running on localhost:4200*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.44.14-pm-1836x1119.png)
*The out of the box home page*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.47.55-pm-1836x862.png)
*app.component.html is the home page component's "template"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.49.06-pm-1836x853.png)
*app.component.ts contains the home page component's class*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.49.27-pm-1836x858.png)
*app.component.css contains the home page component's styling (initially empty)*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.49.18-pm-1836x863.png)
*The app.component.spec.ts file provides unit tests that can be run using "ng test"*

![](/assets/images/angular/screen-shot-2022-06-19-at-11.05.45-am-1836x749.png)
*Running unit tests with "ng test"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.53.50-pm-1836x854.png)
*Updated app.component.html template*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.53.58-pm-1836x1117.png)
*The web page updates*


## Adding a component

I used "ng generate" component to add a component (in a new components folder)

```bash
% ng generate component components/header
```

![](/assets/images/angular/screen-shot-2022-06-18-at-5.55.46-pm-1836x855.png)
*ng generate*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.56.41-pm-1836x855.png)
*The new component has a class. The selector is "app-header"*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.57.15-pm-1836x856.png)
*I updated the app.component's template to use the new component/selector*

![](/assets/images/angular/screen-shot-2022-06-18-at-5.57.22-pm-1836x1117.png)
*The header component is rendered and the title text is discarded*

![](/assets/images/angular/screen-shot-2022-06-18-at-6.07.05-pm-1836x856.png)
*ng-content is used to render the "contents" provided by the parent.*

![](/assets/images/angular/screen-shot-2022-06-18-at-6.03.51-pm-1836x854.png)
*I updated the example to provide the title value to the child component as an attribute*

![](/assets/images/angular/screen-shot-2022-06-18-at-6.04.20-pm-1836x852.png)
*I added @Input() title: string to the header component allowing the header component to accept the "title" attribute*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/angular/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*


---

## angular1

**Source file:** `angular1.md`

---
title: "Angular (Part 1)"
description: "A platform for building mobile and desktop web applications"
date: "2025-09-20"
categories: ["Web Development"]
image: "/assets/images/angular1/hero.png"
tags: ["angular","typescript","ai","ml","testing"]
hidden: true
slug: "angular1"
---

An Angular application is a set of [modules](https://angular.io/guide/architecture-modules). 

An application has at least one (root) module.

For large applications (with many routes) lazy loading [modules](https://angular.io/guide/feature-modules) keeps bundle sizes small.


## Getting started

I installed the Angular command line interface using [npm](npm.html)

```bash
% npm i -g @angular/cli
```

I created a new Angular project using "ng new"

```bash
% ng new haddley-angular
```

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.38.07-pm-1174x746.png)
*npm i -g @angular/cli*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.39.27-pm-1178x738.png)
*I skipped Angular routing (I can add that later)*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.39.54-pm-1172x746.png)
*I select CSS (no preprocessor required)*


## Running the application locally

I started running the new Angular project by changing to the project directory and  using "ng serve"

```bash
% cd haddley-angular
% ng serve
```

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.43.13-pm-1162x744.png)
*I changed to the new project folder and ran "ng serve"*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.43.39-pm-1176x740.png)
*The app is running on localhost:4200*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.44.14-pm-1836x1119.png)
*The out of the box home page*


## App Component

**ng new** creates a single app component.

The app component is defined using four files:

The **app.component.css** file is the component's cascading style sheet.
The **app.component.html** file is the component's html template.
The **app.component.spec.ts** file is used for testing.
The **app.component.ts** file is the component's typescript code.

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.47.55-pm-1836x862.png)
*app.component.html is the home page component's template*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.49.06-pm-1836x853.png)
*app.component.ts contains the home page component's class*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.49.27-pm-1836x858.png)
*app.component.css contains the home page component's styling (initially empty)*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.49.18-pm-1836x863.png)
*The app.component.spec.ts file provides unit tests that can be run using "ng test"*


## App Module

**ng new** creates a single module.

The app module includes a reference to the App Component.


## main.ts

The app module is referenced in the project's main.ts file.


## Updating the app.component

I updated app.component.html to

<h1>{{title}}</h1>

At runtime the {{title}} Angular expression is replaced with the value of the app component's title property.

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.53.50-pm-1836x854.png)
*Updated app.component.html template*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.53.58-pm-1836x1117.png)
*The web page updated*


## Adding a component

I used "ng generate" component to add a header component (in a "components" folder)

```bash
% ng generate component components/header
```

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.55.46-pm-1836x855.png)
*ng generate*

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.56.41-pm-1836x855.png)
*The new component's selector is "app-header"*


## Selector prefix

The angular.json file contains project specific settings.

The prefix value ("app" in this case) is added to the component name to create the selector.


## Updating the app.component (again)

I updated the app component's html template to make use of the header component.

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.57.15-pm-1836x856.png)
*I updated the app.component's template to use the new component/selector*


## Passing content to a component

Replacing the <h1> tags with the <app-header> tags resulted in the {{title}} value being lost.

![](/assets/images/angular1/screen-shot-2022-06-18-at-5.57.22-pm-1836x1117.png)
*The header component is rendered and the title text is discarded*


## ng-content can be used to access the missing content

I updated the header component's html template and used <ng-content> to return the parent component's content.

![](/assets/images/angular1/screen-shot-2022-06-18-at-6.07.05-pm-1836x856.png)
*ng-content is used to render the "contents" provided by the parent.*


## Passing properties

Then I updated the <app-header> tag to pass the {{title}} value as a component attribute

![](/assets/images/angular1/screen-shot-2022-06-18-at-6.03.51-pm-1836x854.png)
*I updated the example to provide the title value to the child component as an attribute*


## @Input

I made a corresponding update to the header component.

I added the **@Input() title: string;** property (and the **import { Input } from 'angular/core';** import)

![](/assets/images/angular1/screen-shot-2022-06-18-at-6.04.20-pm-1836x852.png)
*I added @Input() title: string to the header component allowing the header component to accept the "title" attribute*


## Updating the tests

I updated the app component and header component tests (in line with the changes made above).

The app component and header component are shown in the test results.


## ng build

ng build is used to build the dist folder that will be uploaded to the web server.


---

## angularandasp.net

**Source file:** `angularandasp.net.md`

---
title: "Angular and ASP.NET Core"
description: "Single Page Application (SPA) templates"
date: "2023-03-24"
categories: [".NET","Angular","TypeScript","React"]
tags: []
slug: "angularandasp.net"
image: "/assets/images/angular-full-color-logo.svg"
---


Visual Studio includes ASP.NET Core Single Page Application (SPA) templates that support Angular and React.

I review the Angular template here.


## ChatGPT

**I want to create a ASP.NET Core Angular project**

To create an ASP.NET Core Angular project, follow these steps:

Open Visual Studio and click on "Create a new project."
Select "ASP.NET Core Web Application" and click "Next."
Name your project and choose a location to save it. Then click "Create."
In the next screen, choose "Angular" for the front-end framework and select the latest version of .NET Core. Then click "Create."
Visual Studio will create a new project with the necessary files and folders for an Angular application inside an ASP.NET Core project.
You can now start developing your application by modifying the files in the "ClientApp" folder, which contains the Angular application. You can also modify the ASP.NET Core server-side code in the other folders and files.

Note: If you prefer to use the command line, you can create a new ASP.NET Core Angular project using the following command:

**$ dotnet new angular -n ProjectName**

![](/assets/images/angularandasp.net/screen-shot-2023-03-22-at-9.16.36-am-1440x880.png)
*I used Visual Studio 2022 for Mac*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.07.37-pm-1536x1089.png)
*I selected the Angular template*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.08.29-pm-1536x1088.png)
*I selected the (cross platform) ASP.NET Core 6 framework*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.09.06-pm-1536x1088.png)
*I provided a solution/project name*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.10.07-pm-1536x1125.png)
*The template includes client and server-side code*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.11.50-pm-1836x946.png)
*I ran the project.*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.14.10-pm-1836x1124.png)
*I reviewed the Program.cs file. The template includes a local user database. I registered as a user.*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.15.11-pm-1836x1087.png)
*I was able to login*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.18.50-pm-1836x863.png)
*main.ts specifies that AppModule is the bootstrap Module*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.19.13-pm-1836x862.png)
*app.module.ts declares {AppComponent, NavMenuComponent, ...} and the bootstrap value is set to AppComponent*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.17.45-pm-1836x867.png)
*app.component.ts depends on the app.component.html template*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.24.04-pm-1836x308.png)
*The app.component.html template includes a Navigation menu.*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.55.07-pm-1836x645.png)
*The Fetch data route has canActivate set to AuthorizeGuard*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-8.00.56-pm-1836x645.png)
*The WeatherForecastController includes [Authorize] decorator*

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.38.35-pm-1836x675.png)
*The Navigation Menu component include a reference to a Logon component*


## Update

As an experiment I updated the Angular code so the "Fetch data" menu item did not require a login

![](/assets/images/angularandasp.net/screen-shot-2023-03-24-at-7.58.07-pm-1836x920.png)
*Fetch data page is unable to fetch data from the WeatherForecast service if user is not logged in.*

---

## angularfirebase

**Source file:** `angularfirebase.md`

---
title: "Angular Firebase"
description: "Creating a new firebase project"
date: "2023-04-25"
categories: ["Angular","TypeScript","React","JavaScript"]
tags: []
slug: "angularfirebase"
image: "/assets/images/logo-lockup-firebase-vertical.svg"
---

I created a firebase project using https://console.firebase.google.com

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.02.39-pm-1836x1011.png)
*haddley-firebase*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.03.04-pm-1836x1009.png)
*disable google analytics*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.05.06-pm-1836x1001.png)
*wait*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.05.38-pm-1836x1011.png)
*firebase project has been created*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.07.10-pm-832x520.png)
*Web*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.10.13-pm-1836x1013.png)
*App nickname*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.11.10-pm-1836x1006.png)
*Firebase SDK*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.14.03-pm-1836x921.png)
*firebase project dashboard*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.14.57-pm-1836x729.png)
*Get started*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.15.48-pm-1836x842.png)
*Email/Password*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.17.21-pm-1836x892.png)
*Email/Password enable*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.18.19-pm-1836x769.png)
*esp8266*


## Creating a new angular project

I installed the Angular command line interface using [npm](npm.html)

```bash
% npm i -g @angular/cli
```

I created a new Angular project using "ng new"

```bash
% ng new haddley-angular
```

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.19.35-pm-1836x983.png)
*ng new haddley-angular*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.22.07-pm-1836x965.png)
*npm start*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.23.19-pm-1836x643.png)
*http://localhost:4200*


## angular fire

https://www.npmjs.com/package/@angular/fire

npm i @angular/fire

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-5.27.16-pm-1366x614.png)
*npm i @angular/fire*


## environments

I added firebaseConfig to environments.ts

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-8.24.03-pm-1836x551.png)
*environments.ts*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-8.43.55-pm-1836x773.png)
*I added provideFirebaseApp, provideFirestore, provideAuth and ReactiveFormsModule to app.module.ts*


## login, register and dashboard components

ng generate component login
ng generate component register
ng generate component dashboard

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-8.34.16-pm-1836x520.png)
*ng generate component login, register and dashboard*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-8.36.08-pm-1836x314.png)
*I removed the sample html from app.component.html*


## bootstrap 5

I used bootstrap for styling the forms

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-8.39.03-pm-1836x563.png)
*CSS stylesheet link*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-8.40.07-pm-1836x483.png)
*CSS stylesheet link added*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-8.41.32-pm-1836x803.png)
*example form*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-9.01.00-pm-1836x647.png)
*register.component.html*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-9.53.35-pm-1836x708.png)
*login.component.html*

![](/assets/images/angularfirebase/screen-shot-2023-04-26-at-11.09.01-am-1836x270.png)
*dashboard.component.html*


## Route

Angular routing configuration

![](/assets/images/angularfirebase/screen-shot-2023-04-26-at-11.26.53-am-1836x589.png)
*authguard.ts*

![](/assets/images/angularfirebase/screen-shot-2023-04-26-at-11.27.17-am-1836x621.png)
*app-routing.module.ts*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-9.57.46-pm-1836x580.png)
*firebase users (none)*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-9.58.10-pm-1836x583.png)
*/register*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-9.58.23-pm-1836x591.png)
*firebase users*

![](/assets/images/angularfirebase/screen-shot-2023-04-25-at-9.58.38-pm-1836x540.png)
*/login*

![](/assets/images/angularfirebase/screen-shot-2023-04-26-at-11.10.48-am-1836x613.png)
*/dashboard*


## ng deploy

I used "ng deploy" to deploy the app.

```bash
% ng deploy
```


![](/assets/images/angularfirebase/screen-shot-2023-04-26-at-11.55.42-am-1720x870.png)
*ng deploy*

![](/assets/images/angularfirebase/screen-shot-2023-04-26-at-11.56.01-am-1836x1011.png)
*https://haddley-firebase-e8e21.web.app*


## Saving and retrieving private message documents

addDoc and query collection

![](/assets/images/angularfirebase/screen-shot-2023-04-27-at-11.08.21-am-1836x476.png)
*rules*

![](/assets/images/angularfirebase/screen-shot-2023-04-27-at-11.08.59-am-1298x808.png)
*dashboard*


## dashboard.component.ts

```text
import { Component, OnInit } from '@angular/core';
import { Auth } from '@angular/fire/auth';

@Component({
  selector: 'app-dashboard',
  templateUrl: './dashboard.component.html',
  styleUrls: ['./dashboard.component.scss']
})
export class DashboardComponent implements OnInit {

  user = this.auth.currentUser;

  constructor(private auth: Auth) { }

  ngOnInit(): void {
    console.log(this.auth.currentUser);
  }

}
```

## dashboard.component.html

```text
<div class="container my-5">

    <p>dashboard works!</p>

    <div *ngIf="user">
        User {{ user.email }} is logged in.
    </div>

    <ul>
        <li *ngFor="let message of messages$ | async">
          {{ message.text }}
        </li>
      </ul>

    <form [formGroup]="createMessageForm" (ngSubmit)="onSubmit()">
        <div class="mb-3">
            <label for="exampleInputMessage1" class="form-label">Message</label>
            <input type="text" class="form-control" id="exampleMessage1" aria-describedby="messageHelp"
                formControlName="message">
            <div id="messageHelp" class="form-text">Enter message here.</div>
        </div>
        <button type="submit" class="btn btn-primary">Save</button>
    </form>
</div>
```

## dashboard.component.ts

```text
import { Component, OnInit } from '@angular/core';
import { Auth } from '@angular/fire/auth';
import { Firestore, addDoc, collection, collectionData, getFirestore, query, serverTimestamp, where } from '@angular/fire/firestore';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { Observable } from 'rxjs';

@Component({
  selector: 'app-dashboard',
  templateUrl: './dashboard.component.html',
  styleUrls: ['./dashboard.component.scss']
})
export class DashboardComponent implements OnInit {

  user = this.auth.currentUser;
  createMessageForm!: FormGroup;
  messages$: Observable<any[]>;

  constructor(private formBuilder: FormBuilder, private auth: Auth, firestore: Firestore) {
    this.createMessageForm = this.formBuilder.group({
      message: formBuilder.control('', [Validators.required, Validators.minLength(6)])
    })
    const uid = this.auth.currentUser?.uid;
    const result = query(collection(firestore, 'messages'), where("uid", "==", uid));
    console.log(result);
    this.messages$ = collectionData(result);
  }

  ngOnInit(): void {
    console.log(this.auth.currentUser);
  }

  public onSubmit(): void {
    this.saveMessage(this.createMessageForm.value.message)
    this.createMessageForm.reset();
  }

  // Saves a new message to Cloud Firestore.
  private async saveMessage(messageText: string) {
    try {
      const uid = this.auth.currentUser?.uid;
      await addDoc(collection(getFirestore(), 'messages'), {
        uid: uid,
        email: this.auth.currentUser?.email,
        text: messageText,
        timestamp: serverTimestamp()
      });
    }
    catch (error) {
      console.error('Error writing new message to Firebase Database', error);
    }
  }

}
```

## References

- [Building a web application with Angular and Firebase](https://developers.google.com/codelabs/building-a-web-app-with-angular-and-firebase)
- [Angular Firebase Tutorial](https://www.youtube.com/playlist?list=PL1UHgDbN7Tm4SZ6yLE9yDI-YDtf02uc7d)
- [Github Repository](https://github.com/Haddley/haddley-angular)

---

## angularphaser

**Source file:** `angularphaser.md`

---
title: "Angular and Phaser"
description: "Using Phaser in an Angular Component"
date: "2023-05-10"
categories: ["Angular","JavaScript","React"]
tags: []
slug: "angularphaser"
image: "/assets/images/phaser-logo-1836x1530.png"
---

## Highlights

```bash
% npm i -g @angular/cli
% ng new haddley-angular-phaser
% cd haddley-angular-phaser
% npm i phaser
% code .
% ng generate component bounce
```

Update angular.json:
```json
"scripts": ["node_modules/phaser/dist/phaser.min.js"]
```

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.09.49-pm-1144x740.png)
*ng new haddley-angular-phaser*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.10.31-pm-1136x738.png)
*npm i phaser*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.11.55-pm-1836x1045.png)
*ng generate component bounce*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.16.17-pm-1836x711.png)
*angular.json "scripts": ["node_modules/phaser/dist/phaser.min.js"]*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-9.29.36-pm-1834x442.png)
*I uploaded files to the /src/assets folder*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.22.39-pm-1836x658.png)
*I added a route*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.23.53-pm-1836x614.png)
*I removed unnecessary html*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.24.39-pm-1836x355.png)
*allowSyntheticDefaultImports*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.25.08-pm-1836x436.png)
*scripthost*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-8.36.42-pm-1836x261.png)
*VideoFrameCallbackMetadata issue*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-9.12.29-pm-1836x476.png)
*updating budgets*

![](/assets/images/angularphaser/screen-shot-2023-04-23-at-9.22.08-pm-1836x1231.png)
*running*

## References

- [Using Phaser in an Angular 8 Component](https://braelynnn.medium.com/using-phaser-in-an-angular-8-component-53644a2280e3)
- [Github](https://github.com/Haddley/haddley-angular-phaser)

---

## api-management

**Source file:** `api-management.md`

---
title: "Power Apps, Custom Connectors and API Management"
description: "Azure API Management Service"
date: "2021-08-02"
categories: ["Power Platform","Azure"]
tags: []
slug: "api-management"
image: "/assets/images/office-365-icon-500x500.png"
---


The API Management Service controls how api services are exposed to employees by applying authentication, authorization, and usage limits.

![](/assets/images/api-management/screen-shot-2021-08-01-at-6.03.37-pm-1554x1140.png)
*Navigate to Azure API Management services page*

![](/assets/images/api-management/screen-shot-2021-08-01-at-7.19.56-pm-1516x1412.png)
*Create haddley-api*

![](/assets/images/api-management/screen-shot-2021-08-01-at-7.20.41-pm-1518x1412.png)
*haddley-api will be created*

![](/assets/images/api-management/screen-shot-2021-08-01-at-7.22.37-pm-1794x962.png)
*haddley-api deployment in progress*

![](/assets/images/api-management/screen-shot-2021-08-01-at-8.21.56-pm-1796x954.png)
*haddley-api deployment complete*

![](/assets/images/api-management/screen-shot-2021-08-01-at-8.22.22-pm-1796x962.png)
*haddley-api overview*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.14.22-pm-1628x768.png)
*Existing Web Service API (no authentication)*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.14.51-pm-1624x772.png)
*Existing API includes Swagger*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.15.06-pm-1626x768.png)
*Url to swagger.json definition*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.18.25-pm-1836x1089.png)
*Add API to API Management*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.19.01-pm-1128x766.png)
*Provide url to swagger.json*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.27.46-pm-1836x1089.png)
*Review API details*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.28.02-pm-1836x1088.png)
*Test /Book GET*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.28.18-pm-1836x1086.png)
*Test is successful*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.29.00-pm-1836x1088.png)
*Create Power Connector (for Power Apps)*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.45.40-pm-1836x1089.png)
*Provide connector name*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.46.25-pm-1836x1089.png)
*New custom connector has been added*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.46.49-pm-1836x1082.png)
*Edit the connector to review*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.47.03-pm-1836x1085.png)
*Notice that an API Key/Subscription is required*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.47.37-pm-1836x1079.png)
*+ New connection (based on the Custom Connector)*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.48.00-pm-1836x1089.png)
*A Subscription key has to be provided*

![](/assets/images/api-management/screen-shot-2021-08-03-at-12.33.42-am-1594x746.png)
*Using Chrome to call the API Management service without passing the Subscription key*

![](/assets/images/api-management/screen-shot-2021-08-03-at-12.31.47-am-1836x1047.png)
*Using Postman to call the API Management service without passing the Subscription key*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.49.47-pm-1836x1088.png)
*Notice that a Subscription key was provided in the API Management test page*

![](/assets/images/api-management/screen-shot-2021-08-03-at-12.32.01-am-1836x1143.png)
*Using Postman to call the API Management service providing the Subscription key*

![](/assets/images/api-management/screen-shot-2021-08-02-at-9.24.05-pm-1836x694.png)
*The same Subscription key value can be copied from the API Management Subscriptions page*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.50.07-pm-1836x1086.png)
*Enter the Subscription key*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.50.26-pm-1836x1083.png)
*The new connection has been created*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.50.47-pm-1836x1087.png)
*Create a test Power App*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.51.04-pm-1836x1087.png)
*Blank Power App*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.51.28-pm-1836x1084.png)
*Add a data source*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.51.51-pm-1836x1088.png)
*The connector has been added*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.52.27-pm-1836x1084.png)
*Add a button and configure the "OnSelect" handler*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.52.41-pm-1836x1084.png)
*OnSelect books will be retrieved and stored in a "colBooks" collection*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.53.09-pm-1836x1088.png)
*Preview the app*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.53.18-pm-1836x1090.png)
*Press the Button*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.53.44-pm-1836x1088.png)
*Navigate to Collections to review the result*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.54.29-pm-1836x1085.png)
*Add a gallery control and set items property to colBooks collection*

![](/assets/images/api-management/screen-shot-2021-08-02-at-8.54.54-pm-1836x1086.png)
*update the gallery control to display book titles and isbn (numbers)*

![](/assets/images/api-management/screen-shot-2021-08-02-at-9.00.16-pm-1836x1082.png)
*Add a new subscription*

![](/assets/images/api-management/screen-shot-2021-08-02-at-9.01.26-pm-1836x1086.png)
*Copy the subscription key*

![](/assets/images/api-management/screen-shot-2021-08-02-at-9.04.27-pm-1836x420.png)
*Edit the connection*

![](/assets/images/api-management/screen-shot-2021-08-02-at-9.04.37-pm-1836x1087.png)
*Update the subscription key*

## References

- [How to import APIs to Power Apps using Azure API Management](https://www.youtube.com/watch?v=06CRN18kH1k)

---

## apigateway

**Source file:** `apigateway.md`

---
title: "API Gateway"
description: "How to publish a collection of microservices using an API Gateway."
date: "2021-02-10"
categories: ["DevOps","React","AWS","Azure"]
tags: []
slug: "apigateway"
image: "/assets/images/kubernetes-container-engine.svg"
---

Client applications can be configured to connect to services directly. 

Client applications can be configured to connect to services via a gateway.

A client might be a web page running in a browser or a mobile phone app.

![](/assets/images/apigateway/reverse-proxy-528x204.png)


The diagram above demonstrates how an API gateway sits between a client and a collection of services.

An API Gateway introduces latency but provides a number of benefits:

- **Improved security** - User authentication and other security tasks can be managed in one place
- **Better metrics** - Since all traffic flows through the gateway it is easier to add instrumentation  
- **Simpler code** - With the gateway managing security and metrics centrally each service is easier to write


## nginx

Here we use nginx as the basis of our reverse proxy. In the Docker file we specify that the /etc/nginx/conf.d/default.conf file in the nginx image will be replaced by a custom my-server.config

```dockerfile
FROM nginx
COPY ./my-server.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
```

## Reverse proxy

The proxied server URLs are set using the proxy_pass directive.

```nginx
server {
  listen 80;
  
  default_type text/plain;

  location / {
    proxy_pass http://books-react-service:3000;
  }

  location /books {
    proxy_pass http://books-service:5000;
  }

}
```


## Kubernetes

Kubernetes is a platform for managing containerized workloads.

The yaml file below ensures that there are two copies of the books image, two copies of the books-react image and one copy of the books-reverse-proxy image running at all times. 

The books-reverse-proxy image is the API Gateway.

The yaml file below ensures that clients are only able to connect to the API Gateway.

The books container image provides a [REST API Service](/posts/restapiservice). 

The books-react container image provides a [React App](/posts/reactusestateuseeffect).

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: books-deployment
  labels:
    app: books
spec:
  replicas: 2
  selector:
    matchLabels:
      app: books
  template:
    metadata:
      labels:
        app: books
    spec:
      containers:
        - name: books
          image: haddley/books
          ports:
            - containerPort: 5000
---
apiVersion: v1
kind: Service
metadata:
  name: books-service
spec:
  selector:
    app: books
  ports:
    - protocol: TCP
      port: 5000
      targetPort: 5000
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: books-react-deployment
  labels:
    app: books
spec:
  replicas: 2
  selector:
    matchLabels:
      app: books-react
  template:
    metadata:
      labels:
        app: books-react
    spec:
      containers:
        - name: books-react
          image: haddley/books-react
          ports:
            - containerPort: 3000
---
apiVersion: v1
kind: Service
metadata:
  name: books-react-service
spec:
  selector:
    app: books-react
  ports:
    - protocol: TCP
      port: 3000
      targetPort: 3000
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: books-reverse-proxy-deployment
  labels:
    app: books-reverse-proxy
spec:
  replicas: 1
  selector:
    matchLabels:
      app: books-reverse-proxy
  template:
    metadata:
      labels:
        app: books-reverse-proxy
    spec:
      containers:
        - name: books-reverse-proxy
          image: haddley/books-reverse-proxy
          ports:
            - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: books-reverse-proxy-service
spec:
  selector:
    app: books-reverse-proxy
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
  type: LoadBalancer
```


## Kubernetes Hosting

Kubernetes hosting is offered by Microsoft (Azure), Amazon (AWS) and Google (Google Cloud). 

Kubernetes can be run on a developer's laptop using Docker Desktop or Minikube.

Kubernetes can be run on a collection of Raspberry Pi computers using K3s.

Shown below is a copy of Docker Desktop hosting the Kubernetes cluster described above.

![Docker Desktop](/assets/images/apigateway/image-5-1250x720.png)
*Docker Desktop*

---

## applelaptop

**Source file:** `applelaptop.md`

---
title: "Apple MacBook"
description: "Anaconda Setup"
date: "2023-07-25"
categories: ["Python","AI"]
tags: []
slug: "applelaptop"
image: "/assets/images/jupyter.svg"
---

Anaconda is a popular open-source distribution of Python specifically tailored for data science, machine learning, and scientific computing.

Anaconda incorporates a package manager (Conda) and the Jupyter Notebook/Jupyter Lab development environments.


## Apple MacBook Reset

I reset my Apple MacBook laptop and installed Anaconda.

![](/assets/images/applelaptop/20230726-image0-1836x1377.jpg)
*I restarted my laptop and held down the power button until I was able to access the recovery assistant menu.*

![](/assets/images/applelaptop/20230726-image1-1836x1377.jpg)
*Options*

![](/assets/images/applelaptop/20230726-image2-1836x1377.jpg)
*Erase Mac...*

![](/assets/images/applelaptop/20230726-image3-1836x1377.jpg)
*Erase Mac*

![](/assets/images/applelaptop/20230726-image4-1836x1377.jpg)
*Select a wifi network*

![](/assets/images/applelaptop/20230726-image9-1836x1377.jpg)
*Reinstall macOS Ventura*

![](/assets/images/applelaptop/20230726-image11-1836x1377.jpg)
*Agree*

![](/assets/images/applelaptop/20230726-image12-1836x1377.jpg)
*Select disk*

![](/assets/images/applelaptop/20230726-image13-1836x1377.jpg)
*Installation takes 3 hours (approximately)*


## Anaconda install

I ran into a [documented issue](https://discussions.apple.com/thread/254786965) when I tried to install Anaconda on my Apple MacBook.

These install steps worked for me:

*I ran the Xcode setup "*xcode-select --install"

*I downloaded the anaconda [command line installer](https://repo.anaconda.com/archive/Anaconda3-2023.03-MacOSX-arm64.sh).

I opened a Terminal and navigated to ~/Downloads**

I ran the downloaded script "Bash Anaconda3-2023.03-MacOSX-arm64.sh"
*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-1.06.58-pm-1168x372.png)
*Python was not present*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-1.02.22-pm-1168x736.png)
*I installed Xcodexcode-select --install*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-6.16.57-pm-1170x320.png)
*I had installed python version 3.9.6*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-6.15.42-pm-994x262.png)
*The Xcode installation completed.*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-1.03.12-pm-1172x328.png)
*I installed AnacondaBash Anaconda3-2023.03-MacOSX-arm64.sh*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-1.07.27-pm-1170x354.png)
*I agreed to the license terms*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-1.08.01-pm-1166x742.png)
*I confirmed the install location*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-1.11.25-pm-1166x178.png)
*Anaconda installation completed*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-6.17.51-pm-1170x276.png)
*python 3.10.9 was now available in the "base" Anaconda environment*

![](/assets/images/applelaptop/screenshot-2023-08-01-at-6.18.26-pm-1170x348.png)
*I installed support for jupyter lab into the base environment*

---

## applelogo

**Source file:** `applelogo.md`

---
title: "Apple Logo"
description: "Anaconda Setup"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/applelogo/hero.png"
tags: ["python","ai","machine learning"]
slug: "applelogo"
hidden: true
---


Anaconda is a popular open-source distribution of Python specifically tailored for data science, machine learning, and scientific computing.

Anaconda incorporates a package manager (Conda) and the Jupyter Notebook/Jupyter Lab development environments.


## Apple MacBook Reset

I reset my Apple MacBook laptop and installed Anaconda.

![](/assets/images/applelogo/20230726-image0-1836x1377.jpg)
*I restarted my laptop and held down the power button until I was able to access the recovery assistant menu.*

![](/assets/images/applelogo/20230726-image1-1836x1377.jpg)
*Options*

![](/assets/images/applelogo/20230726-image2-1836x1377.jpg)
*Erase Mac...*

![](/assets/images/applelogo/20230726-image3-1836x1377.jpg)
*Erase Mac*

![](/assets/images/applelogo/20230726-image4-1836x1377.jpg)
*Select a wifi network*

![](/assets/images/applelogo/20230726-image9-1836x1377.jpg)
*Reinstall macOS Ventura*

![](/assets/images/applelogo/20230726-image11-1836x1377.jpg)
*Agree*

![](/assets/images/applelogo/20230726-image12-1836x1377.jpg)
*Select disk*

![](/assets/images/applelogo/20230726-image13-1836x1377.jpg)
*Installation takes 3 hours (approximately)*


## Anaconda install

I ran into a [documented issue](https://discussions.apple.com/thread/254786965) when I tried to install Anaconda on my Apple MacBook.

These install steps worked for me:

*I ran the Xcode setup "*xcode-select --install"

*I downloaded the anaconda [command line installer](https://repo.anaconda.com/archive/Anaconda3-2023.03-MacOSX-arm64.sh).

I opened a Terminal and navigated to ~/Downloads**

I ran the downloaded script "Bash Anaconda3-2023.03-MacOSX-arm64.sh"
*

![](/assets/images/applelogo/screenshot-2023-08-01-at-1.06.58-pm-1168x372.png)
*Python was not present*

![](/assets/images/applelogo/screenshot-2023-08-01-at-1.02.22-pm-1168x736.png)
*I installed Xcodexcode-select --install*

![](/assets/images/applelogo/screenshot-2023-08-01-at-6.16.57-pm-1170x320.png)
*I had installed python version 3.9.6*

![](/assets/images/applelogo/screenshot-2023-08-01-at-6.15.42-pm-994x262.png)
*The Xcode installation completed.*

![](/assets/images/applelogo/screenshot-2023-08-01-at-1.03.12-pm-1172x328.png)
*I installed AnacondaBash Anaconda3-2023.03-MacOSX-arm64.sh*

![](/assets/images/applelogo/screenshot-2023-08-01-at-1.07.27-pm-1170x354.png)
*I agreed to the license terms*

![](/assets/images/applelogo/screenshot-2023-08-01-at-1.08.01-pm-1166x742.png)
*I confirmed the install location*

![](/assets/images/applelogo/screenshot-2023-08-01-at-1.11.25-pm-1166x178.png)
*Anaconda installation completed*

![](/assets/images/applelogo/screenshot-2023-08-01-at-6.17.51-pm-1170x276.png)
*python 3.10.9 was now available in the "base" Anaconda environment*

![](/assets/images/applelogo/screenshot-2023-08-01-at-6.18.26-pm-1170x348.png)
*I installed support for jupyter lab into the base environment*


---

## ashorthistory

**Source file:** `ashorthistory.md`

---
title: "A Short History of Microsoft Dynamics and Microsoft Dataverse"
description: "Microsoft Dynamics and Microsoft Dataverse"
date: "2023-09-09"
categories: ["Microsoft Dynamics","Power Platform","Microsoft 365","Business Central"]
tags: []
slug: "ashorthistory"
image: "/assets/images/dynamics365-color.svg"
---

**In December** **2000 Microsoft announced plans to purchase Great Plains.**

Great Plains Software was an accounting software company located in Fargo, North Dakota, whose products focused on small to medium-sized businesses.

[Solomon Software was an accounting software company that was acquired by Great Plains Software - before Great Plains Software was acquired by Microsoft].

**In 2001 Microsoft announced plans to acquire iCommunicate.**

iCommunicate.net was a web based solution (ASP) for Customer Relationship Management (CRM)

**In May 2002 Microsoft announced plans to acquire Navision**

Navision was was an accounting software company located in Denmark.

[Axapta was an accounting software company created by a group of executives who left Navision. Axapta was acquired by Navision - before Navision was acquired by Microsoft].

**In January 2003 Microsoft released Microsoft CRM 1.0**

**In September 2003 Satya Nadella explained Project Green.**

In 2003 Satya Nadella (then Microsoft Business Solutions division's corporate VP of product development) explained that Project Green was an effort to re-write the Business Solutions divisions products using Microsoft's programming languages, development tools, and APIs.

**In September** **2005 Project Green was renamed Microsoft Dynamics**

**In December 2005 Microsoft released Microsoft Dynamics CRM 3.0**

Microsoft explained that the xRM platform that Microsoft Dynamics CRM 3.0 was built on could be used to create many types of business application.

**In January 2011 Microsoft released Dynamics CRM Online 2011**

**In October 2016 Microsoft announced the general availability of PowerApp and Common Data Services**

Common Data Services was an evolution of Microsoft Dynamics CRM 3.0's xRM platform.

**In November 2016 Microsoft announced the general availability of Microsoft Dynamics 365**

Microsoft explained that Dynamics 365 users would see that Microsoft were bringing their business applications closer together in how they look, feel and integrate with each other.

**In March 2018 Microsoft announced model-driven Power Apps and Common Data Services 2.0**

Microsoft explained that "If you are familiar with the Dynamics 365 platform, you are already familiar with the PowerApps platform and Model-driven Apps."

**In July 2020 Microsoft announced the general availability of Dataverse**

Microsoft explained that "Dataverse is built atop the Common Data Service"

**In October 2022 Microsoft announced general availability of Managed Environments**

Managed Environments made it easier to govern low-code apps.


## In December 2000 Microsoft announced plans to acquire Great Plains Software Inc.

December 21, 2000 |

REDMOND, Wash., and FARGO, ND, Dec. 21, 2000 — Microsoft Corp. and Great Plains Software Inc. today announced plans to join forces in an acquisition designed to provide small and medium companies with the technology necessary to thrive in an increasingly interconnected economy. The acquisition, according to Microsoft, represents a major step in the company’s entry into the small and medium business applications market.

Drawing on Microsoft’s global scale and .NET platform technology and Great Plains’ expertise in business applications for small and medium companies, both corporations say they view this as an opportunity to help small and medium business be more efficient and agile by automating interconnected business processes, bridging the gap between on-premise software and next generation connected software and services. This is also an important part of Microsoft’s strategy to deliver the power of the .NET platform to small and medium companies. At the same time, Microsoft and Great Plains will create new opportunities for partners to grow their businesses by delivering and integrating next generation solutions that take advantage of the powerful .NET foundation for small and medium business applications that Microsoft and Great Plains will provide.
On the eve of the announcement, key strategists from both corporations — Group Vice President Jeff Raikes, of Microsoft’s Productivity and Business Services Group, and Great Plains’ CEO Doug Burgum — took a few moments to sit down with PressPass to discuss the intricacies of acquisition, the significance of the deal to small and medium companies and about the new opportunities this will create for existing Microsoft and Great Plains partners.


## In 2001 Microsoft announced plans to acquire iCommunicate

In 2001 Microsoft acquired iCommunicate, which had 10 employees at the time. The developers behind iCommunicate.NET moved to Redmond and started developing a modern, web based CRM application together with Microsoft’s team. 

[https://jukkaniiranen.com/2013/09/history-of-microsoft-crm/](https://jukkaniiranen.com/2013/09/history-of-microsoft-crm/)

[http://www.ithell.com/Software/CRM_isn_t_a_bad_word/crm_isn_t_a_bad_word.html](http://www.ithell.com/Software/CRM_isn_t_a_bad_word/crm_isn_t_a_bad_word.html)


## In February 2002 Microsoft announced new Customer Relationship Management Solution

**Microsoft Business Solutions Customer Relationship Management 1.0**

FARGO, N.D., Feb. 25, 2002 — Microsoft Corp. today announced it will deliver Microsoft® Customer Relationship Management (CRM), the first Microsoft business solution built on .NET, later this year. Accessible from Microsoft Outlook® and the Web, Microsoft Customer Relationship Management will enable small and medium sized businesses to build more profitable customer relationships through increased sales effectiveness and more consistent customer service. Microsoft Customer Relationship Management is designed for rapid deployment, ease of use, and integration with Microsoft Office and Microsoft Great Plains' back-office solutions, increasing information reliability, employee usage and productivity.

"Microsoft Customer Relationship Management fills a significant need for a single integrated view of customers that delivers on the promise of increasing customer satisfaction, customer loyalty and more profitable customer relationships," said Doug Burgum, senior vice president at Microsoft Corp. and president of Microsoft Great Plains Business Solutions. "Microsoft Customer Relationship Management represents a substantial business opportunity for our partners to deliver an entirely new category of integrated solutions specifically designed for the unique needs of our small and medium-sized customers."

Microsoft Customer Relationship Management will be available as a standalone product as well as an integrated solution to Microsoft Great Plains® Dynamics, Solomon and eEnterprise. Its expected availability in North America is in the fourth quarter of 2002. Availability outside of North America will be phased and is expected to begin in the first quarter of 2003. It will be sold and implemented through Microsoft Great Plains' reselling partner channel, and support will be provided by partners and Microsoft Great Plains' award-winning customer support team. The solution will be available on-premise or as a hosted solution through select partners.

"We're excited about Microsoft Customer Relationship Management and what it means for us and for customers," said Dan Taylor, president and CEO of ManagedOps.com Inc. "As a partner, it's a significant addition to our solution offerings, and customers can be assured of the commitment and service Microsoft Great Plains is known for."

[https://web.archive.org/web/20051013143714/http://www.microsoft.com/presspass/press/2002/feb02/02-26midmarketpr.mspx](https://web.archive.org/web/20051013143714/http://www.microsoft.com/presspass/press/2002/feb02/02-26midmarketpr.mspx)


## In May 2002 Microsoft announced plans to acquire Navision

Microsoft to Acquire Navision
May 7, 2002 |

COPENHAGEN, Denmark, May 7, 2002 — Microsoft Corp. today announced it has reached an agreement to acquire Navision, a global provider of integrated business software solutions. The acquisition will bring together the complementary geographic and product strengths of Navision with Microsoft Great Plains Business Solutions, enhancing Microsofts ability to deliver interconnected .NET business solutions for small and midmarket businesses.

The acquisition is structured as a stock and cash purchase based on an offer to shareholders of 300DKK per share. The total transaction value is estimated at approximately $1.3 billion (U.S.)/1.4 billion EUR/10.8 billion DKK.

[https://news.microsoft.com/2002/05/07/microsoft-to-acquire-navision/](https://news.microsoft.com/2002/05/07/microsoft-to-acquire-navision/)


## In January 2003 announced new Microsoft CRM 1.0 released

Microsoft Business Solutions Customer Relationship Management 1.0 was released in January 2003.

[https://jukkaniiranen.com/2013/09/history-of-microsoft-crm/](https://jukkaniiranen.com/2013/09/history-of-microsoft-crm/)


## In September 2003 Microsoft explained Project Green

The rationale for Project Green was that, in order to get the kind of deep and wide integration that increasingly defines all Microsoft software, the company had to write applications using its own programming languages, development tools, and APIs.

In September 2003 Satya Nadella (then Microsoft Business Solutions division's corporate VP of product development) explained that Project Green was an effort involving about 40% of Business Solutions' 1,700 programmers.

[https://www.informationweek.com/software/microsoft-is-keen-on-green](https://www.informationweek.com/software/microsoft-is-keen-on-green)


## In September 2005 Project Green was renamed Microsoft Dynamics

**In September 2005 Project Green was renamed "Microsoft Dynamics"**

'Project Green' Renamed Microsoft Dynamics
BY SCOTT BEKKER SEPTEMBER 07, 2005
The realignment of the Microsoft Business Solutions product set previously referred to as "Project Green" got its official name Wednesday -- Microsoft Dynamics.

The announcement came out of Microsoft's new Business Summit on the Redmond campus, where the company is focusing on the needs of medium-sized businesses, which the company defines as having 25 to 500 PCs.

In an executive e-mail sent early Wednesday, Microsoft CEO Steve Ballmer framed the problem by saying that in doing market research at midsize companies, Microsoft found that "today's business software doesn't look enough like today's businesses."

"We have designed the next generation of our business solutions, which we're calling Dynamics, around 50 of the most common roles in a midsize company. These solutions expose and connect the specific activities, processes and reports people need for real jobs inside a company, whether they're the president, the finance manager, the warehouse worker or the support clerk. And they'll have the familiar look and feel people know from using Microsoft Windows and Microsoft Office today," Ballmer wrote.

Microsoft will rebrand the core Microsoft Business Solutions products with the Dynamics name as new versions roll out next year. The grand plan is to roll four of the core products into one product in 2008, while offering Microsoft's CRM product both as part of the suite or separately.

In 2006 the product names will change from:

Microsoft CRM to Microsoft Dynamics CRM
Microsoft Business Solutions-Great Plains to Microsoft Dynamics GP
Microsoft Business Solutions-Axapta to Microsoft Dynamics AX
Microsoft Business Solutions-Navision to Microsoft Dynamics NAV
Microsoft Business Solutions-Solomon to Microsoft Dynamics SL.

The 2006 releases, called the wave 1 releases of Microsoft Dynamics, will include a more unified look and feel, contextual business intelligence, a greater emphasis on portals and increased integration with Web services.

Wave 2, in 2008, is supposed to deliver "best of" features and functionality of Axapta, Great Plains, Navision and Solomon. A separate version of Microsoft CRM that will be released in wave 2 will be available with or without the rest of Microsoft Dynamics.

To reduce the licensing uncertainty surrounding product consolidations, Microsoft is promoting a current licensing option called Transformational Assurance. "The Transitional Assurance benefit of the Enhancement Program is that when customers license Microsoft Business Solutions-Solomon, including the Standard editions, as well as Microsoft CRM, and stay current on the Microsoft Business Solutions Enhancement Program, they will be able to move to the future business application suite without having to reacquire the functionality they already license," Microsoft corporate vice president in the Microsoft Business Solutions Group Tami Reller said in a Q&A posted on Microsoft's site.

Microsoft Business Solutions is one of seven divisions at Microsoft. The company will continue to refer to the division by that name internally. Microsoft will also keep the current names for the division's other products: Microsoft Point of Sale, Microsoft Retail Management System, Microsoft FRx and Microsoft C5.

[https://rcpmag.com/articles/2005/09/07/project-green-renamed-microsoft-dynamics.aspx](https://rcpmag.com/articles/2005/09/07/project-green-renamed-microsoft-dynamics.aspx)


## In December 2005 Microsoft released (Project Green) Microsoft Dynamics CRM 3.0

*So in December of 2005, Microsoft released Microsoft Dynamics CRM 3.0, the first to carry the Dynamics brand name. 3.0 was also the first release to include basic marketing including campaigns and static marketing lists. Professionally I had moved onto another Microsoft partner and was becoming interested in Dynamics CRM 3.0 as an application platform. I invested in this book and read it in a weekend. I still have a copy of this book about five feet from me, and while I haven’t opened the book in years it is a reminder of the early days of Dynamics CRM.

Dynamics 3.0 introduced the idea of XRM – CRM could be extended beyond simple contact and sales management. Instead, CRM 3.0 made customization simple but still not as simple as CRM today. While forms could be customized within the applications, Workflows were developed in an external Workflow manager that existed on the CRM server.*

[https://www.encloud9.com/blog/dynamics-crm-personal-history/](https://www.encloud9.com/blog/dynamics-crm-personal-history/)


## The xRM platform

Microsoft Dynamics CRM 3.0 allowed the creation of custom entities. 

 Microsoft explained that the [xRM](https://learn.microsoft.com/en-us/dotnet/api/microsoft.xrm.sdk?view=dataverse-sdk-latest) platform that Microsoft Dynamics CRM 3.0 was built on could be used to create many types of business application.

Here is a description from the Microsoft Video:

*One Platform.  Many Applications.  Infinite Possibilities. *
 

Introducing the xRM platform underlying Microsoft Dynamics CRM that allows organizations to rapidly develop many different unique line of business applications, ranging from the simple to the most complex.

[https://www.youtube.com/watch?v=Yru5CkANOKA&t=34s](https://www.youtube.com/watch?v=Yru5CkANOKA&t=34s)


## In January 2011 Microsoft released Dynamics CRM Online 2011

[https://blogs.microsoft.com/blog/2011/01/17/microsoft-announces-global-release-of-dynamics-crm-online-2011/](https://blogs.microsoft.com/blog/2011/01/17/microsoft-announces-global-release-of-dynamics-crm-online-2011/)

Microsoft Announces Global Release of Dynamics CRM Online 2011
Jan 17, 2011 | Microsoft blog editor - Microsoft News Center Staff

Today, Microsoft announced the worldwide availability of Microsoft Dynamics CRM Online 2011.
The new cloud service will be available in 40 markets and 41 languages and delivers familiar, intelligent and connected experiences to customers.


## In October 2016 Microsoft announced the general availability of PowerApps and Common Data Service

[https://powerapps.microsoft.com/en-us/blog/announcing-general-availability/](https://powerapps.microsoft.com/en-us/blog/announcing-general-availability/)

Announcing general availability of PowerApps
Headshot of article author Darshan Desai
Darshan Desai, Group Program Manager, PowerApps, Monday, October 31, 2016

We introduced the public preview of PowerApps in April 2016. In the six months since, over 124,000 users from 46,000 organizations in 143 countries have created web and mobile apps using PowerApps. We thank all of our preview users for their invaluable feedback, which has helped shape PowerApps into a better product.

Today, we are very happy to announce the general availability of PowerApps. PowerApps is ready for production use, across 6 regions and in 42 languages, with the 99.9% SLA customers expect from a Microsoft service.

In this release, we are pleased to announce a lot of new capabilities, and here are the key new features.

PowerApps Red heart SharePoint: fully integrated with SharePoint lists

In August, we started rolling out the preview of PowerApps integrated in SharePoint Online modern lists. You can create an app right from the command bar of a SharePoint Online custom list. That app then appears as a custom view of your SharePoint Online list, and users can access it both from the web as well as from the SharePoint Mobile app. This experience is now available to all SharePoint Online users. PowerApps also supports connecting to on-premises SharePoint lists for SharePoint 2013 and 2016 using the on-premises data gateway. Learn more about creating apps from SharePoint Online modern lists.

SPO-PowerApps

General availability of Common Data Service

With the general availability of PowerApps, Common Data Service is also now ready for global production use. Common Data Service is included as part of PowerApps plans and is the unifying backbone for your business data across PowerApps, Microsoft Flow, and pro-development tools. It provides an instantly available and scalable data store and a common data model with standard entity schema and behavior. It also provides a powerful data access layer with support for data import and export, security, and integration with Microsoft Office for Excel and Outlook. We’ll soon provide a software development kit (SDK) for professional development scenarios. We’ve incorporated lot of feedback from our preview users as well as from customers who are building business apps using Dynamics 365 and Office 365. You can learn more about the new features and the roadmap for Common Data Service in Arif’s blog post.

CDS-Overview


## In November 2016 Microsoft announced the general availability of Microsoft Dynamics 365

[https://loudblogs.microsoft.com/dynamics365/bdm/2016/11/01/microsoft-dynamics-365-now-generally-available/](https://cloudblogs.microsoft.com/dynamics365/bdm/2016/11/01/microsoft-dynamics-365-now-generally-available/)

November 1, 2016

James Phillips, Corporate Vice President, Microsoft Business Applications, Platform and Intelligence Group

Jujhar Singh, Corporate Vice President, Microsoft Dynamics CRM

Last month we unveiled and provided a first look at Dynamics 365, showing off the capabilities our customers can expect from our latest generation of intelligent business applications. Today, we are excited to announce that Dynamics 365 is generally available.

The first thing users will see with Dynamics 365 is that we are bringing our business applications closer together in how they look, feel and integrate with each other. To better enable end-to-end business processes, we have unified the navigation and core user experience across each of the Dynamics 365 applications. It remains clean, beautiful, and familiar and it gives you the ability to seamlessly move from one application to another without switching windows.

...

Simple, consistent navigation is only the beginning. Dynamics 365 delivers significant new capabilities across all application areas, moving our proven industry leading in-market solutions to the next level:

Dynamics 365 for Sales adds new social selling capabilities enabling people to share knowledge and participate in social conversations, find and connect with new companies and people to generate new leads. In addition, gamification is moving from preview to global general availability. It will expand beyond sales scenarios to help teams across the entire organization collaborate and compete in fun, engaging contests. With highly visible contest results, users are motivated to perform their best for themselves and their teams, leading to increased performance, productivity, and adoption.

Dynamics 365 for Customer Service, helps agents use relevance search to quickly find related content and use faceting to filter to the right record. Agents are now able to edit records directly in a grid while respecting the business rules for the entity.

Dynamics 365 for Field Service, helps organizations improve resource productivity by enabling service organizations to fit in more appointments each day by automatically optimizing technician schedules to minimize driving distance between appointments. Connectivity with IoT is now seamlessly integrated at the platform level enabling connected device signals received to initiate many business processes, such as automatically dispatching a technician for preventative maintenance, as well as the ability to send back commands directly from within the application, for example resetting a sensor.

Dynamics 365 for Project Service Automation, enables unified resource scheduling and service billing experiences, allowing organizations to leverage scarce resources and skillsets not only across field and project-based services, but any source of resource demand.

Dynamics 365 for Operations, the evolution of Dynamics AX on Azure, is our complete business management solution with industry capabilities around Retail, Distribution, Manufacturing, Public Sector and Service industries, across the spectrum of backend operations into Financials for upper mid-market and larger customers. With this update, Dynamics 365 for Operations will add country specific versions of the app for 18 new markets.  Also, as announced last month, we will provide a Cloud Connected on-premises deployment option (available in first half of 2017), with all the inherent benefits of the cloud. The Fall update adds a Vendor Collaboration portal to streamline key processes including Invoicing, a reimagined approach to Cost Accounting, enhanced deployment options for Retail store environments, out of the box support for US Payroll, including Affordable Care Act Reporting, and myriad additional functional enhancements across the product.

Dynamics 365 for Financials, our comprehensive business management solution for small- to midsize- businesses (SMBs), that has generated tremendous excitement through its public preview program as Project “Madeira” is now also generally available, delivering everything SMBs that have outgrown their basic accounting software require, powered by the Microsoft cloud.

...


## In March 2018 Microsoft announced the general availability of model-driven apps and Common Data Service (2.0)

[https://powerapps.microsoft.com/en-us/blog/introducing-model-driven-apps/](https://powerapps.microsoft.com/en-us/blog/introducing-model-driven-apps/)

Introducing model-driven apps – a new way to create
Headshot of article author Adrian Orth
Adrian Orth, Principal Program Manager, Wednesday, March 21, 2018

We are happy to announce the preview of the Model-Driven Apps within PowerApps.  PowerApps is the platform on which Dynamics 365 apps are natively built.  Model-driven apps provides a no-code or low-code component approach to app development. 

Model-driven apps run with the new Unified Interface client which provides a responsive accessible design running in browsers and on popular mobile devices.  This app type composes multiple component types including dashboards, forms, views, charts, and business processes which together form a great UI.  If you are familiar with the Dynamics 365 platform, you are already familiar with the PowerApps platform and Model-driven Apps.

Both model-driven and canvas apps allow you to easily build business apps.  They both share access to the Common Data Service providing standard and custom entities.  Canvas apps start with your user experience, crafting a highly tailored interface with the power of a blank canvas and connecting it to 200 data sources. Canvas apps can be built for web, mobile, and tablet applications. Model-driven apps start with your data model – building up from the shape of your core business data and processes in the Common Data Service to model forms, views, and other components. Model-driven apps automatically generate great UI that is responsive across devices.


## In July 2020 Microsoft announced the general availability of Dataverse

[https://powerapps.microsoft.com/fr-ca/blog/introducing-project-oakdale-a-new-low-code-data-platform-for-microsoft-teams/](https://powerapps.microsoft.com/fr-ca/blog/introducing-project-oakdale-a-new-low-code-data-platform-for-microsoft-teams/)

Introducing Dataverse, a new low-code data platform for Microsoft Teams
Headshot of article author Charles Lamanna
Charles Lamanna, CVP, Low Code Application Platform, Tuesday, July 21, 2020

The COVID-19 crisis has rapidly changed the way we live and work, and many organizations have shifted to remote work or are implementing a hybrid remote work approach as they reopen physical locations. To support this shift to hybrid remote work, we continue to improve the Microsoft Power Platform integration with Microsoft Teams to enable our customers to tailor Microsoft 365 to their needs and empower everyone to be a developer using low-code tools.

Today, we are excited to announce the release of Dataverse. Dataverse delivers a built-in low code data platform for Microsoft Teams, and provides relational data storage, rich data types, enterprise grade governance, and one-click solution deployment. Dataverse enables everyone to easily build and deploy apps and intelligent chatbots in Teams with Power Apps and Power Virtual Agents. Dataverse is built atop the Common Data Service, which reached general availability four years ago. Since that time, the Common Data Service added over 1,000 features and introduced support for Dynamics 365 and Power Apps.


## In October 2022 Microsoft announced the general availability of Managed Environments

[https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments](https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments)

Announcing the general availability of Managed Environments
Headshot of article author Ryan Cunningham
Ryan Cunningham, VP, Power Apps, Wednesday, October 12, 2022

We are pleased to announce the general availability of Managed Environments.

Enabling people with diverse technical and nontechnical skills to contribute to the development process through low-code tools has unlocked an explosion of apps. While low-code has accelerated companies’ abilities to innovate, it has also introduced new dimensions to scaling and managing your developer community.

For IT, the rapid growth of apps brings new challenges of managing, securing, and governing these decentralized technology stacks. With so many apps being created, we need to make sure they are secure and scalable. Figuring out the right way to balance governance without stifling innovation is not easy. That’s why we created Managed Environments—to make it easier than ever to govern low-code apps and ensure they’re safe for the entire organization. With just a few clicks, IT administrators can immediately light up features that give more visibility, more control, and require less effort to manage all of their low-code assets.

Dive deeper in our Managed Environments general availability announcement and learn how you can gain more visibility and control over your application ecosystem today.

[https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments/](https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments/)

---

## aspnet-5-cs

**Source file:** `aspnet-5-cs.md`

---
title: "ASP.NET 5 C#"
description: "Generate Context and Entity Classes from an Existing Database"
date: "2023-03-19"
categories: [".NET","AI"]
tags: []
slug: "aspnet-5-cs"
image: "/assets/images/net-logo.svg"
---


ASP Web Forms was released in 2003 (based on the Windows Server and the .NET Framework)

ASP.NET Model-View-Controller 5 was released in 2009 (based on Windows Server and .NET Framework and Supported in Visual Studio 2019)

ASP.NET Core Model-View-Controller was released in 2017 (based on cross platform .NET Core and Supported in Visual Studio 2022)

I used Visual Studio 2019 and ASP.NET MVC 5 to create a todo app.

![](/assets/images/aspnet-5-cs/capturea1-create-a-new-project-1028x681.png)
*I created a new project*

![](/assets/images/aspnet-5-cs/capturea2-configure-your-new-project-1026x683.png)
*I configured the new project*

![](/assets/images/aspnet-5-cs/capturea3-mvc-1022x708.png)
*I created a Model-View-Controller web application*

![](/assets/images/aspnet-5-cs/capturea4-running-1380x729.png)
*I ran the template project (notice the "ASP.NET MVC gives" text in the index.cshtml file and the web browser).*

![](/assets/images/aspnet-5-cs/capturea5-layout-1366x729.png)
*The _Layout.cshtml file provides a common web page framework and navigation*

![](/assets/images/aspnet-5-cs/capturea5-layout-1366x729.png)
*Web requests are handled by Controller functions/methods. The controller function will typically return a view (the Web response). The About function sets a "Message" value and then returns a corresponding About view.*

![](/assets/images/aspnet-5-cs/capturea6-home-controller-1362x729.png)
*Notice that the About view renders the "Message".*

![](/assets/images/aspnet-5-cs/capturea8-view-page-with-layout-1361x731.png)
*I added a view page to the HelloWorld folder.*

![](/assets/images/aspnet-5-cs/capturea9-name-view-1366x357.png)
*I named the new page "Index" making it the home page for the new folder.*

![](/assets/images/aspnet-5-cs/capturea10-select-layout-1365x500.png)
*I selected the existing _Layout page*

![](/assets/images/aspnet-5-cs/capturea-11-viewbag-1365x177.png)
*I added a reference to a "Name" value.*

![](/assets/images/aspnet-5-cs/capturea-11-add-controller-1368x185.png)
*I added a new controller to the project*

![](/assets/images/aspnet-5-cs/capturea-12-empty-controller-1370x281.png)
*I created an empty controller.*

![](/assets/images/aspnet-5-cs/capturea-14-name-controller-1367x297.png)
*I named the controller HelloWorldController (in line with the folder I had already created)*

![](/assets/images/aspnet-5-cs/capturea-15-hello-world-no-viewbag-1362x639.png)
*I added the folder name HelloWorld to the url and got the result above*

![](/assets/images/aspnet-5-cs/capturea-16-with-view-bag-name-1360x638.png)
*I updated the Controller function to set the "Name" value before returning the view. I refreshed the browser.*

![](/assets/images/aspnet-5-cs/capturea-17-new-item-1367x333.png)
*I selected the Models folder and selected the Add | New Item... menu item*

![](/assets/images/aspnet-5-cs/capturea-18-ado.et-entity-data-model-1363x663.png)
*I entered the name ToDoContext and selected ADO.NET Entity Data Model*

![](/assets/images/aspnet-5-cs/capturea-19-code-first-rom-database-1364x614.png)
*I selected Code First from database*

![](/assets/images/aspnet-5-cs/capturea-20-new-data-connection-1367x529.png)
*New data connection*

![](/assets/images/aspnet-5-cs/capturea-21-test-connection-1360x706.png)
*Test connection succeeded*

![](/assets/images/aspnet-5-cs/capturea-22-choose-connection-1368x597.png)
*I asked Visual Studio to save the connection details in the Web.Config file (notice that the Web.Config file is never returned to a client browser)*

![](/assets/images/aspnet-5-cs/capturea-23-entity-data-model-wizard-1366x594.png)
*I selected the Tasks table*

![](/assets/images/aspnet-5-cs/capturea-24-task-class-generated-1365x418.png)
*The Task class is generated*

![](/assets/images/aspnet-5-cs/capturea-25-new-scaffolder-item-1366x301.png)
*I selected the Controller folder and selected the Add | New Scaffolded Item... menu item*

![](/assets/images/aspnet-5-cs/capturea-26-mvc-5-controller-with-views-using-entity-framework-1367x391.png)
*I selected the MVC 5 Controller with view, using Entity Framework option*

![](/assets/images/aspnet-5-cs/capturea-27-controller-name-1366x514.png)
*I entered the Model class name (Task) and the Data context class (ToDoContext).*

![](/assets/images/aspnet-5-cs/capturea-28-build-error-1366x280.png)
*Visual Studio added CRUD controller functions and views (Visual Studio was confused by class "Task").*

![](/assets/images/aspnet-5-cs/capturea-29-fix-ambiguity-1366x611.png)
*The controller functions includes Index. The TaskController.Index function will fetch all Tasks from the database and then display then using the corresponding Tasks/Index view (Models.Task class name fully qualified to avoid confusion).*

![](/assets/images/aspnet-5-cs/capturea-30-running-tasks-index-page-1366x640.png)
*The TaskController.Index function is executed when a user navigates to /Tasks (see above)*

## References

- [Getting started with ASP.NET MVC 5](https://learn.microsoft.com/en-us/aspnet/mvc/overview/getting-started/introduction/getting-started)

---

## aspnet-5-visual-basic

**Source file:** `aspnet-5-visual-basic.md`

---
title: "ASP.NET 5 Visual Basic"
description: "Generate Context and Entity Classes from an Existing Database"
date: "2023-03-18"
categories: [".NET","SQL","DevOps","Azure"]
tags: []
slug: "aspnet-5-visual-basic"
image: "/assets/images/net-logo.svg"
---

ASP Web Forms was released in 2003 (based on the Windows Server and the .NET Framework)

ASP.NET Model-View-Controller 5 was released in 2009 (based on Windows Server and .NET Framework and Supported in Visual Studio 2019)

ASP.NET Core Model-View-Controller was released in 2017 (based on cross platform .NET Core and Supported in Visual Studio 2022)

I used Visual Studio 2019 and ASP.NET MVC 5 to create a todo app.

![](/assets/images/aspnet-5-visual-basic/capture4-create-new-project-1026x677.png)
*I created a new project*

![](/assets/images/aspnet-5-visual-basic/capture5-configure-new-project-1022x677.png)
*I configured the new project*

![](/assets/images/aspnet-5-visual-basic/capture6-mvc-vb-1020x707.png)
*I created a Model-View-Controller web application*

![](/assets/images/aspnet-5-visual-basic/capture7-home-view-1353x729.png)
*I ran the template project (notice the "ASP.NET MVC gives" text in the index.vbhtml file and the web browser).*

![](/assets/images/aspnet-5-visual-basic/capture8-layout-1416x726.png)
*The _Layout.vbhtml file provides a common web page framework and navigation*

![](/assets/images/aspnet-5-visual-basic/capture9-controller-1382x667.png)
*Web requests are handled by Controller functions/methods. The controller function will typically return a view (the Web response). The About function sets a "Message" value and then returns a corresponding About view.*

![](/assets/images/aspnet-5-visual-basic/capture10-controller-passing-to-view-1405x638.png)
*Notice that the About view renders the "Message".*

![](/assets/images/aspnet-5-visual-basic/capture11-new-folder-842x501.png)
*I created a new HelloWorld folder in the Views folder.*

![](/assets/images/aspnet-5-visual-basic/capture12-new-view-2-993x492.png)
*I added a view page to the HelloWorld folder.*

![](/assets/images/aspnet-5-visual-basic/capture13-new-view-3-995x287.png)
*I named the new page "Index" making it the home page for the new folder.*

![](/assets/images/aspnet-5-visual-basic/capture14-new-view-4-1097x495.png)
*I selected the existing _Layout page*

![](/assets/images/aspnet-5-visual-basic/capture15-new-view-5-1387x306.png)
*I added a reference to a "Name" value.*

![](/assets/images/aspnet-5-visual-basic/capture16-new-controller-1-876x298.png)
*I added a new controller to the project*

![](/assets/images/aspnet-5-visual-basic/capture17-new-controller-2-1365x683.png)
*I created an empty controller.*

![](/assets/images/aspnet-5-visual-basic/capture18-new-controller-3-1114x350.png)
*I named the controller HelloWorldController (in line with the folder I had already created)*

![](/assets/images/aspnet-5-visual-basic/capture19-new-controller-4-1419x311.png)
*Visual Studio created an Index function that would handle requests for the HelloWorld page and return the Index view*

![](/assets/images/aspnet-5-visual-basic/capture20-new-controller-5-1364x615.png)
*I added the folder name HelloWorld to the url and got the result above*

![](/assets/images/aspnet-5-visual-basic/capture21-new-controller-6-1362x545.png)
*I updated the Controller function to set the "Name" value before returning the view. I refreshed the browser.*

![](/assets/images/aspnet-5-visual-basic/capture26-docker-sql-server-1157x622.png)
*docker run -e "ACCEPT_EULA=Y" -e "SA_PASSWORD=Passw0rd123" -p 1433:1433 --name sql2019 -d mcr.microsoft.com/mssql/server:2019-latest*

![](/assets/images/aspnet-5-visual-basic/capture27-docker-sql-server-2-1157x623.png)
*I downloaded a SQL Server docker image*

![](/assets/images/aspnet-5-visual-basic/capture28-docker-sql-server-3-1154x620.png)
*I created a container based in the downloaded docker image*

![](/assets/images/aspnet-5-visual-basic/capture29-docker-sql-server-5-1364x230.png)
*I used Visual Studio to create a new database in the docker container's SQL Server*

![](/assets/images/aspnet-5-visual-basic/capture30-docker-sql-server-6-1047x509.png)
*I entered the credentials*

![](/assets/images/aspnet-5-visual-basic/capture32-docker-sql-server-8-1025x729.png)
*To get another view of the database I opened Azure Data Studio*

![](/assets/images/aspnet-5-visual-basic/capture33-docker-sql-server-9-1023x729.png)
*I entered the address of the SQL Server and the credentials*

![](/assets/images/aspnet-5-visual-basic/capture34-docker-sql-server-10-1027x728.png)
*I selected the ToDo database*

![](/assets/images/aspnet-5-visual-basic/capture35-docker-sql-server-11-1026x423.png)
*I created a Tasks table (with an automatically assigned ID column, a description column and a done boolean column)*

![](/assets/images/aspnet-5-visual-basic/capture36-docker-sql-server-12-1359x471.png)
*I refreshed Data Connections in Visual Studio*

![](/assets/images/aspnet-5-visual-basic/capture37-docker-sql-server-14-808x240.png)
*I selected the Models folder and selected the Add | New Item... menu item*

![](/assets/images/aspnet-5-visual-basic/capture38-docker-sql-server-15-941x573.png)
*I entered the name ToDoContext and selected ADO.NET Entity Data Model*

![](/assets/images/aspnet-5-visual-basic/capture39-docker-sql-server-16-616x559.png)
*I selected Code First from database*

![](/assets/images/aspnet-5-visual-basic/capture40-docker-sql-server-17-612x560.png)
*I asked Visual Studio to save the connection details in the Web.Config file (notice that the Web.Config file is never returned to a client browser)*

![](/assets/images/aspnet-5-visual-basic/capture41-docker-sql-server-18-616x554.png)
*I selected the Tasks table*

![](/assets/images/aspnet-5-visual-basic/capture42-docker-sql-server-19-1365x331.png)
*The Task class is generated*

![](/assets/images/aspnet-5-visual-basic/capture43-docker-sql-server-20-880x242.png)
*I selected the Controller folder and selected the Add | New Scaffolded Item... menu item*

![](/assets/images/aspnet-5-visual-basic/capture44-docker-sql-server-21-952x658.png)
*I selected the MVC 5 Controller with view, using Entity Framework option*

![](/assets/images/aspnet-5-visual-basic/capture45-docker-sql-server-22-589x381.png)
*I entered the Model class name (Task) and the Data context class (ToDoContext).*

![](/assets/images/aspnet-5-visual-basic/capture46-docker-sql-server-23-1364x312.png)
*Visual Studio added CRUD controller functions and views.*

![](/assets/images/aspnet-5-visual-basic/capture47-docker-sql-server-24-1359x664.png)
*The controller functions includes Index. The TaskController.Index function will fetch all Tasks from the database and then display then using the corresponding Tasks/Index view*

![](/assets/images/aspnet-5-visual-basic/capture48-docker-sql-server-25-1363x729.png)
*The TaskController.Index function is executed when a user navigates to /Tasks (see above)*

![](/assets/images/aspnet-5-visual-basic/capture49-docker-sql-server-26-1040x622.png)
*Clicking on the Create New link navigates the user to the TaskController.Create function (returning the generated Create form)*

![](/assets/images/aspnet-5-visual-basic/capture49-docker-sql-server-26-1040x622.png)
*I entered the new task text "Feed the fish" and clicked the create Create button. This posted the contents of the form to another Controller function.*

![](/assets/images/aspnet-5-visual-basic/capture51-docker-sql-server-28-1038x616.png)
*The post handling function added the item to the database table and redirected the user back to the Index page.*

![](/assets/images/aspnet-5-visual-basic/capture52-docker-sql-server-29-1040x617.png)
*I used the generated Edit page to update the task.*

![](/assets/images/aspnet-5-visual-basic/capture53-docker-sql-server-30-1040x616.png)
*Once the database table row has been updated the use is (again) redirected to the Index page.*

![](/assets/images/aspnet-5-visual-basic/capture54-docker-sql-server-31-1039x616.png)
*I added a couple of extra task and marked the Feed the cat task as done.*

![](/assets/images/aspnet-5-visual-basic/capture55-docker-sql-server-32-997x722.png)
*I reviewed the database table using the Azure Data Studio application*

![](/assets/images/aspnet-5-visual-basic/capture56-docker-sql-server-33-1364x668.png)
*Above is an example of the Controller code*

![](/assets/images/aspnet-5-visual-basic/capture57-docker-sql-server-34-1365x668.png)
*Above is an example of the View code*

![](/assets/images/aspnet-5-visual-basic/capture58-docker-sql-server-35-1366x728.png)
*I pushed the project to GitHub*

## References

- [Getting started with ASP.NET MVC 5](https://learn.microsoft.com/en-us/aspnet/mvc/overview/getting-started/introduction/getting-started)

---

## aspnet-core

**Source file:** `aspnet-core.md`

---
title: "ASP.NET Core"
description: "Create Razor Pages with ASP.NET Core."
date: "2023-03-21"
categories: [".NET","SQL"]
tags: []
slug: "aspnet-core"
image: "/assets/images/net-logo.svg"
---


ASP.NET Core is a cross-platform framework for building Internet-connected apps.

Razor Pages is the preferred way to create page or form-based apps in ASP.NET Core. From the docs, "Razor Pages can make coding page-focused scenarios easier and more productive than using controllers and views."

I used Visual Studio 2022 and ASP.NET Core to create a todo app.

![](/assets/images/aspnet-core/capturec-02-1010x674.png)
*I clicked the Create a new project button.*

![](/assets/images/aspnet-core/capturec-03-1014x676.png)
*I selected the ASP.NET Core Web Site option*

![](/assets/images/aspnet-core/capturec-04-1013x679.png)
*I accepted the default solution/project name*

![](/assets/images/aspnet-core/capturec-05-1015x675.png)
*I selected the .NET 6.0 framework*

![](/assets/images/aspnet-core/capturec-06-1366x660.png)
*The template project was downloaded*


## Page and PageModel

Razor pages include HTML markup and are similar to MVC views.

Razor PageModel classes are combination of MVC controllers and models. 

The OnGet() method below is executed when a browser sends a GET request to the server.

An OnPost() method is executed when a browser sends a POST request to the server.

![](/assets/images/aspnet-core/capturec-08-689x490.png)
*I updated the PageModel to include a message property set in the OnGet() method*

![](/assets/images/aspnet-core/capturec-09-963x233.png)
*I updated the corresponding Razor page to include the Message.*

![](/assets/images/aspnet-core/capturec-10-1357x635.png)
*I tested the Web application*

![](/assets/images/aspnet-core/capturec-11-353x40.png)
*I created a Data folder to hold classes generated by Entity framework.*

![](/assets/images/aspnet-core/capturec-15-1008x468.png)
*I wanted Entity framework to generate the classes needed to access and update the contents of a todo items database.*

![](/assets/images/aspnet-core/capturec-16-1357x262.png)
*I installed the dotnet-ef (entity framework) tool*

![](/assets/images/aspnet-core/capturec-17-1352x271.png)
*I needed to add a references to the Microsoft.EntityFrameworkCore.Design and Microsoft.EntityFrameworkCore.SqlServer packages.*

![](/assets/images/aspnet-core/capturec-19-1366x663.png)
*I ran the dotnet ef dbcontext scaffold... command to generate the entity framework related classes.*

![](/assets/images/aspnet-core/capturec-20-1366x663.png)
*The Item class describes a database table row.*

![](/assets/images/aspnet-core/capturec-22-363x44.png)
*I created a ToDo folder in the Pages folder.*

![](/assets/images/aspnet-core/capturec-23-828x721.png)
*I right clicked on the ToDo folder and selected the Add | New Scaffolded Item... menu item*

![](/assets/images/aspnet-core/capturec-25-656x442.png)
*I selected the Entity framework classes I generated eariler.*

![](/assets/images/aspnet-core/capturec-26-468x137.png)
*I watched the progress bar*

![](/assets/images/aspnet-core/capturec-27-408x200.png)
*I ran into an odd issue related to the Microsoft.VisualStudio.Web.CodeGeneration.Design package that was already installed. I reinstalled and tried again.*

![](/assets/images/aspnet-core/capturec-28-1366x658.png)
*The CRUD Razor pages were generated.*

![](/assets/images/aspnet-core/capturec-29-1330x436.png)
*I updated Program.cs to include a reference to ToDoContext...*

![](/assets/images/aspnet-core/capturec-30-1364x317.png)
*...and ran the Web app by navigating to /ToDo*

![](/assets/images/aspnet-core/capturec-31-1366x417.png)
*I used the create page to create a ToDo item.*

![](/assets/images/aspnet-core/capturec-32-1366x363.png)
*The create page's OnPostAsync() method added the new item (using entity framework) and redirected me back to the ToDo index page.*

![](/assets/images/aspnet-core/capturec-33-1362x308.png)
*I updated the appsettings.json file to include the database connection string.*

![](/assets/images/aspnet-core/capturec-34-1366x514.png)
*I updated Program.cs to include a reference to the appsettings value.*

![](/assets/images/aspnet-core/capturec-35-1361x516.png)
*I updated the ToDoContext class's OnModelCreating() method (removing the hardcoded connection string).*

## References

- [Compare Razor Pages to ASP.NET MVC](https://learn.microsoft.com/en-us/aspnet/mvc/overview/getting-started/introduction/getting-started)

---

## aspnetcoreawseks

**Source file:** `aspnetcoreawseks.md`

---
title: "Deploying a .NET Core Web API to Amazon EKS"
description: "Deploying a .NET Core Web API to Amazon Elastic Kubernetes Service (Amazon EKS)"
date: "2021-08-16"
categories: ["AWS","DevOps",".NET"]
tags: []
slug: "aspnetcoreawseks"
image: "/assets/images/amazon-web-services-logo.svg"
---


Amazon Elastic Kubernetes Service (Amazon EKS) makes it possible to deploy, manage, and scale [containerized](docker.html) applications using [Kubernetes](kubernetes.html) on AWS. 

A .NET Core Web API can be deployed to Amazon EKS from Visual Studio Code using the Visual Studio Code terminal window.


## install eksctl

> choco install -y eksctl

![](/assets/images/aspnetcoreawseks/the-eksctl-command-line-utility-amazon-eks-google-chrome-8-16-2021-8-20-21-pm-1836x975.png)
*install eksctl on Windows*

![](/assets/images/aspnetcoreawseks/select-administrator-windows-powershell-8-16-2021-8-24-46-pm-1200x440.png)
*choco install -y eksctl*


## .NET Core Web API

**> dotnet new webapi --no-https**

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-28-32-pm-1536x720.png)
*dotnet new webapi --no-https*

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-29-44-pm-1536x720.png)
*Docker: Add Docker Files to Workspace*

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-29-55-pm-1536x720.png)
*.Net: ASP.NET Core platform*

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-30-04-pm-1536x720.png)
*Linux*

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-30-15-pm-1536x720.png)
*Port 5000*

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-31-14-pm-1536x720.png)
*Dockerfile*

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-31-34-pm-1536x720.png)
*Docker Images: Build Image...*

![](/assets/images/aspnetcoreawseks/dotnetapi-visual-studio-code-8-16-2021-8-32-32-pm-1536x720.png)
*Building*

![](/assets/images/aspnetcoreawseks/amazon-ecr-google-chrome-8-16-2021-8-34-25-pm-1836x975.png)
*Create ECR repository*

![](/assets/images/aspnetcoreawseks/amazon-ecr-google-chrome-8-16-2021-8-34-51-pm-1836x975.png)
*Repository created*

![](/assets/images/aspnetcoreawseks/amazon-ecr-google-chrome-8-16-2021-8-35-04-pm-1836x975.png)
*View push commands macOS/Linux*

![](/assets/images/aspnetcoreawseks/amazon-ecr-google-chrome-8-16-2021-8-37-22-pm-1836x975.png)
*View push commands Windows*

![](/assets/images/aspnetcoreawseks/administrator-windows-powershell-8-16-2021-9-12-34-pm-1200x440.png)
*(Get-ECRLoginCommand)...*

![](/assets/images/aspnetcoreawseks/dockerfile-dotnetapi-visual-studio-code-8-16-2021-9-15-23-pm-1536x720.png)
*docker build -t dotnetapi .*

![](/assets/images/aspnetcoreawseks/dockerfile-dotnetapi-visual-studio-code-8-16-2021-9-16-17-pm-1536x720.png)
*docker tag...*

![](/assets/images/aspnetcoreawseks/dockerfile-dotnetapi-visual-studio-code-8-16-2021-9-16-42-pm-1536x720.png)
*docker push...*

![](/assets/images/aspnetcoreawseks/administrator-windows-powershell-8-16-2021-9-19-09-pm-1200x440.png)
*eksctl create cluster --name dotnetapi*

![](/assets/images/aspnetcoreawseks/amazon-eks-google-chrome-8-16-2021-9-38-55-pm-1644x1069.png)
*Cluster EC2 nodes*

![](/assets/images/aspnetcoreawseks/amazon-eks-google-chrome-8-16-2021-9-39-05-pm-1644x1069.png)
*Workloads*

![](/assets/images/aspnetcoreawseks/dotnetapi.yaml-dotnetapi-visual-studio-code-8-16-2021-9-39-22-pm-1536x720.png)
*kubectl apply -f .\dotnetapi.yaml*

![](/assets/images/aspnetcoreawseks/dotnetapi.yaml-dotnetapi-visual-studio-code-8-16-2021-9-39-31-pm-1536x720.png)
*dotnetapi-service created*

![](/assets/images/aspnetcoreawseks/amazon-eks-google-chrome-8-16-2021-9-39-52-pm-1644x1069.png)
*Workloads*

![](/assets/images/aspnetcoreawseks/dotnetapi.yaml-dotnetapi-visual-studio-code-8-16-2021-9-42-16-pm-1536x720.png)
*kubectl get service/dotnetapi-service*

![](/assets/images/aspnetcoreawseks/dotnetapi.yaml-dotnetapi-visual-studio-code-8-16-2021-9-49-39-pm-1536x720.png)
*updated containerPort, port and targetPort*

![](/assets/images/aspnetcoreawseks/a7eddbf5e5f594b32b4f127603f1de51-188864526.us-east-1.elb.amazonaws.com-weatherforecast-google-chrome-8-16-2021-9-50-04-pm-1407x381.png)
*Navigating to the loadbalancer/cluster*


## WeatherForecastController.cs

```text
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;

namespace dotnetapi.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class WeatherForecastController : ControllerBase
    {
        private static readonly string[] Summaries = new[]
        {
            "Freezing", "Bracing", "Chilly", "Cool", "Mild", "Warm", "Balmy", "Hot", "Sweltering", "Scorching"
        };

        private readonly ILogger<WeatherForecastController> _logger;

        public WeatherForecastController(ILogger<WeatherForecastController> logger)
        {
            _logger = logger;
        }

        [HttpGet]
        public IEnumerable<WeatherForecast> Get()
        {
            var rng = new Random();
            return Enumerable.Range(1, 5).Select(index => new WeatherForecast
            {
                Date = DateTime.Now.AddDays(index),
                TemperatureC = rng.Next(-20, 55),
                Summary = Summaries[rng.Next(Summaries.Length)]
            })
            .ToArray();
        }
    }
}
```

## dotnetapi.yaml

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: dotnetapi-deployment
  labels:
    app: dotnetapi
spec:
  replicas: 2
  selector:
    matchLabels:
      app: dotnetapi
  template:
    metadata:
      labels:
        app: dotnetapi
    spec:
      containers:
      - name: dotnetapi
        image: 575062151998.dkr.ecr.us-east-1.amazonaws.com/dotnetapi
        ports:
        - containerPort: 5000
---
apiVersion: v1
kind: Service
metadata:
  name: dotnetapi-service
spec:
  selector:
    app: dotnetapi
  ports:
    - protocol: TCP
      port: 80
      targetPort: 5000
  type: LoadBalancer
```

## References

- [ASP.NET Core in a container](https://code.visualstudio.com/docs/containers/quickstart-aspnet-core)

---

## aspnetcoreunittests

**Source file:** `aspnetcoreunittests.md`

---
title: "ASP.NET Core Unit Tests"
description: "Test driven development"
date: "2023-03-26"
categories: [".NET"]
tags: []
slug: "aspnetcoreunittests"
image: "/assets/images/net-logo.svg"
---


Unit tests are automated tests written and run by software developers to ensure that a section of an application (known as the "unit") meets its design and behaves as intended.

I wanted to add unit tests that could be run as part of a continuous integration pipeline.

![](/assets/images/aspnetcoreunittests/screen-shot-2023-03-26-at-10.49.22-am-1536x877.png)
*$ dotnet test*


## UnitTest1.cs

```text
using haddley_blazor_api.Server.Models;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;

using haddley_blazor_api.Server.Controllers;

namespace haddley_blazor_app.Tests;


[TestClass]
public class ToDoControllerTests
{
    private ToDoContext? _context;
    private ToDo? _controller;

    [TestInitialize]
    public void Initialize()
    {
        // Create an in-memory database for testing
        var options = new DbContextOptionsBuilder<ToDoContext>()
            .UseInMemoryDatabase(databaseName: "ToDo_TestDatabase")
            .Options;

        _context = new ToDoContext(options);

        // reset in memory database
        _context.Database.EnsureDeleted();

        // Seed the database with test data
        _context.Items.AddRange(new List<Item>
        {
            new Item { Id = 1, Description = "Buy milk", Done = false },
            new Item { Id = 2, Description = "Walk the dog", Done = true },
            new Item { Id = 3, Description = "Do laundry", Done = false }
        });

        _context.SaveChanges();

        // Create an instance of the controller to be tested
        _controller = new ToDo(_context);
    }

    [TestMethod]
    public async Task GetItems_ReturnsAllItems()
    {
        Assert.IsNotNull(_controller);

        // Arrange

        // Act

        var result = await _controller.GetItems();

        // Assert
        Assert.IsNotNull(result.Value);
        Assert.AreEqual(3, result.Value.Count());
    }



    [TestMethod]
    public async Task GetItem_ReturnsNotFound_ForNonExistentId()
    {
        Assert.IsNotNull(_controller);

        // Arrange
        var nonExistentId = 999;

        // Act
        var result = await _controller.GetItem(nonExistentId);

        // Assert
        Assert.IsInstanceOfType(result.Result, typeof(NotFoundResult));

    }


    [TestMethod]
    public async Task PostItem_AddsNewItem()
    {
        Assert.IsNotNull(_controller);
        Assert.IsNotNull(_context);

        // Arrange
        var newItem = new Item { Description = "Clean the house", Done = false };

        // Act
        var result = await _controller.PostItem(newItem);

        Assert.IsNotNull(result);

        // Assert
        Assert.IsInstanceOfType(result.Result, typeof(CreatedAtActionResult));

        // Check that the new item was added to the database
        Assert.AreEqual(4, _context.Items.Count());
        Assert.IsTrue(_context.Items.Any(i => i.Description == newItem.Description));

    }


    [TestMethod]
    public async Task DeleteItem_RemovesExistingItem()
    {
        Assert.IsNotNull(_controller);
        Assert.IsNotNull(_context);

        // Arrange
        var existingItem = await _context.Items.FirstOrDefaultAsync(i => i.Description == "Walk the dog");

        Assert.IsNotNull(existingItem);

        // Act
        var result = await _controller.DeleteItem(existingItem.Id);

        // Assert
        Assert.IsInstanceOfType(result, typeof(NoContentResult));

        // Check that the item was removed from the database
        Assert.AreEqual(2, _context.Items.Count());
        Assert.IsFalse(_context.Items.Any(i => i.Id == existingItem.Id));
    }


}
```

---

## ateamstabsharepointwebpartforonedrive

**Source file:** `ateamstabsharepointwebpartforonedrive.md`

---
title: "A Teams App SharePoint Web Part for One Drive"
description: "The SharePoint Framework (SPFx) can be used to create SharePoint Web Parts and Teams Applications"
date: "2022-05-29"
categories: ["Microsoft 365","React","JavaScript","TypeScript"]
tags: []
slug: "ateamstabsharepointwebpartforonedrive"
image: "/assets/images/office-365-icon-500x500.png"
---

In this post I describe how I created a Teams application using the SharePoint Framework and the Microsoft Graph Toolkit

This post is based on PiaSys Tech Bites's [Using Microsoft Graph Toolkit with React](https://www.youtube.com/watch?v=5ZsD2uHVpz4) video, Microsoft 365 Community's [Building Microsoft Graph Toolkit apps with SharePoint](https://www.youtube.com/watch?v=PTWXRuPbSEw) video, and Microsoft's [Working with files in Microsoft Graph](https://docs.microsoft.com/en-us/graph/api/resources/onedrive?view=graph-rest-1.0) documentation.


## SharePoint Apps

SharePoint Framework (SPFx) applications are deployed to Microsoft 365 when they are uploaded to the [SharePoint online App catalog](sharepointwebpart2.html).

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-1.34.20-pm-1836x837.png)
*Navigate to the SharePoint admin center and click the "More features" link*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-1.37.19-pm-1836x839.png)
*Scroll down to the "Apps" section and click the "Open" link*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-1.37.27-pm-1836x832.png)
*If the "App Catalog" Site (Site Collection) does not exist it is created*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-1.37.47-pm-1836x842.png)
*A welcome message may be displayed*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-1.38.02-pm-1836x839.png)
*App Catalog's Manage apps page*


## yo @microsoft/sharepoint

I used "yo @microsoft/sharepoint" to create a haddley-file-list project.

I used "npm i @microsoft/mgt-spfx@2.5.1" to add Microsoft Graph Toolkit to the project.

I used "npm i @microsoft/mgt-react@2.5.1" to add Microsoft Graph Toolkit's React components to the project.

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-7.21.51-pm-1836x1000.png)
*yo @microsoft/sharepoint*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-7.24.19-pm-1836x1000.png)
*npm i @microsoft/mgt-spfx@2.5.1 @microsoft/mgt-react@2.5.1*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-7.25.08-pm-1836x1038.png)
*I updated serve.json to specify how the workbench would be loaded*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-7.27.28-pm-1836x1040.png)
*The workbench will be loaded in the context of the Mark8ProjectTeam Site*


## gulp

I used "gulp trust-dev-cert" to ensure that gulp would serve content using https

I used "gulp bundle && gulp serve" to preview the application in the workbench

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-7.28.17-pm-1836x1038.png)
*gulp serve to preview*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-7.29.18-pm-1836x805.png)
*Previewing the web part in the workbench*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-7.31.35-pm-1836x1035.png)
*I updated the SPFx Web Part code to add a global provider (constructed using the Web Part's context object)*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.38.53-am-1258x619.png)
*I added permission requests to package-solution.json*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.43.31-am-1255x617.png)
*I updated the Web Part's React code*


## Deployment

I used "gulp bundle --ship && gulp package-solution --ship" to create an .sppkg file (package).

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.48.51-am-1836x957.png)
*gulp bundle --ship && gulp package-solution --ship*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.04.55-am-1401x787.png)
*I navigated to the App catalog manage apps page*


## mgt-spfx-252.sppkg

At runtime (at least in Teams) the web part depends on a shared SharePoint app "mgt-spfx-XXX.sppkg".

https://github.com/microsoftgraph/microsoft-graph-toolkit/releases

I added this shared application to the App Catalog.

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.22.33-am-1183x745.png)
*I downloaded the mgt-spfx-2.5.2.sppkg file (package) from https://github.com/microsoftgraph/microsoft-graph-toolkit/releases. I uploaded the mgt-spfx-2.5.2.sppkg file (package) to the App catalog.*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.06.04-am-1399x783.png)
*I upload the project's haddley-file-list.sppkg file (package) to the App catalog*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-8.37.53-pm-1836x1103.png)
*I enabled the app and selected the enable this app and add to all sites option*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-8.38.08-pm-1836x1105.png)
*I navigated to the API access page*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-28-at-8.38.39-pm-1836x1104.png)
*I approved the permission requests*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.06.57-am-1395x785.png)
*As a test I added the web part to a SharePoint page*


## Adding to teams

The HaddleyListWebPart manifest suggests that the web part will work as a Teams App.

I did not need to update this file

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.13.43-am-1836x904.png)
*HaddleyListWebPart.manifest.json*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.07.16-am-449x303.png)
*I used the "Add to Teams" button in the App catalog to add the Web Part to Teams*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.09.26-am-1403x780.png)
*With no additional effort the web part was shown as a Published app in the Teams admin center*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.10.03-am-1401x787.png)
*The web part was also shown in the Teams desktop application*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.10.15-am-1397x781.png)
*I used the Add button to add the web part to Teams*

![](/assets/images/ateamstabsharepointwebpartforonedrive/screen-shot-2022-05-29-at-10.24.10-am-1400x786.png)
*Here is the code running in Teams*


## serve.json

```text
{
  "$schema": "https://developer.microsoft.com/json-schemas/core-build/serve.schema.json",
  "port": 4321,
  "https": true,
  "initialPage": "https://p8lf.sharepoint.com/sites/Mark8ProjectTeam/_layouts/workbench.aspx"
}
```

## HaddleyListWebPart.ts

```text
import * as React from 'react';
import * as ReactDom from 'react-dom';
import { Version } from '@microsoft/sp-core-library';
import {
  IPropertyPaneConfiguration,
  PropertyPaneTextField
} from '@microsoft/sp-property-pane';
import { BaseClientSideWebPart } from '@microsoft/sp-webpart-base';
import { IReadonlyTheme } from '@microsoft/sp-component-base';

import * as strings from 'HaddleyListWebPartStrings';
import HaddleyList from './components/HaddleyList';
import { IHaddleyListProps } from './components/IHaddleyListProps';

import { Providers,SharePointProvider } from '@microsoft/mgt-spfx';

export interface IHaddleyListWebPartProps {
  description: string;
}

export default class HaddleyListWebPart extends BaseClientSideWebPart<IHaddleyListWebPartProps> {

  private _isDarkTheme: boolean = false;
  private _environmentMessage: string = '';

  protected onInit(): Promise<void> {

    if (!Providers.globalProvider){
      Providers.globalProvider =  new SharePointProvider(this.context);
    }

    this._environmentMessage = this._getEnvironmentMessage();

    return super.onInit();
  }

  public render(): void {
    const element: React.ReactElement<IHaddleyListProps> = React.createElement(
      HaddleyList,
      {
        description: this.properties.description,
        isDarkTheme: this._isDarkTheme,
        environmentMessage: this._environmentMessage,
        hasTeamsContext: !!this.context.sdks.microsoftTeams,
        userDisplayName: this.context.pageContext.user.displayName
      }
    );

    ReactDom.render(element, this.domElement);
  }

  private _getEnvironmentMessage(): string {
    if (!!this.context.sdks.microsoftTeams) { // running in Teams
      return this.context.isServedFromLocalhost ? strings.AppLocalEnvironmentTeams : strings.AppTeamsTabEnvironment;
    }

    return this.context.isServedFromLocalhost ? strings.AppLocalEnvironmentSharePoint : strings.AppSharePointEnvironment;
  }

  protected onThemeChanged(currentTheme: IReadonlyTheme | undefined): void {
    if (!currentTheme) {
      return;
    }

    this._isDarkTheme = !!currentTheme.isInverted;
    const {
      semanticColors
    } = currentTheme;
    this.domElement.style.setProperty('--bodyText', semanticColors.bodyText);
    this.domElement.style.setProperty('--link', semanticColors.link);
    this.domElement.style.setProperty('--linkHovered', semanticColors.linkHovered);

  }

  protected onDispose(): void {
    ReactDom.unmountComponentAtNode(this.domElement);
  }

  protected get dataVersion(): Version {
    return Version.parse('1.0');
  }

  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {
    return {
      pages: [
        {
          header: {
            description: strings.PropertyPaneDescription
          },
          groups: [
            {
              groupName: strings.BasicGroupName,
              groupFields: [
                PropertyPaneTextField('description', {
                  label: strings.DescriptionFieldLabel
                })
              ]
            }
          ]
        }
      ]
    };
  }
}
```

## package-solution.json

```text
{
  "$schema": "https://developer.microsoft.com/json-schemas/spfx-build/package-solution.schema.json",
  "solution": {
    "name": "haddley-file-list-client-side-solution",
    "id": "05e0e1db-dbd6-4913-a19e-a294d1c124ac",
    "version": "1.0.0.0",
    "includeClientSideAssets": true,
    "skipFeatureDeployment": true,
    "isDomainIsolated": false,
    "developer": {
      "name": "",
      "websiteUrl": "",
      "privacyUrl": "",
      "termsOfUseUrl": "",
      "mpnId": "Undefined-1.14.0"
    },
    "metadata": {
      "shortDescription": {
        "default": "haddley-file-list description"
      },
      "longDescription": {
        "default": "haddley-file-list description"
      },
      "screenshotPaths": [],
      "videoUrl": "",
      "categories": []
    },
    "features": [
      {
        "title": "haddley-file-list Feature",
        "description": "The feature that activates elements of the haddley-file-list solution.",
        "id": "a0601d92-f1c2-46d9-9dc7-39267ea39211",
        "version": "1.0.0.0"
      }
    ],
    "webApiPermissionRequests": [
      {
        "resource": "Microsoft Graph",
        "scope": "Mail.Read"
      },
      {
        "resource": "Microsoft Graph",
        "scope": "Files.Read"
      },
      {
        "resource": "Microsoft Graph",
        "scope": "Files.Read.All"
      },
      {
        "resource": "Microsoft Graph",
        "scope": "Sites.Read"
      },
      {
        "resource": "Microsoft Graph",
        "scope": "Sites.Read.All"
      },
      {
        "resource": "Microsoft Graph",
        "scope": "Sites.ReadWrite.All"
      },
      {
        "resource": "Microsoft Graph",
        "scope": "User.Read"
      }
    ]
  },
  "paths": {
    "zippedPackage": "solution/haddley-file-list.sppkg"
  }
}
```

## HaddleyList.tsx

```text
import * as React from 'react';
import styles from './HaddleyList.module.scss';
import { IHaddleyListProps } from './IHaddleyListProps';
import { escape } from '@microsoft/sp-lodash-subset';
// import { Get, MgtTemplateProps, FileList } from '@microsoft/mgt-react';
import { Get, MgtTemplateProps, FileList } from '@microsoft/mgt-react/dist/es6/spfx';

export default class HaddleyList extends React.Component<IHaddleyListProps, {}> {
  public render(): React.ReactElement<IHaddleyListProps> {
    const {
      description,
      isDarkTheme,
      environmentMessage,
      hasTeamsContext,
      userDisplayName
    } = this.props;

    //Template declaration for Get element
    const TemplateFiles = (props: MgtTemplateProps) => {
      console.log("props", props);
      console.log("props.dataContext", props.dataContext);
      let files = props.dataContext;
      if (!Array.isArray(files)) {
        files = [files];
      }
      return (<div>
        {files.map((file: any, index: number) => (<div key={index}>{file.name}</div>))}
      </div>);
    };

    const TemplateDocumentLibraries = (props: MgtTemplateProps) => {
      console.log("props", props);
      console.log("props.dataContext", props.dataContext);
      let libraries = props.dataContext;
      if (!Array.isArray(libraries)) {
        libraries = [libraries];
      }
      return (<div>
        {libraries.map((library: any, index: number) => (<div key={index}><strong>{library.name}</strong> {library.id}</div>))}
      </div>);
    };

    return (
      <section className={`${styles.haddleyList} ${hasTeamsContext ? styles.teams : ''}`}>
        <div className={styles.welcome}>
          <img alt="" src={isDarkTheme ? require('../assets/welcome-dark.png') : require('../assets/welcome-light.png')} className={styles.welcomeImage} />
          <h2>Well done, {escape(userDisplayName)}!</h2>
          <div>{environmentMessage}</div>
          <div>Web part property value: <strong>{escape(description)}</strong></div>
        </div>
        <div>

          <h1>Get /me/drive/root/children</h1>
          <Get resource="/me/drive/root/children">
            <TemplateFiles template="value" />
          </Get>

          <h1>My One Drive Root Folder</h1>
          <FileList enableFileUpload={true}></FileList>

          <h1>p8lf.sharepoint.com "Documents" Document Library Root Folder</h1>
          <FileList
            itemPath="/"
            siteId="p8lf.sharepoint.com"
            enableFileUpload={true}></FileList>

          <h1>p8lf.sharepoint.com "Documents" Document Library Root Folder</h1>
          <FileList
            itemPath="/"
            siteId="p8lf.sharepoint.com"
            enableFileUpload={true}></FileList>

          <h1>Get /sites/p8lf.sharepoint.com:/sites/Mark8ProjectTeam:/drives</h1>
          <Get resource="/sites/p8lf.sharepoint.com:/sites/Mark8ProjectTeam:/drives">
            <TemplateDocumentLibraries template="value" />
          </Get>

          <h1>p8lf.sharepoint.com "Confidental" Document Library Root Folder</h1>
          <FileList
            itemPath="/"
            driveId="b!rx9ik2KF4EGsjBMRetNJSrUFL8a5s69FmTUNWtyhqQhyOPxIxRDNT5VmV2cjHkdO"
            enableFileUpload={true}></FileList>

        </div>
      </section>
    );
  }
}
```

## Other useful code

```text
const siteId = (location.host + "," + context.pageContext.site.id + "," + context.pageContext.web.id).replace(/[\{\}]/g, "")

...

<h1>Get /sites/{siteId}/drive/root/children</h1>
<Get resource={`/sites/${siteId}/drive/root/children`}>
    <TemplateFiles template="value" />
</Get>

<FileList
    itemPath="/"
    siteId={siteId}
    enableFileUpload={true}>
</FileList>
```

## HaddleyListWebPart.manifest.json

```text
{
  "$schema": "https://developer.microsoft.com/json-schemas/spfx/client-side-web-part-manifest.schema.json",
  "id": "2beda14b-5565-4acf-8d4a-dcbe8046bf01",
  "alias": "HaddleyListWebPart",
  "componentType": "WebPart",

  // The "*" signifies that the version should be taken from the package.json
  "version": "*",
  "manifestVersion": 2,

  // If true, the component can only be installed on sites where Custom Script is allowed.
  // Components that allow authors to embed arbitrary script code should set this to true.
  // https://support.office.com/en-us/article/Turn-scripting-capabilities-on-or-off-1f2c515f-5d7e-448a-9fd7-835da935584f
  "requiresCustomScript": false,
  "supportedHosts": ["SharePointWebPart", "TeamsPersonalApp", "TeamsTab", "SharePointFullPage"],
  "supportsThemeVariants": true,

  "preconfiguredEntries": [{
    "groupId": "5c03119e-3074-46fd-976b-c60198311f70", // Other
    "group": { "default": "Other" },
    "title": { "default": "HaddleyList" },
    "description": { "default": "HaddleyList description" },
    "officeFabricIconFontName": "Page",
    "properties": {
      "description": "HaddleyList"
    }
  }]
}
```

---

## azure-active-directory

**Source file:** `azure-active-directory.md`

---
title: "Azure Active Directory (Part 1)"
description: "Using Microsoft Identity to Authenticate Users."
date: "2021-03-29"
categories: ["Azure","JavaScript","Microsoft 365"]
tags: []
slug: "azure-active-directory"
image: "/assets/images/azurex70x75.svg"
---

## Microsoft Teams

Microsoft Office 365 applications including Microsoft SharePoint and Microsoft Teams use Azure Active Directory to authenticate users .

Microsoft Teams allows Guest users to be added to a Team. 

Azure Active Directory is used to support the Teams Guest user feature.

In the screenshot below John Doe with email address john@doe.com is added as a Guest user.

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-6.50.37-pm-1314x906.png)
*John Doe is being added as a Guest user.*


## Members and guests

Once John Doe has been added to the Team his account is included in the "Members and guests" list.

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-6.55.56-pm-1836x833.png)
*John has been added as a (guest) member of the Team*


## Azure Active Directory Users

Switching to the Azure Portal we can see that an external (EXT) Active Directory account has been added for John Doe.

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-7.00.35-pm-1660x932.png)
*Azure Active Directory Users*


## Custom Web Application

We can use the same Azure Active Directory user list to authenticate users accessing a custom "Who am I" web application.


## App Registration

The key step is the creation of an "application registration". 

Navigate to the Azure Active Directory service and select App registrations page.

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-7.28.36-pm-1836x1175.png)
*Navigate to Azure Active Directory and select App registrations*

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-7.31.12-pm-456x178.png)
*Click the "+ New registration" button*

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-9.20.55-pm-1730x1470.png)
*Enter the user-facing display name "who am i" in this case.Enter the redirect uri (this is the address the user will be directed to once they have successfully entered their credentials).*

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-9.25.13-pm-1692x818.png)
*We need to create a client secret*


## We need to take a note of these three values

Application (client) ID 63fe01c7-f396-484e-8a48-760f********
Directory (tenant) ID 1661e837-0a95-4bc6-a655-8653********
Client secret -~nGgWS3F7y~-o2etNGc0BW_ik_*******


## Test the solution

To test the who-am-i web application we can navigate to http://localhost:3000

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-9.30.32-pm-1050x226.png)
*We attempt to navigate to http://localhost:3000*

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-9.30.53-pm-1836x977.png)
*We are redirected to the Azure Active Directory Sign in page (unless federated identity management is enabled).*

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-9.31.03-pm-1836x982.png)
*Once we have entered a correct email/username and password...*

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-9.31.24-pm-1836x983.png)
*...we are asked consent to having our personal details passed to the "who am i" application (unless two factor authentication is enabled).*

![](/assets/images/azure-active-directory/screen-shot-2021-03-31-at-9.31.40-pm-1836x977.png)
*In this case we are redirected to "/redirect" and the name of the authenticated user is displayed*


## package.json

```text
{
  "name": "who-am-i",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "dependencies": {
    "@azure/msal-node": "^1.0.0",
    "express": "^4.17.1",
    "uuid": "^8.3.1"
  },
  "devDependencies": {},
  "scripts": {
    "start": "node index.js"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/Haddley/who-am-i.git"
  },
  "author": "",
  "license": "ISC",
  "bugs": {
    "url": "https://github.com/Haddley/who-am-i/issues"
  },
  "homepage": "https://github.com/Haddley/who-am-i#readme"
}
```

## index.js

```text
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
const express = require("express");
const msal = require('@azure/msal-node');

const SERVER_PORT = process.env.PORT || 3000;
const REDIRECT_URI = "http://localhost:3000/redirect";

// Before running the sample, you will need to replace the values in the config, 
// including the clientSecret
const config = {
    auth: {
        clientId: "63fe01c7-f396-484e-8a48-760f********",
        authority: "https://login.microsoftonline.com/1661e837-0a95-4bc6-a655-8653********",
        clientSecret: "-~nGgWS3F7y~-o2etNGc0BW_ik_*******"
    },
    system: {
        loggerOptions: {
            loggerCallback(loglevel, message, containsPii) {
                console.log(message);
            },
            piiLoggingEnabled: false,
            logLevel: msal.LogLevel.Verbose,
        }
    }
};

// Create msal application object
const pca = new msal.ConfidentialClientApplication(config);

// Create Express App and Routes
const app = express();

app.get('/', (req, res) => {
    const authCodeUrlParameters = {
        scopes: ["user.read"],
        redirectUri: REDIRECT_URI,
    };

    // get url to sign user in and consent to scopes needed for application
    pca.getAuthCodeUrl(authCodeUrlParameters).then((response) => {
        res.redirect(response);
    }).catch((error) => console.log(JSON.stringify(error)));
});

app.get('/redirect', (req, res) => {
    const tokenRequest = {
        code: req.query.code,
        scopes: ["user.read"],
        redirectUri: REDIRECT_URI,
    };

    pca.acquireTokenByCode(tokenRequest).then((response) => {
        console.log("\nResponse: \n:", response);
        // Return the current user's name
        console.log(response.account.name);
        res.send(response.account.name);
        res.sendStatus(200);
    }).catch((error) => {
        console.log(error);
        res.status(500).send(error);
    });
});


app.listen(SERVER_PORT, () => console.log(`Msal Node Auth Code Sample app listening on port ${SERVER_PORT}!`))
```

## References

- [QuickStart](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-v2-nodejs-webapp-msal)

---

## azure-active-directory2

**Source file:** `azure-active-directory2.md`

---
title: "Azure Active Directory (Part 2)"
description: "Microsoft Azure Active Directory Authentication."
date: "2021-04-17"
categories: ["Azure","JavaScript","React","Microsoft 365"]
tags: []
slug: "azure-active-directory2"
image: "/assets/images/azurex70x75.svg"
---

## Single-page application with login

Quickstart projects make it easier to build applications that connect to Azure Active Directory, Microsoft Graph and other Azure resources.

Quickstart projects allow developers to create Web applications, Single page applications (SPAs), Mobile and desktop applications and Daemon applications. 

Here we create a "Haddley React Single Page App" that supports Azure Active Directory login

![](/assets/images/azure-active-directory2/topology-callgraph-700x403.png)
*topology_callgraph by Doğan Erişen is licensed under MIT License*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.42.46-am-1836x1481.png)
*Name is Haddley React Single Page App*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-10.27.44-am-1376x1060.png)
*Select "Single-page application (SPA)"*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.43.42-am-1638x702.png)
*Select "React (preview)"*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.44.44-am-1836x714.png)
*Allow the Quickstart to update the Redirect URI to "http://localhost:3000/"*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.45.15-am-1836x952.png)
*Download the fully configured code sample*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.45.53-am-1836x499.png)
*Open project using Visual Studio Code*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.47.49-am-1836x1372.png)
*Open terminal and run "npm install" and then "npm start"*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.49.20-am-1836x948.png)
*Select either "Sign in using Popup" or "Sign in using Redirect"*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.49.49-am-962x498.png)
*Pick an account*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.49.59-am-964x660.png)
*Enter the password*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.50.15-am-966x1310.png)
*Accept*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-9.50.35-am-1836x947.png)
*After pressing "Request Profile Information"*


## Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD

[https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api)

![](/assets/images/azure-active-directory2/topology-callapi-631x362.png)
*topology_callapi by Doğan Erişen is licensed under MIT License*

![](/assets/images/azure-active-directory2/image-859x481.png)
*.\Configure.ps1*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-4.31.02-pm-1836x989.png)
*update Manifest "accessTokenAcceptedVersion"*


## Configure and run the Client (SPA) and Service (API) apps

**Configure the service app to use your app registration**

Open the project in your IDE (like Visual Studio or Visual Studio Code) to configure the code.

In the steps below, "ClientID" is the same as "Application ID" or "AppId".
Open the config.js file.
Find the key clientID and replace the existing value with the application ID (clientId) of the ms-identity-javascript-tutorial-c3s1-api application copied from the Azure portal.
Find the key tenantID and replace the existing value with your Azure AD tenant ID.
Find the key audience and replace the existing value with the application ID (clientId) of the ms-identity-javascript-tutorial-c3s1-api application copied from the Azure portal.
Register the client app

**Configure the client app to use your app registration**

Open the project in your IDE (like Visual Studio or Visual Studio Code) to configure the code.

In the steps below, "ClientID" is the same as "Application ID" or "AppId".
Open the App\authConfig.js file. Then:

Find the key Enter_the_Application_Id_Here and replace the existing value with the application ID (clientId) of the ms-identity-javascript-c3s1-spa application copied from the Azure portal.
Find the key Enter_the_Cloud_Instance_Id_Here/Enter_the_Tenant_Info_Here and replace the existing value with https://login.microsoftonline.com/XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX (where XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX is the Directory (tenant) ID - same value for all app registrations created in that Azure tenant).

Find the key Enter_the_Redirect_Uri_Here and replace the existing value with the base address of the ms-identity-javascript-tutorial-c3s1-spa application (by default http://localhost:3000).
After you configured your web API, open the App\apiConfig.js file. Then:

Find the key Enter_the_Web_Api_Uri_Here and replace the existing value with the coordinates of your web API (by default http://localhost:5000/api).

Find the key Enter_the_Web_Api_Scope_Here and replace the existing value with the scopes for your web API, like api://e767d418-b80b-4568-9754-557f40697fc5/access_as_user. You can copy this from the Expose an API blade of the web APIs registration.

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-4.53.33-pm-1644x1184.png)
*Click Sign-in*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-4.53.56-pm-964x1310.png)
*Enter Azure/Office 365 credentials to login to*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-4.54.17-pm-1640x1180.png)
*Press Call API to ask Single Page Application to call protected API*

![](/assets/images/azure-active-directory2/screen-shot-2021-04-17-at-4.54.36-pm-1640x1184.png)
*Result returned from protect API*


## Discussion

SPA is a single page application based on an html file and JavaScript (not React, Angular or Vue). As authPopup.js (or authRedirect.js) is loaded myMSALObj is set to a new msal.PublicClientApplication instance using msalConfig. further down in the same file "selectAccount();" is called. selectAccount calls the getAllAccounts method on the msal.PublicClientApplication instance. If at least one account is returned the welcomeUser function is called passing the username from the first account.

welcomeUser is defined in ui.js. welcomeUser uses document.getElementById and css classes to update the html page (showing if a user is logged in).

If the html signIn button is pressed the signIn function in authPopup.js (or authRedirect.js) is run. This calls the loginPopup (or loginRedirect) method on the msal.PublicClientApplication instance passing loginRequest (an object with a scopes property ... {scopes: ["openid", "api://ae580c57-2645-404d-a870-2a390db782ec/access_as_user"]} ). The handleResponse function is called if the user login succeeds. The handleResponse function sets a username variable and calls the welcomeUser function again (passing the value of that username variable).

If the html callApiButton button is pressed the passTokenToApi function is executed. The passTokenToApi function calls getTokenPopup (or getTokenRedirect) which uses myMSALObj.acquireTokenSilent and (possibly) the myMSALObj.acquireTokenPopup (or myMSALObj.acquireTokenRedirect) methods (here the constant tokenRequest is used { scopes: ["Mail.Read"] } although we do not go on to read mail...). 

Once the access_token has been acquired function callApi is called passing apiConfig.uri ("http://localhost:5000/api") and the response.accessToken. callApi appends an Authorization header with value accessToken and uses fetch to call the API. The response from the API call should include the logged in user's **name**.

API is a Node express app. The code starts by defining const app=express(). "morgan" (for debugging) and "passport" are added to the express instance. bearerStrategy is added to the passport reference. CORS is enabled using permissive headers.

Then the "/api" endpoint is exposed. The /api handler is only run if passport.authenticated (see the response received from Azure Active Directory requesting "access_as_user" permissions). req.authInfo provides authentication information. In the sample information from the req.authInfo property is returned as the result of the API call (including the logged in user's **name**).


## App.js

```text
import React, { useState } from "react";
import { AuthenticatedTemplate, UnauthenticatedTemplate, useMsal } from "@azure/msal-react";
import { loginRequest } from "./authConfig";
import { PageLayout } from "./components/PageLayout";
import { ProfileData } from "./components/ProfileData";
import { callMsGraph } from "./graph";
import Button from "react-bootstrap/Button";
import "./styles/App.css";

/**
 * Renders information about the signed-in user or a button to retrieve data about the user
 */
const ProfileContent = () => {
    const { instance, accounts } = useMsal();
    const [graphData, setGraphData] = useState(null);

    function RequestProfileData() {
        // Silently acquires an access token which is then attached to a request for MS Graph data
        instance.acquireTokenSilent({
            ...loginRequest,
            account: accounts[0]
        }).then((response) => {
            callMsGraph(response.accessToken).then(response => setGraphData(response));
        });
    }

    return (
        <>
            <h5 className="card-title">Welcome {accounts[0].name}</h5>
            {graphData ? 
                <ProfileData graphData={graphData} />
                :
                <Button variant="secondary" onClick={RequestProfileData}>Request Profile Information</Button>
            }
        </>
    );
};

/**
 * If a user is authenticated the ProfileContent component above is rendered. Otherwise a message indicating a user is not authenticated is rendered.
 */
const MainContent = () => {    
    return (
        <div className="App">
            <AuthenticatedTemplate>
                <ProfileContent />
            </AuthenticatedTemplate>

            <UnauthenticatedTemplate>
                <h5 className="card-title">Please sign-in to see your profile information.</h5>
            </UnauthenticatedTemplate>
        </div>
    );
};

export default function App() {
    return (
        <PageLayout>
            <MainContent />
        </PageLayout>
    );
}
```

---

## azure-ai-part-1

**Source file:** `azure-ai-part-1.md`

---
title: "Azure AI (Part 1)"
description: "Overview of Azure AI Services"
date: "2024-01-10"
categories: ["Azure"]
image: "/assets/images/azure-ai.png"
tags: ["Azure", "AI", "Machine Learning"]
hidden: true
slug: "azure-ai-part-1"
---

# Azure AI Services - Getting Started

Azure AI provides a comprehensive suite of artificial intelligence services that enable developers to build intelligent applications without deep AI expertise.

Azure AI encompasses several categories of services:

### Cognitive Services
- **Computer Vision**: Analyze images and videos
- **Speech Services**: Speech-to-text and text-to-speech
- **Language Services**: Natural language processing
- **Decision Services**: Content moderation and personalization

### Azure Machine Learning
- **ML Studio**: Visual interface for building ML models
- **Automated ML**: Automatically find the best model
- **Designer**: Drag-and-drop ML pipeline creation
- **Notebooks**: Jupyter notebook environment

## Getting Started with Computer Vision

Here's a simple example using the Computer Vision API:

```python
from azure.cognitiveservices.vision.computervision import ComputerVisionClient
from azure.cognitiveservices.vision.computervision.models import OperationStatusCodes
from msrest.authentication import CognitiveServicesCredentials

# Set up the client
subscription_key = "your-subscription-key"
endpoint = "your-endpoint"

computervision_client = ComputerVisionClient(
    endpoint, 
    CognitiveServicesCredentials(subscription_key)
)

# Analyze an image
def analyze_image(image_url):
    # Select visual features to analyze
    features = ["objects", "tags", "description"]
    
    # Call the API
    results = computervision_client.analyze_image(image_url, features)
    
    # Process results
    if results.description.captions:
        print(f"Description: {results.description.captions[0].text}")
    
    if results.tags:
        print("Tags:")
        for tag in results.tags:
            print(f"  - {tag.name} (confidence: {tag.confidence:.2f})")

# Example usage
image_url = "https://example.com/image.jpg"
analyze_image(image_url)
```

## Azure OpenAI Integration
```

## Azure OpenAI Integration

Azure OpenAI Service provides REST API access to OpenAI's models:

```javascript
import { OpenAIApi, Configuration } from 'azure-openai';

const configuration = new Configuration({
  apiKey: process.env.AZURE_OPENAI_API_KEY,
  basePath: `https://${process.env.AZURE_OPENAI_RESOURCE_NAME}.openai.azure.com/openai/deployments/${process.env.AZURE_OPENAI_DEPLOYMENT_NAME}`,
  baseOptions: {
    headers: {
      'api-key': process.env.AZURE_OPENAI_API_KEY,
    },
    params: {
      'api-version': '2023-05-15'
    }
  }
});

const openai = new OpenAIApi(configuration);

async function generateText(prompt) {
  try {
    const response = await openai.createCompletion({
      prompt: prompt,
      max_tokens: 100,
      temperature: 0.7
    });
    
    return response.data.choices[0].text;
  } catch (error) {
    console.error('Error generating text:', error);
  }
}
```

## Best Practices

```

## Best Practices

1. **Security**: Always use managed identities when possible
2. **Cost Management**: Monitor usage and set up billing alerts
3. **Performance**: Use appropriate regions and pricing tiers
4. **Compliance**: Understand data residency and privacy implications

## Next Steps

In the next part of this series, we'll explore:
- Advanced Azure ML scenarios
- Custom model training
- MLOps with Azure DevOps
- Monitoring and governance

Azure AI services provide powerful capabilities for adding intelligence to your applications with minimal complexity.
```

## References

- [Get started with the Python enterprise chat sample using RAG](https://learn.microsoft.com/en-us/azure/developer/python/get-started-app-chat-template?tabs=github-codespaces) - Microsoft Learn tutorial on building enterprise chat applications with Retrieval Augmented Generation using Python and Azure.

- [Request access to Azure OpenAI service](https://customervoice.microsoft.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR7en2Ais5pxKtso_Pz4b1_xUNTZBNzRKNlVQSFhZMU9aV09EVzYxWFdORCQlQCN0PWcu) - Application form to request access to Azure OpenAI services for your organization.



---

## azureai1-new

**Source file:** `azureai1-new.md`

---
title: "Azure AI (Part 1)"
description: "Azure OpenAI Service, and Retrieval Augmented Generation (RAG) in Azure AI Search"
date: "2025-09-20"
categories: ["Azure"]
image: "/assets/images/azurex70x75.svg"
tags: ["azure","python","ai","git","github"]
hidden: true
slug: "azureai1-new"
---

# Azure AI (Part 1)

## Azure OpenAI Service, and Retrieval Augmented Generation (RAG) in Azure AI Search

![](/assets/images/azureai1/microsoft-azure-logo.svg)
*Microsoft Azure Logo by Microsoft Corporation is Public Domain*


Microsoft provide a chat app sample using Python, Azure OpenAI Service, and Retrieval Augmented Generation (RAG) in Azure AI Search to get answers about employee benefits.

![](/assets/images/azureai1/screenshot-2024-02-18-at-12.59.34-pm-1836x1329.png)
*Microsoft Azure Cost Management*

![](/assets/images/azureai1/screenshot-2024-02-18-at-12.59.47-pm-1836x1321.png)
*No resource groups*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.00.00-pm-1836x1327.png)
*No github codespaces*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.01.18-pm-1836x1472.png)
*Get started with the Python enterprise chat sample using RAG*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.01.34-pm-1836x723.png)
*I clicked the "Open this project in GitHub Codespaces" button*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.02.01-pm-1836x1324.png)
*I clicked the "Create codespace" button*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.02.21-pm-1836x1319.png)
*Setting up the codespace...*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.22.56-pm-1836x873.png)
*The "friendly sniffle" codespace*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.07.11-pm-1836x754.png)
*$ azd auth login*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.07.49-pm-1836x967.png)
*I clicked the Open button*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.08.22-pm-958x718.png)
*I provided my Azure credentials (2 factor)*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.09.02-pm-1836x889.png)
*$ azd up*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.13.02-pm-1364x940.png)
*Environment myEnv*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.18.35-pm-1836x792.png)
*My subscription id is 6e59b290-3a66-40db-b797-84f065edeb7f*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.26.20-pm-1338x816.png)
*The template deployment 'openai' is not valid...*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.27.42-pm-1836x1069.png)
*Request access to Azure OpenAI service.*

![](/assets/images/azureai1/screenshot-2024-02-18-at-2.21.01-pm-1836x1228.png)
*I requested access...*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*



---

## azureai1

**Source file:** `azureai1.md`

---
title: "Azure AI (Part 1)"
description: "Azure OpenAI Service, and Retrieval Augmented Generation (RAG) in Azure AI Search"
date: "2025-09-20"
categories: ["Azure"]
image: "/assets/images/azureai1/hero.png"
tags: ["azure","python","ai","git","github"]
hidden: true
slug: "azureai1"
---

# Azure AI (Part 1)

## Azure OpenAI Service, and Retrieval Augmented Generation (RAG) in Azure AI Search

![](/assets/images/azureai1/microsoft-azure-logo.svg)
*Microsoft Azure Logo by Microsoft Corporation is Public Domain*


Microsoft provide a chat app sample using Python, Azure OpenAI Service, and Retrieval Augmented Generation (RAG) in Azure AI Search to get answers about employee benefits.

![](/assets/images/azureai1/screenshot-2024-02-18-at-12.59.34-pm-1836x1329.png)
*Microsoft Azure Cost Management*

![](/assets/images/azureai1/screenshot-2024-02-18-at-12.59.47-pm-1836x1321.png)
*No resource groups*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.00.00-pm-1836x1327.png)
*No github codespaces*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.01.18-pm-1836x1472.png)
*Get started with the Python enterprise chat sample using RAG*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.01.34-pm-1836x723.png)
*I clicked the "Open this project in GitHub Codespaces" button*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.02.01-pm-1836x1324.png)
*I clicked the "Create codespace" button*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.02.21-pm-1836x1319.png)
*Setting up the codespace...*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.22.56-pm-1836x873.png)
*The "friendly sniffle" codespace*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.07.11-pm-1836x754.png)
*$ azd auth login*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.07.49-pm-1836x967.png)
*I clicked the Open button*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.08.22-pm-958x718.png)
*I provided my Azure credentials (2 factor)*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.09.02-pm-1836x889.png)
*$ azd up*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.13.02-pm-1364x940.png)
*Environment myEnv*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.18.35-pm-1836x792.png)
*My subscription id is 6e59b290-3a66-40db-b797-84f065edeb7f*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.26.20-pm-1338x816.png)
*The template deployment 'openai' is not valid...*

![](/assets/images/azureai1/screenshot-2024-02-18-at-1.27.42-pm-1836x1069.png)
*Request access to Azure OpenAI service.*

![](/assets/images/azureai1/screenshot-2024-02-18-at-2.21.01-pm-1836x1228.png)
*I requested access...*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/azureai1/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*


---

## azureopenal

**Source file:** `azureopenal.md`

---
title: "Azure AI service"
description: "Azure OpenAl"
date: "2025-02-04"
categories: ["Azure","AI"]
tags: []
slug: "azureopenal"
image: "/assets/images/azurex70x75.svg"
---


Azure OpenAI is a service that provides access to OpenAI's generative AI models, including:

GPT-4, GPT-3.5 (for natural language processing)
DALL·E (for image generation)
Codex (for code generation and AI-assisted development)
Whisper (for speech-to-text transcription)

Azure OpenAI Service is used for AI applications, including chatbots, document summarization, and AI-powered automation.

![](/assets/images/azureopenal/screenshot-2025-02-04-at-9.23.12pm-1536x877.png)
*I clicked the Create Azure OpenAI button*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-9.23.39pm-1536x874.png)
*I provided a new resource group name*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-9.24.32pm-1536x943.png)
*I provided a new Azure OpenAI service name*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-9.24.43pm-1536x936.png)
*I selected a firewall option*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-9.25.05pm-1536x941.png)
*I reviewed the terms and clicked the Create button*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-9.25.21pm-1536x226.png)
*The haddley-ai Azure OpenAI instance was deployed*

![](/assets/images/azureopenal/screenshot-2025-02-05-at-4.55.43pm-2136x1099.png)
*I clicked the Explore Azure AI Foundry portal button*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-10.06.50pm-1536x840.png)
*I clicked the + Create new deployment button*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-10.07.11pm-1536x798.png)
*I selected the gpt-35-turbo model*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-10.07.23pm-1536x844.png)
*I clicked the Deploy button*

![](/assets/images/azureopenal/screenshot-2025-02-05-at-4.45.53pm-1536x795.png)
*I used Chat playground to test the deployment/model*

![](/assets/images/azureopenal/screenshot-2025-02-04-at-10.33.37pm-1536x842.png)
*I reviewed the Endpoint details (the Target URI and the Key)*

---

## azurereactstaticweb-app

**Source file:** `azurereactstaticweb-app.md`

---
title: "Azure React Static Web App"
description: "Azure Static Web App"
date: "2024-01-08"
categories: ["React","Azure",".NET"]
tags: []
slug: "azurereactstaticweb-app"
image: "/assets/images/logo512-512x512.png"
---


I created a React app, tested it locally, pushed the code to GitHub and published to Azure.

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.31.20-pm-1836x1037.png)
*I logged onto https://portal.azure.com using my personal account*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.31.43-pm-1836x1039.png)
*I have a Pay-As-You-Go subscription*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.32.39-pm-1836x360.png)
*I opened GitHub Desktop and created a new repository*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.34.02-pm-808x918.png)
*I named the repository react-azure*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.34.26-pm-1836x1257.png)
*I published the empty repository to GitHub. I clicked on the Open in Visual Studio Code (insiders) button*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.35.49-pm-1836x447.png)
*I opened a terminal and ran npx create-react-app . to create a new React app.*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.36.22-pm-1836x748.png)
*create-react-app ran*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.37.25-pm-1836x1338.png)
*create-react-app finished. I ran npm run build to build the React project*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.37.46-pm-1836x1341.png)
*A build folder was created*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.39.35-pm-1836x854.png)
*I opened the build folder using Visual Studio Code and used Live Server to open the application*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.40.14-pm-1424x1060.png)
*The sample React app was loaded from http://127.0.0.1:5000*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.40.25-pm-1836x1264.png)
*I committed the updates*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.40.57-pm-1836x1255.png)
*I pushed the updated to GitHub*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.42.25-pm-1836x1026.png)
*I created a Static Web App (in the Azure portal)*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.43.14-pm-1836x1026.png)
*I created a new Resource Group and a new Static Web App. I selected the free plan*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.43.29-pm-1836x1025.png)
*I clicked the Sign in with GitHub Click here to login link*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.45.42-pm-1836x1027.png)
*I logged into GitHub and clicked the Authorize Azure... button*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.46.45-pm-1836x1025.png)
*I selected the Organization Haddley, Repository react-azure and branch main and clicked the Review + create button*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.47.04-pm-1836x1027.png)
*I reviewed the Static Web App details and clicked the Create button*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.47.23-pm-1836x1025.png)
*The Static Web App was deployed.*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.47.57-pm-1836x671.png)
*A GitHub Action was added to the repository*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.48.08-pm-1836x952.png)
*The GitHub Action built the React application*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.48.45-pm-1836x1029.png)
*Some warnings were generated*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.49.40-pm-1836x1030.png)
*The Azure Static Web App was updated*

![](/assets/images/azurereactstaticweb-app/screen-shot-2024-01-08-at-12.50.32-pm-1836x1037.png)
*I navigated to https://brave-flower-0913bf910.4.azurestaticapps.net*

---

## azurestorage

**Source file:** `azurestorage.md`

---
title: "Azure Storage"
description: "Microsoft Azure Storage"
date: "2022-08-13"
categories: ["Azure"]
tags: []
slug: "azurestorage"
image: "/assets/images/azurex70x75.svg"
---


The Azure Storage platform is Microsoft's cloud storage solution. Azure Storage offers available, scalable, durable, and secure storage in the cloud.

Azure Storage includes Azure Blobs, Data Lake Storage, Azure Queues and Azure Tables. 

The cost of a Storage Account depends on usage and options selected.

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.25.09-am-1020x251.png)
*Creating a Storage Account*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.26.52-am-1020x746.png)
*In a new Resource Group*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.28.08-am-1020x770.png)
*Unique storage account name*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.28.40-am-1020x765.png)
*Selecting the Cool access tier*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.29.06-am-1020x767.png)
*No network address restrictions*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.29.32-am-1020x766.png)
*Storage account can contain blobs, containers (folders) and (smb) file shares.*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.29.46-am-1020x769.png)
*Microsoft-managed keys*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.30.06-am-1792x1340.png)
*No tags are defined*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.30.15-am-1790x1340.png)
*Review a summary*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.30.30-am-1782x1342.png)
*Deployment in progress*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.32.13-am-1782x1340.png)
*Define a budget*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.32.35-am-1790x1344.png)
*10 dollars per month*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.33.38-am-1786x1342.png)
*Create alerts*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.34.19-am-1790x1346.png)
*Create a new file share*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.34.58-am-1784x1338.png)
*Name the file share*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.35.14-am-1784x1336.png)
*'shared' file share has been created*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.36.07-am-1792x994.png)
*Click connect to generate a script*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.36.27-am-1790x1346.png)
*Select platform (macOS) and click "Show Script"*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.37.34-am-1228x1006.png)
*Run the script*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.40.35-am-1834x866.png)
*Create folders in the Share*

![](/assets/images/azurestorage/screen-shot-2022-08-17-at-8.43.10-am-1836x862.png)
*Copy files to the folders*

![](/assets/images/azurestorage/screen-shot-2022-08-18-at-6.28.30-am-1544x554.png)
*Remote Volume*

---

## blazorwasmandasp.net

**Source file:** `blazorwasmandasp.net.md`

---
title: "Blazor WASM and ASP.NET Core"
description: "An ASP.NET Core backend and a Blazor Web Assembly frontend."
date: "2023-03-24"
categories: [".NET"]
tags: []
slug: "blazorwasmandasp.net"
image: "/assets/images/net-logo.svg"
---


## Single Page Application (SPA) templates

Visual Studio includes an ASP.NET Core Single Page Application (SPA) templates that supports Blazor WASM.

I review the Blazor WASM template here.


## ChatGPT

**I want to create a Blazor WebAssembly project**

Great! Here's a step-by-step guide to create a Blazor WebAssembly project:

Open Visual Studio.
Click on "Create a new project".
Select "Blazor App".
Choose a name for your project, and then click "Create".
In the next window, choose "Blazor WebAssembly App" as the project type.
Select the "ASP.NET Core hosted" option, which will create a project with a backend API.
Choose the authentication type you want to use. You can select "No authentication" if you don't need any authentication.
Click "Create" to create your project.
Now, Visual Studio will create a Blazor WebAssembly project with a backend API. You can start coding your application in the client-side Blazor code, and use the backend API to handle data and other operations.

Note: If you prefer to use the command line, you can create a new Blazor WebAssembly project using the following command:

**$ dotnet new blazorwasm -n ProjectName**

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-22-at-9.16.36-am-1440x880.png)
*I used Visual Studio 2022 for Mac*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.36.56-am-1380x978.png)
*I selected the Blazer WebAssembly template*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.37.08-am-1800x1276.png)
*I selected the (cross platform) ASP.NET Core 6 framework*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.37.31-am-1794x1272.png)
*I provided a solution/project name*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.57.21-am-1836x1014.png)
*The template includes client and server-side C# code*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.58.50-am-1836x925.png)
*Solution did not run exactly as generated*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.59.14-am-1836x910.png)
*clientId fix*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.59.37-am-1836x1030.png)
*I ran the project successfully*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-11.59.54-am-1836x743.png)
*I reviewed the Program.cs file. The template includes a local user database.*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-12.06.17-pm-1836x704.png)
*I registered as a user.*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-12.06.28-pm-1836x651.png)
*I was able to login*

![](/assets/images/blazorwasmandasp.net/screen-shot-2023-03-25-at-12.06.35-pm-1836x674.png)
*The Fetch data Blazer Web Assembly component returns data provided by ASP.NET Core controller*

---

## blogcopilotstudio

**Source file:** `blogcopilotstudio.md`

---
title: "Blog Copilot Studio"
description: "Blog Copilot"
date: "2024-03-24"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics","Power Platform"]
tags: []
slug: "blogcopilotstudio"
image: "/assets/images/posts-meta.svg"
---



I created a Business Central extension that allows Business Central users to "chat to" [this blog](https://haddley.github.io).

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-12.37.07-pm-1836x1063.png)
*I created a "Blog Copilot" Copilot*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-12.37.19-pm-1836x1056.png)
*I watched the animation*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-12.38.01-pm-1836x1064.png)
*The Copilot was provisioned*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-12.38.22-pm-1836x1063.png)
*I switched to No authentication*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-12.38.32-pm-1836x1063.png)
*I clicked Save*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-12.39.05-pm-1836x1060.png)
*I published the Copilot*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-12.39.52-pm-1836x1062.png)
*I copied the Token Endpoint*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-6.57.47-pm-1836x544.png)
*With the Business Central extension deployed I navigated to the Blog Copilot page using the search function*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-6.58.22-pm-1836x1023.png)
*I asked the Blog Copilot "What is NGRX"?*

![](/assets/images/blogcopilotstudio/screenshot-2024-03-24-at-6.58.54-pm-1836x1021.png)
*I asked the Blog Copilot "What is an API Gateway" and "What is Java"?*


## BlogCopilotExtension.al

```text
controladdin BlogCopilotControlAddin
{
    RequestedHeight = 400;
    MaximumHeight = 700;
    VerticalStretch = true;
    VerticalShrink = true;
    HorizontalStretch = true;
    HorizontalShrink = true;

    Scripts = 'https://cdn.botframework.com/botframework-webchat/latest/webchat.js', 'BlogCopilotFunctions.js';
    Stylesheets = 'BlogCopilotStyles.css';


    event ControlReady()
    procedure CreateCopilot();
}

page 99110 "Blog Copilot"
{
    PageType=Card;
    Caption='Blog Copilot';


    ApplicationArea = All;
    UsageCategory = Tasks;

    layout
    {
        area(Content)
        {
            usercontrol(Foo; BlogCopilotControlAddin)
            {
                ApplicationArea = All;

            }
        }
    }

}
```

## BlogCopilotFunctions.js

```text
async function CreateCopilot() {

    var __div = document.getElementById('controlAddIn');

    // Specifies style options to customize the Web Chat canvas.
    // Please visit https://microsoft.github.io/BotFramework-WebChat for customization samples.
    const styleOptions = {
        accent: '#00809d',
        botAvatarBackgroundColor: '#FFFFFF',
        // botAvatarImage: 'https://learn.microsoft.com/azure/bot-service/v4sdk/media/logo_bot.svg',
        botAvatarImage: 'data:image;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAACYCAYAAAAYwiAhAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TRZFKwRYRcchQneyiIo6likWwUNoKrTqYXPoFTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxdXFSdJES/5cUWsR4cNyPd/ced+8AoVllqtkTA1TNMtKJuJjLr4p9rwggiCGEMCwxU09mFrPwHF/38PH1LsqzvM/9OQaVgskAn0gcY7phEW8Qz25aOud94jArSwrxOfGkQRckfuS67PIb55LDAs8MG9n0PHGYWCx1sdzFrGyoxDPEEUXVKF/Iuaxw3uKsVuusfU/+wkBBW8lwneYYElhCEimIkFFHBVVYiNKqkWIiTftxD/+o40+RSyZXBYwcC6hBheT4wf/gd7dmcXrKTQrEgd4X2/4YB/p2gVbDtr+Pbbt1AvifgSut4681gblP0hsdLXIEBLeBi+uOJu8BlzvAyJMuGZIj+WkKxSLwfkbflAdCt8DAmttbex+nD0CWulq+AQ4OgYkSZa97vLu/u7d/z7T7+wGSW3Kz8ImFcQAAAAZiS0dEAJ8AoQCjPXDOuwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cMDxMiAOPUJ8QAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAI4ElEQVR42u2dX0xb1x3Hv/dSMFZV41hGkzCaXUCTvBXsSCPsJZf1IeGhg9FGlbZJYWXaXvKvtta3OWqq8NZtOGKqNK1a2zCtD2klmm4PlIcU7yXMD4MkClKFM1vCeUlkLqDJMai+ezAQYl/+5hruOXw/LxYGDte/++F3zj3n3N9VsFsiw+5aoF9BTTcUI2wAAQVwg0iPAegKkDYUZRrFbydXgTHEo/puflfZhViBWrXmbRjGWxSKbEinKB+vFr99D/Foen+CRYbdtWrNu4phRBhOso1o8dU/XoruTbDIcKBOUW8BCDCEZBekV4ziq2bZTDWRK0y5yB4J1CnqrdrIcHj7DMbMRSzOZMrmMVedov6HchELJDu+fpW50UXWqjXvUi5iRXe55tKmDFbqGv/L2BCrWDGKLyMeTaubshchllGrIFLKYKWx1wJDQixGXzGKL6u1QD9jQaqAuxboV6HWdDMWpBooULpVGEaYoSDVwFCUsApOTZCqZTAEVO6QINUch6mMAakmFIxQMELBCKFghIIRCkYIBSMUjFAwQigYoWCEghFCwQgFI4SCEQpGKBghFIxQMELBCKFgxIa8wBDsHq2tGVqrD4lUFom5eQaEglnH2c4gPvz5qY2v3xlLYCQxzcCwi7SGS9qzFRYuaqy4QMEspMFZzyBQMMIx2CHQ196Kvh+0wO95ad9tlP9ug9OBiXNv7Lu9TG4Zk6l5jCZnpY69Uhe9Zsh81ffhz049l1jVJpNbwq8/nUAilWUXKRIDnUFMnHvD1nKVMqMLE+fPYKAzSMFEwe9x4f1+Tahjfr9fs/0/AwVbI3a6C26nQ6hjdjsduHz6RxzkC9E9nqjsbkYS0xgan4KeL9hCpgtaGJd7up55v7e9Be4vHLY4RmawbQb25dy89wDvjCVsc+L0fAFD41MVy01upwN+j4tdpGjMZB/Z8rgmTa4cG+rrKBghFIxQMELBCHkujvx+sA6fF5dOHofW5sNivoCZ7GNc/eo2MrnlQ22LgknAQGcQf9m0ibAkSSPOngjiN59O4PoeFqKtbItdpAT4Pa4KITazl6UbK9uiYJKw045Ut9OBi9rxA2+LgklCqMm7q8x00G1RMEnQ8ys7/kxDvePA26JgkjDzcOflo9Hk/QNvi4JJwp8S09tOH2RyS0ik5g+8LQomTRdZwKkPPjcVI5Nb2vJ71W5LNo70PFgmt4TvDX2Es51BhHyNcNc7MP3wEf6WnN3z1h4r26JgkjGanLXs7h4r22IXSQgFIxSMUDBCKNja1Vw53a0+Wx7rQOf3K95bfLIi1fl4QUbB9HzhmfsitbZm3Bh8DSP/mrHFMbqdDlw8GarYYZHJLdn2BhUKtomRxHTFPYd97a3oa2+19XHLuGdMyjHYTks3ds28Mq5XSinYdks3dpVL1uUkaa8i10+a3bud0eSs1GuVUtcHW8fvcSHU5EWHr9FW/wBf3nsg/TrlkRCMsIskFIwQCkYoGKFghFiEdEtFIV8jOnxeIY99Mb8i3XqkFIKV7pwO44IWFq74rxmlZaNZXE/eF34CVvh5sA6fF58N9kpZ+yGTW8Kbf/0HZh4+5hjssOSaOHdG2sIifo8LX50/s6vSBBSsCsH/bLBXii5xp+7/xq9+IuznFHYMNtAZNM1ck3NZ3LyXwqKAa3wNTgcuaccrPpff48IFLYyh8SmOwQ6Kb2KDFSfi6viUkCehnFhPV8WGST1fwHd+92d2kQczFeE13W4sg1wAtnxIQ8hGu0GkFsx/rLLWlmzPz/7i3oPKixoBB/tCCtZgMuCVbV/VoiSfh0tFhIIRCkaIPIKZjU9kK7Jr9nnM7lqnYFXAbG0uIJlgoabKKQkRywpIk8E0m9af2C8Bk1UKEbfxCCmYni/gTlmw/R6XNIvefo+r4ha7mayYOyqEHeSbPS32rEm1GhGJne6qeE/UKtXCCnbzbqrivYsSbDj0e1zoNnnuuKh1X4UVLJHKmq7X3Rh8TWjBfv/TkxVd/eRcVtht1ELPg101WdzW2pordiKIwuWeLtMSUyJX3RFaMLMsBphvd7F95urXEDM5ZtHLogs/k//mR/80vTEi1tOFb2Jv2f7KssPnRfK3vzB9JGAmt4Sr47eFPj9SFD/paPJi4vyZLQf4o/+etd2jjf0eF2KnuzBwImj6fT1fwIk//J13FYkiGQAk5uZxPTl7aGWT3E4HettbMPDDIDSTK8XNcp364HPcyT4W/rxIVb7J73Ht+i6jxNw8JlNZJFJZ3Mk+qopwfo8LIV8jQk1eaK2+baXa3C3KVJBOuvpgbqcDsZ6uHR9zbJY11kXL5JahPykgs7C0dtKXt/xbDc66kkzHXHDXO9a2NnvxXY9rz3NyI4lpDI1PSbV5UtoCdH6PC7GeLgx0Bm1/rJNzWQyN30bCZHWCggkiWt8rLbaa5dfzBYwmZ3HzbkpKsY6MYJvpe6UFve2t6G5tPpTpCz1fwJd3H+B68j7uPHx8JJ4jeWRrtHY0eRHwuKC1NSPU1IiGtbGTVWRyy5jJPkJmoVQtJzE3j8zC0XvqLYsAl3epx17a2E1a/rrVVR9Q2qOWzi1hMV84kiJtBZ94Wy7MwvJTQSQeGx0UvOmDUDBCwQihYISCEQpGCAUjFIxQMEIoGKFghIIRQsEIBSOEghEKRigYIRSMUDBCwQihYMSOghmAzjCQKqGrANKMA6kGBpBWFaM4w1CQaqAYxrRqAF8zFKQ6GcyYVFeBMY7DSDVYBcZUxKM6jOInDAexNn0ZHyMe1VUAqAHijAixEhXGe6VXAE/i0bRhFK8xLMSasVfx2pN4NL0h2Fp/eQWcsiDPT3p1OBp5msnWiUd11Si+SsnI88i15hAqBXvaVb5Oych+5DKM4uvrXeM6itlP1keGA0VFvQUgwLiR3Waucrm2FGyd2shwXFHUtxk/st2A/kUDV/R41HQuVdmpgfrIcKAIXIGi/pLhJCWpoKtG8RMFiJtlrT0Jto47Muz+H9CvAD82FCUEKAEFcDPcR0MowEgrBqYNGJMvAmNbZaxy/g/gnmrRS4hOdQAAAABJRU5ErkJggg==',
        botAvatarInitials: 'BT',
        userAvatarImage: 'https://content.powerapps.com/resource/makerx/static/media/user.336bbce3.svg',
        userAvatarInitials: 'USER',
        hideUploadButton: true,
        primaryFont: fontFamily(['Segoe UI', 'Segoe WP', 'Segoe', 'device-segoe', 'Tahoma', 'Helvetica', 'Arial', 'sans-serif']),
    };


    // Specifies the token endpoint URL.
    // To get this value, visit Copilot Studio > Settings > Channels > Mobile app page.
    const tokenEndpointURL = new URL('https://b838e0443024ea32b2f47862b85e99.03.environment.api.powerplatform.com/powervirtualagents/botsbyschema/cr74e_blogCopilot/directline/token?api-version=2022-03-01-preview');

    const locale = document.documentElement.lang || 'en'; // Uses language specified in <html> element and fallback to English (United States).

    const apiVersion = tokenEndpointURL.searchParams.get('api-version');

    const [directLineURL, token] = await Promise.all([
        fetch(new URL(`/powervirtualagents/regionalchannelsettings?api-version=${apiVersion}`, tokenEndpointURL))
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to retrieve regional channel settings.');
                }

                return response.json();
            })
            .then(({ channelUrlsById: { directline } }) => directline),
        fetch(tokenEndpointURL)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to retrieve Direct Line token.');
                }

                return response.json();
            })
            .then(({ token }) => token)
    ]);

    const directLine = WebChat.createDirectLine({ domain: new URL('v3/directline', directLineURL), token });

    // Sends "startConversation" event when the connection is established.

    const subscription = directLine.connectionStatus$.subscribe({
        next(value) {
            if (value === 2) {
                directLine
                    .postActivity({
                        localTimezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                        locale,
                        name: 'startConversation',
                        type: 'event',
                    })
                    .subscribe();

                // Only send the event once, unsubscribe after the event is sent.
                subscription.unsubscribe();
            }
        }
    });

    WebChat.renderWebChat({ directLine, locale, styleOptions }, __div);

    Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("ControlReady");

}

function fontFamily(fonts) {
    return fonts.map(font => `'${font}'`).join(', ');
}

// call the setup function
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

sleep(1000).then(() => { CreateCopilot(); });
```

## BlogCopilotStyles.css

```text
* {
    font-size: 10.5pt
}
```

---

## businesscentraladmincenter

**Source file:** `businesscentraladmincenter.md`

---
title: "Business Central Admin Center"
description: "The Business Central Administration Center"
date: "2023-08-18"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "businesscentraladmincenter"
image: "/assets/images/dynamics365-color.svg"
---


The Business Central Administration Center (Admin Center) provides a portal for tenant administration.

I used the Admin Center to create a development/sandbox environment.

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-11.25.26-am-1836x965.png)
*I used the Settings|Admin Center link to navigate to the Admin Center (portal). Notice that the Safari browser is not supported.*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-11.25.42-am-1836x972.png)
*I clicked on the "Production" Environment*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-12.27.14-pm-1836x403.png)
*I clicked the Copy link*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-12.28.01-pm-1836x715.png)
*I selected Sandbox environment type and entered "MySandbox" as the new environment name*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-12.28.20-pm-1836x708.png)
*I clicked the Yes link*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-12.28.40-pm-1836x717.png)
*"Copy Scheduled"*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-12.28.52-pm-1836x714.png)
*The MySandbox environment was listed in the Environments tab as "Preparing"*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-1.00.00-pm-1836x714.png)
*The Sandbox state was updated to "Active"*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-1.08.43-pm-1836x711.png)
*I clicked the link*

![](/assets/images/businesscentraladmincenter/screen-shot-2023-08-18-at-1.12.12-pm-1836x929.png)
*I was able to switch between the Production and Sandbox environment*

---

## businesscentralcanvasapps

**Source file:** `businesscentralcanvasapps.md`

---
title: "Business Central Canvas Apps"
description: "Microsoft Dynamics 365 Business Central"
date: "2023-08-14"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics","Power Platform"]
tags: []
slug: "businesscentralcanvasapps"
image: "/assets/images/dynamics365-color.svg"
---


[Microsoft Dynamics 365](https://en.wikipedia.org/wiki/Microsoft_Dynamics_365) is a product line of more than a dozen enterprise resource planning (ERP) and customer relationship management (CRM) business applications.

[Microsoft Dynamics 365 Business Central](https://en.wikipedia.org/wiki/Microsoft_Dynamics_365#Microsoft_Dynamics_365_Business_Central) (formerly Microsoft Dynamics NAV) is an ERP and CRM product meant for small and mid-sized businesses (Integrating both Dynamics NAV and Dynamics CRM features).


## Power Platform Environments

[Power Platform environments](https://admin.powerplatform.microsoft.com/environments) refer to isolated spaces within the Microsoft Power Platform ecosystem where I can develop, test, and deploy apps, flows, and other solutions.

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-11.48.03-am-1394x806.png)
*I added a Develop environment.*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-11.56.31-am-1152x396.png)
*I navigated to the Power Apps home page and selected the Develop environment*


## Currencies

I created a Canvas app to display the available currencies.

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.06.41-pm-1292x642.png)
*I clicked the "+ Create" link*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.06.53-pm-1294x644.png)
*I clicked the "Create" button on the "Blank canvas app" card*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.07.15-pm-1295x601.png)
*I named the app "Currencies"*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.07.37-pm-1295x601.png)
*I clicked the "Create a gallery" link*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.07.58-pm-1294x602.png)
*I selected the "Dynamics 365 Business Central" connector*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.08.36-pm-1293x241.png)
*I selected the "CRONUS USA, Inc." company in the "MYSANDBOX" environment.*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.08.59-pm-1291x601.png)
*I selected the "currencies (v2.0)" table*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.10.50-pm-1290x599.png)
*I selected the "Title and subtitle" (vertical gallery) layout.*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.11.03-pm-1293x207.png)
*I clicked the "Preview the app" link*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.11.15-pm-1293x377.png)
*I reviewed the preview.*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.18.22-pm-1357x779.png)
*I navigated to CRONUS USA, Inc company accounts in my MySandbox environment - Dynamics 365 Business Central*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.19.00-pm-1356x323.png)
*I used a "Tell Me" search to find a link to the Currencies Administration page.*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.19.50-pm-1359x415.png)
*The Currencies Administration page*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.44.34-pm-1354x378.png)
*Adding an extra currency*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-12.46.11-pm-1311x373.png)
*Running the Canvas app.*


## Sales Orders

I developed a Canvas app to display Sales Orders, filtered by Salesperson

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.42.37-pm-1297x559.png)
*I chose the Blank app*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.42.49-pm-1293x600.png)
*I clicked the Blank canvas app "Create app" link*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.43.35-pm-1293x600.png)
*I entered "Sales Orders" and clicked the Table radio button*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.43.59-pm-1292x599.png)
*I clicked the "Create a gallery" link*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.49.34-pm-1296x326.png)
*I selected the "Dynamics 365 Business Central" connector*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.49.49-pm-1294x200.png)
*I selected the "CRONUS USA, Inc." company accounts in the "MYSANDBOX" environment*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.50.18-pm-1292x601.png)
*I selected the Sales Orders (salesOrders) table*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.50.50-pm-1285x214.png)
*I updated the Gallery (Gallery1) to display a title, subtitle and body.*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.52.23-pm-1294x524.png)
*I "bound" table columns to the Title, Subtitle and Body fields.*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.52.40-pm-1296x175.png)
*All Sales Orders are displayed in a vertical list*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.53.01-pm-1295x492.png)
*I added an Edit Form*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.53.24-pm-1297x374.png)
*I set the Data source of the Form to the (same) Sales Orders table*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.53.51-pm-1296x451.png)
*I updated the Edit Form Item to bind to the item selected in the Gallery (Gallery1)*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.54.01-pm-1293x122.png)
*At this point I could select a Sales Order on the left and see the Sales Order (Item) detail on the right*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.54.41-pm-1293x134.png)
*I added a Drop down list (control)*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.55.37-pm-1294x149.png)
*I set the Data source of the Drop down list to the (same) Sales Orders table*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.56.14-pm-1293x231.png)
*I updated the Drop down list to display only Distinct values (the two salespeople values)*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-2.56.50-pm-1295x493.png)
*I updated Gallery1 to display only items sold by the salesperson selected in the Drop down list*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-3.19.56-pm-1297x604.png)
*I published the Canvas app*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-14-at-3.17.05-pm-1292x600.png)
*The Canvas app.*


## Items App

I developed a Canvas app to edit Items maintained in Business Central

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.20.25-pm-1836x583.png)
*I selected Dataverse*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.20.36-pm-1836x579.png)
*I selected the Dynamics 365 Business Central connection*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.20.48-pm-1836x297.png)
*I selected the CRONUS USA company in the MYSANDBOX environment*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.21.06-pm-1836x582.png)
*I selected the "items" table*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.21.30-pm-1836x586.png)
*A number of screens were automagically generated*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.21.46-pm-1836x579.png)
*I saved the generated app*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.22.01-pm-1836x183.png)
*I published the app*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.22.13-pm-1836x584.png)
*I published the latest version of the app*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.22.47-pm-1836x409.png)
*I "played" the app on my laptop*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.28.27-pm-1836x421.png)
*I selected the > link to view details of the "ATHENS Mobile Pedestal" item*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.28.37-pm-1836x303.png)
*I clicked the pencil icon to switch to the edit screen*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.29.00-pm-1836x660.png)
*I updated the item Display Name*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-12.29.52-pm-1836x507.png)
*I switched back to Microsoft 365 Business Central to check that the update had been saved.*

![](/assets/images/businesscentralcanvasapps/20230817image0-1242x2688.png)
*I "played" the app on my mobile phone*

![](/assets/images/businesscentralcanvasapps/20230817iimage1-1242x2688.png)
*I updated the Display Name again*

![](/assets/images/businesscentralcanvasapps/20230817iimage2-1242x2688.png)
*I saved the update*

![](/assets/images/businesscentralcanvasapps/screen-shot-2023-08-17-at-1.12.37-pm-1836x490.png)
*I switched back to Microsoft 365 Business Central to check that the mobile update had been saved.*

---

## businesscentralintegrationtables

**Source file:** `businesscentralintegrationtables.md`

---
title: "Business Central (Part 25) Integration Tables"
description: "Integration Tables"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/businesscentralintegrationtables/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "businesscentralintegrationtables"
---



![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

---

## businesscentralmicrosoftgraph

**Source file:** `businesscentralmicrosoftgraph.md`

---
title: "Business Central Microsoft Graph"
description: "Financials"
date: "2023-12-18"
categories: ["Microsoft Dynamics","Business Central","Microsoft 365","Microsoft Dynamics"]
tags: []
slug: "businesscentralmicrosoftgraph"
image: "/assets/images/posts-meta.svg"
---




[Microsoft Graph](MicrosoftGraph.html) can be used to develop applications that securely access and integrate with the data stored in Microsoft Dynamics 365 Business Central.

Graph Explorer is a web-based tool provided by Microsoft that allows developers and users to interact with Microsoft Graph APIs (Application Programming Interfaces) without the need for writing code.

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.17.04-am-1836x929.png)
*I navigated to Business Central and reviewed the three companies listed.*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-2.05.32-pm-1836x1025.png)
*In the Evaluation company the ATHENS Desk item had a unit price of $1,000.80*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.17.44-am-1836x928.png)
*I navigated to https://developer.microsoft.com/en-us/graph/graph-explorer and clicked the login button*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.17.59-am-1836x924.png)
*I logged in using the same credentials*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.19.33-am-1836x865.png)
*I switched to the beta endpoint. Typeahead suggested financials*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.20.42-am-1836x873.png)
*I added companies and made a GET request to https://graph.microsoft.com/beta/financials/companies.*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.21.14-am-1836x872.png)
*I added the id of company Evaluation (shown above) to the request url. Typeahead provided a list of options.*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.22.45-am-1836x871.png)
*I selected customers from the typeahead. I made a GET request to https://graph.../customers*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.23.31-am-1836x871.png)
*I added the id of customer Adatum Corporation to the get request URL.*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.28.20-am-1836x871.png)
*I updated the request URL to https://graph.../agedAccountsReceivable to return accounts receivable details*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.23.53-am-1836x871.png)
*I updated the request URL to https://graph.../items*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.25.08-am-1836x866.png)
*I added the ATHENS Desk item id to the URL*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.36.18-am-1836x1090.png)
*Notice that at this point unit price for an ATHENS Desk was $1,000.80*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.39.56-am-1836x1087.png)
*Notice that the eTag value was ...JzE50zY4N... a unique identifier associated with a specific version of a resource*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.52.05-am-1836x1092.png)
*I created a Request body, updated the http verb to PATCH and added an If-Match header to the Request headers. The If-Match header was used to pass the latest eTag value. Notice that the Response returned confirms that the unit price has been updated to $1,000.90*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.52.44-am-1836x1090.png)
*Notice that the Request body included the new unit price and that the Response eTag value was updated to ...JzE50zU5N..*

![](/assets/images/businesscentralmicrosoftgraph/screen-shot-2023-12-18-at-9.53.08-am-1836x1094.png)
*Executing the same PATCH request with the old eTag value results in an error.*

---

## businesscentralpart 27 extendingstandardapis

**Source file:** `businesscentralpart 27 extendingstandardapis.md`

---
title: "Business Central (Part 27) extending standard APIs"
description: "Extending standard APIs"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/businesscentralpart-27-extendingstandardapis/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "businesscentralpart 27 extendingstandardapis"
---

# Business Central (Part 27) extending standard APIs

## Extending standard APIs

![](/assets/images/businesscentralpart-27-extendingstandardapis/dynamics365-color.svg)
*By Microsoft, Public Domain*


## Extending standard APIshttps://www.kauffmann.nl/2021/04/16/extending-standard-apis-2/

.

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-27-extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

---

## businesscentralpart 2extendingstandardapis

**Source file:** `businesscentralpart 2extendingstandardapis.md`

---
title: "Business Central (Part 26) extending standard APIs"
description: "Extending standard APIs"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/businesscentralpart-2extendingstandardapis/hero.png"
tags: ["ai","business central","dynamics"]
slug: "businesscentralpart 2extendingstandardapis"
hidden: true
---


![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart-2extendingstandardapis/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

---

## businesscentralpart25integratingwithdataverseusingdataflows

**Source file:** `businesscentralpart25integratingwithdataverseusingdataflows.md`

---
title: "Business Central (Part 25) Integrating with Dataverse using Dataflows"
description: "Integrating with Dataverse using Dataflows"
date: "2024-12-01"
categories: ["Power Platform","Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "businesscentralpart25integratingwithdataverseusingdataflows"
image: "/assets/images/posts-meta.svg"
---


![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-2.44.28pm-1836x555.png)
*I created a new Business Central Company*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-2.48.13pm-1836x955.png)
*I named the Company Integration*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-2.49.24pm-1836x644.png)
*I clicked Next*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-3.39.53pm-1836x805.png)
*I reset my Develop Power Platform Environment*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.26.29pm-1836x947.png)
*I created a new Power Apps Solution*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.47.24pm-1836x540.png)
*An empty solution was created*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.23.44pm-1836x953.png)
*I navigated to the Integration Company and clicked the Set up a connection to Dataverse link*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.23.56pm-1836x949.png)
*I clicked the Next button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.24.05pm-1836x949.png)
*I clicked the Next button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.24.17pm-1836x953.png)
*I selected the (reset) Develop Dataverse environment*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.24.40pm-1836x950.png)
*I clicked the Next button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.28.01pm-1836x951.png)
*I clicked the Next button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.28.33pm-1836x951.png)
*I clicked the Install Business Central Virtual Table app link*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.28.44pm-1836x929.png)
*I clicked the Get it now button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.29.22pm-1836x944.png)
*I selected the Develop Dataverse environment*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.34.21pm-1836x490.png)
*The installation completed*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.35.10pm-1836x945.png)
*I clicked the Finish button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.43.59pm-1836x634.png)
*I clicked the Sync All button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.44.30pm-1836x546.png)
*I reviewed the records in the Business Central Contacts table*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.45.27pm-1836x947.png)
*I reviewed the records in the Business Central Contacts table*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.48.40pm-1836x950.png)
*I reviewed the records in the Dataverse Contacts table*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.49.23pm-1836x679.png)
*I reviewed the records in the Business Central Customers Table*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-4.56.06pm-1836x948.png)
*I reviewed the records in the Dataverse Accounts Table*


## Integrating with Dataverse using Dataflows

I added a **D365BC Employee** table to Dataverse. I set up a Dataflow to copy Employee records from Business Central to Dataverse.

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.04.02pm-1836x669.png)
*I created a new table*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.04.35pm-1836x943.png)
*I named the table D365BC Employee*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.04.58pm-1836x942.png)
*I reviewed the Primary column*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.06.50pm-1836x959.png)
*I added a First Name column*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.07.17pm-1836x952.png)
*I added a Last Name column*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.08.15pm-1836x947.png)
*I added a Phone Number column*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.08.44pm-1836x949.png)
*I added a Job Title column*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.09.55pm-1836x948.png)
*I added a Key (this will be used to sync the employee data)*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.10.12pm-1836x421.png)
*The Key was added*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.13.57pm-1836x532.png)
*I clicked the Import data button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.15.51pm-1836x947.png)
*I selected the OData connector*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.16.48pm-1836x448.png)
*I navigated to the web services page in Business Central*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.17.39pm-1836x613.png)
*I was unable to find an employee web service*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.19.28pm-1836x457.png)
*I clicked the + New button and provided web service details*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.20.36pm-1836x558.png)
*I copied the OData V4 URL*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.48.34pm-1836x893.png)
*I entered the url into the Connect to data source dialog. Notice that I removed the https:// prefix when I copied the url to the connection textbox*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.49.42pm-1836x952.png)
*A preview was provided. I clicked the Next button.*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.51.03pm-1836x948.png)
*I selected the Load to existing table option and clicked the Next button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.51.32pm-1836x907.png)
*Three of the field mappings were created automatically*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.53.24pm-1836x897.png)
*I completed the last two field mappings. I clicked the Next button*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-5.54.20pm-1836x925.png)
*I set the refresh schedule*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-6.02.59pm-1836x949.png)
*I reviewed the D365BC Employee table records*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-6.03.56pm-1836x948.png)
*I added the Dataflow to the solution*

![](/assets/images/businesscentralpart25integratingwithdataverseusingdataflows/screenshot-2024-12-02-at-6.04.48pm-1836x530.png)
*The Dataflow has been added to the solution*

---

## businesscentralpart26integratingwithdataverseusingintegrationtables

**Source file:** `businesscentralpart26integratingwithdataverseusingintegrationtables.md`

---
title: "Business Central (Part 26) Integrating with Dataverse using Integration Tables"
description: "Integration Tables"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "businesscentralpart26integratingwithdataverseusingintegrationtables"
---



![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integratingwithdataverseusingintegrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

---

## businesscentralpart26integrationtable

**Source file:** `businesscentralpart26integrationtable.md`

---
title: "Business Central (Part 26)"
description: "Integration Tables"
date: "2024-12-22"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics","Power Platform"]
tags: []
slug: "businesscentralpart26integrationtable"
image: "/assets/images/posts-meta.svg"
---



In Dynamics 365 Business Central, an Integration Table is a specialized table used to facilitate the exchange of data between Business Central and external systems or services. These tables are often used in integration scenarios, such as connecting with Dynamics 365 Sales (CRM), Power Platform, or other third-party applications.

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-165830-1361x723.png)
*I clicked the Create AL Project button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-165901-1366x126.png)
*I updated the project name*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-165953-1366x99.png)
*I entered DataverseIntegration*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-170040-1366x201.png)
*I selected the most recent platform*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-170247-591x115.png)
*I selected the Microsoft cloud sandbox option*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-170326-1366x730.png)
*I clicked the Copy & Open button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-170355-1366x694.png)
*I pasted the code*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-170548-1361x728.png)
*I selected Al: Download symbols*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-170645-1366x724.png)
*Symbols were downloaded*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-170906-1366x559.png)
*Initially the Develop Power Platform Environment was configured to access the Production Business Central Environment*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-172259-1366x464.png)
*The Business Central AL project was configured to deploy to the Sandbox environment*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-172414-1366x526.png)
*I clicked the Start Debugging menu option*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-172524-1366x413.png)
*The AL code paused when the line 13 breakpoint was hit*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-172604-1366x469.png)
*I clicked continue and the message was displayed*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-172651-1366x726.png)
*I deleted the HelloWorld.al file*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-174957-1366x657.png)
*I navigated to the Azure portal to copy the Application (Client) Id*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-175103-1354x226.png)
*I navigated to an app running the Power Platform to copy the https://XXX.crm.dynamics.com url*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-180333-1366x726.png)
*I ran the The AL Table Proxy Generator tool (altpgen.exe) to generate 6 files. AccountExt.al, ContactExt.al, Customer Order Line.al, Customer Order.al, TeamExt.al and UserExt.alI updated the object number in the generated AccountExt.al, Customer Order.al, TeamExt.al and UserExt.al files*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-180933-1363x726.png)
*I ran the New AL File Wizard*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-180956-1366x339.png)
*I selected the Page option*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-181135-1366x602.png)
*I entered list page details. I clicked the Next button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-181412-1366x613.png)
*I selected 5 fields*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-181456-1366x612.png)
*I deployed the AL code*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-181722-1366x227.png)
*I clicked the magnifying glass menu item and entered Customer Orders*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-181759-1366x564.png)
*An error was generatedTable connection for table type CRM must be registered using RegisterTableConnection or cmdlet New-NAVTableConnection before it can be used.*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182056-1366x491.png)
*I added an OnInit() trigger*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182157-1366x509.png)
*I navigated to the Customer Orders page again and received an error*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182227-1366x649.png)
*I ran the Dataverse Connection Setup wizard*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182259-1366x647.png)
*I accepted the conditions and clicked the Next button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182321-1366x602.png)
*I selected the Develop Power Platform Environment*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182401-1366x637.png)
*I clicked the Next button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182608-1366x642.png)
*I clicked the Next button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182705-1366x652.png)
*I clicked the Next button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182732-1366x651.png)
*I clicked the Finish button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182803-1366x653.png)
*I clicked the Yes button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182923-1366x576.png)
*I clicked the magnifying glass menu item and entered Customer Orders*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-182957-1366x621.png)
*I received an error message. Business Central was unable to access the Dataverse Customer Orders table*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183232-1366x654.png)
*I reviewed the roles that the Business Central Integration Business Central t... application user had been assigned to*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183318-1365x658.png)
*I updated the Business Central Dataverse Integration role*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183407-1366x633.png)
*I selected the Customer Order table*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183438-1366x650.png)
*I clicked the Permission Settings option*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183504-1366x650.png)
*I selected Full Access and clicked the Save button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183538-1366x654.png)
*I selected the Customer Order Line table and clicked the Permission Settings option*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183603-1366x652.png)
*I selected Full Access and clicked the Save button*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183625-1366x183.png)
*Any member of this role will now be able to access the Customer Order and Customer Order Line tables*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-183658-1366x589.png)
*I selected the Customer Orders page*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-184013-1358x653.png)
*The Dataverse Customer Orders were displayed*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-184427-1366x419.png)
*I ran the New AL File Wizard again*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-184448-1366x280.png)
*I selected the Table Extension option*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-184610-1365x599.png)
*I wanted to create a Customer Order Extension*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-185026-1366x459.png)
*I added a flow field to the generated Customer Order Integration table using the Customer Order Extension file*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-185128-1366x601.png)
*I updated the Customer Orders page to display the Account Name flow field rather than the GUID value*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-185408-1365x359.png)
*The Account column displayed the Account name*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-185506-1366x710.png)
*I updated the Customer Orders page to disable Insert, Modify and Delete and to enable RefreshOnActivate*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-190034-1365x462.png)
*I ran the New AL File Wizard*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-190151-1366x695.png)
*I ran the New AL File Wizard to create a Card page*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-190323-1363x698.png)
*I selected the fields I wanted to display*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-190746-1366x720.png)
*I added an OnDrillDown() trigger to the Customer Order's Name field*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-190849-1362x427.png)
*I clicked on a Customer Order*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-190913-1357x506.png)
*The Customer Order Card was displayed*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-191102-1366x476.png)
*I added a DataCaptionFields value to the Customer Order (Extension)*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-191202-1361x453.png)
*I reviewed the updated Card page*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-234528-1366x616.png)
*I added entity dyn365bc_Item_v2_0. I need to add this entity to ensure that the hadd_Item field is added to the generated Customer Order Lines Integration table.*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-234634-1366x726.png)
*I updated the object number*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-234826-1366x595.png)
*I added a Customer Order Lines ListPart*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-234952-1366x589.png)
*I added Name, Item (GUID) and Quantity fields to the ListPart*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-235233-1366x728.png)
*Notice that hadd_Item is a GUID*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-235644-1366x591.png)
*I added the ListPart to the Customer Order Card*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-22-235839-1366x691.png)
*The Customer Order Line details are displayed*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-23-063651-1366x727.png)
*I updated the Customer Order Lines ListPart to lookup Item details. I was able to use the hadd_Item GUID to lookup records in the Business Central Item table.*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-23-064849-1366x728.png)
*Item details and a calculated Amount value are displayed*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-23-115408-1366x726.png)
*I added a GetTotalAmount() procedure*

![](/assets/images/businesscentralpart26integrationtable/screenshot-2024-12-23-115803-1364x664.png)
*The Total Amount field was displayed on the Customer Order Card*


```text
page 50100 "Customer Orders"
{
    ApplicationArea = All;
    Caption = 'Customer Orders';
    PageType = List;
    SourceTable = "CDS hadd_CustomerOrder";
    UsageCategory = Lists;

    InsertAllowed = false;
    ModifyAllowed = false;
    DeleteAllowed = false;

    RefreshOnActivate = true;

    layout
    {
        area(Content)
        {
            repeater(General)
            {
                field(hadd_Name; Rec.hadd_Name)
                {
                    ToolTip = 'Specifies the value of the Name field.', Comment = '%';

                    trigger OnDrillDown()
                    var
                        CustomerOrderPage: Page "Customer Order";
                        CustomerOrder: Record "CDS hadd_CustomerOrder";
                    begin
                        if CustomerOrder.Get(Rec.hadd_CustomerOrderId) then begin
                            CustomerOrder.SystemId := Rec.hadd_CustomerOrderId;
                            CustomerOrderPage.SetRecord(CustomerOrder);
                            CustomerOrderPage.Run();
                        end;
                    end;
                }
                field("Account Name"; Rec."Account Name")
                {
                    ToolTip = 'Specifies the value of the Account field.', Comment = '%';
                }
                field(hadd_RequestedDeliveryDate; Rec.hadd_RequestedDeliveryDate)
                {
                    ToolTip = 'Specifies the value of the Requested Delivery Date field.', Comment = '%';
                }
                field(statecode; Rec.statecode)
                {
                    ToolTip = 'Specifies the value of the Status field.', Comment = '%';
                }
                field(statuscode; Rec.statuscode)
                {
                    ToolTip = 'Specifies the value of the Status Reason field.', Comment = '%';
                }
            }
        }
    }

    trigger OnInit()
    begin
        Codeunit.Run(Codeunit::"CRM Integration Management");
    end;

}
```

## Tab-Ext50105.CustomerOrderExt.al

```text
tableextension 50105 "Customer Order Ext" extends "CDS hadd_CustomerOrder"
{
    DataCaptionFields = hadd_Name, "Account Name";

    fields
    {
        field(50100; "Account Name"; Text[160])
        {
            Caption = 'Account';
            FieldClass = FlowField;
            CalcFormula = lookup("CRM Account".Name where(AccountId = field(hadd_Account)));
        }
    }
}
```

## Pag50102.CustomerOrderLines.al

```text
page 50102 "Customer Order Lines"
{
    ApplicationArea = All;
    Caption = 'Customer Order Lines';
    PageType = ListPart;
    SourceTable = "CDS hadd_CustomerOrderLine";

    layout
    {
        area(Content)
        {
            repeater(General)
            {
                field(hadd_Name; Rec.hadd_Name)
                {
                    ToolTip = 'Specifies the value of the Name field.', Comment = '%';
                }
                /*field(hadd_Item; Rec.hadd_Item)
                {
                    ToolTip = 'Specifies the value of the Item field.', Comment = '%';
                }*/
                field(ItemNo; GetItemNo()) //Rec.wiise_ItemNo)
                {
                    Caption = 'No.';
                }
                field(ItemDescription; GetItemDescription())
                {
                    Caption = 'Description';
                }
                field(ItemCategoryCode; GetItemCategoryCode()) //Rec.wiise_ItemCategoryCode)
                {
                    Caption = 'Category';
                }
                field("Unit Price"; GetUnitPrice())
                {
                    Caption = 'Unit Price';
                }
                field(hadd_Quantity; Rec.hadd_Quantity)
                {
                    ToolTip = 'Specifies the value of the Quantity field.', Comment = '%';
                }
                field("Unit of Measure"; GetUnitOfMeasure())
                {
                    Caption = 'Unit of Measure';
                }

                field("Amount"; GetAmount())
                {

                }
            }
        }
    }

    local procedure GetItemDescription(): Text[100]
    var
        Item: Record Item;
    begin
        if Item.GetBySystemId(Rec.hadd_Item) then
            exit(Item.Description)
        else
            exit('')
    end;

    local procedure GetItemNo(): Text[20]
    var
        Item: Record Item;
    begin
        if Item.GetBySystemId(Rec.hadd_Item) then
            exit(Item."No.")
        else
            exit('')
    end;

    local procedure GetItemCategoryCode(): Code[20]
    var
        Item: Record Item;
    begin
        if Item.GetBySystemId(Rec.hadd_Item) then
            exit(Item."Item Category Code")
        else
            exit('')
    end;

    local procedure GetUnitPrice(): Decimal
    var
        Item: Record Item;
    begin
        if Item.GetBySystemId(Rec.hadd_Item) then
            exit(Item."Unit Price")
        else
            Error('Price not found');
    end;

    local procedure GetUnitOfMeasure(): Text[50]
    var
        Item: Record Item;
        Unit: Record "Unit of Measure";
    begin
        if Item.GetBySystemId(Rec.hadd_Item) then begin
            if Unit.GetBySystemId(Item."Unit of Measure Id") then
                exit(Unit.Description)
            else
                exit('')
        end;
        exit('');
    end;

    local procedure GetAmount(): Decimal
    var
        Item: Record Item;
    begin
        if Item.GetBySystemId(Rec.hadd_Item) then
            exit(Item."Unit Price" * Rec.hadd_Quantity)
        else
            Error('Price not found');
    end;

}
```

## Pag50101.CustomerOrder.al

```text
page 50101 "Customer Order"
{
    ApplicationArea = All;
    Caption = 'Customer Order';
    PageType = Card;
    SourceTable = "CDS hadd_CustomerOrder";

    layout
    {
        area(Content)
        {
            group(General)
            {
                Caption = 'General';

                field(hadd_Name; Rec.hadd_Name)
                {
                    ToolTip = 'Specifies the value of the Name field.', Comment = '%';
                }
                field("Account Name"; Rec."Account Name")
                {
                    ToolTip = 'Specifies the value of the Account field.', Comment = '%';
                }
                field(hadd_RequestedDeliveryDate; Rec.hadd_RequestedDeliveryDate)
                {
                    ToolTip = 'Specifies the value of the Requested Delivery Date field.', Comment = '%';
                }
                field(statecode; Rec.statecode)
                {
                    ToolTip = 'Specifies the value of the Status field.', Comment = '%';
                }
                field(statuscode; Rec.statuscode)
                {
                    ToolTip = 'Specifies the value of the Status Reason field.', Comment = '%';
                }

                field("Total Amount"; GetTotalAmount())
                {

                }
            }

            part("Customer Order Lines"; "Customer Order Lines")
            {
                SubPageLink = "hadd_Order" = FIELD("hadd_CustomerOrderId");
            }

        }
    }


    local procedure GetTotalAmount(): Decimal
    var
        Item: Record Item;
        OrderLine: Record "CDS hadd_CustomerOrderLine";
        TotalAmount: Decimal;
    begin
        TotalAmount := 0;

        OrderLine.SetRange(OrderLine.hadd_Order, Rec."hadd_CustomerOrderId");

        if OrderLine.FindSet() then
            repeat
                if Item.GetBySystemId(OrderLine.hadd_Item) then
                    TotalAmount += Item."Unit Price" * OrderLine.hadd_Quantity;
            until OrderLine.Next() = 0;

        exit(TotalAmount);
    end;


    trigger OnInit()
    begin
        Codeunit.Run(Codeunit::"CRM Integration Management");
    end;

}
```

---

## businesscentralpart26integrationtables

**Source file:** `businesscentralpart26integrationtables.md`

---
title: "Business Central (Part 26)"
description: "Integration Tables"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/businesscentralpart26integrationtables/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "businesscentralpart26integrationtables"
---

## AL Table Proxy Generator

The AL Table Proxy Generator tool can be used to generate one or more tables for integration with Microsoft Dataverse. When one or more tables are present in Microsoft Dataverse, but not in Dynamics 365 Business Central, the tool can be run to generate integration or proxy tables for the specified table or tables.

An integration or proxy table is a table that represents a table in Microsoft Dataverse. The integration table includes fields that correspond to columns in the Microsoft Dataverse table. The integration table acts as a link or connector between the Business Central table and the Microsoft Dataverse table.

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*


## Lab Book

I created a new table in Dataverse


## altpgen.exe

You can use content blocks to arrange your articles, large texts, instructions. Combine these blocks with media blocks to add illustrations and video tutorials. You can use various content blocks to work with your text. Add quotations, lists, buttons. Select your text to change its formatting or add links. Mobirise is a simple website builder that helps you create amazing web pages without knowing any code.

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/businesscentralpart26integrationtables/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

---

## businesscentralpowerautomateflow

**Source file:** `businesscentralpowerautomateflow.md`

---
title: "Business Central Power Automate Flow"
description: "Business Central includes a Microsoft Power Automate license"
date: "2024-01-02"
categories: ["Microsoft Dynamics","Business Central","Power Platform","Microsoft Dynamics"]
tags: []
slug: "businesscentralpowerautomateflow"
image: "/assets/images/posts-meta.svg"
---




Power Automate flows are triggered when Business Central records are created, modified, or deleted. Flows can also be run on a user-defined schedule or on demand.

A Power Automate flow should at least contain one trigger and one action.

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.30.00-pm-1836x1132.png)
*I created a new Instant Cloud Flow*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.30.31-pm-1836x1128.png)
*I did not provide a flow name. I clicked the Skip button*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.30.57-pm-1836x1128.png)
*I entered "Business Central" into the search box and then clicked on the Dynamics 365 Business Central logo*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.31.16-pm-1836x1129.png)
*I selected the "When a record is created" Trigger.*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.31.33-pm-1836x988.png)
*I selected the PRODUCTION environment*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.31.46-pm-1836x872.png)
*I selected the Evaluation company*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.32.00-pm-1836x1130.png)
*I selected API Category "v2.0"*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.32.16-pm-1836x1134.png)
*I selected the vendors table (entity)*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.32.29-pm-1836x907.png)
*I clicked the + New step button*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.32.47-pm-1836x1132.png)
*I entered outlook into the search box. I selected the Outlook.com logo*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.32.59-pm-1836x1136.png)
*I selected the "Send an email (v2)" Action*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.33.29-pm-1836x1136.png)
*I entered neil@haddley.com into the To field*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.34.19-pm-1836x1132.png)
*I entered "New Vendor with Id {"Row Id"}" into the Subject field*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.34.38-pm-1836x1127.png)
*I added {"body"} into the Body field*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.35.09-pm-1836x774.png)
*I reviewed the new flow*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.35.22-pm-1836x1133.png)
*Notice that the 28-day run history was empty*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.35.34-pm-1836x674.png)
*I navigated to Vendors page in the Business Central web site. I clicked the + New button*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.35.43-pm-1836x1015.png)
*I selected the VENDOR COMPANY option and clicked OK*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.35.55-pm-1836x1133.png)
*I reviewed the newly saved Vendor record*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.37.02-pm-1836x1133.png)
*I reviewed the Sent folder in the Outlook.com web site*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.37.36-pm-1836x1137.png)
*I did not enter any Vendor details. I did not navigate away from the new Vendor page.*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.37.45-pm-1836x1133.png)
*I reviewed the flow details and noticed that the 28-day run history was updated. I clicked on the history item*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.37.59-pm-1836x1125.png)
*I reviewed the flow instance*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.40.34-pm-1836x1132.png)
*I reviewed the sent email details*

![](/assets/images/businesscentralpowerautomateflow/screen-shot-2024-01-03-at-12.40.54-pm-1836x1131.png)
*I navigated to Outlook.com and reviewed the sent email*

---

## businesscentralvirtualtable

**Source file:** `businesscentralvirtualtable.md`

---
title: "Business Central Virtual Table"
description: "Microsoft Dynamics 365 Business Central Virtual Tables for Microsoft Dataverse"
date: "2024-01-12"
categories: ["Microsoft Dynamics","Business Central","Power Platform","Microsoft Dynamics"]
tags: []
slug: "businesscentralvirtualtable"
image: "/assets/images/posts-meta.svg"
---



Microsoft Dynamics 365 Business Central Virtual Table is a virtual data source in Microsoft Dataverse allowing Create, Read, Update and Delete operations from Microsoft Dataverse against Dynamics 365 Business Central. Data for virtual tables do not reside in Microsoft Dataverse, but continue to reside in Business Central. 

Virtual tables are enabled for Business Central APIs, by making them available in Microsoft Dataverse as virtual tables. Custom and Standard APIs exposed in Business Central are consumable on Microsoft Dataverse and can be exposed as virtual tables. 

The new version adds support for data change events (CUD events) so Dataverse virtual tables can be used in Power Automate flows.

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.37.31-pm-1836x1251.png)
*I added the "Business Central Virtual Table" app*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.37.44-pm-1836x1013.png)
*I enabled the "Dynamics 365 Business Central for Virtual Tables" Microsoft Entra app.*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.41.38-pm-1836x915.png)
*I played the Business Central Configuration app*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-2.21.01-pm-1836x708.png)
*I added a Data Source Configuration*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.41.55-pm-1836x918.png)
*I reviewed the Available Tables*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.42.25-pm-1836x915.png)
*I clicked the vendor table*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.42.37-pm-1836x919.png)
*I updated the Visible field to Yes*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.43.02-pm-1836x918.png)
*I saved the vendor table update*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.44.35-pm-1836x918.png)
*I updated the customer table Visible field to Yes*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.46.30-pm-1836x918.png)
*I created a Business Central Solution*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.48.35-pm-1836x671.png)
*I added a Model-driven app to the solution*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.48.59-pm-1836x918.png)
*I named the model-driven app "Customers and Vendors"*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.49.17-pm-1836x918.png)
*I clicked the + Add page button*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.49.27-pm-1836x919.png)
*I clicked the Next button*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.49.57-pm-1836x926.png)
*I selected the Business Central Customer table*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.50.15-pm-1836x915.png)
*I clicked the Pages + New button*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.50.27-pm-1836x921.png)
*I clicked the Next button*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.50.47-pm-1836x921.png)
*I selected the Business Central Vendor table*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.51.43-pm-1836x918.png)
*I clicked the Save icon*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.52.33-pm-1836x529.png)
*I navigated back to the Solution and clicked the Publish all customizations button*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.52.44-pm-1836x547.png)
*I published the solution*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.53.24-pm-1836x585.png)
*I navigated back to the Power Apps home page*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.53.38-pm-1836x913.png)
*I selected the Apps menu item and clicked the Play button*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.54.29-pm-1836x975.png)
*The model driven app allowed me to view the Business Central Customers*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.54.39-pm-1836x982.png)
*The model driven app allowed me to view the Business Central Vendors*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.54.55-pm-1836x922.png)
*I clicked on an individual Customer*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.55.10-pm-1836x532.png)
*I updated the value of the Blocked field*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.56.08-pm-1836x566.png)
*I clicked + New and added a new Customer*

![](/assets/images/businesscentralvirtualtable/screen-shot-2024-01-12-at-1.56.38-pm-1836x918.png)
*I navigated to the Business Central Customers page*

---

## cloudflow

**Source file:** `cloudflow.md`

---
title: "Cloud Flow"
description: "A Topic that uses the Business Central Connector"
date: "2024-02-26"
categories: ["Power Platform","Microsoft Dynamics","Business Central","Azure"]
tags: []
slug: "cloudflow"
image: "/assets/images/office-365-icon-500x500.png"
---




I created a Topic that used the Business Central Connector to retrieve the list of "Evaluation" Company Customers. I used a Cloud Flow to workaround an issue.

![](/assets/images/cloudflow/screenshot-2024-02-26-at-11.41.15-am-1836x1146.png)
*There were six customers setup in the "Evaluation" Company*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.07.19-am-1836x949.png)
*I clicked the + Create|Topic|From blank menu item*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.08.17-am-1836x332.png)
*I named the Topic "Customers"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.08.53-am-1836x865.png)
*I added the phrases "list customers" and "customer list"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.09.15-am-1836x951.png)
*I selected the Call an action|Basic actions|Create a flow menu item*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.10.02-am-1836x198.png)
*I renamed the flow "Customer Flow"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.10.43-am-1836x360.png)
*I clicked the "Add an action" button*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.11.19-am-1836x722.png)
*I searched for "Business Central" actions*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.13.23-am-1836x873.png)
*I selected Environment "PRODUCTION"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.13.34-am-1836x857.png)
*I selected Company "Evalutation"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.13.48-am-1836x1043.png)
*I selected API Category "v2.0"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.14.25-am-1836x858.png)
*I selected table name "customers"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.15.01-am-1836x400.png)
*I added an output*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.15.10-am-1836x502.png)
*I selected "Text"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.23.44-am-1836x436.png)
*I clicked the fx button*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.23.56-am-1836x998.png)
*I selected the string() function*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.24.11-am-1836x990.png)
*I clicked the Dynamic content tab*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.24.21-am-1836x984.png)
*I selected "body/value"*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.24.31-am-1836x766.png)
*I clicked save and returned to the Topic*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.25.35-am-1836x1020.png)
*I added a message to display the output of the cloud flow*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.26.07-am-1836x1040.png)
*I copied part of the JSON*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.26.24-am-1836x1040.png)
*I clicked the Variable management|Parse value menu item*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.26.44-am-1836x1040.png)
*I selected the output of the Cloud Flow*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.26.58-am-1836x1042.png)
*I selected the "From sample data" option*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.27.12-am-1836x1029.png)
*I clicked the Get schema from sample JSON link*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.40.17-am-1836x1039.png)
*I pasted in the JSON I had copied earlier (updating the double quote characters).*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.40.31-am-1836x1037.png)
*I clicked the Edit schema link to review the result*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.40.49-am-1836x1040.png)
*I created a new Variable to save the result (a table)*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.41.04-am-1836x1040.png)
*I reviewed the Parse value action*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.41.51-am-1836x1037.png)
*I created a new Message.*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.42.06-am-1836x1040.png)
*I set the output to Concat(Topic.Var1,displayName,", ")*

![](/assets/images/cloudflow/screenshot-2024-02-26-at-9.43.07-am-1836x1038.png)
*I removed the original Message and tested the Topic by entering the phrase "list customers". The copilot provided the response I was hoping for.*

---

## codespacesauthentication

**Source file:** `codespacesauthentication.md`

---
title: "Codespaces and Authentication"
description: "Adding a NavBar and staticwebapp.config.json"
date: "2024-03-06"
categories: ["React","Azure","DevOps"]
tags: []
slug: "codespacesauthentication"
image: "/assets/images/logo512-512x512.png"
---



I used GitHub Codespaces to create a React app, I published the React App using Azure Static Web Sites and GitHub Actions. I used a staticwebapp.config.json file to enable user login and Authentication.

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.28.25-am-1836x627.png)
*I navigated to GitHub and clicked on the Codespaces link*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.28.54-am-1836x1057.png)
*I clicked on the React|Use this template button*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.30.00-am-1836x1126.png)
*Codespaces opened and "npm start" was executed*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.30.39-am-1836x1119.png)
*I ran "npm run build" (noticing that generated files were saved to the /build folder).*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.32.02-am-1836x1052.png)
*I published the react project as a new GitHub repository*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.32.28-am-1836x1123.png)
*The repository was named Haddley/codespaces-react*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.34.16-am-1836x989.png)
*I navigated to https://portal.azure.com*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.34.38-am-1836x497.png)
*I clicked on the "Static Web Apps" link*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.34.55-am-1836x985.png)
*I clicked the + Create link*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.36.33-am-1836x988.png)
*I created a new resource group*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.36.54-am-1836x988.png)
*I selected the free plan (for hobby and personal projects). I left the Source as GitHub (the default)*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.37.38-am-1836x983.png)
*I selected the codespaces-react repository. I selected the React project presets (with output location "build")*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.38.06-am-1836x1051.png)
*I clicked the Create button*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.38.49-am-1836x686.png)
*I navigated to the web site https://gentle-field-0fe462e10.5.azurestaticapps.net*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.39.02-am-1836x1120.png)
*A placeholder page was displayed*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.39.49-am-1836x803.png)
*I navigated to the GitHub repository*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.39.59-am-1836x909.png)
*I clicked on the Actions tab*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.40.25-am-1836x1124.png)
*An automatic build was already running*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.40.45-am-1836x889.png)
*I navigated to the codespace and selected the "Stop codespace" option*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.41.11-am-1836x815.png)
*The automatic build was successful*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.41.27-am-1836x1124.png)
*The React application was deployed to Azure*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.42.49-am-1836x407.png)
*I navigated to the Static Web Application's Azure Active Directory login page https://gentle-field-0fe462e10.5.azurestaticapps.net/.auth/login/aad*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.43.06-am-1836x1120.png)
*I logged in using my Azure Active Directory credentials*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.44.49-am-1836x1124.png)
*I clicked the Accept button*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.45.05-am-1836x1120.png)
*I clicked the Grant Consent button*

![](/assets/images/codespacesauthentication/screenshot-2024-03-06-at-10.45.16-am-1836x1117.png)
*I was returned to the React app home page*


I added React Router a NavBar and a staticwebapp.config.json file.

![](/assets/images/codespacesauthentication/screenshot-2024-03-07-at-6.00.12-pm-1836x1000.png)
*Updated project folder structure*

![](/assets/images/codespacesauthentication/screenshot-2024-03-07-at-6.08.42-pm-2136x1105.png)
*Home page*

![](/assets/images/codespacesauthentication/screenshot-2024-03-07-at-6.08.55-pm-2136x1104.png)
*About page*

![](/assets/images/codespacesauthentication/screenshot-2024-03-07-at-6.09.25-pm-2136x1107.png)
*Secret page*


## staticwebapp.config.json

```text
{
    "navigationFallback": {
        "rewrite": "/index.html",
        "exclude": [
            "/images/*.{png,jpg,gif}",
            "/css/*"
        ]
    },
    "routes": [
        {
            "route": "/secret*",
            "allowedRoles": [
                "authenticated"
            ]
        }
    ],
    "responseOverrides": {
        "401": {
            "statusCode": 302,
            "redirect": "/.auth/login/aad"
        }
    }
}
```

## updated JavaScript

```text
App.js

import Navbar from "./Navbar"
import Home from "./pages/Home"
import About from "./pages/About"
import Secret from "./pages/Secret"
import { Route, Routes } from "react-router-dom"
import { useEffect } from "react"
import { useState } from "react"

function App() {

  const [clientPrincipal, setClientPrincipal] = useState(null);

  useEffect(() => {
    // declare the async data fetching function
    const fetchData = async () => {
      // get the data from the api
      const response = await fetch('/.auth/me');
      const payload = await response.json();
      const { clientPrincipal } = payload;

      // set state with the result
      setClientPrincipal(clientPrincipal);

      console.log(clientPrincipal);

      return clientPrincipal;
    }

    // call the function
    fetchData()
      // make sure to catch any error
      .catch(console.error);;

  }, [])


  return (
    <>
      <Navbar clientPrincipal={clientPrincipal} />
      <div className="container">
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/about" element={<About />} />
          <Route path="/secret" element={<Secret />} />
        </Routes>
      </div>
    </>
  )
}

export default App

App.css

* {
  box-sizing: border-box;
}

body {
  margin: 0;
}

.container {
  margin: 1rem;
  text-align: center;
}

.nav {
  background-color: #333;
  color: white;
  display: flex;
  justify-content: space-between;
  align-items: stretch;
  gap: 2rem;
  padding: 0 1rem;
}

.site-title {
  font-size: 2rem;
}

.nav ul {
  padding: 0;
  margin: 0;
  list-style: none;
  display: flex;
  gap: 1rem;
}

.nav a {
  color: inherit;
  text-decoration: none;
  height: 100%;
  display: flex;
  align-items: center;
  padding: .25rem;
}

.nav li.active {
  background-color: #555;
}

.nav li:hover {
  background-color: #777;
}

Navbar.js

import { Link, useMatch, useResolvedPath } from "react-router-dom"

export default function Navbar({ clientPrincipal }) {
  return (
    <nav className="nav">
      <Link to="/" className="site-title">
        Site Name
      </Link>
      <ul>
        <CustomLink to="/about">About</CustomLink>
        <a href="/secret">Secret</a>
        {!clientPrincipal ? (<a href="/.auth/login/aad">Login</a>) : (<a href="/.auth/logout">{clientPrincipal.userDetails} Logout</a>)}
      </ul>
    </nav>
  )
}

function CustomLink({ to, children, ...props }) {
  const resolvedPath = useResolvedPath(to)
  const isActive = useMatch({ path: resolvedPath.pathname, end: true })

  return (
    <li className={isActive ? "active" : ""}>
      <Link to={to} {...props}>
        {children}
      </Link>
    </li>
  )
}

About.js

export default function About() {
    return <h1>About</h1>
  }
  
Home.js

export default function Home() {
    return <h1>Home</h1>
  }
  
Secret.js

export default function Secret() {
    return <h1>Secret</h1>
  }
  
index.js

import React from "react"
import ReactDOM from "react-dom/client"
import App from "./App"
import "./App.css"
import { BrowserRouter } from "react-router-dom"

const root = ReactDOM.createRoot(document.getElementById("root"))
root.render(
  <React.StrictMode>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </React.StrictMode>
)
```

---

## colorization

**Source file:** `colorization.md`

---
title: "Colorization"
description: "colorization.ipynb"
date: "2023-08-03"
categories: ["Python","AI"]
tags: []
slug: "colorization"
image: "/assets/images/jupyter.svg"
---



I used the instructions from this ["Black and white image colorization with OpenCV and Deep Learning"](https://www.geeksforgeeks.org/black-and-white-image-colorization-with-opencv-and-deep-learning/) post to add color to a black and white image

![](/assets/images/colorization/364196815-152009791251390-5668419463329752519-n-1836x1153.png)
*Color image generated from a black and white photograph*


```text
!pip install opencv-python
!pip install Pillow

import numpy as np
import cv2
from cv2 import dnn
from PIL import Image

#--------Model file paths--------#
proto_file = 'colorization_deploy_v2.prototxt'
model_file = 'colorization_release_v2.caffemodel'
hull_pts = 'pts_in_hull.npy'
img_path = 'img1.jpg'
#--------------#--------------#
 
#--------Reading the model params--------#
# net = dnn.readNetFromCaffe(proto_file,model_file)
net = dnn.readNetFromCaffe(proto_file,model_file)

dnn.readNetFromCaffe

kernel = np.load(hull_pts)
#-----------------------------------#---------------------#


#-----Reading and preprocessing image--------#
img = cv2.imread(img_path)
scaled = img.astype("float32") / 255.0
lab_img = cv2.cvtColor(scaled, cv2.COLOR_BGR2LAB)
#-----------------------------------#---------------------#

# add the cluster centers as 1x1 convolutions to the model
class8 = net.getLayerId("class8_ab")
conv8 = net.getLayerId("conv8_313_rh")
pts = kernel.transpose().reshape(2, 313, 1, 1)
net.getLayer(class8).blobs = [pts.astype("float32")]
net.getLayer(conv8).blobs = [np.full([1, 313], 2.606, dtype="float32")]
#-----------------------------------#---------------------#

# we'll resize the image for the network
resized = cv2.resize(lab_img, (224, 224))
# split the L channel
L = cv2.split(resized)[0]
# mean subtraction
L -= 50
#-----------------------------------#---------------------#

# predicting the ab channels from the input L channel

net.setInput(cv2.dnn.blobFromImage(L))
ab_channel = net.forward()[0, :, :, :].transpose((1, 2, 0))
# resize the predicted 'ab' volume to the same dimensions as our
# input image
ab_channel = cv2.resize(ab_channel, (img.shape[1], img.shape[0]))


# Take the L channel from the image
L = cv2.split(lab_img)[0]
# Join the L channel with predicted ab channel
colorized = np.concatenate((L[:, :, np.newaxis], ab_channel), axis=2)

# Then convert the image from Lab to BGR
colorized = cv2.cvtColor(colorized, cv2.COLOR_LAB2BGR)
colorized = np.clip(colorized, 0, 1)

# change the image to 0-255 range and convert it from float32 to int
colorized = (255 * colorized).astype("uint8")

# Let's resize the images and show them together
img = cv2.resize(img,(640,640))
colorized = cv2.resize(colorized,(640,640))

result = cv2.hconcat([img,colorized])
cv2.imshow("Grayscale -> Colour", result)
cv2.waitKey(0)

color_coverted = cv2.cvtColor(colorized, cv2.COLOR_BGR2RGB)

img = Image.fromarray(color_coverted, 'RGB')
img.save('img1_converted.jpg')
img
```
## References

- [Black and white image colorization with OpenCV and Deep Learning](https://www.geeksforgeeks.org/black-and-white-image-colorization-with-opencv-and-deep-learning)

---

## componentframework

**Source file:** `componentframework.md`

---
title: "Component Framework"
description: "Component Framework"
date: "2022-08-14"
categories: ["Power Platform","JavaScript","React"]
tags: []
slug: "componentframework"
image: "/assets/images/office-365-icon-500x500.png"
---



Create code components for model-driven and canvas apps.

Developers can use Power Apps component framework to create, import, and add code [components](customcomponents.html) to model-driven and canvas apps. Certain APIs are not available.

![](/assets/images/componentframework/screen-shot-2022-08-17-at-10.08.36-pm-1536x758.png)
*Admin center*

![](/assets/images/componentframework/screen-shot-2022-08-17-at-10.09.25-pm-1536x648.png)
*p8lf environment*

![](/assets/images/componentframework/screen-shot-2022-08-17-at-10.11.44-pm-1536x651.png)
*Search*

![](/assets/images/componentframework/screen-shot-2022-08-17-at-10.12.15-pm-1536x649.png)
*Turn on Power Apps component framework*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-6.37.50-am-1536x754.png)
*Web API endpoint (use this URL below)*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-6.45.35-am-1536x786.png)
*Install Power Platform Tools Visual Studio Extension*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-6.46.03-am-1536x788.png)
*Power Platform Tools installed*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-6.54.01-am-1536x789.png)
*The framework was not found*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-7.07.37-am-1240x880.png)
*Install x64 version of the framework*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-7.08.30-am-1536x915.png)
*pac (help)*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-7.12.38-am-1388x210.png)
*pac pcf init --namespace haddley --name virtualcontrol --template field --framework react*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-7.16.01-am-1536x964.png)
*pac auth create –-url https://org6bf9e824.api.crm.dynamics.com(url value from Web API endpoint see above)*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-7.16.43-am-1536x237.png)
*Authentication successful*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-7.59.42-am-1536x933.png)
*npm run start(I had to run npm i -g webpack and npm link webpack first)*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-7.24.21-am-1536x651.png)
*Component running in test environment*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.02.05-am-1536x955.png)
*pac pcf push --publisher-prefix nlh*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.02.50-am-1536x449.png)
*Component has been pushed to Power Apps environment*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.03.10-am-1536x572.png)
*Contents of solution*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.06.25-am-1536x757.png)
*Create a test solution*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.06.59-am-1536x648.png)
*New model-drive app*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.07.34-am-1536x647.png)
*Name model driven app*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.08.06-am-1536x651.png)
*Add page*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.08.30-am-1536x716.png)
*Select Table based view and form*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.08.56-am-1536x717.png)
*Select "Account" entity/table*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.09.28-am-1536x716.png)
*Switch to classic*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.20.53-am-1536x715.png)
*Edit Information A form for this entity*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.24.28-am-1536x938.png)
*Add code component (use for Web, Mobile and Tablet displays)*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.24.42-am-1536x937.png)
*Default Single-line text control will never be used*

![](/assets/images/componentframework/screen-shot-2022-08-18-at-8.26.15-am-1536x713.png)
*New Account form using code control*

---

## configurecopilotsinglesignonforweb

**Source file:** `configurecopilotsinglesignonforweb.md`

---
title: "Configure Copilot single sign-on for Web"
description: "Publish|Configure channels"
date: "2024-03-16"
categories: ["Power Platform",".NET","Microsoft 365"]
tags: []
slug: "configurecopilotsinglesignonforweb"
image: "/assets/images/office-365-icon-500x500.png"
---


Microsoft Copilot Studio supports single sign-on (SSO). [SSO allows copilots on your website to sign customers in if they're already signed in to the page or app where the copilot is deployed](https://learn.microsoft.com/en-us/microsoft-copilot-studio/configure-sso?tabs=webApp).

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-12.56.22-pm-2136x1285.png)
*I created a new copilot*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-12.57.12-pm-2136x1279.png)
*I named the copilot "Blog Site Copilot"*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-12.57.27-pm-2136x1282.png)
*The copilot was setup*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-12.59.16-pm-2136x1202.png)
*"On Unknown Intent" the "Conversational boosting" Topic will generate an answer based on the contents of https://haddley.github.io (the Data source).*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-12.59.50-pm-2136x1200.png)
*To test the Copilot I asked the question "What is Docker?"*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-1.00.29-pm-2136x1126.png)
*I added a Message to display "System.Activity.Text"*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-1.01.39-pm-2136x1170.png)
*Now the text provided by the user is echoed back to them before the generated answer is displayed*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-1.02.46-pm-2136x1170.png)
*Restarting the session displays the message specified in the "Conversation Start" Topic*


I wanted to publish the Copilot on a custom website.

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-8.50.49-am-1032x573.png)
*I clicked the Publish|Go to Channels link*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-8.53.03-am-1032x572.png)
*"Because you chose Teams Authentication, only Teams channel is available. To use other channels, change your authentication settings. Go to authentication settings."*


## Settings|Security|Authentication

By default the Copilot was configured with Authentication "Only for Teams and Power Apps".

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-1.05.03-pm-2136x1167.png)
*I clicked on the Security menu item*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-1.05.17-pm-2136x1168.png)
*I clicked on the Authentication tile*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-1.08.38-pm-1258x178.png)
*The "Only for Teams and Power Apps" authentication option is selected (by default).*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-13-at-1.06.56-pm-2090x1544.png)
*Notice that a "Blog Site Copilot (Power Virtual Agents)" application registration was automatically created in Azure.*


## Security|Authentication|No Authentication

I set the Authentication setting to No authentication. I navigated to the Demo Website channel.

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-9.17.21-am-1836x1020.png)
*I selected the No authentication option*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-9.20.00-am-1836x1023.png)
*I clicked the Save button*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-9.21.21-am-1836x1022.png)
*I clicked the Copy button*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-9.22.38-am-1836x1017.png)
*I navigated to https://web.powerva.microsoft.com/environments/b838e044-3024-ea32-b2f4-7862b85e9903/bots/cr74e_blogSiteCopilot/canvas?__version__=2*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-9.25.43-am-1836x1020.png)
*I navigated to the Publish tab and clicked the Publish button*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-9.26.06-am-1836x1024.png)
*I clicked the Publish button*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-14-at-10.35.51-am-1836x1085.png)
*I returned to the demo website and asked the question "What is NGRX?"*


## Setting|Security|Manual

To Configure Copilot with single sign-on for I created two Application Registrations.

A "Blog Site Copilot (**Canvas App**)" Application Registration for the Web Page [https://delightful-moss-0ad02620f.5.azurestaticapps.net](https://delightful-moss-0ad02620f.5.azurestaticapps.net/); and

A "Blog Site Copilot (**Authenticated App**)" Application Registration for Copilot Studio [https://token.botframework.com/.auth/web/redirect](https://token.botframework.com/.auth/web/redirect)

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-3.48.16-pm-1836x1107.png)
*The Canvas App Registration has a Web Redirect URI https://delightful-moss-0ad02620f.5.azurestaticapps.net/*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-3.50.26-pm-1836x1104.png)
*The Access tokens and ID tokens options are both checked*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-3.51.50-pm-1836x860.png)
*The Canvas App Registration has a generated Client secret*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-3.53.06-pm-1836x792.png)
*The Canvas App Registration Overview*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-3.54.58-pm-1836x1107.png)
*The Authenticated App Registration has a Web Redirect URI https://token.botframework.com/.auth/web/redirect*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-3.58.30-pm-1836x811.png)
*Notice that the Redirect URL can be copied from the Copilot Studio Security|Authentication page*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-3.59.54-pm-1836x1105.png)
*The Access tokens and ID tokens options are both checked*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.00.35-pm-1836x904.png)
*The Authenticated App Registration has a generated Client secret*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.01.38-pm-1836x1104.png)
*The Authenticated App Registration includes a scope. The Authenticated App is configured to trust the Canvas App Registration. Notice that the Canvas App Client ID "ff20..." has been added.*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.05.03-pm-1836x1053.png)
*The Authenticated App Registration includes scope: api://69552d8b-12ac-4e44-96a6-1dc285405aa5/Readfiles*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.08.04-pm-1836x778.png)
*The Authenticated App Registration Overview*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.06.27-pm-1836x1034.png)
*Notice that the Authenticated The Authenticated App Registration Client ID and Client Secret have been added to the Copilot Studio Security|Authentication page. The "api://6955..." scope has been added to the Copilot Studio Security|Authentication page.*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.13.51-pm-1836x1029.png)
*Code is from https://github.com/microsoft/CopilotStudioSamples/blob/master/BuildYourOwnCanvasSamples/3.single-sign-on/index.html*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.12.52-pm-1836x671.png)
*Static Web App has URL https://delightful-moss-0ad02620f.5.azurestaticapps.net*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.16.59-pm-1836x1170.png)
*To get this example to work I needed to load the web page and to click the "log in" button (promptly).*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.23.27-pm-1836x1036.png)
*Whoami Topic*

![](/assets/images/configurecopilotsinglesignonforweb/screenshot-2024-03-16-at-4.20.00-pm-1836x1030.png)
*This part of the code posts a "signin/tokenExchange" message to the Copilot (avoiding the need for the web page logged in user to login to the Copilot themselves).*

---

## configurecopilotwithauthentication

**Source file:** `configurecopilotwithauthentication.md`

---
title: "Configure Copilot with authentication"
description: "Configure Copilot with authentication"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/configurecopilotwithauthentication/hero.png"
tags: ["azure","docker","ai","ml","git"]
hidden: true
slug: "configurecopilotwithauthentication"
---


Microsoft Copilot Studio supports Azure Active Directory (aad) authentication.

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-12.56.22-pm-2136x1285.png)
*I created a new copilot*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-12.57.12-pm-2136x1279.png)
*I named the copilot "Blog Site Copilot"*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-12.57.27-pm-2136x1282.png)
*The copilot was setup*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-12.59.16-pm-2136x1202.png)
*"On Unknown Intent" the "Conversational boosting" Topic will generate an answer based on the contents of https://haddley.github.io (the Data source).*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-12.59.50-pm-2136x1200.png)
*To test the Copilot I asked the question "What is Docker?"*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-1.00.29-pm-2136x1126.png)
*I added a Message to display "System.Activity.Text"*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-1.01.39-pm-2136x1170.png)
*Now the text provided by the user is echoed back to them before the generated answer is displayed*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-1.02.46-pm-2136x1170.png)
*Restarting the session displays the message specified in the "Conversation Start" Topic*


## Publish|Configure channels

I wanted to publish the Copilot on a custom website.

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-8.50.49-am-1032x573.png)
*I clicked the Publish|Go to Channels link*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-8.53.03-am-1032x572.png)
*"Because you chose Teams Authentication, only Teams channel is available. To use other channels, change your authentication settings. Go to authentication settings."*


## Settings|Security|Authentication

By default the Copilot was configured with Authentication "Only for Teams and Power Apps".

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-1.05.03-pm-2136x1167.png)
*I clicked on the Security menu item*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-1.05.17-pm-2136x1168.png)
*I clicked on the Authentication tile*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-1.08.38-pm-1258x178.png)
*The "Only for Teams and Power Apps" authentication option is selected (by default).*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-13-at-1.06.56-pm-2090x1544.png)
*Notice that a "Blog Site Copilot (Power Virtual Agents)" application registration was automatically created in Azure.*


## Security|Authentication|No Authentication

I set the Authentication setting to No authentication. I navigated to the Demo Website channel.

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-9.17.21-am-1836x1020.png)
*I selected the No authentication option*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-9.20.00-am-1836x1023.png)
*I clicked the Save button*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-9.21.21-am-1836x1022.png)
*I clicked the Copy button*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-9.22.38-am-1836x1017.png)
*I navigated to https://web.powerva.microsoft.com/environments/b838e044-3024-ea32-b2f4-7862b85e9903/bots/cr74e_blogSiteCopilot/canvas?__version__=2*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-9.25.43-am-1836x1020.png)
*I navigated to the Publish tab and clicked the Publish button*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-9.26.06-am-1836x1024.png)
*I clicked the Publish button*

![](/assets/images/configurecopilotwithauthentication/screenshot-2024-03-14-at-10.35.51-am-1836x1085.png)
*I returned to the demo website and asked the question "What is NGRX?"*


## Custom website

I created a custom website to host the Copilot.


## Token Endpoint

I copied the "Token Endpoint" from the Mobile app channel.


## Settings|Security|Manual

To configure "Manual Authentication" I needed to create a "Copilot App" Application Registration and copy the Client ID and a Client Secret to Copilot Studio.


## The "Canvas App" Application Registration

I created a "Canvas App" Application Registration.

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/configurecopilotwithauthentication/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*


## staticwebapp.config.json

```text
{
  "routes": [
    {
      "route": "/*",
      "allowedRoles": [
        "authenticated"
      ]
    }
  ],
  "responseOverrides": {
    "401": {
      "statusCode": 302,
      "redirect": "/.auth/login/aad"
    }
  },
  "auth": {
    "identityProviders": {
      "azureActiveDirectory": {
        "registration": {
          "openIdIssuer": "https://login.microsoftonline.com/<TENANT_ID>/v2.0",
          "clientIdSettingName": "AZURE_CLIENT_ID",
          "clientSecretSettingName": "AZURE_CLIENT_SECRET"
        }
      }
    }
  }
}
```



---

## contextinjection

**Source file:** `contextinjection.md`

---
title: "Context Injection"
description: "Context Injection"
date: "2023-07-19"
categories: ["AI"]
tags: []
slug: "contextinjection"
image: "/assets/images/chatgpt-logo.svg"
---



## What is Context Injection?

Context injection is a technique that involves providing GPT-4 with additional relevant information from your knowledge base alongside the user’s query. This helps guide the model’s response and enhances its accuracy, relevance, and specificity. While it is too expensive (and impractical) to place your entire knowledge base at the beginning of every prompt, it is possible to create a database of the knowledge you want your LLM-based application (such as ChatGPT) to have access to. Then, use that database to help engineer prompts behind the scenes. This technique has two specific benefits: (1) prompts are always more efficiently written, and (2) your data are always up to date.

![](/assets/images/contextinjection/screen-shot-2023-07-19-at-11.17.35-pm-1836x1268.png)
*Results*


## context injection

```text
You are an enthusiastic student keen to impress. Given the following text, answer the questions using only the text. If you are unsure and the answer is not explicitly in the text, say 'Sorry, I don't know how to answer that question".

text:
I have, myself, full confidence that if all do their duty, if nothing is neglected, and if the best arrangements are made, as they are being made, we shall prove ourselves once again able to defend our Island home, to ride out the storm of war, and to outlive the menace of tyranny, if necessary for years, if necessary alone.
At any rate, that is what we are going to try to do. That is the resolve of His Majesty’s Government - every man of them. That is the will of Parliament and the nation.
The British Empire and the French Republic, linked together in their cause and in their need, will defend to the death their native soil, aiding each other like good comrades to the utmost of their strength.
Even though large tracts of Europe and many old and famous States have fallen or may fall into the grip of the Gestapo and all the odious apparatus of Nazi rule, we shall not flag or fail.
We shall go on to the end, we shall fight in France, we shall fight on the seas and oceans, we shall fight with growing confidence and growing strength in the air, we shall defend our Island, whatever the cost may be, we shall fight on the beaches, we shall fight on the landing grounds, we shall fight in the fields and in the streets, we shall fight in the hills; we shall never surrender, and even if, which I do not for a moment believe, this Island or a large part of it were subjugated and starving, then our Empire beyond the seas, armed and guarded by the British Fleet, would carry on the struggle, until, in God’s good time, the New World, with all its power and might, steps forth to the rescue and the liberation of the old.



Questions: 
1) Why does Churchill repeat the phrase “we shall fight” over and over?
2) How does it support the main purpose of this speech?
3) What did President Roosevelt think of the speech?
```
## References

- [Add Your Own Data to ChatGPT](https://shellypalmer.com/2023/04/add-your-own-data-to-chatgpt/)

---

## copilotembedcode

**Source file:** `copilotembedcode.md`

---
title: "Copilot Embed Code"
description: "An HTML page to host my Blog Copilot"
date: "2024-03-11"
categories: []
tags: []
slug: "copilotembedcode"
image: "/assets/images/office-365-icon-500x500.png"
---


I created an HTML page to host my Blog Copilot

![](/assets/images/copilotembedcode/screenshot-2024-03-11-at-6.16.10-pm-1536x893.png)
*I copied the Embed code*

![](/assets/images/copilotembedcode/screenshot-2024-03-11-at-6.30.58-pm-1536x888.png)
*I used https://www.w3schools.com/html/tryit.asp?filename=tryhtml_default to test the html*

---

## copilotstudiobctools

**Source file:** `copilotstudiobctools.md`

---
title: "Copilot Studio Agent Tools"
description: "Connected to Business Central"
date: "2025-09-24"
categories: ["Microsoft Dynamics","Business Central","Power Platform","Microsoft Dynamics"]
tags: []
slug: "copilotstudiobctools"
image: "/assets/images/posts-meta.svg"
hidden: true
---



I created a Copilot Studio Agent that connected to Business Central using a Copilot Studio Tool.

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-4.55.54-pm.png)
*I created a new agent*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-4.56.34-pm.png)
*I named the agent "Business Central Tools Agent"*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-4.56.56-pm.png)
*I created a New Agent*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-4.57.38-pm.png)
*I clicked the Create button*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-5.17.33-pm.png)
*I clicked the Tools menu item*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-5.17.47-pm.png)
*I clicked the Add a tool button*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-5.18.14-pm.png)
*I searched for Business Central actions*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-5.18.34-pm.png)
*I selected the Find records (V3) action and clicked the Add and configure button*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-5.21.23-pm.png)
*I updated the tool name to "Find Vendor records (V3)". I updated the default description*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-6.19.08-pm.png)
*I specified the Environment, Company, API category and Table name (vendors)*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-6.22.19-pm.png)
*I clicked Save and tested the tool "Who do we buy stuff from?". I clicked the Allow button*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-6.27.25-pm.png)
*The Business Central company had a single "Example Vendor"*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-24-at-6.26.05-pm.png)
*The Agent returned details of the Vendor*


![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.43.51-am.png)
*I added a second tool based on the Create record (V2) action*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.44.04-am.png)
*I clicked the Add and configure button*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.44.39-am.png)
*I updated the tool's name to 'Create Vendor record (V2)'*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.46.17-am.png)
*I selected the Environment, Company, API category and table name. I clicked the Add input button and selected displayName*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.51.14-am.png)
*I tried to use the new tool*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.51.44-am.png)
*An error message was returned*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.53.32-am.png)
*I added a number input*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.53.47-am.png)
*The new Vendor record was created*

![](/assets/images/copilotstudiobctools/screenshot-2025-09-26-at-10.54.19-am.png)
*The new vendor was visible in Business Central*



## References

- [Copilot Studio in Action Create Records Anywhere, Effortlessly!](https://www.youtube.com/watch?v=oeTjP_AVqQ8)

---

## createactionbasedonaflow

**Source file:** `createactionbasedonaflow.md`

---
title: "Create action based on a flow"
description: "Created from the Business Central user interface"
date: "2024-01-04"
categories: ["Power Platform","Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "createactionbasedonaflow"
image: "/assets/images/posts-meta.svg"
---




Power Automate flows can be created from the Business Central user interface.

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.30.40-pm-1836x950.png)
*I started with no flows defined*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.31.36-pm-1836x949.png)
*I navigated to a Customer Card page and clicked the "Automate | Power Automate | Create action based on flow" menu item*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.32.12-pm-1836x946.png)
*I clicked the "+ Create a flow" button*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.32.40-pm-1836x951.png)
*I was redirected to a https://make.powerautomate.com/ page*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.33.07-pm-1836x953.png)
*I selected the PRODUCTION Environment*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.33.20-pm-1836x947.png)
*I selected the Evaluation Company*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.34.18-pm-1836x951.png)
*I specified TABLE18 (to limit the flow to customer entities)*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-7.47.03-pm-1836x802.png)
*I added a "BlockCustomer?" Yes/No input*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.38.06-pm-1836x951.png)
*I wanted to add a Business Central action.*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.38.23-pm-1836x951.png)
*I selected the Get record (V3) action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.38.42-pm-1836x950.png)
*I selected the PRODUCTION Environment*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.38.54-pm-1836x950.png)
*I selected the Evaluation company*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.39.08-pm-1836x955.png)
*I selected the v2.0 API Category*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.39.37-pm-1836x946.png)
*I selected the customers table*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.39.51-pm-1836x952.png)
*I provided {System Id} as the Row Id*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.40.17-pm-1836x947.png)
*I provided {System Id} as the Row Id*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.40.31-pm-1836x948.png)
*I selected the Control icon*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.40.51-pm-1836x951.png)
*I added a Condition action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.41.08-pm-1836x946.png)
*I clicked the Choose a value field*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.41.25-pm-1836x948.png)
*I selected the BlockCustomer? field*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.42.45-pm-1836x952.png)
*I entered the value "true"*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.43.16-pm-1836x952.png)
*I clicked the "Add an action" button in the yes branch of the Condition action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.43.46-pm-1836x950.png)
*I selected the Dynamics 365 Business Central icon*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.44.19-pm-1836x949.png)
*I selected the Update record (V3) action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.44.38-pm-1836x949.png)
*In the update record I selected the PRODUCTION environment*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.44.51-pm-1836x950.png)
*I set Company to Evaluation*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.45.06-pm-1836x949.png)
*I set the API category to v2.0*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.45.24-pm-1836x946.png)
*I selected the customers entity*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.46.01-pm-1836x948.png)
*I set the Row Id value to {System Id}*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.46.28-pm-1836x942.png)
*I set the Blocked value to "ALL"*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.46.51-pm-1836x954.png)
*I added another action to the yes branch of the Condition action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.47.12-pm-1836x953.png)
*I selected the Outlook.com icon*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.47.31-pm-1836x948.png)
*I selected the Send an email (V2) action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.47.52-pm-1836x955.png)
*I clicked the Sign in button*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.49.16-pm-1836x951.png)
*I set the To field value to the {Email} field from the "selected record"*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.49.32-pm-1836x956.png)
*I set the To field value to the {Email} field from the "selected record"*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.50.18-pm-1836x951.png)
*I set the Subject to Blocked*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.52.19-pm-1836x946.png)
*I set the email Body to "We have updated..."*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.52.38-pm-1836x953.png)
*I clicked the "Add an action" button in the no branch of the Condition action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.53.05-pm-1836x956.png)
*I selected the Outlook.com icon*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.53.20-pm-1836x951.png)
*I selected the Send an email (V2) action*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.53.45-pm-1836x955.png)
*I set the To field value to the {Email} field from the "selected record"*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.53.57-pm-1836x950.png)
*I set the To field value to the {Email} field from the "selected record"*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.54.53-pm-1836x951.png)
*I set the Subject to "Contact" and the Body to "Please give us..."*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.55.16-pm-1836x944.png)
*I clicked the Save button*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.55.41-pm-1836x448.png)
*Power Automate generated a "Your flow is ready to go..." notification*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.56.23-pm-1836x946.png)
*I clicked the "Automate | ApiConnection-> Get record (V3)..." menu item*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.56.46-pm-1836x953.png)
*I clicked Continue to Sign in.*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.57.06-pm-1836x949.png)
*I reviewed the Run flow form.*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.57.17-pm-1836x946.png)
*I clicked the "BlockCustomer?" switch and clicked the Run flow button*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.57.30-pm-1836x950.png)
*The flow was started*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.57.51-pm-1836x953.png)
*I returned to Power Automate and clicked on the flow*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.58.09-pm-1836x952.png)
*I reviewed the flow history*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.58.41-pm-1836x953.png)
*The flow had run (executing the yes branch of the Condition)*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.59.00-pm-1836x953.png)
*I reviewed the generated email*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-6.59.49-pm-1836x946.png)
*I navigated to Outlook.com*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-04-at-7.00.06-pm-1836x951.png)
*I reviewed the generated email (sent to the selected customer)*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-05-at-7.49.08-am-1836x793.png)
*I navigated to the flow details page*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-05-at-7.49.51-am-1836x797.png)
*I updated the flow name*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-05-at-8.06.07-am-1836x800.png)
*The Blocked? flow name is displayed as a menu item in the Customers page (TABLE18 is the customer table)*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-05-at-7.52.33-am-1836x799.png)
*The Blocked? flow name is displayed as a menu item on the Customer Card*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-05-at-7.56.08-am-1836x794.png)
*I noticed that the Blocked? flow is not displayed as a menu item in the Items page.*

![](/assets/images/createactionbasedonaflow/screen-shot-2024-01-05-at-7.56.29-am-1836x799.png)
*I noticed that the Blocked? flow is not displayed as a menu item on the Vendor Card*

---

## customcomponents

**Source file:** `customcomponents.md`

---
title: "Power Apps Custom Components"
description: "Create reusable Power Apps Components."
date: "2021-07-13"
categories: ["Power Platform","React"]
tags: []
slug: "customcomponents"
image: "/assets/images/office-365-icon-500x500.png"
---

## New component library

Navigate to [https://make.powerapps.com/](https://make.powerapps.com/)

Select the "Apps" menu item and select the "Component libraries" tab.

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-5.57.27-pm-1270x508.png)
*Click the + New component library button*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-5.58.34-pm-1820x1124.png)
*Name the library*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-5.59.41-pm-978x370.png)
*Rename the sample component*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-5.59.50-pm-802x286.png)
*Name the component "EditHeader"*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.00.07-pm-452x134.png)
*Add a second component*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.00.18-pm-1058x450.png)
*Rename the second component*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.00.29-pm-610x118.png)
*Name the second component "BrowseHeader"*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.00.48-pm-982x566.png)
*Add a third component*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.00.58-pm-678x142.png)
*Rename the third component "DetailHeader"*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.01.19-pm-698x240.png)
*Set the height of all three components from 640 to 88.*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.02.46-pm-672x272.png)
*Add a custom property to the EditHeader component*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.03.50-pm-1272x826.png)
*Name the Input property Title*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.07.09-pm-1276x834.png)
*Add an "OnSelectAccept" custom Behavior property*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.05.57-pm-1836x893.png)
*If you are unable to add a Behavior property enable "Enhanced component properties" in the settings dialog.*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.07.42-pm-1268x832.png)
*Add an "OnSelectCancel" custom Behavior property*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.08.28-pm-1836x941.png)
*Select the IconCancel control and edit the OnSelect property so that selecting the cancel icon will raise the custom OnSelectCancel event*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.08.44-pm-1836x941.png)
*Select the AppName control and edit the Text property so that the value of the Title property will be copied to the text property of the label.*

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-6.08.54-pm-1836x949.png)
*Select the IconAccept control and edit the OnSelect property so that selecting the tick icon will raise the new custom OnSelectAccept event*


## Repeat these steps for the BrowseHeader and DetailHeader Components

These custom properties will be added to BrowseHeader:

{Title, OnSelectRefresh, OnSelectNewItem, OnSelectSortUpDown}

These custom properties will be added to DetailHeader:

{Title, OnSelectBack, OnSelectDelete, OnSelectEdit}

![](/assets/images/customcomponents/screen-shot-2021-07-13-at-7.05.52-pm-1758x960.png)
*Publish*

---

## customconnectorsappregistrations

**Source file:** `customconnectorsappregistrations.md`

---
title: "Power Apps, Custom Connectors and Application Registrations"
description: "Power Apps, Custom Connectors and Application Registrations"
date: "2021-08-09"
categories: ["Azure","JavaScript","Power Platform"]
tags: []
slug: "customconnectorsappregistrations"
image: "/assets/images/office-365-icon-500x500.png"
---



## Creating a Custom Connector

To create a PowerApps Azure Active Directory Custom Connector the following values must be provided:

**Client id
Client secret**; and
**Resource URL**

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-10.32.46-am-1836x1170.png)
*Custom Connector OAuth 2.0 Active Directory settings*


## The Custom Connector is the Client Application

In OAuth 2 an application accesses a resource on behalf of a user. 

In OAuth 2 the application does **not** store the user's username and password.

When setting up a Power Apps Custom Connector that will allow a user to access an API Service the Client Application is the Custom Connector and the Resource (Application) is the API Service.

Only three values are needed to create a Power Apps Custom Connector.

The three values needed to create a Power Apps Custom Connector are: the **Client id **(the client application registration ID), the **Client secret **(password); and the **Resource URL **(the resource application registration ID)

Here I will extend the [Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api) tutorial to show how to configure a Power Apps Custom Connector using Azure application registrations.

![](/assets/images/customconnectorsappregistrations/topology-callapi-631x362.png)
*topology_callapi by Doğan Erişen is licensed under MIT License*


## A JavaScript tutorial using MSAL

The [Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api) tutorial demonstrates how to configure Azure Application Registrations for an API and for a Single Page Web Application (SPA) that calls an Application Programming Interface Service (API).

I cloned the git repository using this command:

```bash
% git clone https://github.com/Azure-Samples/ms-identity-javascript-tutorial.git
```

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.41.51-am-1836x1739.png)
*esp8266*


## Resource application registration

Before updating the Application Programming Interface (API) Service I needed to create the **resource application registration**.

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.44.28-am-1704x396.png)
*Create the resource application registration*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.45.27-am-1704x1642.png)
*Provide the resource name*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.46.24-am-1062x294.png)
*Copy the "Application (client) ID" value.*


## Resource URL

The "Application (client) ID" value from the resource application registration is the **Resource URL** value we will need later to create the custom connector.

**be70217c-6a30-4023-b667-d88bf222b94a**

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.09.35-pm-536x70.png)
*This resource is an API Service so click the "Expose an API" menu item*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.14.23-pm-1042x146.png)
*Click the Set link*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.14.33-pm-1194x318.png)
*Save the generated Application ID URI (the URI api:// followed by the resource application client ID)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.15.06-pm-1144x154.png)
*esp8266*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.15.46-pm-1144x286.png)
*The resource must provide at least one scope*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.17.38-pm-1702x1634.png)
*I added the "access_as_user" scope.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.18.10-pm-204x64.png)
*I updated the application registration manifest*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.18.33-pm-1708x1630.png)
*The application registration manifest provides a way to export and update application registration settings.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.21.33-pm-1046x142.png)
*The Directory (tenant) ID is a tenant wide setting (by definition)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.26.20-pm-1836x790.png)
*The sample API code has been updated to include the tenantID and the clientID.*


## Client application registration

If I was following the [Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api) tutorial I would create the client application registration for a Single Page Application (SPA) next.

Instead I will create a client application registration for the Power Apps Custom Connector.

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.24.37-pm-1832x1444.png)
*Notice that the redirect url has been set to https://global.consent.azure-apim.net/redirect*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.25.12-pm-1194x166.png)
*Copy the Application (client) ID*


## Client id

The "Application (client) ID" value from the **client application registration** is the **Client id** we will need later to create the custom connector.

**59259fa1-c2e1-486d-a8e6-92209abf090c**

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.26.25-pm-532x68.png)
*The client application will be allowed to access the resource application registration (the API)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.26.45-pm-1252x330.png)
*Click the + Add a permission link*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.02-pm-1596x428.png)
*Select the "My APIs" tab*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.13-pm-1628x92.png)
*Select the resource application registration (the API)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.34-pm-1824x1444.png)
*Click the access_as_user checkbox*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.58-pm-1258x640.png)
*The access_as_user scope has been added*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.29.09-pm-1830x506.png)
*Click the Authentication menu item and enable "Access tokens"*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.29.47-pm-1832x528.png)
*Click on the Certificates & secrets menu item.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.30.13-pm-1832x1442.png)
*Add a client secret*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.30.27-pm-1830x586.png)
*Copy the "client secret" value*


## Client secret

The generated "Value" is the **Client secret** we will need to create the custom connector.

.ljDa4a7mFqn1tWj0wyPQ6X5L6B_3V.x~f

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.31.36-pm-1834x306.png)
*Create a new custom connector (from blank)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.31.59-pm-672x460.png)
*Provide a name for the custom connector*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.33.43-pm-1836x1239.png)
*Enter the url of the host the API service. Enter the base URL (if applicable)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.33.59-pm-1482x626.png)
*Select Authentication type OAuth 2.0*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.34.10-pm-1312x378.png)
*Select "Azure Active Directory" as the Identity Provider*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.37.06-pm-1836x1233.png)
*Enter the Client id, Client secret and Resource URL value.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.37.35-pm-560x192.png)
*This API publishes a single action*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.38.05-pm-1836x1234.png)
*Provide a name for each action*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.38.16-pm-1096x368.png)
*Click Import from sample to describe the action*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.39.13-pm-1836x1237.png)
*In this case the path /api/ should return identity information*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.39.29-pm-1836x1234.png)
*The action request has been described*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.39.37-pm-1054x444.png)
*Click the + Add default response link*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.40.20-pm-1836x1238.png)
*Provide an example API response.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.40.56-pm-1836x526.png)
*Click on the tick to create the custom connector*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.41.39-pm-1836x1235.png)
*Click the + New connection link to create a new connection*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.41.50-pm-1836x556.png)
*Click Create*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.42.12-pm-1836x704.png)
*Provide value Azure Active Directory credentials*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.42.42-pm-1836x1242.png)
*Consent*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.43.15-pm-1836x592.png)
*The connection has been created*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-8.06.57-pm-1836x1032.png)
*Test the operation*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.43.39-pm-1836x1238.png)
*Create a PowerApp Canvas app*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.43.57-pm-788x444.png)
*Select the data menu item and click the Add data button*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.44.18-pm-896x540.png)
*Select the Identity connection*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.44.45-pm-1836x1235.png)
*Notice that using the Identity Connection requires a Premium PowerApps license*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.45.42-pm-1836x642.png)
*Add a button to the app screen. Use the ClearCollect operation to call the API.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.45.54-pm-1836x472.png)
*Run the app*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.46.54-pm-1836x570.png)
*Switch to the Colllections page to see the results of the API call*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.47.52-pm-1836x1026.png)
*Add the collection to a Vertical gallery control*


## Enterprise Applications

A service principal is created in each tenant where the application is used.

The service principle in each tenant references the globally unique application registration.

The service principal defines what the app can do in the specific tenant, who can access the app, and what resources the app can access.

The service principal objects are what you see when you select the Enterprise applications page.

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.44.26-am-1836x949.png)
*The Service Principal Objects are what you see when you select the Enterprise applications page*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.44.49-am-1836x950.png)
*The API's Enterprise Application configuration*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.46.54-am-1836x947.png)
*The Custom Connector's Enterprise Application configuration*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.47.20-am-1836x946.png)
*The Custom Connector's Permissions*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-11.32.02-am-1836x946.png)
*Permission Details*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.51.31-am-1836x948.png)
*The Custom Connector's Users and Groups*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-11.01.26-am-1836x946.png)
*The Custom Connector's Properties*

## References

- [Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api)
- [Azure AD App Registrations, Enterprise Apps and Service Principals](https://www.youtube.com/watch?v=WVNvoiA_ktw)

---

## customcopilotstudio

**Source file:** `customcopilotstudio.md`

---
title: "Custom Copilot Studio"
description: "Customer Copilot"
date: "2024-03-23"
categories: ["Microsoft Dynamics","Business Central","Power Platform","Microsoft Dynamics"]
tags: []
slug: "customcopilotstudio"
image: "/assets/images/posts-meta.svg"
---



I created a Business Central extension that allows Business Central users to "chat to" Customers.

I used the Global Variable and Generative AI features in Copilot studio.

The same approach could be used to allow users to chat to other Business Central entities

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.18.51-pm-1836x272.png)
*I created a new Copilot*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.19.14-pm-1836x971.png)
*I called the Copilot "Customer Copilot"*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.19.34-pm-1836x964.png)
*I watched the animation*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.20.00-pm-1836x380.png)
*I created a Copilot Studio Topic*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.21.10-pm-1836x518.png)
*I named the Topic "Parameter Config"*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.22.00-pm-1836x969.png)
*I used the "Set a variable value" action*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.23.32-pm-1836x972.png)
*I created a "Customer_Name" Global variable that could be set by an external source (Business Central in this case)*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.24.25-pm-1836x970.png)
*I created a "Customer_City" Global variable*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.25.44-pm-1836x971.png)
*I created a "Customer_No" Global variable*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.27.19-pm-1836x970.png)
*I created a "Customer_Blocked" Global variable*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.28.54-pm-1836x970.png)
*I updated the "Conversation Start" Topic*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.29.19-pm-1836x972.png)
*I used the {x} button to insert Global variable values into the Conversation Start action's text*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.29.48-pm-1836x969.png)
*I saved the Topic*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.42.11-pm-1836x968.png)
*I navigated to the Generative AI tab and enabled the "Boost conversational coverage with generative answers" feature*

![](/assets/images/customcopilotstudio/screenshot-2024-03-23-at-3.42.55-pm-1836x604.png)
*The Conversational boosting Topic was added*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-9.16.45-am-1836x972.png)
*In the Conversational booking Topic I created a Custom Data variable*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-9.17.18-am-1836x971.png)
*I updated the "create generative answers" action's Data sources property*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-9.17.31-am-1836x967.png)
*The Custom data datasource was set to the CustomData variable*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-9.44.50-am-1836x974.png)
*I published the Copilot*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-10.04.45-am-1836x1059.png)
*I created a Business Central extension that connected to the Copilot*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-9.36.28-am-1836x972.png)
*I was able to "chat to" School of Fine Art*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-9.36.49-am-1836x963.png)
*I was able to "chat to" Alpine Ski House*

![](/assets/images/customcopilotstudio/screenshot-2024-03-24-at-10.02.53-am-1836x970.png)
*I was able to "chat to" Adatum Corporation*


## CustomerCopilotExtension.al

```text
controladdin CustomerCopilotFactBox
{
    RequestedHeight = 400;
    MaximumHeight = 600;
    VerticalStretch = false;
    VerticalShrink = false;
    HorizontalStretch = true;
    HorizontalShrink = true;
    Scripts = 'https://cdn.botframework.com/botframework-webchat/latest/webchat.js', 'CustomerCopilotFunctions.js';
    Stylesheets = 'CustomerCopilotStyles.css';

    event ControlReady()
    procedure CreateSidebar(no: Text; city: Text; name: Text; blocked: Enum Microsoft.Sales.Customer."Customer Blocked");
}

page 99101 CopilotCustListFactBoxPart
{
    PageType = CardPart;
    SourceTable = "Customer";

    layout
    {
        area(Content)
        {
            usercontrol(Sidebar; CustomerCopilotFactBox)
            {
                ApplicationArea = All;
            }
        }
    }

    trigger OnAfterGetRecord()
    begin
        CurrPage.Sidebar.CreateSidebar(rec."No.", rec.City, rec.Name, rec.Blocked);
    end;
}

pageextension 99102 "Customer Copilot Cust Card" extends "Customer Card"
{
    layout
    {
        addfirst(FactBoxes)
        {
            part(CopilotCustListFactBoxPart; CopilotCustListFactBoxPart)
            {
                ApplicationArea = all; //Basic, Suite;// all;
                Caption = 'Customer Copilot';
                SubPageLink = "No." = FIELD("No.");
            }
        }
    }

}

pageextension 99103 "Customer Copilot Cust List" extends "Customer List"
{

    layout
    {
        addfirst(FactBoxes)
        {
            part(CopilotCustListFactBoxPart; CopilotCustListFactBoxPart)
            {
                ApplicationArea = all;
                caption = 'Customer Copilot';
                SubPageLink = "No." = FIELD("No.");
            }
        }

    }
}
```

## CustomerCopilotFunctions.js

```text
function CreateSidebar(no, city, name, blocked) {
    var __div = document.getElementById('controlAddIn');

    (async function () {

        // Specifies style options to customize the Web Chat canvas.
        // Please visit https://microsoft.github.io/BotFramework-WebChat for customization samples.
        const styleOptions = {
            accent: '#00809d',
            botAvatarBackgroundColor: '#FFFFFF',
            botAvatarImage: 'data:image;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAACYCAYAAAAYwiAhAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TRZFKwRYRcchQneyiIo6likWwUNoKrTqYXPoFTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxdXFSdJES/5cUWsR4cNyPd/ced+8AoVllqtkTA1TNMtKJuJjLr4p9rwggiCGEMCwxU09mFrPwHF/38PH1LsqzvM/9OQaVgskAn0gcY7phEW8Qz25aOud94jArSwrxOfGkQRckfuS67PIb55LDAs8MG9n0PHGYWCx1sdzFrGyoxDPEEUXVKF/Iuaxw3uKsVuusfU/+wkBBW8lwneYYElhCEimIkFFHBVVYiNKqkWIiTftxD/+o40+RSyZXBYwcC6hBheT4wf/gd7dmcXrKTQrEgd4X2/4YB/p2gVbDtr+Pbbt1AvifgSut4681gblP0hsdLXIEBLeBi+uOJu8BlzvAyJMuGZIj+WkKxSLwfkbflAdCt8DAmttbex+nD0CWulq+AQ4OgYkSZa97vLu/u7d/z7T7+wGSW3Kz8ImFcQAAAAZiS0dEAJ8AoQCjPXDOuwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cMDxMiAOPUJ8QAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAI4ElEQVR42u2dX0xb1x3Hv/dSMFZV41hGkzCaXUCTvBXsSCPsJZf1IeGhg9FGlbZJYWXaXvKvtta3OWqq8NZtOGKqNK1a2zCtD2klmm4PlIcU7yXMD4MkClKFM1vCeUlkLqDJMai+ezAQYl/+5hruOXw/LxYGDte/++F3zj3n3N9VsFsiw+5aoF9BTTcUI2wAAQVwg0iPAegKkDYUZRrFbydXgTHEo/puflfZhViBWrXmbRjGWxSKbEinKB+vFr99D/Foen+CRYbdtWrNu4phRBhOso1o8dU/XoruTbDIcKBOUW8BCDCEZBekV4ziq2bZTDWRK0y5yB4J1CnqrdrIcHj7DMbMRSzOZMrmMVedov6HchELJDu+fpW50UXWqjXvUi5iRXe55tKmDFbqGv/L2BCrWDGKLyMeTaubshchllGrIFLKYKWx1wJDQixGXzGKL6u1QD9jQaqAuxboV6HWdDMWpBooULpVGEaYoSDVwFCUsApOTZCqZTAEVO6QINUch6mMAakmFIxQMELBCKFghIIRCkYIBSMUjFAwQigYoWCEghFCwQgFI4SCEQpGKBghFIxQMELBCKFgxIa8wBDsHq2tGVqrD4lUFom5eQaEglnH2c4gPvz5qY2v3xlLYCQxzcCwi7SGS9qzFRYuaqy4QMEspMFZzyBQMMIx2CHQ196Kvh+0wO95ad9tlP9ug9OBiXNv7Lu9TG4Zk6l5jCZnpY69Uhe9Zsh81ffhz049l1jVJpNbwq8/nUAilWUXKRIDnUFMnHvD1nKVMqMLE+fPYKAzSMFEwe9x4f1+Tahjfr9fs/0/AwVbI3a6C26nQ6hjdjsduHz6RxzkC9E9nqjsbkYS0xgan4KeL9hCpgtaGJd7up55v7e9Be4vHLY4RmawbQb25dy89wDvjCVsc+L0fAFD41MVy01upwN+j4tdpGjMZB/Z8rgmTa4cG+rrKBghFIxQMELBCHkujvx+sA6fF5dOHofW5sNivoCZ7GNc/eo2MrnlQ22LgknAQGcQf9m0ibAkSSPOngjiN59O4PoeFqKtbItdpAT4Pa4KITazl6UbK9uiYJKw045Ut9OBi9rxA2+LgklCqMm7q8x00G1RMEnQ8ys7/kxDvePA26JgkjDzcOflo9Hk/QNvi4JJwp8S09tOH2RyS0ik5g+8LQomTRdZwKkPPjcVI5Nb2vJ71W5LNo70PFgmt4TvDX2Es51BhHyNcNc7MP3wEf6WnN3z1h4r26JgkjGanLXs7h4r22IXSQgFIxSMUDBCKNja1Vw53a0+Wx7rQOf3K95bfLIi1fl4QUbB9HzhmfsitbZm3Bh8DSP/mrHFMbqdDlw8GarYYZHJLdn2BhUKtomRxHTFPYd97a3oa2+19XHLuGdMyjHYTks3ds28Mq5XSinYdks3dpVL1uUkaa8i10+a3bud0eSs1GuVUtcHW8fvcSHU5EWHr9FW/wBf3nsg/TrlkRCMsIskFIwQCkYoGKFghFiEdEtFIV8jOnxeIY99Mb8i3XqkFIKV7pwO44IWFq74rxmlZaNZXE/eF34CVvh5sA6fF58N9kpZ+yGTW8Kbf/0HZh4+5hjssOSaOHdG2sIifo8LX50/s6vSBBSsCsH/bLBXii5xp+7/xq9+IuznFHYMNtAZNM1ck3NZ3LyXwqKAa3wNTgcuaccrPpff48IFLYyh8SmOwQ6Kb2KDFSfi6viUkCehnFhPV8WGST1fwHd+92d2kQczFeE13W4sg1wAtnxIQ8hGu0GkFsx/rLLWlmzPz/7i3oPKixoBB/tCCtZgMuCVbV/VoiSfh0tFhIIRCkaIPIKZjU9kK7Jr9nnM7lqnYFXAbG0uIJlgoabKKQkRywpIk8E0m9af2C8Bk1UKEbfxCCmYni/gTlmw/R6XNIvefo+r4ha7mayYOyqEHeSbPS32rEm1GhGJne6qeE/UKtXCCnbzbqrivYsSbDj0e1zoNnnuuKh1X4UVLJHKmq7X3Rh8TWjBfv/TkxVd/eRcVtht1ELPg101WdzW2pordiKIwuWeLtMSUyJX3RFaMLMsBphvd7F95urXEDM5ZtHLogs/k//mR/80vTEi1tOFb2Jv2f7KssPnRfK3vzB9JGAmt4Sr47eFPj9SFD/paPJi4vyZLQf4o/+etd2jjf0eF2KnuzBwImj6fT1fwIk//J13FYkiGQAk5uZxPTl7aGWT3E4HettbMPDDIDSTK8XNcp364HPcyT4W/rxIVb7J73Ht+i6jxNw8JlNZJFJZ3Mk+qopwfo8LIV8jQk1eaK2+baXa3C3KVJBOuvpgbqcDsZ6uHR9zbJY11kXL5JahPykgs7C0dtKXt/xbDc66kkzHXHDXO9a2NnvxXY9rz3NyI4lpDI1PSbV5UtoCdH6PC7GeLgx0Bm1/rJNzWQyN30bCZHWCggkiWt8rLbaa5dfzBYwmZ3HzbkpKsY6MYJvpe6UFve2t6G5tPpTpCz1fwJd3H+B68j7uPHx8JJ4jeWRrtHY0eRHwuKC1NSPU1IiGtbGTVWRyy5jJPkJmoVQtJzE3j8zC0XvqLYsAl3epx17a2E1a/rrVVR9Q2qOWzi1hMV84kiJtBZ94Wy7MwvJTQSQeGx0UvOmDUDBCwQihYISCEQpGCAUjFIxQMEIoGKFghIIRQsEIBSOEghEKRigYIRSMUDBCwQihYMSOghmAzjCQKqGrANKMA6kGBpBWFaM4w1CQaqAYxrRqAF8zFKQ6GcyYVFeBMY7DSDVYBcZUxKM6jOInDAexNn0ZHyMe1VUAqAHijAixEhXGe6VXAE/i0bRhFK8xLMSasVfx2pN4NL0h2Fp/eQWcsiDPT3p1OBp5msnWiUd11Si+SsnI88i15hAqBXvaVb5Oych+5DKM4uvrXeM6itlP1keGA0VFvQUgwLiR3Waucrm2FGyd2shwXFHUtxk/st2A/kUDV/R41HQuVdmpgfrIcKAIXIGi/pLhJCWpoKtG8RMFiJtlrT0Jto47Muz+H9CvAD82FCUEKAEFcDPcR0MowEgrBqYNGJMvAmNbZaxy/g/gnmrRS4hOdQAAAABJRU5ErkJggg==',
            botAvatarInitials: 'BOT',
            userAvatarImage: 'https://content.powerapps.com/resource/makerx/static/media/user.336bbce3.svg',
            userAvatarInitials: 'USER',
            hideUploadButton: true,
            primaryFont: fontFamily(['Segoe UI', 'Segoe WP', 'Segoe', 'device-segoe', 'Tahoma', 'Helvetica', 'Arial', 'sans-serif']),
        };

        // Specifies the token endpoint URL.
        // To get this value, visit Copilot Studio > Settings > Channels > Mobile app page.
        const tokenEndpointURL = new URL('https://b838e0443024ea32b2f47862b85e99.03.environment.api.powerplatform.com/powervirtualagents/botsbyschema/cr74e_customerCopilot/directline/token?api-version=2022-03-01-preview');

        const locale = document.documentElement.lang || 'en'; // Uses language specified in <html> element and fallback to English (United States).

        const apiVersion = tokenEndpointURL.searchParams.get('api-version');

        const [directLineURL, token] = await Promise.all([
            fetch(new URL(`/powervirtualagents/regionalchannelsettings?api-version=${apiVersion}`, tokenEndpointURL))
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to retrieve regional channel settings.');
                    }

                    return response.json();
                })
                .then(({ channelUrlsById: { directline } }) => directline),
            fetch(tokenEndpointURL)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to retrieve Direct Line token.');
                    }

                    return response.json();
                })
                .then(({ token }) => token)
        ]);

        const directLine = WebChat.createDirectLine({ domain: new URL('v3/directline', directLineURL), token });

        // Sends "startConversation" event when the connection is established.
        const subscription = directLine.connectionStatus$.subscribe({
            next(value) {
                if (value === 2) {
                    directLine
                        .postActivity({
                            localTimezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                            locale,
                            name: 'startConversation',
                            type: 'event',
                            // https://www.dynamicsforcrm.com/pass-parameters-to-copilot-studio-bot-from-calling-site/
                            value: {
                                Customer_No:no, 
                                Customer_City:city, 
                                Customer_Name:name, 
                                Customer_Blocked:blocked
                            }
                        })
                        .subscribe();

                    // Only send the event once, unsubscribe after the event is sent.
                    subscription.unsubscribe();
                }
            }
        });

        WebChat.renderWebChat({ directLine, locale, styleOptions }, __div);


        Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("ControlReady");

    })();

}

function fontFamily(fonts) {
    return fonts.map(font => `'${font}'`).join(', ');
}
```

## CustomerCopilotStyles.css

```text
* {
    font-size: 10.5pt
}
```

---

## customercontentvirtualtables

**Source file:** `customercontentvirtualtables.md`

---
title: "Customer Content Virtual Tables"
description: "Customer Content Virtual Tables"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/customercontentvirtualtables/hero.png"
tags: ["ai","business central","power platform"]
hidden: true
slug: "customercontentvirtualtables"
---



I created two related Business Central tables and connected to them as Power Platform Dataverse Virtual Tables.

![](/assets/images/customercontentvirtualtables/screenshot-2024-05-07-at-6.07.14pm-1836x923.png)
*The Car Brand table can be edited using the Car Brand List page*

![](/assets/images/customercontentvirtualtables/screenshot-2024-05-07-at-6.07.45pm-1836x921.png)
*The Car Model table can be edited using the Car Model List page*

![](/assets/images/customercontentvirtualtables/screenshot-2024-05-07-at-6.09.07pm-1836x1059.png)
*The Car Brand and Car Model tables are shown in the Available Tables list*

![](/assets/images/customercontentvirtualtables/screenshot-2024-05-07-at-6.09.51pm-1836x1063.png)
*The contents of the Car Brands table can be viewed using a Model Driven App View*

![](/assets/images/customercontentvirtualtables/screenshot-2024-05-07-at-6.10.02pm-1836x1064.png)
*The contents of the Car Models table can be viewed using a Model Driven App View*

![](/assets/images/customercontentvirtualtables/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*A Car Model record can be updated using a Model Driven App Form*


## Car.al

```text
table 50200 "Car Brand"
{
    DataClassification = CustomerContent;
    Caption = 'Car Brand';

    fields
    {
        field(1; Name; Text[100])
        {
            Caption = 'Name';
        }
        field(2; Description; Text[100])
        {
            Caption = 'Description';
        }
        field(3; "Country"; Text[100])
        {
            Caption = 'Country';
        }
    }

    keys
    {
        key(PK; Name)
        {
            Clustered = true;
        }
    }
}
table 50201 "Car Model"
{
    DataClassification = CustomerContent;
    Caption = 'Car Model';

    fields
    {
        field(1; Name; Text[100])
        {
            Caption = 'Name';
        }
        field(2; Description; Text[100])
        {
            Caption = 'Description';
        }
        field(3; "Brand Id"; Guid)
        {
            TableRelation = "Car Brand".SystemId;
            // https://yzhums.com/22220/
            ValidateTableRelation = false;
            Caption = 'Brand Id';
        }
        field(4; Power; Integer)
        {
            Caption = 'Power (cc)';
        }
        field(5; "Fuel Type"; Enum "Fuel Type")
        {
            Caption = 'Fuel Type';
        }
    }

    keys
    {
        key(PK; Name, "Brand Id")
        {
            Clustered = true;
        }
    }
}
enum 50200 "Fuel Type"
{
    Extensible = true;
    value(0; Petrol)
    {
        Caption = 'Petrol';
    }
    value(1; Diesel)
    {
        Caption = 'Diesel';
    }
    value(2; Electric)
    {
        Caption = 'Electric';
    }
}
page 50200 "API Car Brand"
{
    PageType = API;

    APIVersion = 'v1.0';
    APIPublisher = 'bctech';
    APIGroup = 'demo';

    EntityCaption = 'Car Brand';
    EntitySetCaption = 'Car Brands';
    EntityName = 'carBrand';
    EntitySetName = 'carBrands';

    ODataKeyFields = SystemId;
    SourceTable = "Car Brand";

    Extensible = false;
    DelayedInsert = true;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }

                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(country; Rec.Country)
                {
                    Caption = 'Country';
                }
            }

            part(carModels; "API Car Model")
            {
                Caption = 'Car Models';
                Multiplicity = ZeroOrOne;
                EntityName = 'carModel';
                EntitySetName = 'carModels';
                SubPageLink = "Brand Id" = Field(SystemId);
            }
        }
    }
}
page 50201 "API Car Model"
{
    PageType = API;

    APIVersion = 'v1.0';
    APIPublisher = 'bctech';
    APIGroup = 'demo';

    EntityCaption = 'Car Model';
    EntitySetCaption = 'Car Models';
    EntityName = 'carModel';
    EntitySetName = 'carModels';

    ODataKeyFields = SystemId;
    SourceTable = "Car Model";

    Extensible = false;
    DelayedInsert = true;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }
                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(brandId; Rec."Brand Id")
                {
                    Caption = 'Brand Id';
                }
                field(power; Rec.Power)
                {
                    Caption = 'Power';
                }
                field(fuelType; Rec."Fuel Type")
                {
                    Caption = 'Fuel Type';
                }
            }
        }
    }
}
permissionset 50200 "Car Brand"
{
    permissions =
        tabledata "Car Brand" = RIMD,
        page "API Car Brand" = X;

}
permissionset 50201 "Car Model"
{
    permissions =
        tabledata "Car Model" = RIMD,
        page "API Car Model" = X;

}


page 50210 "Car Brand List"
{
    PageType = List;
    SourceTable = "Car Brand";
    ApplicationArea = All;
    UsageCategory = Lists;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }

                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(country; Rec.Country)
                {
                    Caption = 'Country';
                }
            }




        }
    }
}
page 50211 "Car Model List"
{
    PageType = List;
    SourceTable = "Car Model";
    ApplicationArea = All;
    UsageCategory = Lists;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }
                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(brandId; Rec."Brand Id")
                {
                    Caption = 'Brand Id';
                }
                field(power; Rec.Power)
                {
                    Caption = 'Power';
                }
                field(fuelType; Rec."Fuel Type")
                {
                    Caption = 'Fuel Type';
                }
            }
        }
    }
}
```



---

## customercopilotstudio

**Source file:** `customercopilotstudio.md`

---
title: "Customer Copilot Studio"
description: "Business Central Customer CopilotUsing Copilot Studio"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/customercopilotstudio/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "customercopilotstudio"
---



I created a Business Central extension that allows Business Central users to "chat to" Customers.

I used the Global Variable and Generative AI features in Copilot studio.

The same approach could be used to allow users to chat to other Business Central entities

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.18.51-pm-1836x272.png)
*I created a new Copilot*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.19.14-pm-1836x971.png)
*I called the Copilot "Customer Copilot"*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.19.34-pm-1836x964.png)
*I watched the animation*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.20.00-pm-1836x380.png)
*I created a Copilot Studio Topic*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.21.10-pm-1836x518.png)
*I named the Topic "Parameter Config"*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.22.00-pm-1836x969.png)
*I used the "Set a variable value" action*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.23.32-pm-1836x972.png)
*I created a "Customer_Name" Global variable that could be set by an external source (Business Central in this case)*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.24.25-pm-1836x970.png)
*I created a "Customer_City" Global variable*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.25.44-pm-1836x971.png)
*I created a "Customer_No" Global variable*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.27.19-pm-1836x970.png)
*I created a "Customer_Blocked" Global variable*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.28.54-pm-1836x970.png)
*I updated the "Conversation Start" Topic*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.29.19-pm-1836x972.png)
*I used the {x} button to insert Global variable values into the Conversation Start action's text*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.29.48-pm-1836x969.png)
*I saved the Topic*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.42.11-pm-1836x968.png)
*I navigated to the Generative AI tab and enabled the "Boost conversational coverage with generative answers" feature*

![](/assets/images/customercopilotstudio/screenshot-2024-03-23-at-3.42.55-pm-1836x604.png)
*The Conversational boosting Topic was added*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-9.16.45-am-1836x972.png)
*In the Conversational booking Topic I created a Custom Data variable*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-9.17.18-am-1836x971.png)
*I updated the "create generative answers" action's Data sources property*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-9.17.31-am-1836x967.png)
*The Custom data datasource was set to the CustomData variable*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-9.44.50-am-1836x974.png)
*I published the Copilot*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-10.04.45-am-1836x1059.png)
*I created a Business Central extension that connected to the Copilot*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-9.36.28-am-1836x972.png)
*I was able to "chat to" School of Fine Art*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-9.36.49-am-1836x963.png)
*I was able to "chat to" Alpine Ski House*

![](/assets/images/customercopilotstudio/screenshot-2024-03-24-at-10.02.53-am-1836x970.png)
*I was able to "chat to" Adatum Corporation*


## CustomerCopilotExtension.al

```text
controladdin CustomerCopilotFactBox
{
    RequestedHeight = 400;
    MaximumHeight = 600;
    VerticalStretch = false;
    VerticalShrink = false;
    HorizontalStretch = true;
    HorizontalShrink = true;
    Scripts = 'https://cdn.botframework.com/botframework-webchat/latest/webchat.js', 'CustomerCopilotFunctions.js';
    Stylesheets = 'CustomerCopilotStyles.css';

    event ControlReady()
    procedure CreateSidebar(no: Text; city: Text; name: Text; blocked: Enum Microsoft.Sales.Customer."Customer Blocked");
}

page 99101 CopilotCustListFactBoxPart
{
    PageType = CardPart;
    SourceTable = "Customer";

    layout
    {
        area(Content)
        {
            usercontrol(Sidebar; CustomerCopilotFactBox)
            {
                ApplicationArea = All;
            }
        }
    }

    trigger OnAfterGetRecord()
    begin
        CurrPage.Sidebar.CreateSidebar(rec."No.", rec.City, rec.Name, rec.Blocked);
    end;
}

pageextension 99102 "Customer Copilot Cust Card" extends "Customer Card"
{
    layout
    {
        addfirst(FactBoxes)
        {
            part(CopilotCustListFactBoxPart; CopilotCustListFactBoxPart)
            {
                ApplicationArea = all; //Basic, Suite;// all;
                Caption = 'Customer Copilot';
                SubPageLink = "No." = FIELD("No.");
            }
        }
    }

}

pageextension 99103 "Customer Copilot Cust List" extends "Customer List"
{

    layout
    {
        addfirst(FactBoxes)
        {
            part(CopilotCustListFactBoxPart; CopilotCustListFactBoxPart)
            {
                ApplicationArea = all;
                caption = 'Customer Copilot';
                SubPageLink = "No." = FIELD("No.");
            }
        }

    }
}
```

## CustomerCopilotFunctions.js

```text
function CreateSidebar(no, city, name, blocked) {
    var __div = document.getElementById('controlAddIn');

    (async function () {

        // Specifies style options to customize the Web Chat canvas.
        // Please visit https://microsoft.github.io/BotFramework-WebChat for customization samples.
        const styleOptions = {
            accent: '#00809d',
            botAvatarBackgroundColor: '#FFFFFF',
            botAvatarImage: 'data:image;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAACYCAYAAAAYwiAhAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TRZFKwRYRcchQneyiIo6likWwUNoKrTqYXPoFTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxdXFSdJES/5cUWsR4cNyPd/ced+8AoVllqtkTA1TNMtKJuJjLr4p9rwggiCGEMCwxU09mFrPwHF/38PH1LsqzvM/9OQaVgskAn0gcY7phEW8Qz25aOud94jArSwrxOfGkQRckfuS67PIb55LDAs8MG9n0PHGYWCx1sdzFrGyoxDPEEUXVKF/Iuaxw3uKsVuusfU/+wkBBW8lwneYYElhCEimIkFFHBVVYiNKqkWIiTftxD/+o40+RSyZXBYwcC6hBheT4wf/gd7dmcXrKTQrEgd4X2/4YB/p2gVbDtr+Pbbt1AvifgSut4681gblP0hsdLXIEBLeBi+uOJu8BlzvAyJMuGZIj+WkKxSLwfkbflAdCt8DAmttbex+nD0CWulq+AQ4OgYkSZa97vLu/u7d/z7T7+wGSW3Kz8ImFcQAAAAZiS0dEAJ8AoQCjPXDOuwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cMDxMiAOPUJ8QAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAI4ElEQVR42u2dX0xb1x3Hv/dSMFZV41hGkzCaXUCTvBXsSCPsJZf1IeGhg9FGlbZJYWXaXvKvtta3OWqq8NZtOGKqNK1a2zCtD2klmm4PlIcU7yXMD4MkClKFM1vCeUlkLqDJMai+ezAQYl/+5hruOXw/LxYGDte/++F3zj3n3N9VsFsiw+5aoF9BTTcUI2wAAQVwg0iPAegKkDYUZRrFbydXgTHEo/puflfZhViBWrXmbRjGWxSKbEinKB+vFr99D/Foen+CRYbdtWrNu4phRBhOso1o8dU/XoruTbDIcKBOUW8BCDCEZBekV4ziq2bZTDWRK0y5yB4J1CnqrdrIcHj7DMbMRSzOZMrmMVedov6HchELJDu+fpW50UXWqjXvUi5iRXe55tKmDFbqGv/L2BCrWDGKLyMeTaubshchllGrIFLKYKWx1wJDQixGXzGKL6u1QD9jQaqAuxboV6HWdDMWpBooULpVGEaYoSDVwFCUsApOTZCqZTAEVO6QINUch6mMAakmFIxQMELBCKFghIIRCkYIBSMUjFAwQigYoWCEghFCwQgFI4SCEQpGKBghFIxQMELBCKFgxIa8wBDsHq2tGVqrD4lUFom5eQaEglnH2c4gPvz5qY2v3xlLYCQxzcCwi7SGS9qzFRYuaqy4QMEspMFZzyBQMMIx2CHQ196Kvh+0wO95ad9tlP9ug9OBiXNv7Lu9TG4Zk6l5jCZnpY69Uhe9Zsh81ffhz049l1jVJpNbwq8/nUAilWUXKRIDnUFMnHvD1nKVMqMLE+fPYKAzSMFEwe9x4f1+Tahjfr9fs/0/AwVbI3a6C26nQ6hjdjsduHz6RxzkC9E9nqjsbkYS0xgan4KeL9hCpgtaGJd7up55v7e9Be4vHLY4RmawbQb25dy89wDvjCVsc+L0fAFD41MVy01upwN+j4tdpGjMZB/Z8rgmTa4cG+rrKBghFIxQMELBCHkujvx+sA6fF5dOHofW5sNivoCZ7GNc/eo2MrnlQ22LgknAQGcQf9m0ibAkSSPOngjiN59O4PoeFqKtbItdpAT4Pa4KITazl6UbK9uiYJKw045Ut9OBi9rxA2+LgklCqMm7q8x00G1RMEnQ8ys7/kxDvePA26JgkjDzcOflo9Hk/QNvi4JJwp8S09tOH2RyS0ik5g+8LQomTRdZwKkPPjcVI5Nb2vJ71W5LNo70PFgmt4TvDX2Es51BhHyNcNc7MP3wEf6WnN3z1h4r26JgkjGanLXs7h4r22IXSQgFIxSMUDBCKNja1Vw53a0+Wx7rQOf3K95bfLIi1fl4QUbB9HzhmfsitbZm3Bh8DSP/mrHFMbqdDlw8GarYYZHJLdn2BhUKtomRxHTFPYd97a3oa2+19XHLuGdMyjHYTks3ds28Mq5XSinYdks3dpVL1uUkaa8i10+a3bud0eSs1GuVUtcHW8fvcSHU5EWHr9FW/wBf3nsg/TrlkRCMsIskFIwQCkYoGKFghFiEdEtFIV8jOnxeIY99Mb8i3XqkFIKV7pwO44IWFq74rxmlZaNZXE/eF34CVvh5sA6fF58N9kpZ+yGTW8Kbf/0HZh4+5hjssOSaOHdG2sIifo8LX50/s6vSBBSsCsH/bLBXii5xp+7/xq9+IuznFHYMNtAZNM1ck3NZ3LyXwqKAa3wNTgcuaccrPpff48IFLYyh8SmOwQ6Kb2KDFSfi6viUkCehnFhPV8WGST1fwHd+92d2kQczFeE13W4sg1wAtnxIQ8hGu0GkFsx/rLLWlmzPz/7i3oPKixoBB/tCCtZgMuCVbV/VoiSfh0tFhIIRCkaIPIKZjU9kK7Jr9nnM7lqnYFXAbG0uIJlgoabKKQkRywpIk8E0m9af2C8Bk1UKEbfxCCmYni/gTlmw/R6XNIvefo+r4ha7mayYOyqEHeSbPS32rEm1GhGJne6qeE/UKtXCCnbzbqrivYsSbDj0e1zoNnnuuKh1X4UVLJHKmq7X3Rh8TWjBfv/TkxVd/eRcVtht1ELPg101WdzW2pordiKIwuWeLtMSUyJX3RFaMLMsBphvd7F95urXEDM5ZtHLogs/k//mR/80vTEi1tOFb2Jv2f7KssPnRfK3vzB9JGAmt4Sr47eFPj9SFD/paPJi4vyZLQf4o/+etd2jjf0eF2KnuzBwImj6fT1fwIk//J13FYkiGQAk5uZxPTl7aGWT3E4HettbMPDDIDSTK8XNcp364HPcyT4W/rxIVb7J73Ht+i6jxNw8JlNZJFJZ3Mk+qopwfo8LIV8jQk1eaK2+baXa3C3KVJBOuvpgbqcDsZ6uHR9zbJY11kXL5JahPykgs7C0dtKXt/xbDc66kkzHXHDXO9a2NnvxXY9rz3NyI4lpDI1PSbV5UtoCdH6PC7GeLgx0Bm1/rJNzWQyN30bCZHWCggkiWt8rLbaa5dfzBYwmZ3HzbkpKsY6MYJvpe6UFve2t6G5tPpTpCz1fwJd3H+B68j7uPHx8JJ4jeWRrtHY0eRHwuKC1NSPU1IiGtbGTVWRyy5jJPkJmoVQtJzE3j8zC0XvqLYsAl3epx17a2E1a/rrVVR9Q2qOWzi1hMV84kiJtBZ94Wy7MwvJTQSQeGx0UvOmDUDBCwQihYISCEQpGCAUjFIxQMEIoGKFghIIRQsEIBSOEghEKRigYIRSMUDBCwQihYMSOghmAzjCQKqGrANKMA6kGBpBWFaM4w1CQaqAYxrRqAF8zFKQ6GcyYVFeBMY7DSDVYBcZUxKM6jOInDAexNn0ZHyMe1VUAqAHijAixEhXGe6VXAE/i0bRhFK8xLMSasVfx2pN4NL0h2Fp/eQWcsiDPT3p1OBp5msnWiUd11Si+SsnI88i15hAqBXvaVb5Oych+5DKM4uvrXeM6itlP1keGA0VFvQUgwLiR3Waucrm2FGyd2shwXFHUtxk/st2A/kUDV/R41HQuVdmpgfrIcKAIXIGi/pLhJCWpoKtG8RMFiJtlrT0Jto47Muz+H9CvAD82FCUEKAEFcDPcR0MowEgrBqYNGJMvAmNbZaxy/g/gnmrRS4hOdQAAAABJRU5ErkJggg==',
            botAvatarInitials: 'BOT',
            userAvatarImage: 'https://content.powerapps.com/resource/makerx/static/media/user.336bbce3.svg',
            userAvatarInitials: 'USER',
            hideUploadButton: true,
            primaryFont: fontFamily(['Segoe UI', 'Segoe WP', 'Segoe', 'device-segoe', 'Tahoma', 'Helvetica', 'Arial', 'sans-serif']),
        };

        // Specifies the token endpoint URL.
        // To get this value, visit Copilot Studio > Settings > Channels > Mobile app page.
        const tokenEndpointURL = new URL('https://b838e0443024ea32b2f47862b85e99.03.environment.api.powerplatform.com/powervirtualagents/botsbyschema/cr74e_customerCopilot/directline/token?api-version=2022-03-01-preview');

        const locale = document.documentElement.lang || 'en'; // Uses language specified in <html> element and fallback to English (United States).

        const apiVersion = tokenEndpointURL.searchParams.get('api-version');

        const [directLineURL, token] = await Promise.all([
            fetch(new URL(`/powervirtualagents/regionalchannelsettings?api-version=${apiVersion}`, tokenEndpointURL))
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to retrieve regional channel settings.');
                    }

                    return response.json();
                })
                .then(({ channelUrlsById: { directline } }) => directline),
            fetch(tokenEndpointURL)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to retrieve Direct Line token.');
                    }

                    return response.json();
                })
                .then(({ token }) => token)
        ]);

        const directLine = WebChat.createDirectLine({ domain: new URL('v3/directline', directLineURL), token });

        // Sends "startConversation" event when the connection is established.
        const subscription = directLine.connectionStatus$.subscribe({
            next(value) {
                if (value === 2) {
                    directLine
                        .postActivity({
                            localTimezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                            locale,
                            name: 'startConversation',
                            type: 'event',
                            // https://www.dynamicsforcrm.com/pass-parameters-to-copilot-studio-bot-from-calling-site/
                            value: {
                                Customer_No:no, 
                                Customer_City:city, 
                                Customer_Name:name, 
                                Customer_Blocked:blocked
                            }
                        })
                        .subscribe();

                    // Only send the event once, unsubscribe after the event is sent.
                    subscription.unsubscribe();
                }
            }
        });

        WebChat.renderWebChat({ directLine, locale, styleOptions }, __div);


        Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("ControlReady");

    })();

}

function fontFamily(fonts) {
    return fonts.map(font => `'${font}'`).join(', ');
}
```

## CustomerCopilotStyles.css

```text
* {
    font-size: 10.5pt
}
```

---

## customerpostinggroup

**Source file:** `customerpostinggroup.md`

---
title: "Customer Posting Group"
description: "Which accounts receivable account?"
date: "2023-12-14"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "customerpostinggroup"
image: "/assets/images/posts-meta.svg"
---



A Customer Posting Group is used to define which accounts receivable general ledger account to use when selling goods to a Customer.

Customer Posting Groups are maintained using the Customer Posting Groups page.

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.30.52-am-1836x800.png)
*I used search to navigate to the Customer page. I used + New to create a new Customer*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.34.14-am-1836x801.png)
*I entered Customer details*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.36.16-am-1836x805.png)
*I reviewed the Invoicing tab for the new Customer*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.37.28-am-1836x808.png)
*I clicked the + New link*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.40.51-am-1836x814.png)
*I added code DOMESTIC and set Receivables Account to 15110 (Account Receivable, Domestic)*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.43.39-am-1836x806.png)
*Customer Posting Group is set to DOMESTIC*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.46.28-am-1836x808.png)
*I used search to navigate to the General Journal page*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-8.57.33-am-1836x1021.png)
*I selected Customer Alpine Ski House*

![](/assets/images/customerpostinggroup/screen-shot-2023-12-12-at-12.05.28-pm-1536x426.png)
*I clicked the Preview Posting button*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-9.00.43-am-1836x590.png)
*The preview showed 8 General Ledger entries, 1 Customer Ledger entry and 1 Detailed Customer Ledger entry*

![](/assets/images/customerpostinggroup/screenshot-2023-12-14-at-9.01.37-am-1836x1018.png)
*The first general ledger entry relates to General Ledger account 15110 Accounts Receivable, Domestic (per the DOMESTIC Customer Posting Group).*

---

## customgpt

**Source file:** `customgpt.md`

---
title: "OpenAI"
description: "What are Custom GPTs?"
date: "2025-10-03"
categories: ["AI","Python"]
tags: []
slug: "customgpt"
image: "/assets/images/chatgpt-logo.svg"
---

In November 2023 OpenAI introduced "GPTs" - custom versions of ChatGPT that I could create for specific purposes without needing to code.

To get started, I needed a ChatGPT Plus subscription.

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.00.46 AM.png)
*I explored the prebuilt GPTs available*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.04.16 AM.png)
*I chose the recommended plan for Plus subscribers*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.05.44 AM.png)
*I entered my credit card details to upgrade*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.07.28 AM.png)
*I confirmed I can cancel at any time*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.08.16 AM.png)
*I clicked "Not now" to skip additional setup*

## How I Created My Research GPT

Here's how I built my custom GPT using the GPT Builder. I wanted to create something that could help me with B2B sales research for my SaaS ERP business.

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%209.51.06 AM.png)
*I selected the GPTs menu and clicked Create*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.08.53 AM.png)
*I clicked the Configure tab to start customizing*

## How I Crafted Effective Instructions

I spent a lot of time on the "Instructions" section in the Configure tab - this is crucial for getting high-quality results. For my company research GPT, I included directives like:

"Always structure your analysis to first cover the company's business model, then key financial indicators, recent strategic moves, and finally, potential risks."
"When presenting information, cite your sources where possible, especially when using web browsing."
"Ask me clarifying questions if you need more context to provide a more targeted analysis."

## My GPT Instructions

**Role:**
You are an expert B2B sales intelligence analyst specializing in SaaS and ERP solutions for medium-sized businesses. Your core function is to analyze company websites and provide detailed, actionable prospect research reports.

**Instruction:**
When provided with a company website URL, you must generate a comprehensive research report. The report should synthesize information to build a complete picture of the prospect and identify potential pain points my ERP can solve.

**Key Research Areas & Report Outline:**
Your report MUST be structured using the following sections:
1.  **Company Overview:** Summarize the company's primary business, industry, and core operations.
2.  **Business Model & Potential Pain Points:** Infer how the company likely operates and identify challenges a growing medium-sized business might face (e.g., disjointed systems, manual data entry, inventory management, inefficient financial reporting).
3.  **Stakeholder Mapping:** Suggest the most relevant job titles (e.g., CFO, COO, Head of Operations, IT Director) that would be involved in an ERP purchase decision:cite[3].
4.  **Personalized Outreach Angle:** Develop a "hook" for sales outreach. This could be based on a recent company achievement, an inferred operational challenge, or their stated mission:cite[6].
5.  **ERP Value Proposition:** Clearly articulate how a SaaS ERP system could address the identified pain points, focusing on benefits like operational efficiency, data-driven decision-making, and scalability.

**Guardrails (Rules of Engagement):**
- **Tone:** Always maintain a professional and analytical tone.
- **Sourcing:** Clearly state when information is inferred from the website's messaging versus being explicitly stated.
- **Honesty:** If there is insufficient information on the website to make a reasonable inference for a section, state this clearly rather than guessing.
- **Format:** Present the final report in a clear, well-structured format with distinct headings for each section.

**Specifics (My Context):**
- **My Product:** I sell a Software-as-a-Service (SaaS) Enterprise Resource Planning (ERP) product.
- **My Target Market:** I sell to medium-sized companies, which I define as having approximately $2 million in turnover.
- **My Goal:** To quickly understand a prospect's business and pain points to initiate a relevant and valuable sales conversation.

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.13.49 AM.png)
*I added the detailed set of instructions*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.18.34 AM.png)
*I entered a name and description for my GPT*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.19.17 AM.png)
*I selected "Anyone with the link" for sharing*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.19.42 AM.png)
*I copied the shareable link: https://chatgpt.com/g/g-68def7e5ca1081919fc1558d8fb84e6b-saas-erp-prospect-analyst*

## Will I Be Charged When Someone Uses My Custom GPT?

I was curious about the costs. I learned that I won't be charged if someone else uses my custom GPT that I shared via a link. The usage costs are covered by the subscription of the person using it, not me as the creator.

However, there's an important limitation: the person I share the link with must also be a ChatGPT Plus subscriber to use my custom GPT.

## What I Learned About Sharing Custom GPTs

Here's what I discovered about sharing and using custom GPTs:

| Aspect | What I Found |
| :--- | :--- |
| **Who Pays for Usage?** | The **user** accessing the GPT. I'm not charged for others' use. |
| **Who Can Use a Shared GPT?** | Only users with an active **ChatGPT Plus** subscription. |
| **Key Limitation** | I cannot share my GPT with users on the free plan; they will be prompted to upgrade. |

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.23.40 AM.png)
*I used the link to navigate to my custom GPT*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.23.58 AM.png)
*I tested my custom GPT with a simple prompt: "please provide a report for Sigma https://www.sigma-alimentos.com/en/"*

## My GPTs Conversation Starters

I added these conversation starters to make my GPT easier to use. You can add them directly to the "Conversation starters" field in the Configure tab of your GPT Builder.

1. **Core Analysis & Reporting**

"Analyze the company at [paste URL] and provide a full prospect report."

I use this for comprehensive analysis - it's my "one-click" option that triggers the full research process.

"Summarize the business model and key operations for [Company Name]."

This gives me a quicker overview when I just need high-level understanding.

2. **Identifying Pain Points & Opportunities**

"Based on their website, what are the top 3 potential operational pain points for [paste URL]?"

This helps me get direct insights for sales conversations.

"What signs of growth or scaling challenges can you infer from [paste URL]?"

This connects the prospect's situation to the value of my scalable SaaS ERP.

3. **Stakeholder Mapping & Outreach Strategy**

"Who are the likely decision-makers for an ERP at [paste URL]? Map the stakeholders."

This focuses on the crucial "who" of the sales process.

"Create a personalized outreach hook for [Company Name] based on their recent news/mission."

This generates personalized content for my first outreach.

4. **Technical & Qualification Check**

"What does the tech stack/careers page at [paste URL] suggest about their IT maturity?"

This helps me gauge integration difficulty and technical priorities.

💡 **How I Added Them to My GPT**

I went to the GPT Builder and selected my "SaaS ERP Prospect Analyst" GPT.
I clicked on the Configure tab.
I scrolled down to the Conversation starters section.
I pasted the most useful starters from my list.
I clicked Save.

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%208.59.29 AM.png)
*I added a few conversation starters*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%2010.00.04 AM.png)
*I used the link to access my custom GPT and selected a conversation starter*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%2010.01.11 AM.png)
*I entered a prospect website address (URL)*

![](/assets/images/customgpt/Screenshot%202025-10-03%20at%2010.01.58 AM.png)
*I reviewed the generated report*

## Alternative Paths for Broader Sharing

If you need to share your custom GPT with users who don't have ChatGPT Plus, the built-in sharing won't work. I found that community discussions suggest using the OpenAI API to rebuild your GPT's functionality as an AI Assistant. You would host it on your own server and pay for usage through your API account, making it accessible to anyone.

This approach requires more technical work and shifts costs to you as the developer, but removes the subscription barrier.

## References

- [Does publicly sharing a GPTs incur additional charges?](https://community.openai.com/t/does-publicly-sharing-a-gpts-incur-additional-charges/492150)


---

## customizedefaultcanvas

**Source file:** `customizedefaultcanvas.md`

---
title: "Copilot Studio"
description: "Customize the look and feel of the bot default canvas"
date: "2024-03-11"
categories: []
tags: []
slug: "customizedefaultcanvas"
image: "/assets/images/office-365-icon-500x500.png"
---



I updated an HTML page hosting my Blog Copilot adding "styleOptions"

![](/assets/images/customizedefaultcanvas/screenshot-2024-03-11-at-6.16.10-pm-1536x893.png)
*I copied the Token Endpoint*

![](/assets/images/customizedefaultcanvas/screenshot-2024-03-11-at-7.03.22-pm-1536x890.png)
*I used https://www.w3schools.com/html/tryit.asp?filename=tryhtml_default to test the html*

![](/assets/images/customizedefaultcanvas/screenshot-2024-03-11-at-7.04.53-pm-1536x721.png)
*I pasted the "Token Endpoint" into the sample HTML*

![](/assets/images/customizedefaultcanvas/screenshot-2024-03-11-at-7.39.06-pm-1536x709.png)
*I updated styleOptions*

---

## customtvirtualtables

**Source file:** `customtvirtualtables.md`

---
title: "Custom Virtual Tables"
description: "Customer Content Virtual Tables"
date: "2024-05-07"
categories: ["Power Platform","AI","Microsoft Dynamics","Business Central"]
tags: []
slug: "customtvirtualtables"
image: "/assets/images/office-365-icon-500x500.png"
---



I created two related Business Central tables and connected to them as Power Platform Dataverse Virtual Tables.

![](/assets/images/customtvirtualtables/screenshot-2024-05-07-at-6.07.14pm-1836x923.png)
*The Car Brand table can be edited using the Car Brand List page*

![](/assets/images/customtvirtualtables/screenshot-2024-05-07-at-6.07.45pm-1836x921.png)
*The Car Model table can be edited using the Car Model List page*

![](/assets/images/customtvirtualtables/screenshot-2024-05-07-at-6.09.07pm-1836x1059.png)
*The Car Brand and Car Model tables are shown in the Available Tables list*

![](/assets/images/customtvirtualtables/screenshot-2024-05-07-at-6.09.51pm-1836x1063.png)
*The contents of the Car Brands table can be viewed using a Model Driven App View*

![](/assets/images/customtvirtualtables/screenshot-2024-05-07-at-6.10.02pm-1836x1064.png)
*The contents of the Car Models table can be viewed using a Model Driven App View*

![](/assets/images/customtvirtualtables/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*A Car Model record can be updated using a Model Driven App Form*


## Car.al

```text
table 50200 "Car Brand"
{
    DataClassification = CustomerContent;
    Caption = 'Car Brand';

    fields
    {
        field(1; Name; Text[100])
        {
            Caption = 'Name';
        }
        field(2; Description; Text[100])
        {
            Caption = 'Description';
        }
        field(3; "Country"; Text[100])
        {
            Caption = 'Country';
        }
    }

    keys
    {
        key(PK; Name)
        {
            Clustered = true;
        }
    }
}
table 50201 "Car Model"
{
    DataClassification = CustomerContent;
    Caption = 'Car Model';

    fields
    {
        field(1; Name; Text[100])
        {
            Caption = 'Name';
        }
        field(2; Description; Text[100])
        {
            Caption = 'Description';
        }
        field(3; "Brand Id"; Guid)
        {
            TableRelation = "Car Brand".SystemId;
            // https://yzhums.com/22220/
            ValidateTableRelation = false;
            Caption = 'Brand Id';
        }
        field(4; Power; Integer)
        {
            Caption = 'Power (cc)';
        }
        field(5; "Fuel Type"; Enum "Fuel Type")
        {
            Caption = 'Fuel Type';
        }
    }

    keys
    {
        key(PK; Name, "Brand Id")
        {
            Clustered = true;
        }
    }
}
enum 50200 "Fuel Type"
{
    Extensible = true;
    value(0; Petrol)
    {
        Caption = 'Petrol';
    }
    value(1; Diesel)
    {
        Caption = 'Diesel';
    }
    value(2; Electric)
    {
        Caption = 'Electric';
    }
}
page 50200 "API Car Brand"
{
    PageType = API;

    APIVersion = 'v1.0';
    APIPublisher = 'bctech';
    APIGroup = 'demo';

    EntityCaption = 'Car Brand';
    EntitySetCaption = 'Car Brands';
    EntityName = 'carBrand';
    EntitySetName = 'carBrands';

    ODataKeyFields = SystemId;
    SourceTable = "Car Brand";

    Extensible = false;
    DelayedInsert = true;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }

                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(country; Rec.Country)
                {
                    Caption = 'Country';
                }
            }

            part(carModels; "API Car Model")
            {
                Caption = 'Car Models';
                Multiplicity = ZeroOrOne;
                EntityName = 'carModel';
                EntitySetName = 'carModels';
                SubPageLink = "Brand Id" = Field(SystemId);
            }
        }
    }
}
page 50201 "API Car Model"
{
    PageType = API;

    APIVersion = 'v1.0';
    APIPublisher = 'bctech';
    APIGroup = 'demo';

    EntityCaption = 'Car Model';
    EntitySetCaption = 'Car Models';
    EntityName = 'carModel';
    EntitySetName = 'carModels';

    ODataKeyFields = SystemId;
    SourceTable = "Car Model";

    Extensible = false;
    DelayedInsert = true;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }
                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(brandId; Rec."Brand Id")
                {
                    Caption = 'Brand Id';
                }
                field(power; Rec.Power)
                {
                    Caption = 'Power';
                }
                field(fuelType; Rec."Fuel Type")
                {
                    Caption = 'Fuel Type';
                }
            }
        }
    }
}
permissionset 50200 "Car Brand"
{
    permissions =
        tabledata "Car Brand" = RIMD,
        page "API Car Brand" = X;

}
permissionset 50201 "Car Model"
{
    permissions =
        tabledata "Car Model" = RIMD,
        page "API Car Model" = X;

}


page 50210 "Car Brand List"
{
    PageType = List;
    SourceTable = "Car Brand";
    ApplicationArea = All;
    UsageCategory = Lists;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }

                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(country; Rec.Country)
                {
                    Caption = 'Country';
                }
            }




        }
    }
}
page 50211 "Car Model List"
{
    PageType = List;
    SourceTable = "Car Model";
    ApplicationArea = All;
    UsageCategory = Lists;

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(id; Rec.SystemId)
                {
                    Caption = 'Id';
                    Editable = false;
                }
                field(name; Rec.Name)
                {
                    Caption = 'Name';
                }
                field(description; Rec.Description)
                {
                    Caption = 'Description';
                }
                field(brandId; Rec."Brand Id")
                {
                    Caption = 'Brand Id';
                }
                field(power; Rec.Power)
                {
                    Caption = 'Power';
                }
                field(fuelType; Rec."Fuel Type")
                {
                    Caption = 'Fuel Type';
                }
            }
        }
    }
}
```

---

## dataverseadvancedreportssetup

**Source file:** `dataverseadvancedreportssetup.md`

---
title: "Microsoft Dataverse Advanced Reports Setup"
description: "Microsoft Dataverse Advanced Reports Setup"
date: "2024-08-10"
categories: ["SQL","Microsoft Dynamics","Power Platform"]
tags: []
slug: "dataverseadvancedreportssetup"
image: "/assets/images/office-365-icon-500x500.png"
---


The **Visual Studio shell** used to create Reporting Services reports has been released under various names, including SQL Server Data Tools (SSDT).

![](/assets/images/dataverseadvancedreportssetup/ssrs-1-512x243.png)
*Previous releases of SQL Server Data Tools (SSDT) - SQL Server Data Tools (SSDT) | Microsoft Learnhttps://go.microsoft.com/fwlink/?linkid=2132817*

![](/assets/images/dataverseadvancedreportssetup/ssrs-1a-512x123.png)
*I downloaded the Disk Image File*

![](/assets/images/dataverseadvancedreportssetup/ssrs-2-512x128.png)
*I opened the Disk Image File and ran SSDTSetup*

![](/assets/images/dataverseadvancedreportssetup/ssrs-3-512x357.png)
*I selected the SQL Server Reporting Services checkbox and clicked the Next button*

![](/assets/images/dataverseadvancedreportssetup/ssrs-4-512x353.png)
*I agreed to the license terms*

![](/assets/images/dataverseadvancedreportssetup/ssrs-5-512x352.png)
*Visual Studio 2015 Shell was installed*

![](/assets/images/dataverseadvancedreportssetup/ssrs-6-512x359.png)
*Setup was successful*

![](/assets/images/dataverseadvancedreportssetup/ssrs-7-512x271.png)
*I clicked the New Project... link*

![](/assets/images/dataverseadvancedreportssetup/ssrs-8-512x271.png)
*I selected the Project Server Report option*

![](/assets/images/dataverseadvancedreportssetup/ssrs-9-512x123.png)
*I right clicked on the Reports folder and selected the Add New Report menu item*

![](/assets/images/dataverseadvancedreportssetup/ssrs-10-512x273.png)
*I clicked the Next button*

![](/assets/images/dataverseadvancedreportssetup/ssrs-11-512x271.png)
*Microsoft Dynamics was not shown as a data source type*

![](/assets/images/dataverseadvancedreportssetup/ssrs-12-512x46.png)
*Install the Report Authoring Extension for Dynamics 365 Customer Engagement (on-premises) | Microsoft LearnDownload Dynamics 365, version 9.0 Report Authoring Extension (with SQL Server Data Tools support) from Official Microsoft Download Center*

![](/assets/images/dataverseadvancedreportssetup/ssrs-13-512x270.png)
*I installed the Microsoft Dynamics 365 Report Authoring Extension*

![](/assets/images/dataverseadvancedreportssetup/ssrs-14-512x387.png)
*I accepted the license agreement*

![](/assets/images/dataverseadvancedreportssetup/ssrs-15-512x391.png)
*I installed Microsoft Application Error Reporting*

![](/assets/images/dataverseadvancedreportssetup/ssrs-16-512x391.png)
*I clicked the Next button*

![](/assets/images/dataverseadvancedreportssetup/ssrs-17-512x458.png)
*I clicked the Next button*

![](/assets/images/dataverseadvancedreportssetup/ssrs-18-512x455.png)
*I clicked the Next button*

![](/assets/images/dataverseadvancedreportssetup/ssrs-19-512x451.png)
*I clicked the Finish button*

![](/assets/images/dataverseadvancedreportssetup/ssrs-20-512x130.png)
*I right clicked on the Reports folder and selected the Add New Report menu item (again)*

![](/assets/images/dataverseadvancedreportssetup/ssrs-21-512x273.png)
*Microsoft Dynamics 365 FetchXML was the default data source typeI entered my https://XXX.crm.dynamics.com URL into the Connection string box and clicked the Next button*

---

## dataversefetchxml

**Source file:** `dataversefetchxml.md`

---
title: "Microsoft Dataverse FetchXML"
description: "Microsoft Dataverse FetchXML"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/dataversefetchxml/hero.png"
tags: ["sql","ml"]
hidden: true
slug: "dataversefetchxml"
---


The **Visual Studio shell** used to create Reporting Services reports has been released under various names, including SQL Server Data Tools (SSDT).

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*

![](/assets/images/dataversefetchxml/screenshot-2024-05-07-at-6.10.15pm-1836x1062.png)
*<<COMMENT>>*


---

## dataversereports

**Source file:** `dataversereports.md`

---
title: "Microsoft Dataverse Reports"
description: "Creating a Dataverse Report"
date: "2024-07-19"
categories: ["Power Platform"]
tags: []
slug: "dataversereports"
image: "/assets/images/office-365-icon-500x500.png"
---



![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.39.25am-2136x1101.png)
*I created a Reports solution*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.39.51am-2136x708.png)
*I added a Report*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.41.02am-2136x620.png)
*I clicked the Report Wizard button*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.41.11am-2136x1030.png)
*I selected the Start a new report option*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.41.30am-2136x976.png)
*I selected the Currencies table*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.41.45am-2136x984.png)
*I clicked the Clear button*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.41.56am-2136x992.png)
*I clicked the Next button*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.42.08am-2136x966.png)
*I clicked the Click here to add a column link*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.42.36am-2136x955.png)
*I selected the Currency Name column*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.42.58am-2136x998.png)
*I added the Currency Symbol and Exchange Rate columns*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.43.06am-2136x979.png)
*I selected the Table only option*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.43.13am-2136x1001.png)
*I clicked the Next button*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.43.26am-2136x953.png)
*I clicked the Finish button*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.43.34am-2136x244.png)
*I clicked the Run Report button*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.43.46am-2136x693.png)
*I reviewed the report*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.44.00am-2136x770.png)
*I clicked the Done button*

![](/assets/images/dataversereports/screenshot-2024-07-19-at-10.44.13am-2136x567.png)
*The Currencies report had been added to the Reports solution*

---

## devopsstarterazuredevops

**Source file:** `devopsstarterazuredevops.md`

---
title: "DevOps Starter Azure DevOps"
description: "Everything you need for developing, deploying, and monitoring your application."
date: "2021-04-26"
categories: ["DevOps","Azure","JavaScript"]
tags: []
slug: "devopsstarterazuredevops"
image: "/assets/images/svgexport-22.svg"
---



DevOps Starter makes it easy to get started on Azure using either GitHub actions or Azure DevOps

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.13.17-pm-810x140.png)
*Click "here" to switch between GitHub actions and Azure DevOps*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.14.02-pm-1836x1035.png)
*Select Azure DevOps and Node*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.14.37-pm-1836x1035.png)
*Select Express*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.14.54-pm-1836x1033.png)
*Select Web App for Containers or Windows Web App*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.16.07-pm-1836x1030.png)
*Web App on Windows can be used with Pricing tier "F1 Free"*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.27.04-pm-1836x1032.png)
*Azure resources have been deployed*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.27.50-pm-1836x988.png)
*Continuous integration and Continuous delivery pipeline has completed*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.29.05-pm-1836x993.png)
*Click Clone to edit code*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.31.23-pm-1200x386.png)
*Open Visual Studio Code*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.41.06-pm-1836x1081.png)
*Make update... add an extra description line.*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.42.19-pm-1836x1084.png)
*Push changes to Azure git*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.42.44-pm-1836x989.png)
*New commit was successful*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.45.48-pm-1836x985.png)
*Pipeline is running*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.48.20-pm-1836x989.png)
*Pipeline has completed*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.49.29-pm-1836x986.png)
*Updated code has been deployed to production*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-5.58.49-pm-1836x1419.png)
*View or edit pipeline*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-6.23.50-pm-1836x1002.png)
*Node.js tool installer View YAML*

![](/assets/images/devopsstarterazuredevops/screen-shot-2021-04-26-at-6.28.57-pm-1836x1007.png)
*Agent job 1 View YAML*


## Agent job 1

```yaml
pool:
  name: Azure Pipelines
steps:
- task: NodeTool@0
  displayName: 'Use Node version'
  inputs:
    versionSpec: 8.4

- task: Npm@0
  displayName: 'Install application dependencies'
  inputs:
    cwd: Application
    arguments: '--force'

- task: Npm@0
  displayName: 'Install test dependencies'
  inputs:
    cwd: Tests
    arguments: '--force'

- task: gulp@0
  displayName: 'Run unit tests'
  inputs:
    gulpFile: Tests/gulpfile.js
    targets: unittest
    gulpjs: 'Tests/node_modules/gulp/bin/gulp.js'
    publishJUnitResults: true

- task: ArchiveFiles@2
  displayName: 'Archive application'
  inputs:
    rootFolderOrFile: '$(System.DefaultWorkingDirectory)/Application'
    includeRootFolder: false
    archiveFile: '$(Build.ArtifactStagingDirectory)/Application$(Build.BuildId).zip'

- task: ArchiveFiles@2
  displayName: 'Archive tests'
  inputs:
    rootFolderOrFile: '$(System.DefaultWorkingDirectory)/Tests'
    includeRootFolder: false
    archiveFile: '$(Build.ArtifactStagingDirectory)/Tests$(Build.BuildId).zip'

- task: CopyFiles@2
  displayName: 'Copy ARM templates'
  inputs:
    SourceFolder: armTemplates
    TargetFolder: '$(build.artifactstagingdirectory)'

- task: PublishBuildArtifacts@1
  displayName: 'Publish Artifact: drop'
```
## References

- [DevOps Starter](https://docs.microsoft.com/en-us/azure/devops-project/overview)

---

## devopsstartergithubactions

**Source file:** `devopsstartergithubactions.md`

---
title: "DevOps Starter GitHub actions"
description: "Everything you need for developing, deploying, and monitoring your application."
date: "2021-04-25"
categories: ["JavaScript","DevOps","Azure"]
tags: []
slug: "devopsstartergithubactions"
image: "/assets/images/svgexport-22.svg"
---



DevOps Starter makes it easy to get started on Azure using either GitHub actions or Azure DevOps

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.22.36-pm-1836x1028.png)
*Select "DevOps Starter" in Azure Portal*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.23.43-pm-1836x1035.png)
*Create a Node app*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.23.55-pm-1836x1033.png)
*Select Express*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.24.23-pm-1836x1035.png)
*Select Web App for Containers or Windows Web App (free $)*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.24.40-pm-1836x1032.png)
*Enter GitHub credentials*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.25.26-pm-1836x1033.png)
*Select pricing tier "F1 Free"*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.26.05-pm-1836x1033.png)
*Deployment to Azure in progress*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.28.02-pm-1836x1030.png)
*GitHub Actions workflow runs Unit Tests*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.28.44-pm-1836x1031.png)
*If Unit Tests pass deploy Node app to Azure*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.31.15-pm-1836x1030.png)
*Once deployed to Azure run Functional Tests (Selenium)*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.34.39-pm-1836x1036.png)
*GitHub Actions workflow complete*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.35.19-pm-1836x1033.png)
*Summary of Azure resources*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.35.37-pm-1836x1031.png)
*Navigate to production URL*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.39.39-pm-1836x1031.png)
*To add Factorial API... Open with GitHub Desktop*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.39.56-pm-1012x630.png)
*Clone repository*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-3.40.46-pm-1836x1254.png)
*Open in Visual Studio Code*


## Run the updated app locally

$ cd Application

$ npm install haddley-factorial-cc
or
$ npm install haddley-factorial-js

$ npm install
$ npm run start

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-4.10.02-pm-1836x1033.png)
*Updated code returns factorial of 9*


## Run the unit tests locally

$ cd ../Tests
$ npm install
$ gulp unittest

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-4.13.54-pm-1836x1079.png)
*Updated Unit Tests*


## Run the functional tests locally

$ xattr -d com.apple.quarantine chromedriver

$ npm run start&
$ cd ../Tests
$ gulp functionaltest --webAppUrl http://localhost:3000/

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-4.50.40-pm-1836x1087.png)
*Functional tests*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-4.08.12-pm-1836x1259.png)
*Push updates to GitHub... origin master*

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-5.05.24-pm-1836x1027.png)
*GitHub Actions workflow runs again*


## Test factorial API in production

[https://haddley-factorial-api.azurewebsites.net/factorial/9](https://haddley-factorial-api.azurewebsites.net/factorial/9)

![](/assets/images/devopsstartergithubactions/screen-shot-2021-04-26-at-5.06.36-pm-1836x1034.png)
*Factorial API running in production*


## devops-starter-workflow.yaml

```yaml
name: Build and Deploy node Express app to azure
on:
  push:
    branches:
      - master

env:
  AZURE_WEBAPP_NAME: "haddley-factorial-api"    # set this to your application's name
  AZURE_WEBAPP_PACKAGE_PATH: "Application"      # set this to the path to your web app project, defaults to the repository root
  NODE_VERSION: '8.11.1'                        # set this to the node version to use
  RESOURCEGROUPNAME: "haddley-factorial-api-rg"
  LOCATION: "South Central US"
  HOSTINGPLANNAME: "haddley-factorial-api-plan"
  APPINSIGHTLOCATION: "South Central US"
  SKU: "F1 Free"

jobs:
  build:
    name: Build and Run tests
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2

    - name: Use Node.js ${{ env.NODE_VERSION }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ env.NODE_VERSION }}

    - name: npm install and build
      continue-on-error: false
      run: |
        cd Application
        npm install
        npm run build --if-present

    - name: Run unit tests
      continue-on-error: false
      run: |
        cd Tests
        npm install
        gulp unittest

    - name: Creating artifact directories
      run: |
        mkdir buildartifacts
        mkdir deploymenttemplates

    # Archive build artifact
    - name: Archive Application
      run: |
        zip -qq -r ./buildartifacts/Application.zip ./Application

    # Uploading application to build artifact
    - name: Upload Application to Build Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: buildartifacts
        path: buildartifacts

    # Archive Arm templates
    - name: Archive ArmTemplates
      uses: montudor/action-zip@v0.1.0
      with:
        args: zip -qq -r ./deploymenttemplates/armtemplates.zip ./armTemplates

    # Uploading Arm Templates to artifacts
    - name: Upload Arm templates to Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: deploymenttemplates
        path: deploymenttemplates

  Deploy:
    name: Deploy to azure web app
    needs: build
    runs-on: ubuntu-latest
    steps:
    # Downloading build artifact
    - name: Download a Build Artifact
      uses: actions/download-artifact@v2
      continue-on-error: false
      with:
        name: buildartifacts
        path: buildartifacts

    # Uzipping build artifacts
    - name: unzipping build artifact
      run: |
        unzip -qq ./buildartifacts/Application.zip -d .

  # Downloading Arm Templates
    - name: Download an Arm template
      uses: actions/download-artifact@v2
      continue-on-error: false
      with:
        name: deploymenttemplates
        path: deploymenttemplates

    # Uzipping Arm template directory
    - name: unzipping arm artifact
      run: |
        unzip -qq ./deploymenttemplates/armtemplates.zip -d .

    # Login to azure
    - name: Login to Azure
      uses: azure/login@v1
      continue-on-error: false
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}

    # Deploy Arm template
    - name: Deploy ARM Template
      uses: azure/CLI@v1
      continue-on-error: false
      with:
        inlineScript: |
          az group create --name "${{ env.RESOURCEGROUPNAME }}" --location "${{ env.LOCATION }}"
          az deployment group create --resource-group "${{ env.RESOURCEGROUPNAME }}" --template-file ./armTemplates/windows-webapp-template.json --parameters webAppName="${{ env.AZURE_WEBAPP_NAME }}" hostingPlanName="${{ env.HOSTINGPLANNAME }}" appInsightsLocation="${{ env.APPINSIGHTLOCATION }}" sku="${{ env.SKU }}"

    # Deploy web app on azure
    - name: 'Deploy to Azure WebApp'
      uses: azure/webapps-deploy@v2
      with: 
        app-name: ${{ env.AZURE_WEBAPP_NAME }}
        package: ${{ env.AZURE_WEBAPP_PACKAGE_PATH }}

  # Job to run functional tests
  FunctionalTests:
    name: Run Functional tests
    runs-on: windows-latest
    needs: Deploy
    steps:
    - uses: actions/checkout@v2

    - name: Use Node.js ${{ env.NODE_VERSION }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ env.NODE_VERSION }}

    # Run functional tests
    - name: Run Functional Tests
      continue-on-error: false
      run: |
        cd Application
        npm install
        cd ../Tests
        npm install
        gulp functionaltest --webAppUrl https://${{ env.AZURE_WEBAPP_NAME }}.azurewebsites.net/
```

## routesindex.js

```text
'use strict';
var express = require('express');
var router = express.Router();
// var factorial = require('haddley-factorial-cc');
var factorial = require('haddley-factorial-js');

/* GET home page. */
router.get('/', function (req, res) {
    res.render('index', { title: 'Express' });
});

router.get('/factorial/:n', (request, response) => {
    try {
        const n = Number(request.params.n);
        const result = factorial.factorial_it(n);
        response.json(result);
    }
    catch (err) {
        response.status(500).send(err);
    }
});

module.exports = router;
```

## unittestssampleUnitTests.js

```text
var assert = require('assert');
var app = require('../../Application/app');
var http = require('http');
 
describe('sampleUnitTests', function () {
    before(function () {
    });
  
    after(function () {
        app.close();
    });

    it('Should return 200', function (done) {
        http.get('http://localhost:3000', function (res) {
            assert.equal(200, res.statusCode, 'Result code should be 200.');
            done();
        });
    });

    it('Assert title', function (done) {
        http.get('http://localhost:3000', function (res) {
            assert.equal(200, res.statusCode, 'Result code should be 200.');
            var data = '';

            res.on('data', function (chunk) {
                data += chunk;
            });

            res.on('end', function () {
                assert.equal(true, data.includes('<title>Express - Node.js Express Application</title>'), 'Title should be Express - Node.js Express Application.');
                done();
            })
        });
    });


    it('Assert factorial 9', function (done) {
        http.get('http://localhost:3000/factorial/9', function (res) {
            assert.equal(200, res.statusCode, 'Result code should be 200.');
            var data = '';

            res.on('data', function (chunk) {
                data += chunk;
            });

            res.on('end', function () {
                assert.equal(true, data.includes('362880'));
                done();
            })
        });
    });

});
```
## References

- [DevOps Starter](https://docs.microsoft.com/en-us/azure/devops-project/overview)

---

## docker

**Source file:** `docker.md`

---
title: "Docker"
description: "Docker is an easy way to create, manage, and deliver applications."
date: "2021-02-06"
categories: ["DevOps"]
tags: []
slug: "docker"
image: "/assets/images/method-draw-image.svg"
---


Docker Hub is a cloud based repository that allows users to share container images. 

Software developers use container images to automate software testing and deployment tasks.

Software developers can use public repositories to share their work. 

[https://hub.docker.com/u/haddley](https://hub.docker.com/u/haddley)

![Docker Hub](/assets/images/docker/screen-shot-2021-02-06-at-4.11.46-pm.png)


## Docker playground

The Docker playground allows users to run container images in a "playground" environment.

[https://www.docker.com/play-with-docker](https://www.docker.com/play-with-docker).

![](/assets/images/docker/screen-shot-2021-02-09-at-8.55.45-am-994x793.png)
*Docker playground web site*


## Lab Environment

Complete a workshop without installing anything using this Docker playground

Navigate to [https://labs.play-with-docker.com](https://labs.play-with-docker.com)

**[verify your identity]**

Click the "**+ Add new instance**" button.

Then enter these two commands:

**$ docker pull haddley/blog**

**$ docker run -d -p 80:80 haddley/blog**

Click on the "**80**" button to connect to the running container image using http.

![](/assets/images/docker/screen-shot-2021-02-09-at-9.06.33-am-1408x921.png)
*Adding an instance*

![](/assets/images/docker/screen-shot-2021-02-09-at-9.07.07-am-1740x1133.png)
*Pulling the haddley/blog image*

![](/assets/images/docker/screen-shot-2021-02-09-at-9.07.47-am-1740x1143.png)
*Running the docker image*

![](/assets/images/docker/screen-shot-2021-02-09-at-9.08.11-am-1740x1137.png)
*Accessing the running image using a generated url and port 80*


## OS/ARCH

Docker images can be published using a single Operating System/Architecture or using multiple Operating System/Architectures.

Since the haddley/blog image has been published using multiple Operating System/Architectures an image can be pulled from Docker Hub and run on a Raspberry Pi computer.

[https://www.docker.com/blog/happy-pi-day-docker-raspberry-pi/](https://www.docker.com/blog/happy-pi-day-docker-raspberry-pi/)

**$ ssh pi@raspberrypi.local

$ sudo apt-get update && sudo apt-get upgrade**
**$ curl -fsSL get.docker.com -o get-docker.sh && sh get-docker.sh

$ docker pull haddley/blog
$ docker run -d -p 80:80 haddley/blog**

connect to the running container image using http by navigating to [http://rasberrypi.local](http://rasberrypi.local).

![](/assets/images/docker/screen-shot-2021-02-25-at-3.21.15-pm-1128x734.png)
*using ssh to logon to the raspberry pi*

![](/assets/images/docker/screen-shot-2021-02-25-at-3.25.41-pm-1124x732.png)
*Pulling the haddley/blog image from Docker Hub*

![](/assets/images/docker/screen-shot-2021-02-25-at-3.27.03-pm-1132x738.png)
*Running the container image*

![](/assets/images/docker/screen-shot-2021-02-25-at-3.19.21-pm-1622x972.png)
*Navigating to the Docker image running on the Raspberry Pi*

---

## dockerbuildx

**Source file:** `dockerbuildx.md`

---
title: "Docker Buildx"
description: "Build multi-platform Docker images."
date: "2021-03-01"
categories: ["DevOps","JavaScript"]
tags: []
slug: "dockerbuildx"
image: "/assets/images/method-draw-image.svg"
---


Buildx allows a developer to build for multiple architecture/operating systems.

When you invoke **docker buildx build**, you can set the --platform flag to specify the target platform for the build output, (for example, linux/amd64, linux/arm64, linux/arm/v7,linux/arm/v6, darwin/amd64).


## The Dockerfile

Visual Studio Code is able to add a Dockerfile to the graphql-server project automagically.

Open the Command Palette (⇧⌘P) and use the "Docker: Add Docker Files to Workspace..." command:

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.32.18-am-1536x944.png)
*Docker: Add Docker Files to Workspace...*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.32.36-am-1536x935.png)
*Application Platform is Node.js*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.32.53-am-1536x940.png)
*Select the project's package.json file*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.33.15-am-1536x940.png)
*Specify the port that the image will be listening to*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.33.38-am-1536x941.png)
*Don't add the Docker Compose file*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.34.54-am-1536x995.png)
*Build the Docker image*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.35.27-am-1536x992.png)
*Image built and uploaded to Docker Desktop*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.38.12-am-1536x883.png)
*New container based on the new image (port 5000)*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.38.28-am-1066x242.png)
*Container running*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.40.18-am-1536x833.png)
*Testing the image using Docker Desktop*


## Uploading to Dockerhub

**$ docker login --username=haddley**

**$ docker buildx build --platform linux/amd64,linux/arm64,linux/arm/v7,linux/arm/v6 --rm -t haddley/graphql-server:latest --push .**

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.48.59-am-1536x990.png)
*Build image for multiple Operating Systems/Processors*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.51.16-am-1536x835.png)
*Image has been uploaded to Docker Hub*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-8.06.23-am-1536x824.png)
*Multiple OS/ARCH*


## Docker playground

Add new instance.

**docker run -d -p 5000:5000 haddley/graphql-server**

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-7.58.19-am-1536x826.png)
*docker run -d -p 5000:5000 haddley/graphql-server*

![](/assets/images/dockerbuildx/screen-shot-2021-03-03-at-8.05.03-am-1536x827.png)
*Accessing the image running in the lab*


## Raspberry Pi

The docker image can be run on a Raspberry Pi.

![](/assets/images/dockerbuildx/screen-shot-2021-03-13-at-3.32.48-pm-1138x742.png)
*docker run the haddley/graphql-server image*

![](/assets/images/dockerbuildx/screen-shot-2021-03-13-at-3.35.52-pm-1636x1166.png)
*GraphiQL intellisense*

![](/assets/images/dockerbuildx/screen-shot-2021-03-13-at-3.36.12-pm-1638x1172.png)
*GraphQL service running on the Raspberry Pi*

---

## dotnet core part2 deleted

**Source file:** `dotnet core part2 deleted.md`

---
title: ".NET Core (Part 2 deleted)"
description: "Creating a VB.NET Web App using Microsoft's cross-platform framework."
date: "2025-09-20"
categories: [".NET"]
image: "/assets/images/dotnet-core-part2-deleted/hero.png"
tags: ["dotnet","c#","ai","git","asp.net"]
hidden: true
slug: "dotnet core part2 deleted"
---



I am able to develop ASP.NET Core applications with the VB.NET language. However, creating a VB.NET ASP.NET Core application is not support by the dotnet command line app.

$ dotnet new web -lang VB -o haddley-web (fails)

$ dotnet new web -lang C# -o haddley-web (works)

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.05.08-pm-1148x386.png)
*dotnet new web -lang VB -o haddley-web (fails)*

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.05.47-pm-1144x738.png)
*dotnet new web -lang C# -o haddley-web (works)*


## VB.NET console app

As a workaround I can generate a VB.NET console application project and convert it to a VB.NET Web App project.

$ dotnet new console -lang VB -o haddley-console
$ cd haddley-console
$ dotnet new gitignore
$ dotnet run

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.21.39-pm-1138x488.png)
*dotnet new console -lang VB -o haddley-console*

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.25.13-pm-1140x316.png)
*dotnet run (the generated console application)*

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.34.56-pm-1536x225.png)
*I updated the .vbproj file*

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.35.58-pm-1536x452.png)
*I updated the Program.vb code from"Console.WriteLine(...)"*

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.36.42-pm-1536x477.png)
*to "WebApplication.CreateBuilder(...)..."*

![](/assets/images/dotnet-core-part2-deleted/screen-shot-2023-03-15-at-2.38.17-pm-1476x522.png)
*dotnet run (the Web App)*
## References

- [How to create an ASP.NET Core Minimal API with Visual Basic .NET](https://swimburger.net/blog/dotnet/create-an-aspdotnet-core-minimal-api-with-vbdotnet)



---

## dotnet core part3

**Source file:** `dotnet core part3.md`

---
title: ".NET Core (Part 3)"
description: "Creating a Blazor App that calls Microsoft Graph."
date: "2025-09-20"
categories: [".NET"]
image: "/assets/images/dotnet-core-part3/hero.png"
tags: ["azure","dotnet","ai","ml","dynamics"]
hidden: true
slug: "dotnet core part3"
---


## Microsoft Graph

[Microsoft Graph](MicrosoftGraph.html) is a REST API that can be used to access: Microsoft 365, Azure Active Directory, Windows and Dynamics 365.

Microsoft Graph explorer is a developer tool that lets you learn about Microsoft Graph APIs.

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.20.07-am-1836x1069.png)
*Microsoft Graph Explorer*


## Blazor Server app

I wanted to create a Blazor Server app that would allow users to sign in using their M365/Azure Active Directory credentials.

I wanted the Blazor Server app to display the logged in user's name and their photograph.

I created an Azure application (app) registration.

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.29.54-am-1836x373.png)
*Azure Active Directory*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.30.45-am-1836x250.png)
*New registration*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.32.09-am-1836x667.png)
*Single tenant*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.33.46-am-1836x1018.png)
*redirect uri set to localhost...*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.34.43-am-1836x462.png)
*App registration created*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.37.11-am-1836x977.png)
*Update Authentication*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.38.08-am-1836x767.png)
*Add a client secret*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.38.43-am-1836x350.png)
*Secret will be valid for 180 days*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.38.57-am-1836x332.png)
*Copy the value*


## Blazor Server

Blazor is a web framework for building Razor components.

Razor components run server-side in ASP.NET Core.

(Razor components run client-side in the browser using WebAssembly)

A blazor server application can be generated using the dotnet command line tool.

**$ dotnet new blazorserver -o <project name>**

In this case I wanted to create a blazor server application that would authenticate users using Azure Active Directory (the App registration created above) and call Microsoft Graph to access the user's profile and the user's profile photograph.

**$CONTENT$nbsp;dotnet new blazorserver --auth SingleOrg --calls-graph -o haddley-blazor-graph --client-id "5df669b6-f661-473c-9f5d-100f792d16c7" --tenant-id "2788913d-04ad-47a2-ac42-4b02caa6a4be" --domain "p8lf.onmicrosoft.com" -f net7.0**

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.45.37-am-1664x496.png)
*dotnet new blazorserver ...*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.51.13-am-1836x948.png)
*dotnet run (navigate to localhost)*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.51.33-am-1836x942.png)
*The generated Blazor Server app (includes integration with Azure Active Directory and Microsoft Graph)*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.53.09-am-1836x1072.png)
*I copied the ClientSecret to appsettings.json*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.59.15-am-1836x1065.png)
*I am now able to login to the Blazor Server app using Azure Active Directory credentials*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-10.59.43-am-1836x1063.png)
*I provided the password*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.00.13-am-1836x1072.png)
*I skipped Multi factor authentication (for now)*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.00.24-am-1836x1066.png)
*Do I want to stay signed in?*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.00.39-am-1836x1067.png)
*I navigate to the Show profile page*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.01.51-am-1836x1073.png)
*/showprofile page*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.02.06-am-1836x567.png)
*Key move is call to injected GraphServiceClient (to access Microsoft Graph)*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.04.37-am-1836x998.png)
*I updated navigation...*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.05.55-am-1836x391.png)
*... to include a link to a /showphoto page*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.09.35-am-1836x737.png)
*The /showphoto page will need to make a "my photo" call to Microsoft Graph*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.43.49-am-1836x1023.png)
*I copied the "Me.Photo.Content" expression/path to the new /showphoto page.*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-11.44.08-am-1836x990.png)
*Show photo page running*


## Program.cs

Notice that the Blazor Server project includes a Program.cs file with contents similar what you would expect to see in a Model-View-Controller project.

A Blazor Server project and a Model-View-Controller project are both ASP.NET Core projects and it is possible to mix and match.

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-12.48.33-pm-1836x1077.png)
*Program.cs (part 1)*

![](/assets/images/dotnet-core-part3/screen-shot-2023-03-17-at-12.48.44-pm-1836x1040.png)
*Program.cs (part 2)*


## ShowPhoto.razor

```text
@page "/showphoto"

@using Microsoft.Identity.Web
@using Microsoft.Graph
@inject Microsoft.Graph.GraphServiceClient GraphServiceClient
@inject MicrosoftIdentityConsentAndConditionalAccessHandler ConsentHandler

<h1>My Photo</h1>

<p>This component demonstrates fetching data from a service.</p>

@if (imgDataURL == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <img src=@imgDataURL />
}

@code {
    String? imgDataURL;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            Stream photo = await GraphServiceClient.Me.Photo.Content.Request().GetAsync();

            if (photo != null)
            {
                MemoryStream ms = new MemoryStream();
                photo.CopyTo(ms);
                byte[] buffer = ms.ToArray();
                string result = Convert.ToBase64String(buffer);
                imgDataURL = string.Format("data:image/png;base64,{0}", result);
            }
            else
            {
                imgDataURL = "";
            }
        }
        catch (Exception ex)
        {
            ConsentHandler.HandleException(ex);
        }
    }
}
```

## Program.cs

```text
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.OpenIdConnect;
using Microsoft.Identity.Web;
using Microsoft.Identity.Web.UI;
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Components;
using Microsoft.AspNetCore.Components.Web;
using Microsoft.AspNetCore.Mvc.Authorization;
using Graph = Microsoft.Graph;
using haddley_blazor_graph.Data;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
var initialScopes = builder.Configuration["DownstreamApi:Scopes"]?.Split(' ');

builder.Services.AddAuthentication(OpenIdConnectDefaults.AuthenticationScheme)
    .AddMicrosoftIdentityWebApp(builder.Configuration.GetSection("AzureAd"))
        .EnableTokenAcquisitionToCallDownstreamApi(initialScopes)
            .AddMicrosoftGraph(builder.Configuration.GetSection("DownstreamApi"))
            .AddInMemoryTokenCaches();
builder.Services.AddControllersWithViews()
    .AddMicrosoftIdentityUI();

builder.Services.AddAuthorization(options =>
{
    // By default, all incoming requests will be authorized according to the default policy
    options.FallbackPolicy = options.DefaultPolicy;
});

builder.Services.AddRazorPages();
builder.Services.AddServerSideBlazor()
    .AddMicrosoftIdentityConsentHandler();
builder.Services.AddSingleton<WeatherForecastService>();

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
    app.UseHsts();
}

app.UseHttpsRedirection();

app.UseStaticFiles();

app.UseRouting();

app.MapControllers();
app.MapBlazorHub();
app.MapFallbackToPage("/_Host");

app.Run();
```
## References

- [Create a Blazor Server app that uses the Microsoft identity platform for authentication](https://learn.microsoft.com/en-us/azure/active-directory/develop/tutorial-blazor-server)



---

## dotnet-core-part1

**Source file:** `dotnet-core-part1.md`

---
title: ".NET Core (Part 1)"
description: "Creating a REST API Service using Microsoft cross-platform framework."
date: "2021-04-10"
categories: [".NET","DevOps"]
tags: []
slug: "dotnet-core-part1"
image: "/assets/images/net-logo.svg"
---



$ dotnet new webapi
$ dotnet new gitignore
$ dotnet run

![](/assets/images/dotnet-core-part1/screen-shot-2021-04-11-at-3.10.16-pm-1482x960.png)
*Example Controller*


## Creating a Book class

$ code .
Add Book class


## Books REST Controller

Add BooksController class


## dotnet run

$ dotnet run

![](/assets/images/dotnet-core-part1/screen-shot-2021-04-11-at-3.55.12-pm-1836x802.png)
*https://localhost:5001/books*

![](/assets/images/dotnet-core-part1/screen-shot-2021-04-06-at-11.19.46-am-1836x873.png)
*https://localhost:5001/books/1788395549*

![](/assets/images/dotnet-core-part1/screen-shot-2021-04-11-at-4.13.17-pm-1836x809.png)
*https://localhost:5001/books/1234567890*


## Swagger

Notice that by default Swagger is available.

![](/assets/images/dotnet-core-part1/screen-shot-2021-04-11-at-4.18.49-pm-1834x1328.png)
*https://localhost:5001/swagger/index.html*


## Startup

Support for Swagger is added in the project's Startup.cs file


## Static files

Static files can be added to a wwwroot folder in a Dotnet Core webapi project.

The static files can be image files, html files and javascript files.

To enable the static files add "app.UseStaticFiles();" to Startup.cs as shown below.

![](/assets/images/dotnet-core-part1/screen-shot-2021-04-11-at-4.33.18-pm-644x302.png)
*app.UseStaticFiles()*


## React client

The static files can be a React app that calls the REST API exposed by the (same) Dotnet Core project.

![](/assets/images/dotnet-core-part1/screen-shot-2021-04-11-at-4.45.21-pm-1836x1255.png)
*Running React/Dotnet Core app*


## haddley_power_app_api

The BooksController code can be extended to support POST, PUT and DELETE actions

![](/assets/images/dotnet-core-part1/screen-shot-2021-06-19-at-2.57.45-pm-1836x1178.png)
*haddley_power_app_api*


## Book.cs

```text
using System;

namespace dotnet_api
{
    public class Book
    {
        public Book(long id, String title)
        {
            this.id = id;
            this.title = title;
        }

        public long id { get; set; }

        public string title { get; set; }
    }
}
```

## BooksController.cs

```text
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;

namespace dotnet_api.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class BooksController : ControllerBase
    {
        private static readonly List<Book> books = new List<Book>()
        {
            (new Book(1788395549, "Learning Node.js Development")),
            (new Book(1788620216, "Hands-On Microservices with Node.js"))
        };

        private readonly ILogger<BooksController> _logger;

        public BooksController(ILogger<BooksController> logger)
        {
            _logger = logger;
        }

        [HttpGet]
        public IEnumerable<Book> GetBooks()
        {
            return books.ToArray();
        }

        [HttpGet("{id}")]
        public ActionResult<Book> GetBooks(long id)
        {
            Book book = books.Find(x => (x.id == id));
            if (book == null)
            {
                return NotFound("Book Not Found");
            }
            return book;
        }


    }
}
```

## Startup.cs

```text
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.HttpsPolicy;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Logging;
using Microsoft.OpenApi.Models;

namespace dotnet_api
{
    public class Startup
    {
        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        public IConfiguration Configuration { get; }

        // This method gets called by the runtime. Use this method to add services to the container.
        public void ConfigureServices(IServiceCollection services)
        {

            services.AddControllers();
            services.AddSwaggerGen(c =>
            {
                c.SwaggerDoc("v1", new OpenApiInfo { Title = "dotnet_api", Version = "v1" });
            });
        }

        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
                app.UseSwagger();
                app.UseSwaggerUI(c => c.SwaggerEndpoint("/swagger/v1/swagger.json", "dotnet_api v1"));
            }

            app.UseHttpsRedirection();

            app.UseRouting();

            app.UseAuthorization();

            app.UseEndpoints(endpoints =>
            {
                endpoints.MapControllers();
            });
        }
    }
}
```

## App.js

```text
import React, { useEffect, useState } from 'react';

function App() {

  const [books, setBooks] = useState([]);

  useEffect(() => {

    console.log("use effect");
    fetch('/books')
      .then(
        (d) => {
          d.json().then((b) => {
            setBooks(() => b)
          });
        }
      )

  }
    , [])

  return (

    <>
        {books.map(book =>
            <h4>{book.title}</h4>)}
    </>

  );
}

export default App;
```

## index.html

```text
<!DOCTYPE html>
<html lang="en">

<head>
	<title>React App</title>
</head>

<body>

	<noscript>You need to enable JavaScript to run this app.</noscript>
	<div id="root"></div>

	<script>!function (e) {function r(r) {for (var n, i, l = r[0], p = r[1], f = r[2], c = 0, s = []; c < l.length; c++)i = l[c], Object.prototype.hasOwnProperty.call(o, i) && o[i] && s.push(o[i][0]), o[i] = 0; for (n in p) Object.prototype.hasOwnProperty.call(p, n) && (e[n] = p[n]); for (a && a(r); s.length;)s.shift()(); return u.push.apply(u, f || []), t()} function t() {for (var e, r = 0; r < u.length; r++) {for (var t = u[r], n = !0, l = 1; l < t.length; l++) {var p = t[l]; 0 !== o[p] && (n = !1)} n && (u.splice(r--, 1), e = i(i.s = t[0]))} return e} var n = {}, o = {1: 0}, u = []; function i(r) {if (n[r]) return n[r].exports; var t = n[r] = {i: r, l: !1, exports: {}}; return e[r].call(t.exports, t, t.exports, i), t.l = !0, t.exports} i.m = e, i.c = n, i.d = function (e, r, t) {i.o(e, r) || Object.defineProperty(e, r, {enumerable: !0, get: t})}, i.r = function (e) {"undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {value: "Module"}), Object.defineProperty(e, "__esModule", {value: !0})}, i.t = function (e, r) {if (1 & r && (e = i(e)), 8 & r) return e; if (4 & r && "object" == typeof e && e && e.__esModule) return e; var t = Object.create(null); if (i.r(t), Object.defineProperty(t, "default", {enumerable: !0, value: e}), 2 & r && "string" != typeof e) for (var n in e) i.d(t, n, function (r) {return e[r]}.bind(null, n)); return t}, i.n = function (e) {var r = e && e.__esModule ? function () {return e.default} : function () {return e}; return i.d(r, "a", r), r}, i.o = function (e, r) {return Object.prototype.hasOwnProperty.call(e, r)}, i.p = "/"; var l = this["webpackJsonpnode-spring-client"] = this["webpackJsonpnode-spring-client"] || [], p = l.push.bind(l); l.push = r, l = l.slice(); for (var f = 0; f < l.length; f++)r(l[f]); var a = p; t()}([])</script>
	<script src="/js/2.bd91be3c.chunk.js"></script>
	<script src="/js/main.d36b6e09.chunk.js"></script>

</body>

</html>
```

## BookController.cs

```text
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;

namespace haddley_power_app_api.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class BookController : ControllerBase
    {

        private static readonly List<Book> books = new List<Book>()
            {
                (new Book(1788395549, "Learning Node.js Development")),
                (new Book(1788620216, "Hands-On Microservices with Node.js"))
            };

        private readonly ILogger<BookController> _logger;

        public BookController(ILogger<BookController> logger)
        {
            _logger = logger;
        }

        [HttpGet]
        public IEnumerable<Book> GetBooks()
        {
            return books.ToArray();
        }

        [HttpGet("{id}")]
        public ActionResult<Book> GetBooks(long id)
        {
            var itemFound = books.SingleOrDefault(book => book.id == id);
            if (itemFound == null)
            {
                return NotFound("Book Not Found");
            }

            return itemFound;
        }

        
        [HttpPost]
        public IActionResult Post([FromBody] Book book)
        {
            books.Add(book);

            System.Console.WriteLine(book.title);

            return StatusCode(200);
        }


        [HttpPut("{id}")]
        public IActionResult Put(long id, [FromBody] Book book)
        {
            var itemToUpdate = books.SingleOrDefault(book => book.id == id);
            if (itemToUpdate != null)
                itemToUpdate.title = book.title;

            return StatusCode(200);
        }

        [HttpDelete("{id}")]
        public IActionResult Delete(long id)
        {
            var itemToRemove = books.SingleOrDefault(book => book.id == id);
            if (itemToRemove != null)
                books.Remove(itemToRemove);
            return StatusCode(200);
        }

    }

}
```
## References

- [Static files in ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/static-files)

---

## dotnet-core-part2

**Source file:** `dotnet-core-part2.md`

---
title: ".NET Core (Part 2)"
description: "Creating a Blazor App that calls Microsoft Graph."
date: "2023-03-15"
categories: [".NET","Microsoft 365","Azure","Microsoft Dynamics"]
tags: []
slug: "dotnet-core-part2"
image: "/assets/images/net-logo.svg"
---



[Microsoft Graph](MicrosoftGraph.html) is a REST API that can be used to access: Microsoft 365, Azure Active Directory, Windows and Dynamics 365.

Microsoft Graph explorer is a developer tool that lets you learn about Microsoft Graph APIs.

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.20.07-am-1836x1069.png)
*Microsoft Graph Explorer*


## Blazor Server app

I wanted to create a Blazor Server app that would allow users to sign in using their M365/Azure Active Directory credentials.

I wanted the Blazor Server app to display the logged in user's name and their photograph.

I created an Azure application (app) registration.

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.29.54-am-1836x373.png)
*Azure Active Directory*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.30.45-am-1836x250.png)
*New registration*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.32.09-am-1836x667.png)
*Single tenant*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.33.46-am-1836x1018.png)
*redirect uri set to localhost...*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.34.43-am-1836x462.png)
*App registration created*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.37.11-am-1836x977.png)
*Update Authentication*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.38.08-am-1836x767.png)
*Add a client secret*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.38.43-am-1836x350.png)
*Secret will be valid for 180 days*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.38.57-am-1836x332.png)
*Copy the value*


## Blazor Server

Blazor is a web framework for building Razor components.

Razor components run server-side in ASP.NET Core.

(Razor components run client-side in the browser using WebAssembly)

A blazor server application can be generated using the dotnet command line tool.

**$ dotnet new blazorserver -o <project name>**

In this case I wanted to create a blazor server application that would authenticate users using Azure Active Directory (the App registration created above) and call Microsoft Graph to access the user's profile and the user's profile photograph.

**$ dotnet new blazorserver --auth SingleOrg --calls-graph -o haddley-blazor-graph --client-id "5df669b6-f661-473c-9f5d-100f792d16c7" --tenant-id "2788913d-04ad-47a2-ac42-4b02caa6a4be" --domain "p8lf.onmicrosoft.com" -f net7.0**

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.45.37-am-1664x496.png)
*dotnet new blazorserver ...*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.51.13-am-1836x948.png)
*dotnet run (navigate to localhost)*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.51.33-am-1836x942.png)
*The generated Blazor Server app (includes integration with Azure Active Directory and Microsoft Graph)*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.53.09-am-1836x1072.png)
*I copied the ClientSecret to appsettings.json*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.59.15-am-1836x1065.png)
*I am now able to login to the Blazor Server app using Azure Active Directory credentials*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-10.59.43-am-1836x1063.png)
*I provided the password*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.00.13-am-1836x1072.png)
*I skipped Multi factor authentication (for now)*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.00.24-am-1836x1066.png)
*Do I want to stay signed in?*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.00.39-am-1836x1067.png)
*I navigate to the Show profile page*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.01.51-am-1836x1073.png)
*/showprofile page*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.02.06-am-1836x567.png)
*Key move is call to injected GraphServiceClient (to access Microsoft Graph)*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.04.37-am-1836x998.png)
*I updated navigation...*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.05.55-am-1836x391.png)
*... to include a link to a /showphoto page*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.09.35-am-1836x737.png)
*The /showphoto page will need to make a "my photo" call to Microsoft Graph*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.43.49-am-1836x1023.png)
*I copied the "Me.Photo.Content" expression/path to the new /showphoto page.*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-11.44.08-am-1836x990.png)
*Show photo page running*


## Program.cs

Notice that the Blazor Server project includes a Program.cs file with contents similar what you would expect to see in a Model-View-Controller project.

A Blazor Server project and a Model-View-Controller project are both ASP.NET Core projects and it is possible to mix and match.

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-12.48.33-pm-1836x1077.png)
*Program.cs (part 1)*

![](/assets/images/dotnet-core-part2/screen-shot-2023-03-17-at-12.48.44-pm-1836x1040.png)
*Program.cs (part 2)*


## ShowPhoto.razor

```text
@page "/showphoto"

@using Microsoft.Identity.Web
@using Microsoft.Graph
@inject Microsoft.Graph.GraphServiceClient GraphServiceClient
@inject MicrosoftIdentityConsentAndConditionalAccessHandler ConsentHandler

<h1>My Photo</h1>

<p>This component demonstrates fetching data from a service.</p>

@if (imgDataURL == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <img src=@imgDataURL />
}

@code {
    String? imgDataURL;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            Stream photo = await GraphServiceClient.Me.Photo.Content.Request().GetAsync();

            if (photo != null)
            {
                MemoryStream ms = new MemoryStream();
                photo.CopyTo(ms);
                byte[] buffer = ms.ToArray();
                string result = Convert.ToBase64String(buffer);
                imgDataURL = string.Format("data:image/png;base64,{0}", result);
            }
            else
            {
                imgDataURL = "";
            }
        }
        catch (Exception ex)
        {
            ConsentHandler.HandleException(ex);
        }
    }
}
```

## Program.cs

```text
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.OpenIdConnect;
using Microsoft.Identity.Web;
using Microsoft.Identity.Web.UI;
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Components;
using Microsoft.AspNetCore.Components.Web;
using Microsoft.AspNetCore.Mvc.Authorization;
using Graph = Microsoft.Graph;
using haddley_blazor_graph.Data;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
var initialScopes = builder.Configuration["DownstreamApi:Scopes"]?.Split(' ');

builder.Services.AddAuthentication(OpenIdConnectDefaults.AuthenticationScheme)
    .AddMicrosoftIdentityWebApp(builder.Configuration.GetSection("AzureAd"))
        .EnableTokenAcquisitionToCallDownstreamApi(initialScopes)
            .AddMicrosoftGraph(builder.Configuration.GetSection("DownstreamApi"))
            .AddInMemoryTokenCaches();
builder.Services.AddControllersWithViews()
    .AddMicrosoftIdentityUI();

builder.Services.AddAuthorization(options =>
{
    // By default, all incoming requests will be authorized according to the default policy
    options.FallbackPolicy = options.DefaultPolicy;
});

builder.Services.AddRazorPages();
builder.Services.AddServerSideBlazor()
    .AddMicrosoftIdentityConsentHandler();
builder.Services.AddSingleton<WeatherForecastService>();

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
    app.UseHsts();
}

app.UseHttpsRedirection();

app.UseStaticFiles();

app.UseRouting();

app.MapControllers();
app.MapBlazorHub();
app.MapFallbackToPage("/_Host");

app.Run();
```
## References

- [Create a Blazor Server app that uses the Microsoft identity platform for authentication](https://learn.microsoft.com/en-us/azure/active-directory/develop/tutorial-blazor-server)

---

## dynamicssales1

**Source file:** `dynamicssales1.md`

---
title: "Dynamics 365 Sales (Part 1)"
description: " the Account|Sales Insights form"
date: "2023-10-21"
categories: ["Microsoft Dynamics"]
tags: []
slug: "dynamicssales1"
image: "/assets/images/dynamics365-color.svg"
---



I used [https://make.powerapps.com](https://make.powerapps.com) to customize the Account|Sales Insights form.

I added the customizations to a [solution](modelDriven1.html).

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.48.17-pm-2136x1029.png)
*The Sales Trial environment https://haddley-sales-trial.crm.dynamics.com*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.46.25-pm-2136x1245.png)
*By default the Accounts page in the Sales app displays the Account|My Active Accounts view*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.46.39-pm-2136x1244.png)
*Clicking on an Account in the Account|My Active Accounts view opens the Account|Sales Insights Form*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.49.54-pm-2136x1255.png)
*To customize the "Sales Insights" form I navigated to https://make.powerapps.com and selected the the "Sales Trial" environment*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.54.50-pm-2136x1103.png)
*I created a "Sales Customizations" solution*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.55.42-pm-2136x1111.png)
*I create a new publisher (Neil Haddley)*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.55.52-pm-2136x1111.png)
*I added my email address*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.57.44-pm-2136x1108.png)
*I clicked the Create button to create the new solution*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.58.19-pm-2136x1100.png)
*I wanted to add an existing table*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.58.33-pm-2136x1108.png)
*I added the (existing) Account table*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-12.58.47-pm-2136x435.png)
*I clicked the "select objects" link*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-1.35.10-pm-2136x1104.png)
*I selected the "Sales Insights" form and clicked the Add button*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-1.36.01-pm-2136x1108.png)
*I deleted the Fax element from the Account|Sales Insights form*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-1.36.18-pm-2136x1109.png)
*I deleted the Ticker Symbols element from the Account|Sales Insights form*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-1.36.45-pm-2136x1103.png)
*I deleted the Shipping section from the Details tab of the Account|Sales Insights form*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-1.37.07-pm-2136x691.png)
*I deleted the Number of Employees element from the Account|Sales Insights form*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-1.37.25-pm-2136x355.png)
*I saved and published the changes*

![](/assets/images/dynamicssales1/screenshot-2023-10-21-at-1.38.34-pm-2136x1107.png)
*I returned to the Sales App https://haddley-sales-trial.crm.dynamics.com to review the changes*

---

## dynamicssales2

**Source file:** `dynamicssales2.md`

---
title: "Dynamics 365 Sales (Part 2)"
description: "The Lead to Opportunity Sales Process"
date: "2023-10-21"
categories: ["Microsoft Dynamics"]
tags: []
slug: "dynamicssales2"
image: "/assets/images/dynamics365-color.svg"
---



I used [https://make.powerapps.com](https://make.powerapps.com) to customize the "Lead to Opportunity Sales Process" business process flow.

I added the customizations to my Sales Customizations [solution](modelDriven1.html).

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.45.17-pm-2136x1106.png)
*I wanted to add the (existing) Opportunity table to my Sales Customizations solution*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.46.26-pm-2136x1248.png)
*I selected the Opportunity table and clicked the Next button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.46.59-pm-2136x1153.png)
*I clicked Add to add the table*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.48.20-pm-2136x442.png)
*I clicked the + New button to add a column to the existing Opportunity table*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.49.08-pm-2136x1154.png)
*I added Trial Start (Optional)*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.50.06-pm-2136x1148.png)
*I added Trial End (Optional)*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.50.54-pm-2136x1109.png)
*I wanted to add an existing Business Process Flow to my Sales Customizations solution*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.51.19-pm-2136x1153.png)
*I selected the "Lead to Opportunity Sales Process" business process flow and clicked the Add button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.51.44-pm-2136x990.png)
*I clicked the Edit button up edit the Business Process Flow*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.52.40-pm-2136x1111.png)
*I clicked the Add Stage button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.53.55-pm-2136x1112.png)
*I updated the Display Name to "Trial" and clicked the Apply button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.54.47-pm-2136x1224.png)
*I added a "Trial Start" Data Step*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.55.32-pm-2136x1228.png)
*I selected the Required option*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.56.09-pm-2136x1225.png)
*I clicked the Apply button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.56.38-pm-2136x1225.png)
*I added a "Trial End" Data Step*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.56.57-pm-2136x1225.png)
*Again I selected the Required option and clicked the Apply button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.57.19-pm-2136x537.png)
*I clicked the Update button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-3.57.29-pm-2136x752.png)
*Validation was successful*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-4.28.51-pm-2136x1107.png)
*I opened an existing Lead and Clicked the Next Stage button to move from Qualify to Develop*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-4.29.10-pm-2136x1109.png)
*I created the (Lead) Opportunity*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-4.29.36-pm-2136x1113.png)
*I clicked the Next Stage button to move the Business Process Flow from Develop to Trial*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-4.29.55-pm-2136x1107.png)
*I clicked the Next Stage button again*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-4.30.43-pm-2136x1109.png)
*I entered Opportunity|Trail Start and Opportunity|Trial End values and clicked the Next Stage button*

![](/assets/images/dynamicssales2/screenshot-2023-10-21-at-4.32.13-pm-2136x962.png)
*The Business Process Flow moved to the Propose Stage*

---

## dynamicssales3

**Source file:** `dynamicssales3.md`

---
title: "Dynamics 365 Sales (Part 3)"
description: "Adding a Warranty table"
date: "2023-10-21"
categories: ["Microsoft Dynamics","Power Platform"]
tags: []
slug: "dynamicssales3"
image: "/assets/images/dynamics365-color.svg"
---



I used [https://make.powerapps.com](https://make.powerapps.com) to add a Warranty table to Microsoft Dynamics 365 Sales.

I added the customization to my Sales Customizations [solution](modelDriven1.html).

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.00.51-pm-2136x915.png)
*I wanted to add a new table*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.02.03-pm-2136x1220.png)
*I added a Warranty table*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.02.34-pm-2136x1227.png)
*By default the name column is required single line of text*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.04.08-pm-2136x1222.png)
*I updated the name column to be an autonumber*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.05.39-pm-2136x1272.png)
*I added a required Start Date column*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.06.51-pm-2136x1273.png)
*I added an End Date formula column*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.07.27-pm-2136x1274.png)
*End Date would be calculated to be 3 years after the Start Date*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.08.10-pm-2136x1272.png)
*I added an Account (record) Lookup Column*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.08.51-pm-2136x1276.png)
*Adding the Account Lookup column creates a new Many-to-one relationship*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.09.57-pm-2136x1270.png)
*I added a Many-to-one relationship (Column) for Product (record)*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.10.55-pm-2136x1128.png)
*I updated the Main Warranty form*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.11.17-pm-2136x1274.png)
*Initially the Main form only included the Name and Owner columns*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.16.00-pm-2136x1292.png)
*I moved the Owner Column to the form header and removed the Name column. I added the Start Date, End Date, Account and Product Columns*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.17.19-pm-2136x896.png)
*I updated the Active Warranties view*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.18.11-pm-2136x581.png)
*I added the Start Date, End Date, Account and Product Columns to the view*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.19.18-pm-2136x855.png)
*I added a 1-column tab to the Account table's Main form*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.19.42-pm-2136x1293.png)
*I renamed the new tab "Warranties"*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.20.13-pm-2136x1292.png)
*I added a subgrid to the new tab*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.20.56-pm-2136x1289.png)
*I updated the Labels*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.21.10-pm-2136x322.png)
*I Saved and Published my changes*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.23.44-pm-2136x1292.png)
*I added the Sales Trial app to the Sales Customizations solution*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.24.32-pm-2136x1291.png)
*I added a Dataverse table page*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.24.50-pm-2136x1290.png)
*I selected the Warranty table*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.25.07-pm-2136x686.png)
*I published my changes*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.26.02-pm-2136x1087.png)
*The Sales Trial app now included a Warranties page*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.27.01-pm-2136x1245.png)
*The Accounts page includes a Warranties tab*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.27.15-pm-2136x1243.png)
*I can create a new Warranty (for the current Account) using the + New Warranty button*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.27.27-pm-2136x1020.png)
*The Account is automatically filled in*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.27.50-pm-2136x1141.png)
*I entered the Start Date, selected a Product and clicked the Save button*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.28.03-pm-2136x1083.png)
*The new record is saved with the name "warranty-100000"*

![](/assets/images/dynamicssales3/screenshot-2023-10-21-at-5.28.19-pm-2136x1239.png)
*The Warranty is shown in the subgrid*

---

## dynamicssales4

**Source file:** `dynamicssales4.md`

---
title: "Dynamics 365 Sales (Part 4)"
description: "Tiki Tour"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/dynamicssales4/hero.png"
tags: ["ai","dynamics"]
hidden: true
slug: "dynamicssales4"
---



![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.00.51-pm-2136x915.png)
*I wanted to add a new table*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.02.03-pm-2136x1220.png)
*I added a Warranty table*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.02.34-pm-2136x1227.png)
*By default the name column is required single line of text*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.04.08-pm-2136x1222.png)
*I updated the name column to be an autonumber*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.05.39-pm-2136x1272.png)
*I added a required Start Date column*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.06.51-pm-2136x1273.png)
*I added an End Date formula column*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.07.27-pm-2136x1274.png)
*End Date would be calculated to be 3 years after the Start Date*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.08.10-pm-2136x1272.png)
*I added an Account (record) Lookup Column*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.08.51-pm-2136x1276.png)
*Adding the Account Lookup column creates a new Many-to-one relationship*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.09.57-pm-2136x1270.png)
*I added a Many-to-one relationship (Column) for Product (record)*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.10.55-pm-2136x1128.png)
*I updated the Main Warranty form*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.11.17-pm-2136x1274.png)
*Initially the Main form only included the Name and Owner columns*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.16.00-pm-2136x1292.png)
*I moved the Owner Column to the form header and removed the Name column. I added the Start Date, End Date, Account and Product Columns*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.17.19-pm-2136x896.png)
*I updated the Active Warranties view*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.18.11-pm-2136x581.png)
*I added the Start Date, End Date, Account and Product Columns to the view*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.19.18-pm-2136x855.png)
*I added a 1-column tab to the Account table's Main form*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.19.42-pm-2136x1293.png)
*I renamed the new tab "Warranties"*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.20.13-pm-2136x1292.png)
*I added a subgrid to the new tab*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.20.56-pm-2136x1289.png)
*I updated the Labels*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.21.10-pm-2136x322.png)
*I Saved and Published my changes*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.23.44-pm-2136x1292.png)
*I added the Sales Trial app to the Sales Customizations solution*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.24.32-pm-2136x1291.png)
*I added a Dataverse table page*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.24.50-pm-2136x1290.png)
*I selected the Warranty table*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.25.07-pm-2136x686.png)
*I published my changes*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.26.02-pm-2136x1087.png)
*The Sales Trial app now included a Warranties page*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.27.01-pm-2136x1245.png)
*The Accounts page includes a Warranties tab*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.27.15-pm-2136x1243.png)
*I can create a new Warranty (for the current Account) using the + New Warranty button*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.27.27-pm-2136x1020.png)
*The Account is automatically filled in*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.27.50-pm-2136x1141.png)
*I entered the Start Date, selected a Product and clicked the Save button*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.28.03-pm-2136x1083.png)
*The new record is saved with the name "warranty-100000"*

![](/assets/images/dynamicssales4/screenshot-2023-10-21-at-5.28.19-pm-2136x1239.png)
*The Warranty is shown in the subgrid*

---

## dynamicstrialsignup

**Source file:** `dynamicstrialsignup.md`

---
title: "Dynamics Trial Signup"
description: "Microsoft Signup"
date: "2023-08-14"
categories: ["Microsoft Dynamics","Business Central"]
tags: []
slug: "dynamicstrialsignup"
image: "/assets/images/dynamics365-color.svg"
---



I created a littleburra.onmicrosoft.com tenant

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-7.34.24-am-1836x1023.png)
*I navigated to https://businessstore.microsoft.com/en-us/store(signup:signup/admin)*

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-7.37.39-am-1836x1021.png)
*I entered the new tenant details*

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-7.38.06-am-1836x981.png)
*I entered my mobile telephone number*

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-7.43.01-am-1836x1021.png)
*I navigated to http://login.microsoftonline.com*

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-7.43.56-am-1836x517.png)
*I navigated to http://microsoft365.com/*

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-7.44.26-am-1836x976.png)
*I navigated to https://admin.microsoft.com/*

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-7.47.06-am-1836x1023.png)
*I navigated to http://myaccount.microsoft.com*

![](/assets/images/dynamicstrialsignup/screen-shot-2023-08-22-at-8.01.19-am-1836x1060.png)
*I navigated to https://dynamics.microsoft.com/en-us/dynamics-365-free-trial/*

---

## electron

**Source file:** `electron.md`

---
title: "Electron"
description: "Create a Desktop app using Node and Chromium."
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/electron/hero.png"
tags: ["javascript","java","ai","ml","git"]
hidden: true
slug: "electron"
---



## Advantages

Electron allows developers to build cross-platform desktop applications using HTML, CSS, JavaScript and C++.

Visual Studio Code, Slack, Microsoft Teams and Github Desktop are all Electron applications.

A minimal Electron app is made up of node code (that might be in a file named main.js) and Chromium code (that might be in a file named index.html).


## main.js and index.html

We can create a package.json file using the npm init command
$ npm init -y

We can add the electron dependencies using the npm i --save-dev electron command
$ npm i --save-dev electron

Once the dependencies have been added we can create a main.js file and an index.html file:


## package.json

Now we can update the package.json file and run the Electron app.

"main": "main.js",
    "scripts": {
  "start": "electron ."
    }

Use "npm start" to run the Electron app.

$ npm start

![](/assets/images/electron/screen-shot-2021-02-23-at-2.36.38-pm-1836x1166.png)
*npm start*

![](/assets/images/electron/screen-shot-2021-02-23-at-2.44.21-pm-1588x1194.png)
*Running electron app*


## npm

Some of the modules published to npmjs.com are designed to run in node only.

These modules access resources that a web pages running in a desktop browser are not allowed to access. 

These modules may have been created using [JavaScript](npm.html) or [C++](npmCC.html).

In an Electron app code in an index.html page (hosted by Chromium) is able to call into node modules (hosted by node).

![](/assets/images/electron/screen-shot-2021-02-26-at-2.41.35-pm-1836x1169.png)
*Electron code*

![](/assets/images/electron/screen-shot-2021-02-26-at-2.46.42-pm-1314x780.png)
*Running Electron application*


## main.js

```javascript
const { app, BrowserWindow } = require('electron')

function createWindow() {
    const win = new BrowserWindow({
        width: 800,
        height: 600,
        webPreferences: {
            nodeIntegration: true
        }
    })

    win.loadFile('index.html')
}

app.whenReady().then(createWindow)

app.on('window-all-closed', () => {
    if (process.platform !== 'darwin') {
        app.quit()
    }
})

app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) {
        createWindow()
    }
})
```

## index.html

```html
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
</head>

<body style="background: white;">
    <h1>Hello World!</h1>
    <p>
        We are using node
        <script>document.write(process.versions.node)</script>,
        Chrome
        <script>document.write(process.versions.chrome)</script>,
        and Electron
        <script>document.write(process.versions.electron)</script>.
    </p>
</body>

</html>
```

## Code that will run on an Electron index.html page

```typescript
const nodeFactorialCC = require("node-factorial-cc")
            const result = nodeFactorialCC.factorial(9)
            document.write(`factorial of 9 is: ${result}`)
```



---

## financialoperationspurchaseinvoice

**Source file:** `financialoperationspurchaseinvoice.md`

---
title: "Financial Operations Purchase Invoice"
description: "Payment Journals"
date: "2023-08-20"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "financialoperationspurchaseinvoice"
image: "/assets/images/dynamics365-color.svg"
---



Businesses that purchase items from Vendors need to provide payment.

Businesses should take advantage of payment terms and discounts for prompt payment.

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.48.12-pm-1836x434.png)
*I noticed that there were 13 Outstanding Vendor Invoices in the CRONUS USA, Inc. company accounts*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.49.21-pm-1836x280.png)
*I created a payment for the $14,895 Nod Publishers Invoice*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.49.47-pm-1836x644.png)
*I selected Payment Type "Computer Check"*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.50.31-pm-1836x332.png)
*I noticed that the Check Printed value was false (unselected)*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.50.48-pm-1836x320.png)
*As a test I tried to Post the payment*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.51.00-pm-1836x426.png)
*I confirmed Yes*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.51.37-pm-1836x205.png)
*Business Central generated an error. I had specified Computer Check but I had not printed a Check.*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.51.53-pm-1836x320.png)
*I selected the Check|Print Check... menu item*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.52.41-pm-1836x645.png)
*I selected the "Send to..." link*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.52.54-pm-1836x644.png)
*I selected the PDF Document option*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.53.12-pm-1836x57.png)
*Check.pdf has been downloaded*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.53.24-pm-1836x643.png)
*Business Central generated a one page pdf document (ready for me to print)*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.53.43-pm-1836x318.png)
*I selected Preview Posting*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.53.58-pm-1836x300.png)
*There were going to be two General Ledger Entries addedThere was going to be a Vendor Ledger Entry addedThere was going to be a Bank Account Ledger Entry addedThere were going to be three Detailed Vendor Ledger Entries added*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.54.16-pm-1836x280.png)
*A Credit entry was going to be added to the Checking Account (The value of the Asset would reduce)*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.54.29-pm-1836x280.png)
*A Debit entry was going to be added to the Accounts Payable Account (The size of the Liability would reduce)Notice that the name of the Vendor was added as a Description*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.54.48-pm-1836x261.png)
*A Debit entry was going to be added to the Nod Publishers Account in the Vendor Ledger*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.55.11-pm-1836x236.png)
*A Credit entry was going to be added to the CHECKING Account in the Bank Account Ledger*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.55.45-pm-1836x240.png)
*Three entries were going to be added to the Detailed Vendor Ledger*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-7.59.55-pm-1836x325.png)
*I selected the Post|Post menu item*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.00.06-pm-1836x447.png)
*I selected the Yes option*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.00.17-pm-1836x442.png)
*The journal lines were successfully posted*


## Suggest Vendor Payments

I used the Suggest Vendor Payments menu item to suggest payment lines. In normal operations suggested payment lines would include payments that will qualify for payment discounts.

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.07.38-pm-1836x121.png)
*Payment Journals*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.07.55-pm-1836x268.png)
*I selected the CASH batch (as a starting point)*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.08.11-pm-1836x333.png)
*I clicked the Suggest Vendor Payments link*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.08.40-pm-1836x645.png)
*I clicked the "Show more" link*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.09.24-pm-1836x645.png)
*I selected Bal. Account Type: Bank Account, Bal. Account No.: CHECKING, and Bank Payment Type: Computer Check*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.09.36-pm-1836x499.png)
*I clicked the OK link*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.10.03-pm-1836x444.png)
*As a test I tried to click the Post|Post link*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.10.22-pm-1836x196.png)
*Again Business Central generated an error. I had specified Computer Check but I had not printed the Checks.*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.10.43-pm-1836x402.png)
*I clicked the Check|Print Check... link*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.11.09-pm-1836x642.png)
*I selected the Send to... link*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.11.21-pm-1836x643.png)
*I selected the PDF Document option*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.11.51-pm-1836x644.png)
*The result was a 5 page pdf file. Each page included the check details and the corresponding Vendor invoice details*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.12.06-pm-1836x433.png)
*I selected Preview Posting*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.12.20-pm-1836x642.png)
*There were going to be ten General Ledger Entries addedThere were going to be five Vendor Ledger Entries addedThere was going to be five Bank Account Ledger Entries addedThere were going to be twenty two Detailed Vendor Ledger Entries added*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.12.46-pm-1836x462.png)
*Five Credit entries were going to be added to the Checking Account (The value of the Asset would reduce)*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.12.56-pm-1836x425.png)
*Five Debit entries were going to be added to the Accounts Payable Account (The size of the Liability would reduce)Notice that in each instance the name of the Vendor was added as a Description*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.13.31-pm-1836x381.png)
*Five Debit entries were going to be added to the Vendor Ledger (one for each of the five Vendor Accounts)*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.13.43-pm-1836x341.png)
*Five Credit entries were going to be added to the CHECKING Account in the Bank Account Ledger*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.13.57-pm-1836x644.png)
*Twenty two entries were going to be added to the Detailed Vendor Ledger*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.14.11-pm-1836x645.png)
*I selected the Post|Post menu item*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.14.20-pm-1836x642.png)
*I selected the Yes option*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.14.32-pm-1836x642.png)
*The journal lines were successfully posted*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.15.15-pm-1836x266.png)
*The Outstanding Vendor Invoices count was reduced to 0*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.15.36-pm-1836x645.png)
*I reviewed the bank accounts list*

![](/assets/images/financialoperationspurchaseinvoice/screen-shot-2023-08-21-at-8.15.59-pm-1836x290.png)
*At least $49,421.55 will need to be deposited in the CHECKING bank account before the Vendors receive the physical checks.*

---

## finetuning

**Source file:** `finetuning.md`

---
title: "Fine Tuning"
description: "Fine Tuning"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/finetuning/hero.png"
tags: ["ai"]
hidden: true
slug: "finetuning"
---



## ChatGPT Is a Blurry JPEG of the Web

In his [New Yorker article](https://www.newyorker.com/tech/annals-of-technology/chatgpt-is-a-blurry-jpeg-of-the-web) Ted Chiang contrasts ChatGPT and google search.

The following screenshots demonstrate Ted's argument.

![](/assets/images/finetuning/summarize-the-plot-of-th...-1650x3640.png)
*The responses provided by the Large Language Model above are nonsense.*

![](/assets/images/finetuning/screen-shot-2023-08-10-at-9.36.09-am-1836x870.png)
*In contrast providing the prompt to google search returns useful (and accurate) information.*

![](/assets/images/finetuning/screen-shot-2023-08-10-at-9.39.09-am-1836x903.png)
*The Wikipedia Article provides a good summary of the book's plot.*


## Fine Tuning

Fine-tuning a large language models (LLMs) involves re-training the pre-trained models with new data.

![](/assets/images/finetuning/screenshot-2023-08-09-at-9.55.28-am-1171x1138.png)
*esp8266*

![](/assets/images/finetuning/screen-shot-2023-08-09-at-8.08.16-pm-1836x1331.png)
*esp8266*

![](/assets/images/finetuning/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/finetuning/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/finetuning/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*
## References

- [Learn Prompting](https://learnprompting.org/docs/intro)



---

## firebase

**Source file:** `firebase.md`

---
title: "Firebase"
description: "Firebase web codelab"
date: "2023-04-24"
categories: ["JavaScript","Azure"]
tags: []
slug: "firebase"
image: "/assets/images/logo-lockup-firebase-vertical.svg"
---



The application I built uses these Firebase products for web apps:

Firebase Authentication to easily allow your users to sign into your app.
Cloud Firestore to save structured data on the cloud and get instant notification when data changes.
Cloud Storage for Firebase to save files in the cloud.
Firebase Hosting to host and serve your assets.
Firebase Cloud Messaging to send push notifications and display browser popup notifications; and
Firebase Performance Monitoring to collect user performance data for your app.

Instructions are available:

https://firebase.google.com/codelabs/firebase-web

I started by cloning the codelab-friendlychat-web repository

```bash
% git clone https://github.com/firebase/codelab-friendlychat-web
```


![](/assets/images/firebase/screen-shot-2023-04-24-at-9.26.33-pm-1836x1262.png)
*codelab-friendlychat-web*

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.46.58-pm-1836x1050.png)
*I opened the project in Visual Studio Code*


## I created a Firebase project

https://console.firebase.google.com

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.42.04-pm-1836x692.png)
*I provided a name for the project*

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.42.31-pm-1836x1013.png)
*I disabled google analytics for this project*

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.42.41-pm-1836x1018.png)
*I waited*

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.48.14-pm-1836x712.png)
*The new project was ready*

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.51.37-pm-1836x844.png)
*FriendlyChat project*

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.54.01-pm-1836x911.png)
*Project ID is friendlychat-2ee95*


## Add a web app

I added a Firebase web app to the Firebase project

![](/assets/images/firebase/screen-shot-2023-04-24-at-9.59.48-pm-1416x596.png)
*Web*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.01.56-pm-1836x923.png)
*Register app*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.02.44-pm-1836x1008.png)
*Add Firebase SDK instructions*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.04.31-pm-1836x769.png)
*Copy this object*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.07.26-pm-1836x1049.png)
*Paste here*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.17.54-pm-1836x567.png)
*The Friendly Chat web app has been created*


## Enable Google sign-in for Firebase Authentication

To allow users to sign in to the web app with their Google accounts, I selected the Google sign-in method

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.22.48-pm-1836x827.png)
*Google provider*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.25.18-pm-1836x1013.png)
*Enable Google Authentication*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.26.39-pm-1836x990.png)
*Provider Enabled*


## Enable Cloud Firestore

The web app uses Cloud Firestore to save chat messages and receive new chat messages.

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.29.18-pm-1836x961.png)
*Start in test mode*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.30.35-pm-1640x1006.png)
*I selected location and clicked the Enable button*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.32.05-pm-1836x700.png)
*Firestore database has been created*


## Enable Cloud Storage

The web app uses Cloud Storage for Firebase to store, upload, and share pictures.

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.35.55-pm-1466x1008.png)
*old default*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.36.28-pm-1634x1104.png)
*Start in test mode*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.37.27-pm-1634x658.png)
*Location defaults to firestore location*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.39.33-pm-1836x588.png)
*Firestore storage has been created*


## Installing the Firebase command-line interface

npm install -g firebase-tools
firebase --version
firebase login

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.42.42-pm-1354x86.png)
*firebase --version*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.11.51-pm-1352x602.png)
*firebase login*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.46.45-pm-1322x210.png)
*firebase use --add*


## Run the starter app locally

firebase serve --only hosting

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.48.50-pm-1298x138.png)
*firebase serve --only hosting*

![](/assets/images/firebase/screen-shot-2023-04-24-at-10.49.41-pm-1836x1093.png)
*The web app User Interface*


## Import the Firebase SDK

I navigated to the web-start directory
I ran npm install to download the Firebase SDK
I ran npm run start to start Webpack.

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.20.53-am-1836x831.png)
*/web-start/package.json*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.22.59-am-1836x869.png)
*/web-start/index.js*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.25.10-am-1360x426.png)
*npm i*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.25.40-am-1350x408.png)
*npm run start*


## Configure Firebase

I copied the config object snippet and added it to /web-start/src/firebase-config.js.

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.28.16-am-1836x904.png)
*snippet*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.30.08-am-1836x706.png)
*firebase-config.js*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.31.57-am-1836x512.png)
*initializeApp*


## Authenticate users with Google Sign-In

In the app, when a user clicks the Sign in with Google button, the signIn function is triggered.

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.34.43-am-1836x724.png)
*signIn() and signOut()*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.36.18-am-1836x277.png)
*initFirebaseAuth()*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.37.26-am-1836x638.png)
*authStateObserver(user)*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.38.56-am-1836x352.png)
*getProfilePicUrl() and getUserName()*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.40.16-am-1836x210.png)
*isUserSignedIn()*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.42.56-am-1836x462.png)
*firebase serve --only hostingTest sign-in*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.45.44-am-1548x830.png)
*messages*


## Add messages to Cloud Firestore

A user clicking the SEND button the app adds a message object to the Cloud Firestore. The add() method adds a new document with an automatically generated ID to the collection.

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.49.02-am-1836x535.png)
*saveMessage()*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.50.05-am-1254x216.png)
*testing "SEND"*

![](/assets/images/firebase/screen-shot-2023-04-25-at-4.58.32-am-1836x976.png)
*addDoc(...)*

![](/assets/images/firebase/screen-shot-2023-04-25-at-5.01.18-am-1836x856.png)
*messages*


## Synchronize messages

To read messages in the app, I added listeners that trigger when data changes and then create a UI element that shows new messages.

![](/assets/images/firebase/screen-shot-2023-04-25-at-5.04.44-am-1836x590.png)
*loadMessages()*

![](/assets/images/firebase/screen-shot-2023-04-25-at-5.07.50-am-1304x498.png)
*loadMessages()*


## Save images to Cloud Storage

After selecting a file, the saveImageMessage function is called.

![](/assets/images/firebase/screen-shot-2023-04-25-at-7.25.20-am-1836x928.png)
*saveImageMessage*

![](/assets/images/firebase/screen-shot-2023-04-25-at-7.30.53-am-1636x1260.png)
*testing saveImageMessage*


## Add a Firebase Cloud Messaging service worker

The app will notify users when new messages are posted in the chat.

![](/assets/images/firebase/screen-shot-2023-04-25-at-7.51.40-am-1836x433.png)
*service worker*


## Get Firebase Cloud Messaging device tokens

When notifications have been enabled on a device or browser, you'll be given a device token. This device token is what we use to send a notification to a particular device or particular browser.

![](/assets/images/firebase/screen-shot-2023-04-25-at-7.54.56-am-1836x947.png)
*saveMessagingDeviceToken()*


## Request permissions to show notifications

When the user has not yet granted your app permission to show notifications, you won't be given a device token. In this case, we call the firebase.messaging().requestPermission() method, which will display a browser dialog asking for this permission ( in supported browsers).

![](/assets/images/firebase/screen-shot-2023-04-25-at-7.57.22-am-1836x518.png)
*requestPermission()*

![](/assets/images/firebase/screen-shot-2023-04-25-at-7.59.51-am-1636x544.png)
*Allow notifications*

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.04.40-am-1632x658.png)
*device token*


## Send a notification to your device

Now that you have your device token, you can send a notification using the Cloud Messaging tab of the Firebase console.

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.08.24-am-1836x1046.png)
*Testing*


## Database security rules

Cloud Firestore uses a specific rules language to define access rights, security, and data validations.

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.17.23-am-1836x915.png)
*Updated Firestore rules*


## Storage security rules

Cloud Storage for Firebase uses a specific rules language to define access rights, security, and data validations.

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.21.59-am-1836x729.png)
*Updated Storage rules*


## Collect performance data

You can use the Performance Monitoring SDK to collect real-world performance data from your app and then review and analyze that data in the Firebase console.

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.25.36-am-1836x128.png)
*getPerformance()*


## Measure first input delay

First input delay starts when the user first interacts with an element on the page, like clicking a button or hyperlink. It stops immediately after the browser is able to respond to the input, meaning that the browser isn't busy loading or parsing your page's content.

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.27.11-am-1836x290.png)
*First input delay*


## Deploy the app using Firebase Hosting

I deployed the app files to Firebase Hosting using the Firebase CLI. 

I needed to specify in the firebase.json file which local files should be deployed.

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.35.12-am-1836x852.png)
*firebase.json*

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.36.34-am-1440x560.png)
*firebase deploy --except functions*

![](/assets/images/firebase/screen-shot-2023-04-25-at-8.37.44-am-1638x1334.png)
*https://friendlychat-2ee95.web.app/*
## References

- [Firebase web codelab](https://firebase.google.com/codelabs/firebase-web)
- [Patterns for security with Firebase: per-user permissions for Cloud Firestore](https://medium.com/firebase-developers/patterns-for-security-with-firebase-per-user-permissions-for-cloud-firestore-be67ee8edc4a)

---

## generalledger

**Source file:** `generalledger.md`

---
title: "General Ledger"
description: "Purchase"
date: "2023-12-11"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "generalledger"
image: "/assets/images/dynamics365-color.svg"
---



The General Ledger is fundamental to financial management and accounting within Microsoft Dynamics 365 Business Central.

Users update the General Ledger through the creation and posting of General Journal entries (or through the posting of documents using the document to journal to ledger pattern).

The General Ledger contains the balances of all accounts in the Chart of Accounts.

I created a Chart of Accounts from scratch and demonstrate how Journal entries can be used to record a Purchase transaction and a Sales transaction.

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.07.53-am-1279x735.png)
*I created a new company*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.08.10-am-1281x735.png)
*I added myself as a user*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.08.18-am-1279x733.png)
*I clicked the Finish button*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.28.24-am-1280x734.png)
*I navigated to the new company and clicked on the Chart of Accounts link*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.51.18-am-1283x297.png)
*I added an account (entity)*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.53.05-am-1277x735.png)
*I added a Balance Sheet Heading*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.53.23-am-1281x383.png)
*I clicked + New to add another entity*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.55.06-am-1279x733.png)
*I added an Assets Begin-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-9.55.40-am-1281x364.png)
*I clicked + New to add another entity*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.01.34-am-1284x735.png)
*I added a Total Assets End-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.01.56-am-1281x392.png)
*I clicked + New to add another entity*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.03.58-am-1281x736.png)
*I added a Liability Begin-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.04.12-am-1281x363.png)
*I clicked + New to add another entity*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.05.55-am-1280x733.png)
*I added a Total Liabilities End-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.06.16-am-1283x435.png)
*I clicked + New to add another entity*


When we purchase items we will need to record the value of the items (a new asset), the money we owe to the vendor (a new liability) and the sales tax that we will claim back from the authorities.

I created a Finished Goods asset account that I could post the purchase value to.
I created an Accounts Payable, Domestic account that I could post the vendor liability to.
I created a Taxes Liable account that I could post the sales tax amounts to.

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.10.32-am-1281x736.png)
*I created a Finished Goods asset account*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.11.48-am-1282x456.png)
*I clicked + New to add another entity*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.13.55-am-1280x736.png)
*I created a Goods for Resale account*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.14.12-am-1282x480.png)
*I clicked + New to add another entity*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.15.45-am-1279x734.png)
*I created an Accounts Payable, Domestic account*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.16.08-am-1281x513.png)
*I clicked + New to add another entity*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.18.31-am-1279x733.png)
*I created a Taxes Liable account*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.19.06-am-1281x544.png)
*I reviewed the updated Chart of Accounts*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.32.52-am-1282x735.png)
*I created a set of Journal entries to record the purchase of 10 black PARIS Guest Chairs (@ $250.30 each)*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.35.40-am-1281x455.png)
*I posted the Journal Lines*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.36.35-am-1282x733.png)
*I clicked Yes*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.37.00-am-1279x732.png)
*The lines were posted to the General Ledger*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.39.27-am-1283x510.png)
*I used search to navigate to the General Ledger Entries (Archive) page*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.38.36-am-1280x733.png)
*I reviewed the posted Journal entries*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.39.53-am-1281x371.png)
*I clicked on the Chart of Accounts link to navigate to the Chart of Accounts page*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-10.40.35-am-1280x735.png)
*I reviewed the updated Chart of Accounts balances (and totals)*


## Sale

When we sell items we will need to record the money our customer owes to us (a new asset), the revenue generated by the sale, the cost of the goods sold, and sales tax that we will be providing to the authorities

I created an Accounts Payable, Domestic account that I could post the vendor liability to.
I created a Resale of Goods account.
I created a Cost of Materials account.

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.11.20-am-1278x736.png)
*I created an Accounts Receivable, Domestic account*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.13.58-am-1282x735.png)
*I added an Income Statement Heading*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.24.41-am-1281x735.png)
*I added an Income Begin-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.26.02-am-1281x737.png)
*I added an Total Income End-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.27.49-am-1278x735.png)
*I added a Cost of Goods Sold Begin-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.29.20-am-1279x738.png)
*I added a Total Cost of Goods Sold End-Total*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.30.52-am-1279x767.png)
*I reviewed the updated Chart of Accounts*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.31.59-am-1280x768.png)
*I added a Resale of Goods Income account*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.33.06-am-1279x767.png)
*I added a Cost of Materials account*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.34.42-am-1281x320.png)
*I used search to navigate to the General Journal page*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.52.35-am-1277x755.png)
*I created a set of Journal entries to record the sale of 10 black PARIS Guest Chairs (@ $300.00 each)*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.53.10-am-1281x756.png)
*I posted the Journal lines*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.54.45-am-1280x693.png)
*I used search to navigate to the General Ledger Entries (Archive)*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.55.26-am-1279x773.png)
*I reviewed the posted Journal Lines*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-11.56.40-am-1281x897.png)
*I reviewed the Chart of Account balances (and totals)*


## Revenue

Notice that after these two business transactions (one purchase and one sale):

The difference between Total Assets ($3,210) and Total Liabilities ($2,713) is **$497**; and
The difference between Total Income ($3,000) and Total Cost of Goods Sold ($2,503) is **$497**

![](/assets/images/generalledger/screen-shot-2023-12-11-at-12.16.16-pm-1282x897.png)
*I clicked the Indent Chart of Account button*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-12.16.31-pm-1280x897.png)
*I clicked the Yes button*

![](/assets/images/generalledger/screen-shot-2023-12-11-at-12.17.09-pm-1279x896.png)
*The accounts were indented*

---

## generalpostingsetup

**Source file:** `generalpostingsetup.md`

---
title: "General Posting Setup"
description: "Which accounts payable ledger account"
date: "2023-12-14"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "generalpostingsetup"
image: "/assets/images/posts-meta.svg"
---



General Posting Setup is used to define which accounts receivable and cost of goods sold general ledger accounts to use when selling a given Item (with a given General Business Posting Group) to a given Customer (with a given General Product Posting Group).

General Posting Setup is used to define which accounts payable general ledger account to use when buying a given Item (with a given General Business Posting Group) from a given Vendor (with a given General Product Posting Group).

The General Posting Setup is maintained using the General Posting Setup page.

![](/assets/images/generalpostingsetup/screenshot-2023-12-14-at-10.36.23-am-1836x974.png)
*I used search to navigate to the General Posting Setup page.*

![](/assets/images/generalpostingsetup/screenshot-2023-12-14-at-10.41.37-am-1836x867.png)
*If we sell a RETAIL item to a DOMESTIC customer the 40140 Resale of Goods account should be used to record the sale.*

![](/assets/images/generalpostingsetup/screenshot-2023-12-14-at-10.54.46-am-1836x864.png)
*If we sell a RETAIL item to a DOMESTIC customer the 50110 Cost of Materials account should be used to record the cost of goods sold.*

![](/assets/images/generalpostingsetup/screenshot-2023-12-14-at-11.09.47-am-1836x867.png)
*Example of ledger entries generated when we sell a RETAIL item to a DOMESTIC customer.*

![](/assets/images/generalpostingsetup/screenshot-2023-12-14-at-10.49.56-am-1836x868.png)
*If we buy a RETAIL item from a DOMESTIC vendor the 14140 Goods for Resale account should be used to record the purchase*

![](/assets/images/generalpostingsetup/screenshot-2023-12-14-at-11.58.29-am-1836x868.png)
*Example of ledger entries generated when we buy a RETAIL item from a DOMESTIC vendor.*

---

## gingerbreadhouse

**Source file:** `gingerbreadhouse.md`

---
title: "Gingerbread House"
description: "holiday.py"
date: "2023-12-26"
categories: ["Python"]
tags: []
slug: "gingerbreadhouse"
image: "/assets/images/raspberry-pi-logo.svg"
---


$ sudo apt-get update
$ sudo  apt-get dist-upgrade

$ python -m venv my-env
$ source my-env/bin/activate

[$ pip install --upgrade pip setuptools wheel](https://singleboardblog.com/install-python-opencv-on-raspberry-pi/?fbclid=IwAR1BtOgVIk8SzhOmEIcPJk_73dkW8a9rc5bsi54KpVDr1vuCB6jnxBgWVqk)
$ pip install opencv-contrib-python

$ python
>>> import cv2
>>> print(cv2.__version__)

$ pip install --upgrade luma.oled
$ sudo raspi-config

$ curl -o holiday.mp4 https://download-video.akamaized.net/...

$ vi holiday.py
$ python holiday.py

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-10.44.44-am-1362x956.png)
*Raspberry Pi Imager*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-10.44.54-am-1360x952.png)
*I selected the Micro SD card*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-10.45.04-am-1354x954.png)
*I clicked YES to include WIFI and logon credentials*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-10.45.11-am-1358x952.png)
*I clicked YES*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-10.48.35-am-1362x954.png)
*SD card was moved from Macbook to Raspberry Pi*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.33.59-pm-1144x744.png)
*I plugged in the Raspberry Pi and used ping to access*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.36.24-pm-1132x732.png)
*I connected to the Raspberry Pi using secure shell (ssh)*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.38.15-pm-1138x740.png)
*I executed $ sudo apt-get update*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.39.14-pm-1132x734.png)
*I executed $ sudo apt-get dist-upgrade*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-27-at-5.56.06-am-1140x746.png)
*I created a python environment, activated the environment and ran pip install$ python -m venv my-env$ source my-env/bin/activate$ pip install --upgrade pip setuptools wheel*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-27-at-5.58.01-am-1128x744.png)
*I ran $ pip install opencv-contrib-pythonI ran import cv2 to ensure that OpenCV was properly installed*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-27-at-5.59.24-am-1130x740.png)
*I ran $ pip install --upgrade luma.oledlibrary for the mini oled display*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.52.14-pm-1140x734.png)
*I ran $ sudo raspi-configI selected the Interface Options menu option*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.52.29-pm-1138x742.png)
*I selected the I2C menu option*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.52.42-pm-1138x736.png)
*I selected Yes*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.52.52-pm-1136x744.png)
*I selected Ok*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-26-at-1.53.05-pm-1140x734.png)
*I selected Finish*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-27-at-6.01.01-am-1134x738.png)
*I downloaded video file from https://pixabay.com/videos/girl-child-snow-snowflakes-window-191152/*

![](/assets/images/gingerbreadhouse/screenshot-2023-12-27-at-6.01.59-am-1138x742.png)
*I created and ran holiday.pyNotice that the cv.imshow("Img", frame) line is commented out*

![](/assets/images/gingerbreadhouse/img-5336-1380x1840.jpg)
*I wired up two displays*

![](/assets/images/gingerbreadhouse/414614983-3592654821010285-4862293336907881210-n-1532x1149.jpg)
*Sweet tooth*

![](/assets/images/gingerbreadhouse/413991968-3592654847676949-8340720245653303904-n-1134x2016.jpg)
*Edible Leaves*

![](/assets/images/gingerbreadhouse/414650583-3592654754343625-1719951648167488634-n-2048x1536.jpg)
*Raspberry Pi*

![](/assets/images/gingerbreadhouse/414450418-3592654787676955-2853045504914548798-n-1536x2048.jpg)
*Invader Zim*

![](/assets/images/gingerbreadhouse/414438799-3592654771010290-8300621329522910848-n-2048x1536.jpg)
*Traditional*

![](/assets/images/gingerbreadhouse/414472361-3592654111010356-258204729919225997-n-960x720.jpg)
*Bluey*


```text
from luma.core.interface.serial import i2c, spi, pcf8574
from luma.core.interface.parallel import bitbang_6800
from luma.core.render import canvas
from luma.oled.device import ssd1306, ssd1309, ssd1325, ssd1331, sh1106, sh1107

from time import sleep

import cv2

# OpenCV follows BGR color convention and PIL follows RGB color convention

# Python Imaging Library
from PIL import Image

serial = i2c(port=1, address=0x3C)
device = sh1106(serial)

width =  device.width
height = device.height

cap = cv2.VideoCapture("holiday.mp4")
while True:
    ret, frame = cap.read()
    if not ret:
        break
#    cv2.imshow("Img", frame)
    
    color_coverted = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
    pil_image = Image.fromarray(color_coverted)
    image_r = pil_image.resize((width,height), Image.LANCZOS) 
    # Image.BICUBIC is another option
    image_bw = image_r.convert("1")

    device.display(image_bw)

    key = cv2.waitKey(1)
    if key == 27:
        break
        
cap.release()
cv2.destroyAllWindows()
```

---

## graphql

**Source file:** `graphql.md`

---
title: "GraphQL"
description: "GraphQL is a query and manipulation language for APIs."
date: "2021-03-01"
categories: ["JavaScript","React"]
tags: []
slug: "graphql"
image: "/assets/images/graphql-logo.svg-1200x1200.png"
---



A [REST](restapiservice.html) API client may need to make multiple calls to a REST Service to get all of the data it needs.

A GraphQL API client may be able to request all of the data it needs in a single call.

GraphQL supports reading data, mutating data, and subscribing to data (WebSockets).


## server.js

We create a package.json file using the npm init command
**$ npm init -y**

We add the GraphQL dependencies using npm
**$ npm i express@4.16.4 express-graphql@0.7.1 graphql@14.1.1 cors@2.8.5**

![](/assets/images/graphql/screen-shot-2021-03-02-at-10.50.19-pm-1536x940.png)
*npm i*


## server.js

Once the dependencies have been added we can create a server.js file.


## package.json

Now we can update the package.json file and run the GraphQL service.

"scripts": {
  "start": "node server.js"
  },


## npm start

Use "npm start" to run the GraphQL server.

**$ npm start**

![](/assets/images/graphql/screen-shot-2021-03-02-at-10.55.09-pm-1536x778.png)
*Reading books and related author details*

![](/assets/images/graphql/screen-shot-2021-03-02-at-10.57.26-pm-1536x782.png)
*Reading data for a single author*

![](/assets/images/graphql/screen-shot-2021-03-02-at-11.00.26-pm-1536x780.png)
*Mutating data. Adding an author*

![](/assets/images/graphql/screen-shot-2021-03-02-at-11.03.34-pm-1536x785.png)
*Mutating data. Adding a book*


## A GraphQL client app

It is possible to use react and apollo to create a GraphQL client app.

We create a package.json file using the npm init command
**$ npm init -y**

We add the GraphQL and Apollo dependencies using npm
**$ npm i apollo-boost@0.4.9 graphql@15.4.0 react@17.0.1 react-apollo@3.1.5 react-dom@17.0.1 react-scripts@4.0.1**

The app.js code includes a GraphQL query, an ApolloProvider and a Query.

![](/assets/images/graphql/screen-shot-2021-03-02-at-11.52.18-pm-1536x884.png)
*localhost:3000*


## API Gateway

Notice that the Cross-Origin Resource Sharing (CORS) library reference in the GraphQL code above is not needed when the GraphQL server and the GraphQL client App are published using an [API Gateway](apigateway.html).


## server.js

```javascript
const express = require('express')
const expressGraphQL = require('express-graphql')
const {
  GraphQLSchema,
  GraphQLObjectType,
  GraphQLString,
  GraphQLList,
  GraphQLInt,
  GraphQLNonNull
} = require('graphql')

const cors=require('cors'); // optional

const app = express()

app.use(cors()) // optional

const authors = [
  { id: 1, name: 'Samer Buna' },
  { id: 2, name: 'Robin Wieruch' },
  { id: 3, name: 'Nader Dabit' },
  { id: 4, name: 'Sebastian Grebe' },
  { id: 5, name: 'Eve Porcello' },
  { id: 6, name: 'Alex Banks' }
]

const books = [
  { id: 1, isbn10: '161729568X', name: 'GraphQL in Action', authorIds: [1] },
  { id: 2, isbn10: '1730853935', name: 'The Road to GraphQL: Your journey to master pragmatic GraphQL in JavaScript with React.js and Node.js', authorIds: [2] },
  { id: 3, isbn10: '1492059897', name: 'Full Stack Serverless: Modern Application Development with React, AWS, and GraphQL', authorIds: [3] },
  { id: 4, isbn10: '1789134528', name: 'Hands-On Full-Stack Web Development with GraphQL and React', authorIds: [4] },
  { id: 5, isbn10: '1492030716', name: 'Learning GraphQL: Declarative Data Fetching for Modern Web Apps', authorIds: [5, 6] },
  { id: 6, isbn10: '1492051721', name: 'Learning React: Modern Patterns for Developing React Apps', authorIds: [5, 6] },
]

const BookType = new GraphQLObjectType({
  name: 'Book',
  description: 'This represents a book written by an author',
  fields: () => ({
    id: { type: GraphQLNonNull(GraphQLInt) },
    name: { type: GraphQLNonNull(GraphQLString) },
    isbn10: { type: GraphQLNonNull(GraphQLString) },
    authorIds: { type: GraphQLNonNull(GraphQLList(GraphQLInt)) },
    authors: {
      type: new GraphQLList(AuthorType),
      resolve: (book) => {
        return authors.filter(author => (book.authorIds.includes(author.id)))
      }
    }
  })
})

const AuthorType = new GraphQLObjectType({
  name: 'Author',
  description: 'This represents an author of a book',
  fields: () => ({
    id: { type: GraphQLNonNull(GraphQLInt) },
    name: { type: GraphQLNonNull(GraphQLString) },
    books: {
      type: new GraphQLList(BookType),
      resolve: (author) => {
        return books.filter(book => (book.authorIds.includes(author.id)))
      }
    }
  })
})

const RootQueryType = new GraphQLObjectType({
  name: 'Query',
  description: 'Root Query',
  fields: () => ({
    book: {
      type: BookType,
      description: 'A Single Book',
      args: {
        id: { type: GraphQLInt }
      },
      resolve: (parent, args) => books.find(book => book.id === args.id)
    },
    books: {
      type: new GraphQLList(BookType),
      description: 'List of All Books',
      resolve: () => books
    },
    authors: {
      type: new GraphQLList(AuthorType),
      description: 'List of All Authors',
      resolve: () => authors
    },
    author: {
      type: AuthorType,
      description: 'A Single Author',
      args: {
        id: { type: GraphQLInt }
      },
      resolve: (parent, args) => authors.find(author => author.id === args.id)
    }
  })
})

const RootMutationType = new GraphQLObjectType({
  name: 'Mutation',
  description: 'Root Mutation',
  fields: () => ({
    addBook: {
      type: BookType,
      description: 'Add a book',
      args: {
        name: { type: GraphQLNonNull(GraphQLString) },
        isbn10: { type: GraphQLNonNull(GraphQLString) },
        authorIds: { type: GraphQLNonNull(GraphQLList(GraphQLInt)) }
      },
      resolve: (parent, args) => {
        const book = { id: books.length + 1, name: args.name, isbn10: args.isbn10, authorIds: args.authorIds }
        books.push(book)
        return book
      }
    },
    addAuthor: {
      type: AuthorType,
      description: 'Add an author',
      args: {
        name: { type: GraphQLNonNull(GraphQLString) }
      },
      resolve: (parent, args) => {
        const author = { id: authors.length + 1, name: args.name }
        authors.push(author)
        return author
      }
    }
  })
})

const schema = new GraphQLSchema({
  query: RootQueryType,
  mutation: RootMutationType
})

app.use('/graphql', expressGraphQL({
  schema: schema,
  graphiql: true
}))
app.listen(5000, () => console.log('Server Running'))
```

## package.json

```javascript
{
  "name": "graphql-server",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node server.js"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/haddleyoffice365/graphql-server.git"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "bugs": {
    "url": "https://github.com/haddleyoffice365/graphql-server/issues"
  },
  "homepage": "https://github.com/haddleyoffice365/graphql-server#readme",
  "dependencies": {
    "cors": "^2.8.5",
    "express": "^4.16.4",
    "express-graphql": "^0.7.1",
    "graphql": "^14.1.1"
  }
}
```

## app.js

```javascript
import ApolloClient from 'apollo-boost';
import { ApolloProvider, Query } from 'react-apollo';
import gql from 'graphql-tag';

const client = new ApolloClient({
  uri: 'http://localhost:5000/graphql'
})

const query = gql`
query booksQuery {
  books {
    id,
    name,
    authors
    {
      name
    }
  }
}
`

function App() {

  return (

    <ApolloProvider client={client}>

      <div>

        <Query query={query}>
          {
            ({ loading, error, data }) => {
              if (loading) return <h4>Loading...</h4>
              if (error) console.log({ error })
              return data.books.map(book =>
                <>
                  <h3 key={book.id}>{book.name}</h3>
                  {book.authors.map(author =>
                    <h4>{author.name}</h4>)}
                </>
              )
            }
          }
        </Query>

      </div>

    </ApolloProvider>

  );
}

export default App;
```

---

## hands-on-lab2.1

**Source file:** `hands-on-lab2.1.md`

---
title: "Hands-on-Lab 2.1"
description: "Create and configure a new company"
date: "2023-11-22"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "hands-on-lab2.1"
image: "/assets/images/hands-on-lab2.1/dynamics365-color.svg"
---



I worked through the MB-800 Business Central Functional Consultant hands on labs.

**Hands-on-Lab 2.1: Create and configure a new company**

"You are a functional consultant assigned to a new project, where you are responsible for the analysis of your customers business processes. Your customer is Contoso Inc., situated in Redmond Washington. They will start to use Microsoft Dynamics 365 Business Central as of their new fiscal year, January 1st 2024.
You initiate the process by creating a new company within the customers database, including some predefined setup information but without any business data."

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.05.24-am-1546x473.png)
*I navigated to Business Central*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.06.29-am-1546x854.png)
*I clicked the search button 🔍 in the top-right corner of the page to open the "Tell me what you want to do" dialog. I entered "Compan" and clicked the Companies link.*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.08.15-am-1545x245.png)
*I clicked New and selected the Create New Company button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.08.59-am-1544x808.png)
*I clicked Next*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.32.23-am-1544x812.png)
*I selected the Production – Setup Data Only option*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.09.53-am-1543x809.png)
*I entered the Company name*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.10.06-am-1545x811.png)
*I clicked the Manage Users link*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.10.31-am-1546x810.png)
*I selected my username*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.10.48-am-1543x806.png)
*I clicked Next*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.11.03-am-1545x808.png)
*I clicked Finish*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.11.11-am-1544x806.png)
*I Working on it... dialog appeared*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.12.24-am-503x188.png)
*A dialog explained that the operation might take 10 minutes*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.39.43-am-1543x217.png)
*I clicked the button to the left of the search button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.40.02-am-1541x295.png)
*I selected the Contoso Haddley company and clicked the Switch button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.42.46-am-1545x853.png)
*I navigated to the Contoso Haddley company*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.45.17-am-1546x298.png)
*I clicked the gear icon and clicked the Company information link*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.46.08-am-1546x811.png)
*A Company Information page was opened*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.48.47-am-1541x809.png)
*I entered information into the General tab*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.50.09-am-1545x286.png)
*I clicked the search button and navigated to the Accounting periods page*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.51.00-am-1544x809.png)
*I clicked the Create Year... button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.53.57-am-1542x810.png)
*I entered 1/1/2024 as the Starting Date*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.55.14-am-1542x808.png)
*I clicked OK*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.55.43-am-1544x812.png)
*I clicked the Yes button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.56.20-am-1544x811.png)
*The check box in the New Fiscal Year column shows that the Company's Fiscal Year will follow the Calendar year.*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.58.55-am-1545x427.png)
*I used the search button to navigate to the Zip Codes page*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.59.06-am-1545x341.png)
*No Zip Codes have been defined*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.59.26-am-1544x359.png)
*I used the search button to navigate to the Shipment Methods page*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-10.59.35-am-1546x408.png)
*No Shipment methods have been defined*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.02.07-am-1544x453.png)
*I used the search button to navigate to the Configuration Worksheet page*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.02.33-am-1548x808.png)
*The Worksheet included details of a Sales Company Area, a number of Groups (including a Master Data Group) and a number of Tables (including a Customer Table).*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.06.43-am-1545x812.png)
*I added a new General Setup Group*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.07.51-am-1544x807.png)
*I added a new ZIP Code table*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.09.10-am-1544x808.png)
*I used the three dots icon in the Table ID column to lookup the Zip Code table ID*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.10.58-am-1544x809.png)
*I used the three dots icon in the Table ID column to lookup the Shipment Method table ID*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.12.24-am-1545x810.png)
*I clicked the Copy Data from Company... button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.13.29-am-1547x810.png)
*I clicked the three dots icon in the second column and select the Select More button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.14.40-am-1545x811.png)
*A selected round check box appeared*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.16.04-am-1544x809.png)
*I clicked the round check box in the Shipment Method row and clicked the Copy Data button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.17.28-am-1545x810.png)
*I clicked the Yes button*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.18.09-am-1543x807.png)
*A dialog box appeared confirming that the selected tables had been copied*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.19.31-am-1545x444.png)
*I used the search button to navigate to the Zip Codes page*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.20.31-am-1545x808.png)
*Zip Codes had been copied*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.22.00-am-1545x473.png)
*I used the search button to navigate to the Shipment Methods page*

![](/assets/images/hands-on-lab2.1/screen-shot-2023-11-22-at-11.22.45-am-1542x810.png)
*Shipment Methods had been copied*
## References

- [Hands-on-Lab 2.1: Create and configure a new company](https://microsoftlearning.github.io/MB-800-Business-Central-Functional-Consultant/Instructions/Labs/LAB%5BMB-800%5D_M02_Lab01_Create_company.html)

---

## hands-on-lab2.2

**Source file:** `hands-on-lab2.2.md`

---
title: "Hands-on-Lab 2.2"
description: "Migrate master data to a new company"
date: "2023-11-22"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "hands-on-lab2.2"
image: "/assets/images/dynamics365-color.svg"
---



**Hands-on-Lab 2.2: Migrate master data to a new company**

"After completing the basic configuration, you can now start by uploading the company’s business data, such as customers, vendors, items and the chart of accounts.

In order to prepare the migration of this data, you will configure some configuration packages and provide these excel-files to Contoso’s super users, to complete the information.

You will start with the vendor list, including contact information. To make sure the users know how to complete the required information, you prepare the following example."

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.37.32-pm-1543x473.png)
*I used the search button to navigate to the Configuration Packages page*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.37.49-pm-1541x810.png)
*I clicked the + New button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.41.24-pm-1546x812.png)
*Dialog opened with new Configuration Package*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.42.22-pm-1542x808.png)
*I entered a code, a name and clicked on the three dots button in the Table ID column*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.42.38-pm-1541x810.png)
*I selected the Vendor Table*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.42.49-pm-1544x809.png)
*I clicked on the Table tab*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.44.35-pm-1544x810.png)
*I clicked on the Fields button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.44.51-pm-1543x809.png)
*I clicked the No button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.45.23-pm-1543x808.png)
*I clicked the Clear included button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.46.02-pm-1545x811.png)
*Only the No. field was still selected*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.47.32-pm-1545x811.png)
*I clicked on the checkboxes to select the Name, Address, City, Phone No., Currency Code, Language Code, Country/Region Code and Post Code fields*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.48.16-pm-1543x808.png)
*I clicked the Export to Excel button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.48.26-pm-1544x811.png)
*I clicked Yes*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-22-at-12.49.32-pm-1543x812.png)
*I opened the Configuration Package (the Excel Workbook)*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-24-at-3.07.41-pm-1836x827.png)
*I added the vendor details*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-12.25.53-pm-1536x803.png)
*I used the search button to access the Currencies page*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-12.26.05-pm-1536x804.png)
*I clicked the + New button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.16.55-pm-1536x808.png)
*I added GBP details*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.19.38-pm-1536x803.png)
*I set the Realized Gains and Realized Losses accounts*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.19.53-pm-1536x804.png)
*The GBP Currency had been added*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.21.17-pm-1536x808.png)
*I used the search button to access the Counties/Regions page*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.24.11-pm-1536x804.png)
*I added details for the (fictional) Island of Sodor*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.55.23-pm-1536x803.png)
*I used search to navigate back to the Configuration Packages page and selected the Import from Excel button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.55.34-pm-1536x807.png)
*I selected the updated Excel Workbook*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.56.21-pm-1536x806.png)
*I clicked the Import button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.56.58-pm-1536x806.png)
*I scrolled to the right to review the number of tables, rows and errors. I clicked the Apply Package button*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.57.11-pm-1536x807.png)
*The dialog confirmed that 9 records were inserted*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.57.24-pm-1536x807.png)
*I clicked on the Vendors link to navigate to the Vendors page*

![](/assets/images/hands-on-lab2.2/screen-shot-2023-11-23-at-3.57.38-pm-1536x804.png)
*I reviewed the inserted Vendor records*
## References

- [Hands-on-Lab 2.2: Migrate master data to a new company](https://microsoftlearning.github.io/MB-800-Business-Central-Functional-Consultant/Instructions/Labs/LAB%5BMB-800%5D_M02_Lab02_Migrate_Master_data.html)

---

## hands-on-lab2.3

**Source file:** `hands-on-lab2.3.md`

---
title: "Hands-on-Lab 2.3"
description: "Set up dimensions"
date: "2023-12-04"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "hands-on-lab2.3"
image: "/assets/images/dynamics365-color.svg"
---



**Hands-on-Lab 2.3: Set up dimensions**

"Contoso has expressed their requirements regarding reporting goals.
From the general ledger they would like to analyze their sales by sales person and customer group."

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.19.31-am-1836x948.png)
*I used search to navigate to the Dimensions page*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.20.02-am-1836x543.png)
*I clicked the + New button*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.21.07-am-1836x650.png)
*I entered the code SALESPERSON_NEWLIST and clicked the Dimensions | Dimension Values button*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.23.26-am-1836x747.png)
*I added values AH, BD, etc.*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.29.08-am-1836x651.png)
*I added a dimension with code CUSTOMERGROUP*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.29.35-am-1836x566.png)
*I selected the CUSTOMERGROUP dimension and clicked the Dimension | Account Type Default Dim button*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.30.00-am-1836x472.png)
*I clicked the ... button in the Table ID column*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.30.21-am-1836x871.png)
*I selected the Customer table*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.38.10-am-1836x417.png)
*I selected Code Mandatory in the Value Posting column*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.39.27-am-1836x430.png)
*I selected the SALESPERSON_NEWLIST dimension and clicked the Dimension | Account Type Default Dim button*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.40.06-am-1836x607.png)
*I selected the Salesperson/Purchaser table*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.40.32-am-1836x485.png)
*I selected Code Mandatory in the Value Posting column*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.42.18-am-1836x641.png)
*I used search to navigate to the Dimension Combinations page*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.44.47-am-1836x950.png)
*I clicked on the _ button in the cell in the CUSTOMERGROUP row and the SALESPERSON_NEWLIST column*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.44.59-am-1836x948.png)
*I selected Limited and clicked OK*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.45.32-am-1836x948.png)
*A Limited link is now displayed in the in the cell in the CUSTOMERGROUP row and the SALESPERSON_NEWLIST column and in the cell in the SALESPERSON_NEWLIST row and the CUSTOMERGROUP column*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.45.50-am-1836x947.png)
*I clicked the Limited link and clicked Yes*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.46.40-am-1836x948.png)
*At this point I realized that the CUSTOMERGROUP dimension had no values*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.55.55-am-1836x737.png)
*I added LARGE, MEDIUM and SMALL values to the CUSTOMERGROUP dimension*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-9.56.37-am-1836x947.png)
*I returned to the Dimension Value Combinations page*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-10.04.08-am-1836x945.png)
*I clicked the _ link in the cell in the row "AH" and column MEDIUM. I clicked the Blocked option and clicked OK*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-10.04.22-am-1836x948.png)
*I clicked the _ link in the cell in the row "AH" and column LARGE.*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-10.04.33-am-1836x950.png)
*I clicked the Blocked option and clicked OK*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-10.06.37-am-1836x949.png)
*I continued blocking combinations...*

![](/assets/images/hands-on-lab2.3/screen-shot-2023-12-04-at-10.07.24-am-1836x950.png)
*...until the blocked Dimension Value Combinations were all added*
## References

- [Hands-on-Lab 2.3: Set up dimensions](https://microsoftlearning.github.io/MB-800-Business-Central-Functional-Consultant/Instructions/Labs/LAB%5BMB-800%5D_M02_Lab03_Set_up_dimensions.html)

---

## hands-on-lab3.1

**Source file:** `hands-on-lab3.1.md`

---
title: "Hands-on-Lab 3.1"
description: "Set Up Finance Management"
date: "2023-12-04"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "hands-on-lab3.1"
image: "/assets/images/dynamics365-color.svg"
---


**Hands-on-Lab 3.1: Set Up Finance Management**

"When setting up the company you were misinformed about Contoso’s fiscal year. Although they want to use Microsoft Dynamics 365 Business Central as of January 1st 2024, their new fiscal year does not start until July 1st 2024.

You will have to correct this mistake and prepare the accounting periods for the entire fiscal year..

After setting up the correct accounting periods, you will complete some general accounting setup.

Contoso is located in the United States and will record their accounting data in US dollar, thereby respecting the currencies 2 digit decimals for displaying invoice amounts and amounts. Unit-prices however, can be shown with 2 up to 5 digit decimals.

Analysis of recorded accounting data will be mainly focused on the sales transactions, using the created dimensions. Contoso’s accounting manager would like to analyze these sales transactions directly from the chart of accounts, to make sure all the detailed information is at hand. Later they will set up some more general reports. 

He would also like to track costs by department where, for now, the main focus is on easily entering this information. The specific reporting details will be determined later on.

Once the company’s users will start to record sales and purchase transactions, the accounting manager wants to make sure they are only processed within the current accounting period. Make sure the company is set for the first transactions for January 2022, but also allow your own user to process the opening balance on December 31st 2021."

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-10.57.19-am-1836x535.png)
*I used search to navigate to the Accounting Periods page*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.41.59-am-1836x944.png)
*I selected the 7/1/2024 row*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.42.42-am-1836x948.png)
*I clicked the Edit List button*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.43.18-am-1836x948.png)
*I selected the New Fiscal Year checkbox*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.45.09-am-1836x948.png)
*I clicked the Create Year.. button, specified 7/1/2024 as the Starting Date and clicked OK*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.46.37-am-1836x840.png)
*I deselected the New Fiscal Year on the 1/1/2025 row*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.48.05-am-1836x843.png)
*I used search to navigate to the Currencies page*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.48.31-am-1836x841.png)
*I clicked the + New button*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.52.43-am-1836x917.png)
*I added USD. I selected 40330 as the Realized Gains Account.*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.53.09-am-1836x922.png)
*I selected 40330 as the Realized Losses Account.*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.53.20-am-1836x919.png)
*I clicked the left arrow button*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.53.57-am-1836x821.png)
*I used search to navigate to the General Ledger Setup page*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.55.31-am-1836x917.png)
*I checked that the local currency code (LCY Code) was set to USD. I checked the Amount Rounding and Unit-Amount Decimal settings*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.56.49-am-1836x917.png)
*I clicked the Home | Change Global Dimensions button*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.57.00-am-1836x918.png)
*The Global Dimension 1 Code and Global Dimension 2 Code settings were not set*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.57.18-am-1836x916.png)
*I set the Global Dimension 1 Code to SALESPERSON_NEWLIST*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.57.37-am-1836x916.png)
*I set the Global Dimension 1 Code to CUSTOMERGROUP*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.58.12-am-1836x366.png)
*esp8266*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-11.58.21-am-1836x913.png)
*I clicked the Sequential | Start button*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.14.02-pm-1836x810.png)
*I used search to navigate to the General Ledger Setup page*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.15.13-pm-1836x810.png)
*I scrolled down to the Dimensions tab and wanted to set Shortcut Dimension 3 to Department (but the Department dimension was missing)*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.22.16-pm-1836x729.png)
*I used search to navigate to the Dimensions page*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.23.24-pm-1836x810.png)
*I used the + New button to add the DEPARTMENT dimension*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.23.37-pm-1836x806.png)
*I selected the DEPARTMENT dimension and clicked the Dimension | Dimension Values button*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.25.18-pm-1836x704.png)
*I added the Contoso departments*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.26.11-pm-1836x687.png)
*I used search to return to the General Ledger Setup page*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.26.35-pm-1836x806.png)
*I scrolled down to the Dimensions tab and updated the Shortcut Dimension 3 setting to DEPARTMENT*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.27.03-pm-1836x809.png)
*Shortcut Dimension 3 was updated*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.28.43-pm-1836x810.png)
*I scrolled up to the General tab. I updated the Allow Posting From setting*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.29.13-pm-1836x806.png)
*I updated the Allow Posting To setting.*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.30.24-pm-1836x809.png)
*I used search to navigate to the User Setup page*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.30.40-pm-1836x809.png)
*I selected my User ID*

![](/assets/images/hands-on-lab3.1/screen-shot-2023-12-04-at-12.37.45-pm-1836x812.png)
*I added an Allow Posting From value*
## References

- [Hands-on-Lab 3.1: Set up dimensions](https://microsoftlearning.github.io/MB-800-Business-Central-Functional-Consultant/Instructions/Labs/LAB%5BMB-800%5D_M03_Lab01_Set_up_Finance.html)

---

## hubspotquotetemplate

**Source file:** `hubspotquotetemplate.md`

---
title: "HubSpot Quote Template"
description: "Quote Template"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/hubspotquotetemplate/hero.png"
tags: []
hidden: true
slug: "hubspotquotetemplate"
---



I created a custom quote template in HubSpot.

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.37.21am-2136x988.png)
*I clicked on the Settings button (the gear icon)*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.38.01am-2136x990.png)
*I selected the Data Management|Objects|Quotes menu item*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.38.16am-2136x702.png)
*I clicked the Quote template tab*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.39.15am-2136x770.png)
*I clicked the Customize quote template button*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.39.55am-2136x587.png)
*I selected the CMS Quotes Theme | Basic | Choose button*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.40.24am-2136x232.png)
*I clicked the pencil button*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.40.53am-2136x148.png)
*I updated the template name to Basic Updated and clicked the Save button*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.41.17am-2136x825.png)
*The Basic Updated quote template was added to the quote template list*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.41.25am-2136x820.png)
*I clicked the Actions | Edit list item*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.42.22am-2136x1104.png)
*I selected the Line items table menu item*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.43.32am-2136x937.png)
*I updated the Line item columns*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.44.27am-2136x838.png)
*I added an Item column*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.45.32am-2136x830.png)
*The Item column was added as the last item in the column list*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.45.45am-2136x921.png)
*I used drag and drop to move Item column to the top of the column list*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-1.22.56pm-2136x859.png)
*I added the Start Date and Term columns and removed the Products & Services and Price columns*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.49.45am-2136x1024.png)
*I selected the Commerce | Quotes menu item*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.50.02am-2136x362.png)
*I clicked the Create Quote button*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-8.50.38am-2136x881.png)
*I selected a deal and clicked next until I was able to select the new Quote template*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-1.29.00pm-2136x358.png)
*Notice that the Item, Start Date, Term and Quantity columns are displayed*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-1.54.39pm-2136x1107.png)
*I clicked the Edit CMS template button*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-3.53.52pm-2136x1026.png)
*I navigated to the line_items_table module in the cms-quotes-theme and clicked the Create child theme button.*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-3.55.40pm-1558x1110.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-3.56.16pm-1262x1244.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-3.56.54pm-1406x1042.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-3.57.37pm-2136x1020.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-3.59.53pm-2136x1022.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-4.00.17pm-1368x612.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-5.12.44pm-1584x984.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-5.17.52pm-2136x796.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-6.32.10pm-1491x770.png)
*Add one*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-5.17.03pm-2136x1275.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-6.51.42pm-2136x1122.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-6.52.32pm-2136x1123.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.05.55pm-2136x1209.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.06.33pm-2136x1207.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.07.23pm-2136x1206.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.08.01pm-2136x490.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.08.44pm-1578x1320.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.09.15pm-1262x1060.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.10.10pm-2136x767.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.11.20pm-2136x1053.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.11.46pm-1282x604.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.13.17pm-2136x735.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.13.56pm-2136x867.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.15.32pm-2136x1088.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.16.32pm-2136x1274.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.17.06pm-2136x241.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.17.29pm-2136x406.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.18.42pm-2136x1088.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.19.22pm-2136x923.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.20.30pm-1472x636.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.21.59pm-2136x912.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.22.28pm-1471x82.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.23.19pm-2136x790.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.23.57pm-1464x334.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.25.40pm-2136x892.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.26.57pm-2136x968.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.30.10pm-2136x1080.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.31.14pm-2136x992.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-14-at-7.59.38pm-2136x1014.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-15-at-10.59.10am-2136x990.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-15-at-10.59.58am-1268x568.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-15-at-11.01.41am-2136x990.png)
*<<COMMENT>>*

![](/assets/images/hubspotquotetemplate/screenshot-2024-10-15-at-11.04.29am-2136x1147.png)
*<<COMMENT>>*


---

## internetofthings1

**Source file:** `internetofthings1.md`

---
title: "Internet of Things (Part 1)"
description: "ESP8266 is a low-cost Wi-Fi microchip, with a full TCP/IP stack and microcontroller capability."
date: "2021-03-03"
categories: ["DevOps"]
tags: []
slug: "internetofthings1"
image: "/assets/images/iot-microchip.svg"
---


## Breadboard

Here an ESP8266 device is connected to a DHT11 temperature and humidity sensor.

With the Hardware assembled we can create and configure the Internet of Things (IoT) software.

An MQTT publish/subscribe broker will be at the center of the software configuration. We will upload code to the ESP8266 that will allow the ESP8266 device to communicate with other devices via the MQTT broker.

![esp8266](/assets/images/internetofthings1/esp8266-512x384.png)
*ESP8266 with DHT Sensor*


## Arduino IDE setup

The Arduino Integrated Development Environment (IDE) can be used to create and upload C++ code to an ESP8266.

To add support for ESP8266 boards to the Arduino IDE select the "Arduino|Preferences..." menu item and add this url to the "additional boards manager" text box:

http://arduino.esp8266.com/stable/package_esp8266com_index.json

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-9.23.14-pm-1592x1116.png)
*Arduino IDE Preferences*


## Support for the ESP8266 board

Use the "Tools|Board|Boards Manager..." menu item to install support for the ESP8266 boards.

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-9.28.06-pm-1108x122.png)
*Boards Manager...*

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*Boards package*


## GitHub boards

The ESP8266 boards information is maintained in a GitHub repository

[https://github.com/esp8266/Arduino](https://github.com/esp8266/Arduino)

Once the boards package is installed the correct ESP8266 board can be selected.

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-9.36.46-pm-1512x318.png)
*Selecting "NodeMCU (ESP-12E Module)"*


## ESP8622 Libraries

Arduino libraries can downloaded to the Arduino IDE using the "Tools|Manage Libraries..." menu item.

The PubSubClient library allows the ESP8266 to connect to an MQTT broker.

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-9.55.43-pm-1596x902.png)
*PubSubClient Library*


## PubSubLibrary example

[knolleary/pubsubclient](https://github.com/knolleary/pubsubclient) is licensed under the MIT License.

Once the PubSubClient Library is installed the mqtt_esp8266 example sketch is added to the "File|Examples" Menu.

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-9.58.23-pm-906x374.png)
*An example ESP8266 sketch*


## The mqtt_esp8266 example sketch

The mqtt_esp8266 example sketch subscribes to an MQTT server's "inTopic" messages.

When an "inTopic" message is received by the ESP8266 the example code's "callback" function is executed. If the payload of the "inTopic" message is the string "1" the ESP8266's builtin LED is turned on.

Every two seconds the example sketch publishes a "hello world" message to "outTopic".


## MQTT

MQTT is a publish/subscribe messaging system commonly used by IoT devices.

The 'eclipse-mosquitto' Docker container image can be used to establish a test MQTT broker.

**$ docker run -it -p 1883:1883 -p 9001:9001 eclipse-mosquitto:1.4.8**

![eclipse-mosquitto](/assets/images/internetofthings1/screen-shot-2021-03-04-at-5.36.09-pm-1132x734.png)
*eclipse-mosquitto Docker image*


## MQTT Explorer

Desktop and mobile applications are able to connect to an MQTT broker showing messages that are being published. Desktop and mobile applications allow users to manually publish messages to an MQTT broker.

![](/assets/images/internetofthings1/screen-shot-2021-03-04-at-6.25.29-pm-1836x1286.png)
*MQTT Explorer connecting to the MQTT broker*

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-11.11.07-pm-622x362.png)
*ESP8266 is publishing "outTopic" messages to the MQTT broker*

![](/assets/images/internetofthings1/screen-shot-2021-03-06-at-11.21.28-pm-1616x930.png)
*MQTT explorer publishes an "inTopic" message with payload "1" to the MQTT broker and the ESP8266's LED turns on.*


## mqtt_esp8266.ino

```text
/*
 Basic ESP8266 MQTT example
 This sketch demonstrates the capabilities of the pubsub library in combination
 with the ESP8266 board/library.
 It connects to an MQTT server then:
  - publishes "hello world" to the topic "outTopic" every two seconds
  - subscribes to the topic "inTopic", printing out any messages
    it receives. NB - it assumes the received payloads are strings not binary
  - If the first character of the topic "inTopic" is an 1, switch ON the ESP Led,
    else switch it off
 It will reconnect to the server if the connection is lost using a blocking
 reconnect function. See the 'mqtt_reconnect_nonblocking' example for how to
 achieve the same result without blocking the main loop.
 To install the ESP8266 board, (using Arduino 1.6.4+):
  - Add the following 3rd party board manager under "File -> Preferences -> Additional Boards Manager URLs":
       http://arduino.esp8266.com/stable/package_esp8266com_index.json
  - Open the "Tools -> Board -> Board Manager" and click install for the ESP8266"
  - Select your ESP8266 in "Tools -> Board"
*/

/**/

#include <ESP8266WiFi.h>
#include <PubSubClient.h>

// Update these with values suitable for your network.

const char* ssid = "........";
const char* password = "........";
const char* mqtt_server = "broker.mqtt-dashboard.com";

WiFiClient espClient;
PubSubClient client(espClient);
unsigned long lastMsg = 0;
#define MSG_BUFFER_SIZE	(50)
char msg[MSG_BUFFER_SIZE];
int value = 0;

void setup_wifi() {

  delay(10);
  // We start by connecting to a WiFi network
  Serial.println();
  Serial.print("Connecting to ");
  Serial.println(ssid);

  WiFi.mode(WIFI_STA);
  WiFi.begin(ssid, password);

  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  randomSeed(micros());

  Serial.println("");
  Serial.println("WiFi connected");
  Serial.println("IP address: ");
  Serial.println(WiFi.localIP());
}

void callback(char* topic, byte* payload, unsigned int length) {
  Serial.print("Message arrived [");
  Serial.print(topic);
  Serial.print("] ");
  for (int i = 0; i < length; i++) {
    Serial.print((char)payload[i]);
  }
  Serial.println();

  // Switch on the LED if an 1 was received as first character
  if ((char)payload[0] == '1') {
    digitalWrite(BUILTIN_LED, LOW);   // Turn the LED on (Note that LOW is the voltage level
    // but actually the LED is on; this is because
    // it is active low on the ESP-01)
  } else {
    digitalWrite(BUILTIN_LED, HIGH);  // Turn the LED off by making the voltage HIGH
  }

}

void reconnect() {
  // Loop until we're reconnected
  while (!client.connected()) {
    Serial.print("Attempting MQTT connection...");
    // Create a random client ID
    String clientId = "ESP8266Client-";
    clientId += String(random(0xffff), HEX);
    // Attempt to connect
    if (client.connect(clientId.c_str())) {
      Serial.println("connected");
      // Once connected, publish an announcement...
      client.publish("outTopic", "hello world");
      // ... and resubscribe
      client.subscribe("inTopic");
    } else {
      Serial.print("failed, rc=");
      Serial.print(client.state());
      Serial.println(" try again in 5 seconds");
      // Wait 5 seconds before retrying
      delay(5000);
    }
  }
}

void setup() {
  pinMode(BUILTIN_LED, OUTPUT);     // Initialize the BUILTIN_LED pin as an output
  Serial.begin(115200);
  setup_wifi();
  client.setServer(mqtt_server, 1883);
  client.setCallback(callback);
}

void loop() {

  if (!client.connected()) {
    reconnect();
  }
  client.loop();

  unsigned long now = millis();
  if (now - lastMsg > 2000) {
    lastMsg = now;
    ++value;
    snprintf (msg, MSG_BUFFER_SIZE, "hello world #%ld", value);
    Serial.print("Publish message: ");
    Serial.println(msg);
    client.publish("outTopic", msg);
  }
}
```

---

## internetofthings2

**Source file:** `internetofthings2.md`

---
title: "Internet of Things (Part 2)"
description: "Node-RED can publish messages to a MQTT broker and subscribe to MQTT topics."
date: "2021-03-06"
categories: ["AWS","DevOps"]
tags: []
slug: "internetofthings2"
image: "/assets/images/iot-microchip.svg"
---


## Node-RED

Node-RED can be used to publish messages to an MQTT broker.

Node-RED is able to subscribe to MQTT broker messages.

**$ docker run -it -p 1880:1880 nodered/node-red**

![](/assets/images/internetofthings2/screen-shot-2021-03-04-at-7.46.57-pm-1136x736.png)
*node-red Docker image*

![](/assets/images/internetofthings2/screen-shot-2021-03-06-at-11.35.48-pm-1836x1045.png)
*Connecting Node-RED to the MQTT broker*

![](/assets/images/internetofthings2/screen-shot-2021-03-06-at-11.41.33-pm-1836x1051.png)
*"mqtt in" node subscribes to "outTopic" messages*

![](/assets/images/internetofthings2/screen-shot-2021-03-06-at-11.42.05-pm-1836x1053.png)
*"debug" node displays the incoming "outTopic" messages on debug panel*

![](/assets/images/internetofthings2/screen-shot-2021-03-06-at-11.45.34-pm-1836x1040.png)
*"mqtt out" node publishes "1" or "0" to the "inTopic" and ESP8266 LED turns on or off.*


## MQTT topics and payloads

In the example above "inTopic" is a command topic and "outTopic" is a topic for telemetry.


## Command Topics

In the example above the ESP8266 microprocessor subscribes to "inTopic" messages and when it sees a message with the payload "1" the builtin LED is turned on. 

In fact dozens or hundreds of IoT devices could subscribe to "inTopic" messages turning on or off together. 

But, what if a developer would like a single ESP8266 device's builtin LED to turn on? What if a developer would like to turn on a fan connected to a single ESP8266 device? What if a developer would like to turn off the fans connected to all ESP8266 devices on given floor of a given building?

Well every device that connects to an MQTT broker has a unique "thing name" (and a unique MQTT client id) but how would the publisher of a control message specify that they wanted to turn off the fan connected to the ESP8266 with a given "thing name"?


## Topic structure

If a device with thing name "thing1" is in conference room 2 on floor 2 of building 3 a developer can arrange for that thing's builtin LED to turn off whenever a message with payload "0" is published with this topic:

**cmd/hvac/building3/floor2/confroom2/thing1/builtinled**

A developer can arrange for a fan controlled by thing1 to be turned on whenever a message with payload "1" is published with this topic:

**cmd/hvac/building3/floor2/confroom2/thing1/fan**

A developer can arrange for fans controlled by all things on floor 2 to be turned off when a message with payload "0" is published with this topic:

**cmd/hvac/building3/floor2/fan**

Sample ESP8266 code is shown below.

![](/assets/images/internetofthings2/screen-shot-2021-03-07-at-11.21.47-am-1836x1106.png)
*publishing to "cmd/hvac/building3/floor2/confroom2/thing1/builtinled"*

![](/assets/images/internetofthings2/screen-shot-2021-03-07-at-11.35.42-am-1836x1108.png)
*subscribing to "cmd/hvac/#'*


## Response

If the publisher of a Command Topic message wants to receive responses they might provide a JSON payload that includes a "session-id" and a "res-topic". The session-id would be passed to the ESP8266 device so that it can differentiate between commands that are repeated or re-sent over time. The res-topic would be used as the response message's topic (it is better not to hardcode the response message's topic).

Instead of passing the string "1" the Command Topic message's payload would be:

{
"session-id":"session-123456789012",
"res-topic":"cmd/hvac/building3/floor2/res",
"value":"1"
}


## Topic for telemetry

Telemetry is read-only data that is transmitted by a device and aggregated elsewhere.

A temperature sensor reading might be published by the ESP8266 using this topic 

**dt/hvac/building3/floor2/confroom2/thing1/temperature**

the temperature units might be published using this topic

**dt/hvac/building3/floor2/confroom2/thing1/temperature/units**

A humidity sensor reading might be published by the ESP8266 using this topic

**dt/hvac/building3/floor2/confroom2/thing1/humidity**

How often an ESP8266 should publish a value depend on the application. The device could publish an update every few minutes, every few seconds or every time the value changes.


## Data subscriptions

While telemetry messages are being published to the MQTT server client applications can subscribe to individual topics or to multiple topics using wildcards.

The # wildcard matches multiple topic name levels. 

The + wildcard matches a single topic name level.

![](/assets/images/internetofthings2/screen-shot-2021-03-07-at-3.27.31-pm-1836x938.png)
*Humidity sensor readings from 2nd floor of building 3.*


## mqtt_esp8266_topic_structure.ino

```text
#include <ESP8266WiFi.h>
#include <PubSubClient.h>

const char* THING_NAME = "thing1";

const char* ssid = "<WIFI NAME>";
const char* password = "<WIFI PASSWORD>"
const char* mqtt_server = "<MQTT BROKER ADDRESS>";
const int CONNECTED_FAN = 4; // GOIP D2

WiFiClient espClient;
PubSubClient client(espClient);
unsigned long lastMsg = 0;
#define MSG_BUFFER_SIZE	(50)
char msg[MSG_BUFFER_SIZE];
int value = 0;

void setup_wifi() {

  delay(10);
  Serial.println();
  Serial.print("Connecting to ");
  Serial.println(ssid);

  WiFi.mode(WIFI_STA);
  WiFi.begin(ssid, password);

  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  Serial.println("");
  Serial.println("WiFi connected");
  Serial.println("IP address: ");
  Serial.println(WiFi.localIP());
}

void callback(char* topic, byte* payload, unsigned int length) {
  Serial.print("Message arrived [");
  Serial.print(topic);
  Serial.print("] ");
  for (int i = 0; i < length; i++) {
    Serial.print((char)payload[i]);
  }
  Serial.println();

  String strTopic(topic);
  if (strTopic.endsWith("/builtinled")) {
    if ((char)payload[0] == '1') {
      digitalWrite(BUILTIN_LED, LOW);   // Turn the LED on (Note that LOW is the voltage level
    } else {
      digitalWrite(BUILTIN_LED, HIGH);  // Turn the LED off by making the voltage HIGH
    }
  }
  if (strTopic.endsWith("/fan")) {
    if ((char)payload[0] == '1') {
      digitalWrite(CONNECTED_FAN, LOW);   // Turn the FAN off
    } else {
      digitalWrite(CONNECTED_FAN, HIGH);  // Turn the FAN on
    }
  }


}

void reconnect() {
  // Loop until we're reconnected
  while (!client.connected()) {
    Serial.print("Attempting MQTT connection...");

    // Create a "thing name"/client ID
    String strThingName(THING_NAME);
    String fullpathThingName = "cmd/hvac/building3/floor2/confroom2/"+strThingName+"/+";

    // Attempt to connect
    if (client.connect(THING_NAME)) {
      Serial.println("connected");
      // resubscribe
      client.subscribe(fullpathThingName.c_str());
      client.subscribe("cmd/hvac/building3/floor2/confroom2/+");
      client.subscribe("cmd/hvac/building3/floor2/+");
      client.subscribe("cmd/hvac/building3/+");
    } else {
      Serial.print("failed, rc=");
      Serial.print(client.state());
      Serial.println(" try again in 5 seconds");
      // Wait 5 seconds before retrying
      delay(5000);
    }
  }
}

void setup() {
  pinMode(BUILTIN_LED, OUTPUT);     // Initialize the BUILTIN_LED pin as an output
  pinMode(CONNECTED_FAN, OUTPUT);   // Initialize CONNECTED_FAN  - GOIP D2 - as an output
  Serial.begin(115200);
  setup_wifi();
  client.setServer(mqtt_server, 1883);
  client.setCallback(callback);
}

void loop() {

  if (!client.connected()) {
    reconnect();
  }
  client.loop();

}
```

## mqtt_esp8266_topic_structure_telemetry.ino

```text
#include <ESP8266WiFi.h>
#include <PubSubClient.h>
#include "DHT.h"

const char* THING_NAME = "thing1";

// Create a "thing name"/client ID
static String strThingName(THING_NAME);

const char* ssid = "<WIFI NAME>";
const char* password = "<WIFI PASSWORD>"
const char* mqtt_server = "<MQTT BROKER ADDRESS>";
const int CONNECTED_FAN = 4; // GOIP D2

#define DHTTYPE DHT11   // DHT 11
// DHT Sensor
const int DHTPin = 5; // GPIO D1
// Initialize DHT sensor.
DHT dht(DHTPin, DHTTYPE);

// Temporary variables
static char celsiusTemp[7];
static char fahrenheitTemp[7];
static char humidityTemp[7];

#define  FLT_MIN   1.17549435E-38F

static float h_old = FLT_MIN;
static float t_old = FLT_MIN;

WiFiClient espClient;
PubSubClient client(espClient);
unsigned long lastMsg = 0;
#define MSG_BUFFER_SIZE	(50)
char msg[MSG_BUFFER_SIZE];

void setup_wifi() {

  delay(10);
  // We start by connecting to a WiFi network
  Serial.println();
  Serial.print("Connecting to ");
  Serial.println(ssid);

  WiFi.mode(WIFI_STA);
  WiFi.begin(ssid, password);

  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  Serial.println("");
  Serial.println("WiFi connected");
  Serial.println("IP address: ");
  Serial.println(WiFi.localIP());
}

void callback(char* topic, byte* payload, unsigned int length) {
  Serial.print("Message arrived [");
  Serial.print(topic);
  Serial.print("] ");
  for (int i = 0; i < length; i++) {
    Serial.print((char)payload[i]);
  }
  Serial.println();

  String strTopic(topic);
  if (strTopic.endsWith("/builtinled")) {
    if ((char)payload[0] == '1') {
      digitalWrite(BUILTIN_LED, LOW);   // Turn the LED on (Note that LOW is the voltage level
    } else {
      digitalWrite(BUILTIN_LED, HIGH);  // Turn the LED off by making the voltage HIGH
    }
  }
  if (strTopic.endsWith("/fan")) {
    if ((char)payload[0] == '1') {
      digitalWrite(CONNECTED_FAN, LOW);   // Turn the FAN off
    } else {
      digitalWrite(CONNECTED_FAN, HIGH);  // Turn the FAN on
    }
  }

}

void reconnect() {
  // Loop until we're reconnected
  while (!client.connected()) {
    Serial.print("Attempting MQTT connection...");

    String fullpathThingName = "cmd/hvac/building3/floor2/confroom2/" + strThingName + "/+";

    // Attempt to connect
    if (client.connect(THING_NAME)) {
      Serial.println("connected");
      // resubscribe
      client.subscribe(fullpathThingName.c_str());
      client.subscribe("cmd/hvac/building3/floor2/confroom2/+");
      client.subscribe("cmd/hvac/building3/floor2/+");
      client.subscribe("cmd/hvac/building3/+");
    } else {
      Serial.print("failed, rc=");
      Serial.print(client.state());
      Serial.println(" try again in 5 seconds");
      // Wait 5 seconds before retrying
      delay(5000);
    }
  }
}

void setup() {
  pinMode(BUILTIN_LED, OUTPUT);     // Initialize the BUILTIN_LED pin as an output
  pinMode(CONNECTED_FAN, OUTPUT);
  Serial.begin(115200);
  setup_wifi();
  client.setServer(mqtt_server, 1883);
  client.setCallback(callback);
}

void loop() {

  if (!client.connected()) {
    reconnect();
  }
  client.loop();

  unsigned long now = millis();
  if (now - lastMsg > 5000) {

    // SENSOR READ START

    // Sensor readings may also be up to 5 seconds 'old' (its a very slow sensor)
    float h = dht.readHumidity();
    // Read temperature as Celsius (the default)
    float t = dht.readTemperature();
    // Read temperature as Fahrenheit (isFahrenheit = true)
    float f = dht.readTemperature(true);
    // Check if any reads failed and exit early (to try again).
    if (isnan(h) || isnan(t) || isnan(f)) {
      Serial.println("Failed to read from DHT sensor!");
      strcpy(celsiusTemp, "Failed");
      strcpy(fahrenheitTemp, "Failed");
      strcpy(humidityTemp, "Failed");
    }
    else {
      // Computes temperature values in Celsius + Fahrenheit and Humidity
      float hic = dht.computeHeatIndex(t, h, false);
      dtostrf(hic, 6, 2, celsiusTemp);
      float hif = dht.computeHeatIndex(f, h);
      dtostrf(hif, 6, 2, fahrenheitTemp);
      dtostrf(h, 6, 2, humidityTemp);
      // You can delete the following Serial.print's, it's just for debugging purposes
      Serial.print("Humidity: ");
      Serial.print(h);
      Serial.print(" %\t Temperature: ");
      Serial.print(t);
      Serial.print(" *C ");
      Serial.print(f);
      Serial.print(" *F\t Heat index: ");
      Serial.print(hic);
      Serial.print(" *C ");
      Serial.print(hif);
      Serial.println(" *F");

      if (h != h_old) {
        String fullpathThingNameHumidity = "dt/hvac/building3/floor2/confroom2/" +
                                           strThingName + "/humidity";
        client.publish(fullpathThingNameHumidity.c_str(), humidityTemp);
        h_old = h;
      }
      if (t != t_old) {
        String fullpathThingNameTemperature = "dt/hvac/building3/floor2/confroom2/"
                                              + strThingName + "/temperature";
        client.publish(fullpathThingNameTemperature.c_str(), celsiusTemp);
        t_old=t;
      }
    }

    // SENSOR READ END

    lastMsg = now;
  
  }
}
```

## References

- [Designing MQTT Topics for AWS IoT Core](https://docs.aws.amazon.com/whitepapers/latest/designing-mqtt-topics-aws-iot-core/designing-mqtt-topics-aws-iot-core.html) - AWS whitepaper on MQTT topic design patterns and best practices for IoT Core implementation.

---

## internetofthings3

**Source file:** `internetofthings3.md`

---
title: "Internet of Things (Part 3)"
description: "Arduino Nano 33 BLE Sense"
date: "2025-03-01"
categories: ["AI"]
tags: []
slug: "internetofthings3"
image: "/assets/images/iot-microchip.svg"
---



Edge Impulse is a development platform for creating machine learning (ML) models optimized for edge devices. It allows developers to collect data, train ML models, and deploy them on low-power hardware such as microcontrollers, IoT devices, and embedded systems. The platform is particularly useful for applications in **industrial automation, healthcare, predictive maintenance, and smart devices**.

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-9.04.25am-2136x1234.png)
*I navigated to https://studio.edgeimpulse.com/*


The Arduino Nano 33 BLE Sense is a compact, microcontroller board designed for Artificial Intelligence (AI) and Internet of Things (IoT) applications, featuring built-in sensors and Bluetooth Low Energy (BLE) connectivity. 

The Arduino Nano 33 BLE Sense can be used in edge computing, AI/ML applications, and sensor-based projects.

![](/assets/images/internetofthings3/nano33-ble-sense-650x374.png)
*Nano 33 BLE Sense User Manual*


## Edge Impulse firmware

I installed the Edge Impulse firmware on the Arduino Nano 33 BLE Sense to improve its connectivity with Edge Impulse Studio for data collection.

![](/assets/images/internetofthings3/482410156-627953613276540-5451296773514265879-n-859x450.png)
*I followed these instructions https://docs.edgeimpulse.com/docs/edge-ai-hardware/mcu/arduino-nano-33-ble-sense*


## Sampling Frequency

The Edge Impulse firmware for the Arduino Nano 33 BLE Sense supports a sampling frequency of 16,000 Hz.

Audio files recorded with this firmware can be previewed and edited in Edge Impulse Studio.

I noticed that the play, pause, and volume media controls in Edge Impulse Studio only appeared when the selected audio file had been recorded using an Arduino Nano 33 BLE Sense with the Edge Impulse firmware installed.

![](/assets/images/internetofthings3/482435269-1145132687404726-4716611611337756326-n-1102x688.png)
*The Edge Impulse firmware for the Arduino Nano 33 BLE Sense supports a sampling frequency of 16,000 Hz.*

![](/assets/images/internetofthings3/476496236-1162144762281696-6300659400931351561-n-1359x645.png)
*When the dog was barking I clicked the Start sampling button*

![](/assets/images/internetofthings3/476504697-664391085933372-6833322121764778224-n-1366x673.png)
*The button text updated to Waiting to start...*

![](/assets/images/internetofthings3/476492243-9287067184705791-2599704835014173228-n-1365x696.png)
*The button text updated to Sampling... (Xs left)*

![](/assets/images/internetofthings3/476497092-484165971427295-7355111782948313514-n-1366x690.png)
*The button text updated to Reading data from device (XX%)...*

![](/assets/images/internetofthings3/476497322-1578815952747483-1090199327499510722-n-1366x680.png)
*The button text updated to Uploading...*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-1.08.35pm-2136x911.png)
*I selected a 10 second sample and selected the Split sample menu option*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-1.10.25pm-2136x1344.png)
*Edge Impulse highlighted 6 interesting segments. I clicked the Split button*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-1.55.50pm-2136x1100.png)
*I reviewed each of the newly created 1 second segment keeping every sample that was useful.*


## Training and Testing groups

Data is split into **Training** and **Testing** groups to ensure that a machine learning model generalizes well to new, unseen data. This separation helps prevent overfitting, where a model performs well on the training data but poorly on new inputs.

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.44.44pm-2136x712.png)
*I clicked the Perform train / test split button*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.45.21pm-2136x1103.png)
*I clicked the Yes, perform the train / test split button*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.45.49pm-2136x1099.png)
*I typed perform split and clicked the Perform train / test split button*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.46.10pm-2136x1110.png)
*I clicked the OK button*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.47.22pm-2136x1173.png)
*The samples were divided into a training set and a test set*


## EON Tuner

The Edge Impulse EON Tuner is a machine learning optimization tool that helps developers find the best ML model configuration for edge devices. It evaluates different model architectures, balancing accuracy, latency, and memory usage, to ensure the best possible performance on resource-constrained hardware.

[https://www.youtube.com/watch?v=c3R9w7R_tRw](https://www.youtube.com/watch?v=c3R9w7R_tRw)

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.54.42pm-2136x481.png)
*EON Tuner*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.55.55pm-2136x344.png)
*I selected Audible events*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.22.47pm-2136x1261.png)
*Audible events. Listen for short one-time occurrences of non-voice audio*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-5.58.09pm-2136x1173.png)
*EON Tuner is running...*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.07.06pm-2136x1165.png)
*EON Tuner results*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.27.34pm-2136x1001.png)
*I clicked the + Add button on the best looking model configuration*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.28.07pm-2136x1088.png)
*mfcc-conv1d-8f2 was added as an Impulse*


## Deployment

After training the model I was able to deploy it to the Arduino Nano 33 BLE Sense.

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.29.25pm-2136x1177.png)
*I clicked the Deployment menu item. I clicked the Build button*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.30.56pm-2136x966.png)
*An Arduino library .zip file was generated*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.31.41pm-1758x204.png)
*I copied the .zip file from the Downloads folder*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.33.14pm-1754x324.png)
*I copied the .zip file to the Arduino libraries folder*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.37.25pm-1758x1150.png)
*I unzipped the library*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.35.20pm-2136x292.png)
*I ran the Arduino Integrated Development Environment (IDE)*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.38.40pm-2136x1288.png)
*I selected the nano_ble33_sense_microphone example*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.39.38pm-2136x237.png)
*I clicked the Upload button*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.40.32pm-2136x1241.png)
*I waited for the sketch to compile*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.44.58pm-2136x1200.png)
*I waited for the sketch to be uploaded to the Arduino Nano 33 BLE Sense*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.45.39pm-2136x347.png)
*I started the Serial Monitor*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-6.47.04pm-2136x1232.png)
*With no barking the model correctly predicted: Background*

![](/assets/images/internetofthings3/screenshot-2025-03-01-at-7.20.55pm-2136x1238.png)
*With barking the model correctly predicted: Bark*

## References

- [Arduino Nano 33 BLE Sense](https://docs.edgeimpulse.com/docs/edge-ai-hardware/mcu/arduino-nano-33-ble-sense) - Edge Impulse documentation for Arduino Nano 33 BLE Sense development
- [TinyML Dog Bark Stopper](https://www.hackster.io/NathanielF/tinyml-dog-bark-stopper-77e436) - Hackster.io project tutorial for creating a dog bark detection system
- [The Bark Stopper GitHub](https://github.com/NathanielFelleke/The-Bark-Stopper) - GitHub repository with source code for the bark stopper project
- [Wio Terminal TinyML Course #2 Audio Scene Recognition - ML on Microcontrollers with Arduino IDE](https://www.youtube.com/watch?v=2BISspenUng&t=1194s) - YouTube tutorial on audio scene recognition with TinyML
- [Connecting Arduino Nano 33 BLE Sense to Edge Impulse](https://www.youtube.com/watch?v=wOkMZUaPLUM) - YouTube tutorial on connecting Arduino Nano to Edge Impulse platform

---

## ionic

**Source file:** `ionic.md`

---
title: "Ionic"
description: "Cross-platform apps.Powered by the Web."
date: "2021-12-22"
categories: ["React","TypeScript","Azure","DevOps"]
tags: []
slug: "ionic"
image: "/assets/images/logo-192x192.png"
---



## Starting an app

$ npm install -g @ionic/cli

$ ionic start <name>

In this case we will create a todo [Progressive Web Application](pwa.html) (PWA)

$ ionic start haddley-todo

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.01.48-pm-586x372.png)
*React*

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.15.41-pm-585x370.png)
*blank*


## Running

$ cd <name>

$ ionic serve

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.17.22-pm-588x374.png)
*ionic serve*

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.21.33-pm-767x492.png)
*blank*


## Visual Studio Code

$ code .

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.25.04-pm-1026x771.png)
*Visual Studio Code*


## IndexDB

Modern browsers support IndexDB.

The Localbase package makes it easier to work with IndexDB.

$ npm install localbase --save

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.30.00-pm-1001x698.png)
*npm install localbase*


## localbase.d.ts

Localbases does not include typescript type definitions.

To workaround this issue create a localbase.d.ts file

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.32.49-pm-323x75.png)
*localbase.d.ts*

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.33.11-pm-1000x478.png)
*contents*


## todos.ts

Create a TypeScript file that defines the "Todo" interface and uses Localbase to fetch, create and update todo items.

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.39.55-pm-1000x478.png)
*todos.ts*


## TodoListItem

A react component to display each todo item.

Created using Ionic Web Components {IonItem, IonCheckbox and IonLabel}

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.44.26-pm-1322x711.png)
*TodoListItem*


## Home.tsx

The home page fetches todo items from browser's IndexDB using the getTodos() method defined in todos.ts.

The home page uses the setComplete(...) method to toggle the completed value.

The home page uses the addToDo(...) method to add a new todo item.

The home page uses Ionic Web Components to display a text box and a list of TodoListItems {IonButton, IonContent, IonHeader, IonInput, IonItem, IonList, IonPage, IonRefresher, IonRefresherContent, IonTitle and IonToolbar}.

The IonRefresher Web Component allows a user to refresh the list by swiping the list from top to bottom.

![](/assets/images/ionic/screen-shot-2021-12-22-at-3.52.51-pm-1327x706.png)
*Home.tsx*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.01.53-pm-1718x607.png)
*Web Inspector (Safari)*


## pwa-asset-generator

The pwa-asset-generator can be used to generate a set of application icons from a single .jpg image

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.22.35-pm-1324x711.png)
*pwa-asset-generator*


## index.html

Update public/index.html to include the links

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.24.04-pm-1321x714.png)
*generated icons*


## manifest.json

The public/manifest.json file provides details of the web application.

Update the manifest.json file to reference the generated icons

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.03.42-pm-1326x709.png)
*default manifest.json*


## updated manifest.json

Update the application name.

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.28.44-pm-1322x709.png)
*Updated manifest.json*


## Service Worker

Service Worker allows the PWA to run offline.

Service Worker allows the PWA to upgrade while online.

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.35.51-pm-1323x710.png)
*serviceWorkerRegistration.register(...)*


## build

$ ionic build

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.38.55-pm-1324x712.png)
*ionic build*


## Deploy to Azure

Deploy to Static Website via Azure Storage...

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.39.41-pm-1324x710.png)
*Deploy to Static Website...*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.40.36-pm-638x98.png)
*Create new Storage Account...*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.40.50-pm-623x92.png)
*haddleytodo*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.41.45-pm-472x58.png)
*Creating...*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.44.37-pm-465x182.png)
*Deployment complete*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.45.20-pm-894x523.png)
*Running in safari (from Azure)*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.48.42-pm-355x732.png)
*Running on iPhone Simulator (Safari)*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.49.00-pm-358x730.png)
*Add to Home Screen*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.49.09-pm-360x730.png)
*Add*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.49.18-pm-360x730.png)
*Icon on home screen*

![](/assets/images/ionic/screen-shot-2021-12-22-at-4.49.58-pm-363x732.png)
*Running (online)*

![](/assets/images/ionic/screen-shot-2021-12-22-at-5.06.21-pm-357x730.png)
*Updated version available*


## IonItemSliding

Add the IonItemSliding tag and the user is able to swipe an item from right to left to reveal a Delete option.

![](/assets/images/ionic/screen-shot-2021-12-23-at-1.00.16-pm-1310x778.png)
*IonItemSliding*

![](/assets/images/ionic/screen-shot-2021-12-23-at-1.00.42-pm-718x1446.png)
*Swipe list item right to left*


## PouchDB

[PouchDB](https://pouchdb.com) is an open-source JavaScript database inspired by Apache CouchDB that is designed to run well within the browser.

PouchDB was created to help web developers build applications that work as well offline as they do online.


## CouchDB

```bash
% docker run -p 5984:5984 -e COUCHDB_USER=admin -e COUCHDB_PASSWORD=password -d couchdb

% curl localhost:5984
```

http://localhost:5984/_utils/

The code below demonstrates how the todo application was updated to use PouchDB and CouchDB.

![](/assets/images/ionic/screen-shot-2021-12-27-at-12.16.35-pm-1162x546.png)
*docker run ...*

![](/assets/images/ionic/screen-shot-2021-12-27-at-12.18.39-pm-587x276.png)
*curl localhost:5984*

![](/assets/images/ionic/screen-shot-2021-12-27-at-12.20.36-pm-1146x613.png)
*_utils*

![](/assets/images/ionic/screen-shot-2021-12-27-at-12.22.03-pm-1145x617.png)
*Enable CORS*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.10.40-pm-1352x718.png)
*No databases*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.10.59-pm-1354x722.png)
*Adding Task 1 using Safari*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.11.09-pm-1353x721.png)
*Task 1 has been added*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.11.21-pm-1352x721.png)
*Task 1 details have been replicated to the CouchDB server*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.11.34-pm-1355x719.png)
*All documents*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.11.44-pm-1354x720.png)
*Task 1 details*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.12.00-pm-1353x719.png)
*Task 1 has been replicated to Chrome*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.12.11-pm-1353x719.png)
*Task 1 has been updated using Chrome*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.13.40-pm-1355x718.png)
*Task 1 update has been replicated to Safari*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.16.12-pm-1272x721.png)
*CouchDB is stopped*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.17.25-pm-1570x898.png)
*Multiple changes made offline using Safari and Chrome*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.17.54-pm-1267x718.png)
*CouchDB server started*

![](/assets/images/ionic/screen-shot-2021-12-27-at-2.18.50-pm-1570x901.png)
*Multiple updates are replicated to/from Safari/Chrome*


## datatodos.ts

```text
import Localbase from 'localbase'

function createGuid() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    });
}

export interface Todo {
    guid: string;
    task: string;
    completed: boolean;
}

let db = new Localbase('todos')

export const getTodos = async () => {
    const todos = await db.collection('tasks').get()
    console.log(todos)
    return todos
}

export const setCompleted: any = async (guid: string, completed: boolean) => {
    await db.collection('tasks').doc({ guid: guid }).update({
        completed: completed
    })
    return
}

export const addToDo: any = async (description: string) => {
    const guid = createGuid();
    await db.collection('tasks').add({
        guid: guid,
        task: description,
        completed: false
    })
    return guid
}
```

## componentsTodoListItem.tsx

```text
import {
  IonCheckbox,
  IonItem,
  IonLabel,
  } from '@ionic/react';
import { Todo } from '../data/todos';
import './TodoListItem.css';

interface TodoListItemProps {
  todo: Todo;
  toggleTodo: any;
}

const TodoListItem: React.FC<TodoListItemProps> = ({ todo, toggleTodo }) => {
  return (
    <IonItem >
      <IonCheckbox checked={todo.completed} onIonChange={e => toggleTodo(todo.guid)} slot="start"/>
      <IonLabel className="ion-text-wrap">
          {todo.task}
      </IonLabel>
    </IonItem>
  );
};

export default TodoListItem;
```

## pagesHome.tsx

```text
import { IonButton, IonContent, IonHeader, IonInput, IonItem, IonList, IonPage, IonRefresher, IonRefresherContent, IonTitle, IonToolbar, useIonViewWillEnter } from '@ionic/react';
import { useState } from 'react';
import TodoListItem from '../components/TodoListItem';
import { addToDo, getTodos, setCompleted, Todo } from '../data/todos';
import './Home.css';

const Home: React.FC = () => {

  const [todos, setTodos] = useState<Todo[]>([]);
  const [text, setText] = useState<string>();

  useIonViewWillEnter(async () => {
    const todos = await getTodos();
    setTodos(todos);
  });


  const toggleTodo = async (guid: string) => {
    const existing = todos.find((todo) => todo.guid === guid)
    if (existing) {
      const completed = !existing.completed
      await setCompleted(guid, completed)
      // refresh from db
      const todos = await getTodos();
      setTodos(todos);
    }
  }

  const addTask = async () => {
    if (text) {
      const guid = await addToDo(text)
      console.log(guid)
      //reset textbox
      setText(() => '')
      // refresh from db
      const todos = await getTodos();
      setTodos(todos);
    }
  }

  const refresh = async (e: CustomEvent) => {
    // refresh from db
    const todos = await getTodos();
    setTodos(todos);
    e.detail.complete();
  };

  const HandleKeyPress = (value: any) => {
    if (value == "Enter") {
      //  console.log("Enter key pressed")
      addTask()
    }
  }

  return (
    <IonPage>
      <IonHeader>
        <IonToolbar>
          <IonTitle>Tasks</IonTitle>
        </IonToolbar>
      </IonHeader>
      <IonContent fullscreen>

        <IonRefresher slot="fixed" onIonRefresh={refresh}>
          <IonRefresherContent></IonRefresherContent>
        </IonRefresher>

        <IonItem>
          <IonInput value={text} placeholder="Enter task" onKeyPress={e => HandleKeyPress(e.key)} onIonChange={e => setText(e.detail.value!)}></IonInput>
          <IonButton slot="end" onClick={() => addTask()}>Add</IonButton>
        </IonItem>

        <IonList>
          {todos.map(m => <TodoListItem key={m.guid} todo={m} toggleTodo={toggleTodo} />)}
        </IonList>


      </IonContent>
    </IonPage>
  );
};

export default Home;
```

## publicmanifest.json

```text
{
  "short_name": "Todo",
  "name": "Todo App",
  "icons": [
    {
      "src": "manifest-icon-192.maskable.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any"
    },
    {
      "src": "manifest-icon-192.maskable.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "maskable"
    },
    {
      "src": "manifest-icon-512.maskable.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any"
    },
    {
      "src": "manifest-icon-512.maskable.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "maskable"
    }
  ],
  "start_url": ".",
  "display": "standalone",
  "theme_color": "#ffffff",
  "background_color": "#ffffff"
}
```

## index.tsx

```text
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
import * as serviceWorkerRegistration from './serviceWorkerRegistration';
import reportWebVitals from './reportWebVitals';

ReactDOM.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
  document.getElementById('root')
);

// If you want your app to work offline and load faster, you can change
// unregister() to register() below. Note this comes with some pitfalls.
// Learn more about service workers: https://cra.link/PWA
// serviceWorkerRegistration.unregister();

const config = {
  onUpdate: (registration: any) => { alert("An updated version of this app is available.  Please close and re-start the app.") },
}

serviceWorkerRegistration.register(config);

// If you want to start measuring performance in your app, pass a function
// to log results (for example: reportWebVitals(console.log))
// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals
reportWebVitals();
```

## todos.ts

```text
import PouchDB from 'pouchdb-browser'

const db = new PouchDB('tasksdb')
const remotedburl = 'http://admin:password@localhost:5984/tasksdb'

function createGuid() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    });
}

export interface Todo {
    guid: string;
    task: string;
    completed: boolean;
    _id: string,
    _rev: string
}

export const getTodos = async () => {
    await replicateFrom()
    const todos = await db.allDocs({
        include_docs: true,
        attachments: false
    })
    return todos.rows.map((row: { doc: any; }) => <Todo>row.doc)
}

export const setCompleted = async (existing: Todo, completed: boolean) => {
    try {
        await db.put({
            ...existing,
            completed
        })
        await replicateTo()
    }
    catch (err) {
        console.log("err", err)
    }
}

export const deleteTodo = async (existing: Todo) => {
    try {
        await db.remove(
            existing._id,
            existing._rev
        )
        await replicateTo()
    }
    catch (err) {
        console.log("err", err)
    }
}

export const addToDo = async (description: string) => {
    try {
        const guid = createGuid();
        await db.post({
            guid: guid,
            task: description,
            completed: false
        })
        await replicateTo()
    }
    catch (err) {
        console.log("err", err)
    }
}

export const replicate = async () => {
    await replicateFrom()
    await replicateTo()
}

const replicateFrom = async () => {
    try {
        const result = await db.replicate.from(remotedburl)
        console.log("result", result)
    }
    catch (err) {
        console.log("err", err)
    }
}

const replicateTo = async () => {
    try {
        const result = await db.replicate.to(remotedburl)
        console.log("result", result)
    }
    catch (err) {
        console.log("err", err)
    }
}
```
## References

- [Starting an App](https://ionicframework.com/docs/developing/starting)

---

## javascriptgraph

**Source file:** `javascriptgraph.md`

---
title: "JavaScript and Microsoft Graph"
description: "A console application that calls the Microsoft Graph API"
date: "2022-05-28"
categories: ["JavaScript","Microsoft 365","Azure"]
tags: []
slug: "javascriptgraph"
image: "/assets/images/office-365-icon-500x500.png"
---



This post is based on Microsoft's "[Build JavaScript apps with Microsoft Graph](https://docs.microsoft.com/en-nz/graph/tutorials/javascript?tabs=aad)" tutorial.

The node console application I created here uses OAuth for identity management.

An OAuth application requires an "identity provider". 

In this case the identity provider is [Azure Active Directory](azure-active-directory.html#top).

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.21.09-pm-1836x1288.png)
*I navigated to Azure Portal and selected Azure Active Directory*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.21.40-pm-1836x1278.png)
*I selected the "App registrations" link*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.22.04-pm-1836x1285.png)
*I selected the "New registration" link*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.23.43-pm-1836x1285.png)
*I entered the name of the console application and selected "Register"*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.24.32-pm-1836x1276.png)
*I made a note of the "Application (client) ID" and the "Directory (tenant) ID"*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.29.06-pm-1836x969.png)
*I created a minimal node project*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.30.07-pm-1836x95.png)
*I added @azure/identity, @microsoft/microsoft-graph-client, isomorphic-fetch and readline-sync dependencies*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.33.22-pm-1836x968.png)
*I created an appSettings.js file including the "Application (client) ID" and the "Directory (tenant) ID" values provided in the Application registration page. I included the required Microsoft Graph permissions (the "graphUserScopes").*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.42.00-pm-1836x968.png)
*I ran the console application*


## Key moves

The index.js code contains the console application user interface. This is where the user selects an option.

The graphHelper.js file contains the most interesting code. 

The graphHelper code creates a TokenCredentialAuthenticationProvider object and uses that to create a _userClient (client) object.

The client object is then used to make calls as shown in the [Graph Explorer](MicrosoftGraph.html) "Code snippets" tab.

![](/assets/images/javascriptgraph/screen-shot-2022-05-28-at-11.08.04-am-1208x572.png)
*GetUserSnippet from the application*

![](/assets/images/javascriptgraph/screen-shot-2022-05-27-at-2.47.11-pm-1836x943.png)
*Graph Explorer Code snippet*


## Full code

The final code is included below.


## index.js

```text
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

// <ProgramSnippet>
const readline = require('readline-sync');

const settings = require('./appSettings');
const graphHelper = require('./graphHelper');

async function main() {
  console.log('JavaScript Graph Tutorial');

  let choice = 0;

  // Initialize Graph
  initializeGraph(settings);

  // Greet the user by name
  await greetUserAsync();

  const choices = [
    'Display access token',
    'List my inbox',
    'Send mail',
    'List users (requires app-only)',
    'Make a Graph call'
  ];

  while (choice != -1) {
    choice = readline.keyInSelect(choices, 'Select an option', { cancel: 'Exit' });

    switch (choice) {
      case -1:
        // Exit
        console.log('Goodbye...');
        break;
      case 0:
        // Display access token
        await displayAccessTokenAsync();
        break;
      case 1:
        // List emails from user's inbox
        await listInboxAsync();
        break;
      case 2:
        // Send an email message
        await sendMailAsync();
        break;
      case 3:
        // List users
        await listUsersAsync();
        break;
      case 4:
        // Run any Graph code
        await makeGraphCallAsync();
        break;
      default:
        console.log('Invalid choice! Please try again.');
    }
  }
}

main();
// </ProgramSnippet>

// <InitializeGraphSnippet>
function initializeGraph(settings) {
  graphHelper.initializeGraphForUserAuth(settings, (info) => {
    // Display the device code message to
    // the user. This tells them
    // where to go to sign in and provides the
    // code to use.
    console.log(info.message);
  });
}
// </InitializeGraphSnippet>

// <GreetUserSnippet>
async function greetUserAsync() {
  try {
    const user = await graphHelper.getUserAsync();
    console.log(`Hello, ${user?.displayName}!`);
    // For Work/school accounts, email is in mail property
    // Personal accounts, email is in userPrincipalName
    console.log(`Email: ${user?.mail ?? user?.userPrincipalName ?? ''}`);
  } catch (err) {
    console.log(`Error getting user: ${err}`);
  }
}
// </GreetUserSnippet>

// <DisplayAccessTokenSnippet>
async function displayAccessTokenAsync() {
  try {
    const userToken = await graphHelper.getUserTokenAsync();
    console.log(`User token: ${userToken}`);
  } catch (err) {
    console.log(`Error getting user access token: ${err}`);
  }
}
// </DisplayAccessTokenSnippet>

// <ListInboxSnippet>
async function listInboxAsync() {
  try {
    const messagePage = await graphHelper.getInboxAsync();
    const messages = messagePage.value;

    // Output each message's details
    for (const message of messages) {
      console.log(`Message: ${message.subject ?? 'NO SUBJECT'}`);
      console.log(`  From: ${message.from?.emailAddress?.name ?? 'UNKNOWN'}`);
      console.log(`  Status: ${message.isRead ? 'Read' : 'Unread'}`);
      console.log(`  Received: ${message.receivedDateTime}`);
    }

    // If @odata.nextLink is not undefined, there are more messages
    // available on the server
    const moreAvailable = messagePage['@odata.nextLink'] != undefined;
    console.log(`\nMore messages available? ${moreAvailable}`);
  } catch (err) {
    console.log(`Error getting user's inbox: ${err}`);
  }
}
// </ListInboxSnippet>

// <SendMailSnippet>
async function sendMailAsync() {
  try {
    // Send mail to the signed-in user
    // Get the user for their email address
    const user = await graphHelper.getUserAsync();
    const userEmail = user?.mail ?? user?.userPrincipalName;

    if (!userEmail) {
      console.log('Couldn\'t get your email address, canceling...');
      return;
    }

    await graphHelper.sendMailAsync('Testing Microsoft Graph',
      'Hello world!', userEmail);
    console.log('Mail sent.');
  } catch (err) {
    console.log(`Error sending mail: ${err}`);
  }
}
// </SendMailSnippet>

// <ListUsersSnippet>
async function listUsersAsync() {
  try {
    const userPage = await graphHelper.getUsersAsync();
    const users = userPage.value;

    // Output each user's details
    for (const user of users) {
      console.log(`User: ${user.displayName ?? 'NO NAME'}`);
      console.log(`  ID: ${user.id}`);
      console.log(`  Email: ${user.mail ?? 'NO EMAIL'}`);
    }

    // If @odata.nextLink is not undefined, there are more users
    // available on the server
    const moreAvailable = userPage['@odata.nextLink'] != undefined;
    console.log(`\nMore users available? ${moreAvailable}`);
  } catch (err) {
    console.log(`Error getting users: ${err}`);
  }
}
// </ListUsersSnippet>

// <MakeGraphCallSnippet>
async function makeGraphCallAsync() {
  try {
    await graphHelper.makeGraphCallAsync();
  } catch (err) {
    console.log(`Error making Graph call: ${err}`);
  }
}
// </MakeGraphCallSnippet>
```

## graphHelper.js

```text
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

// <UserAuthConfigSnippet>
require('isomorphic-fetch');
const azure = require('@azure/identity');
const graph = require('@microsoft/microsoft-graph-client');
const authProviders =
  require('@microsoft/microsoft-graph-client/authProviders/azureTokenCredentials');

let _settings = undefined;
let _deviceCodeCredential = undefined;
let _userClient = undefined;

function initializeGraphForUserAuth(settings, deviceCodePrompt) {
  // Ensure settings isn't null
  if (!settings) {
    throw new Error('Settings cannot be undefined');
  }

  _settings = settings;

  _deviceCodeCredential = new azure.DeviceCodeCredential({
    clientId: settings.clientId,
    tenantId: settings.authTenant,
    userPromptCallback: deviceCodePrompt
  });

  const authProvider = new authProviders.TokenCredentialAuthenticationProvider(
    _deviceCodeCredential, {
      scopes: settings.graphUserScopes
    });

  _userClient = graph.Client.initWithMiddleware({
    authProvider: authProvider
  });
}
module.exports.initializeGraphForUserAuth = initializeGraphForUserAuth;
// </UserAuthConfigSnippet>

// <GetUserTokenSnippet>
async function getUserTokenAsync() {
  // Ensure credential isn't undefined
  if (!_deviceCodeCredential) {
    throw new Error('Graph has not been initialized for user auth');
  }

  // Ensure scopes isn't undefined
  if (!_settings?.graphUserScopes) {
    throw new Error('Setting "scopes" cannot be undefined');
  }

  // Request token with given scopes
  const response = await _deviceCodeCredential.getToken(_settings?.graphUserScopes);
  return response.token;
}
module.exports.getUserTokenAsync = getUserTokenAsync;
// </GetUserTokenSnippet>

// <GetUserSnippet>
async function getUserAsync() {
  // Ensure client isn't undefined
  if (!_userClient) {
    throw new Error('Graph has not been initialized for user auth');
  }

  return _userClient.api('/me')
    // Only request specific properties
    .select(['displayName', 'mail', 'userPrincipalName'])
    .get();
}
module.exports.getUserAsync = getUserAsync;
// </GetUserSnippet>

// <GetInboxSnippet>
async function getInboxAsync() {
  // Ensure client isn't undefined
  if (!_userClient) {
    throw new Error('Graph has not been initialized for user auth');
  }

  return _userClient.api('/me/mailFolders/inbox/messages')
    .select(['from', 'isRead', 'receivedDateTime', 'subject'])
    .top(25)
    .orderby('receivedDateTime DESC')
    .get();
}
module.exports.getInboxAsync = getInboxAsync;
// </GetInboxSnippet>

// <SendMailSnippet>
async function sendMailAsync(subject, body, recipient) {
  // Ensure client isn't undefined
  if (!_userClient) {
    throw new Error('Graph has not been initialized for user auth');
  }

  // Create a new message
  const message = {
    subject: subject,
    body: {
      content: body,
      contentType: 'text'
    },
    toRecipients: [
      {
        emailAddress: {
          address: recipient
        }
      }
    ]
  };

  // Send the message
  return _userClient.api('me/sendMail')
    .post({
      message: message
    });
}
module.exports.sendMailAsync = sendMailAsync;
// </SendMailSnippet>

// <AppOnyAuthConfigSnippet>
let _clientSecretCredential = undefined;
let _appClient = undefined;

function ensureGraphForAppOnlyAuth() {
  // Ensure settings isn't null
  if (!_settings) {
    throw new Error('Settings cannot be undefined');
  }

  if (!_clientSecretCredential) {
    _clientSecretCredential = new azure.ClientSecretCredential(
      _settings.tenantId,
      _settings.clientId,
      _settings.clientSecret
    );
  }

  if (!_appClient) {
    const authProvider = new authProviders.TokenCredentialAuthenticationProvider(
      _clientSecretCredential, {
        scopes: [ 'https://graph.microsoft.com/.default' ]
      });

    _appClient = graph.Client.initWithMiddleware({
      authProvider: authProvider
    });
  }
}
// </AppOnyAuthConfigSnippet>

// <GetUsersSnippet>
async function getUsersAsync() {
  ensureGraphForAppOnlyAuth();

  return _appClient?.api('/users')
    .select(['displayName', 'id', 'mail'])
    .top(25)
    .orderby('displayName')
    .get();
}
module.exports.getUsersAsync = getUsersAsync;
// </GetUsersSnippet>

// <MakeGraphCallSnippet>
// This function serves as a playground for testing Graph snippets
// or other code
async function makeGraphCallAsync() {
  // INSERT YOUR CODE HERE
  // Note: if using _appClient, be sure to call ensureGraphForAppOnlyAuth
  // before using it.
  // ensureGraphForAppOnlyAuth();
}
module.exports.makeGraphCallAsync = makeGraphCallAsync;
// </MakeGraphCallSnippet>
```

## appSettings.js

```text
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

const settings = {
  'clientId': 'YOUR_CLIENT_ID_HERE',
  'clientSecret': 'YOUR_CLIENT_SECRET_HERE_IF_USING_APP_ONLY',
  'tenantId': 'YOUR_TENANT_ID_HERE_IF_USING_APP_ONLY',
  'authTenant': 'common',
  'graphUserScopes': [
    'user.read',
    'mail.read',
    'mail.send'
  ]
};

module.exports = settings;
```

---

## kubernetes

**Source file:** `kubernetes.md`

---
title: "Kubernetes"
description: "Kubernetes is a platform for managing containerized workloads."
date: "2021-02-06"
categories: ["DevOps"]
tags: []
slug: "kubernetes"
image: "/assets/images/kubernetes-container-engine.svg"
---


Docker Desktop includes Kubernetes.

Enter these commands to deploy the haddley/blog container image:

$ kubectl create deployment blog --image=haddley/blog --replicas=2

$ kubectl expose deployment blog --type=LoadBalancer --port=8080 --target-port=80

Or create a file called blog.yaml and enter this command:

$ kubectl apply -f .\blog.yaml

Adjust the Kubernetes cluster by editing the yaml file below and "applying" the yaml file again.

Access one of the blog web servers by navigating to:

http://<ip address of the computer running Docker Desktop>:8080

![](/assets/images/kubernetes/image-888x488.png)
*Using the "kubectl create deployment" and "kubectl expose deployment" commands*

![](/assets/images/kubernetes/image-3-888x488.png)
*Using the "kubectl apply" command to apply a yaml file*

![](/assets/images/kubernetes/image-2-1250x720.png)
*The Docker image running in two Kubernetes pods.*

![](/assets/images/kubernetes/screen-shot-2021-02-10-at-2.26.59-pm-1794x1190.png)
*Accessing the cluster using port 8080*


## blog.yaml

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: blog-deployment
  labels:
    app: blog
spec:
  replicas: 2
  selector:
    matchLabels:
      app: blog
  template:
    metadata:
      labels:
        app: blog
    spec:
      containers:
      - name: blog
        image: haddley/blog
        resources:
          limits:
            memory: 512Mi
            cpu: "1"
          requests:
            memory: 256Mi
            cpu: "0.2"
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: blog-service
spec:
  selector:
    app: blog
  ports:
    - protocol: TCP
      port: 8080
      targetPort: 80
  type: LoadBalancer
```
## References

- [Kubernetes Tutorial](https://www.youtube.com/watch?v=X48VuDVv0do)

---

## langchain

**Source file:** `langchain.md`

---
title: "LangChain (RAG)"
description: "Using LangChain to create a medical report application"
date: "2023-07-21"
categories: ["AI","Python"]
tags: []
slug: "langchain"
image: "/assets/images/chatgpt-logo.svg"
---



LangChain is a framework built around Large Language Models. 

I used LangChain to create a medical report application.


## streamlit

Streamlit is an open-source Python library used to create web applications for data science and machine learning projects.

I used streamlit to create the application's user interface.

![](/assets/images/langchain/langchain-capture-0004-1473x711.png)
*hello world streamlit app*


## OpenAI's API

I updated my hello world application to call OpenAI's API.

I had to request a secret API key.

![](/assets/images/langchain/screen-shot-2023-07-20-at-10.13.26-am-1836x1013.png)
*secret key*

![](/assets/images/langchain/langchain-capture-0005-1476x710.png)
*Using LangChain to call OpenAI's API.*


## Document pages

I used LangChain to return the text found on each page of a sample medical report.

[https://www.med.unc.edu/medclerk/wp-content/uploads/sites/877/2018/10/hp4.pdf](https://www.med.unc.edu/medclerk/wp-content/uploads/sites/877/2018/10/hp4.pdf)

![](/assets/images/langchain/screen-shot-2023-07-22-at-6.54.13-am-1836x1001.png)
*hp4.pdf medical report*


## Jupyter Notebook

To improve performance and reduce costs I pre-processed the pdf file and stored the result.

I created a Jupyter Notebook to keep track of the steps I followed.

![](/assets/images/langchain/screen-shot-2023-07-21-at-5.13.17-pm-1142x740.png)
*Running jupyter-notebook locally*

![](/assets/images/langchain/screen-shot-2023-07-21-at-7.54.08-pm-1536x982.png)
*I loaded pages from the medical report.*

![](/assets/images/langchain/screen-shot-2023-07-21-at-7.57.22-pm-1536x997.png)
*I broke the pages into paragraphs (texts).*


## Chroma

I used Chroma to create an [embeddings](sentencesimilarity.html) vector store and saved the store locally.

![](/assets/images/langchain/screen-shot-2023-07-21-at-7.59.26-pm-1536x1033.png)
*I used OpenAI's API to generate the embeddings*

![](/assets/images/langchain/screen-shot-2023-07-21-at-8.03.05-pm-1536x842.png)
*I converted the query 'Does the patient smoke?' to an embedding and compared the result with the embeddings in the vector store.*

![](/assets/images/langchain/screen-shot-2023-07-21-at-8.05.23-pm-1536x784.png)
*I ensured that the embeddings vector store could be loaded from the local folder.*

![](/assets/images/langchain/screen-shot-2023-07-21-at-8.16.41-pm-1536x867.png)
*I located the most similar paragraphs and sent those (see Context Injection) and the query to OpenAI's servers.*

![](/assets/images/langchain/screen-shot-2023-07-21-at-8.19.11-pm-1536x982.png)
*The streamlit code*

![](/assets/images/langchain/screen-shot-2023-07-21-at-8.21.56-pm-1536x866.png)
*The finished application*


## app0.py

```text
# pip install streamlit
# python -m streamlit run app0.py              

import streamlit

prompt = streamlit.text_input('Input your name')

if prompt:
    response = "Hello " + prompt
    streamlit.write(response)
```

## app1.py

```text
# pip install langchain openai streamlit
# python -m streamlit run app.py              

# import os
from langchain.llms import OpenAI
import streamlit

# os.environ['OPENAI_API_KEY']='<insert key here>'

llm = OpenAI(temperature=0.9)

prompt = streamlit.text_input('Input your prompt')

if prompt:
    response = llm(prompt)
    streamlit.write(response)
```

## 1

```text
from langchain.document_loaders import PyPDFLoader

loader = PyPDFLoader('hp4.pdf')
pages = loader.load_and_split()


print (pages[0].page_content)
```

## 2  3

```text
from langchain.text_splitter import RecursiveCharacterTextSplitter

# Define chunk size, overlap and separators
text_splitter = RecursiveCharacterTextSplitter(
    chunk_size = 1024,
    chunk_overlap  = 40,
    length_function = len,
    separators=["\n \n", " ", ""]
)

# Split the pages into paragraphs (texts) as defined above
texts = text_splitter.split_documents(pages)

len(texts)

texts[1].page_content
```

## 4

```text
from langchain.llms import OpenAI

from langchain.embeddings import OpenAIEmbeddings

from langchain.vectorstores import Chroma

from langchain.agents.agent_toolkits import (
    create_vectorstore_agent,
    VectorStoreToolkit,
    VectorStoreInfo
)


llm = OpenAI(temperature=0.9,verbose=True)
embeddings=OpenAIEmbeddings()

save_directory = "Chroma"

store = Chroma.from_documents(texts, embeddings, collection_name='hp4', persist_directory=save_directory)
store.persist()

store.get()
```

## 5

```text
search = store.similarity_search_with_score('Does the patient smoke?')

search
```

## 6

```text
db = Chroma(persist_directory=save_directory,collection_name='hp4',embedding_function=embeddings)

print(db._collection.count())

db.get()
```

## 7

```text
vectorstore_info = VectorStoreInfo(
    name="hp4",
    description="vectore store generate from hp4.pdf",
    vectorstore=store
)

toolkit = VectorStoreToolkit(vectorstore_info=vectorstore_info)

agent_executor = create_vectorstore_agent(
    llm=llm,
    toolkit=toolkit,
    verbose=True
)

response = agent_executor.run("Does the patient smoke?")

response
```

## app2.py

```text
import streamlit as st

from langchain.llms import OpenAI

from langchain.embeddings import OpenAIEmbeddings

from langchain.vectorstores import Chroma

from langchain.agents.agent_toolkits import (
    create_vectorstore_agent,
    VectorStoreToolkit,
    VectorStoreInfo
)


llm = OpenAI(temperature=0.9,verbose=True)

embeddings=OpenAIEmbeddings()

save_directory = "Chroma"

# load embeddings from "Chroma" directory
db = Chroma(persist_directory=save_directory,collection_name='hp4',embedding_function=embeddings)

vectorstore_info = VectorStoreInfo(
    name="hp4",
    description="embeddings generated from the pdf document",
    vectorstore=db
)

toolkit = VectorStoreToolkit(vectorstore_info=vectorstore_info)

agent_executor = create_vectorstore_agent(
    llm=llm,
    toolkit=toolkit,
    verbose=True
)

prompt = st.text_input('Input your prompt')

if prompt:
    #response = llm(prompt)
    response = agent_executor.run(prompt)
    st.write(response)

    with st.expander('Document Similarity Search'):
        search = db.similarity_search_with_score(prompt)
        st.write(search)
```
## References

- [LangChain Quickstart](https://python.langchain.com/docs/get_started/quickstart)
- [I built a GPT Investment Banker using this 312 PAGE document](https://www.youtube.com/watch?v=u8vQyTzNGVY)

---

## langchainagents

**Source file:** `langchainagents.md`

---
title: "LangChain Agents"
description: "Agents"
date: "2024-08-25"
categories: ["AI","Python"]
tags: []
slug: "langchainagents"
image: "/assets/images/langchain.svg"
---



Agents are systems that use LLMs as reasoning engines to determine which actions to take and the inputs to pass them. After executing actions, the results can be fed back into the LLM to determine whether more actions are needed, or whether it is okay to finish.

I created two LangChain Agents

I created a LangChain Agent that used Wikipedia 

I created a LangChain Agent that used DuckDuckGo and a Maths tool

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.44.32pm-2136x464.png)
*I created a new Jupyter Notebook*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.45.51pm-2136x429.png)
*I created a new Python Environment*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.46.29pm-2136x279.png)
*I clicked the + Create Python Environment link*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.47.01pm-2136x210.png)
*I clicked the Venv link*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.47.26pm-2136x175.png)
*I selected Python 3.12.4*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.48.12pm-2136x1170.png)
*I used pip install*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.50.45pm-2136x323.png)
*I imported dependencies*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.57.23pm-2136x717.png)
*I ensured that an OPENAI_API_KEY could be relieved from the local .env file*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-4.58.00pm-2136x575.png)
*I created a large language model wrapper*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-5.03.41pm-2136x446.png)
*I ensured that I could access Wikipedia*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-5.38.10pm-1536x538.png)
*I created a prompt template*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-6.10.49pm-2136x1147.png)
*I created an agent, added the Wikipedia tool and invoked the agent (with verbose=True)*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-5.39.14pm-1536x974.png)
*I created a second agent, added a maths tool and added DuckDuckGo*

![](/assets/images/langchainagents/screenshot-2024-08-25-at-5.39.53pm-1536x722.png)
*I invoked the second agent (with verbose=True)*

---

## langflow1

**Source file:** `langflow1.md`

---
title: "Langflow (Part 1)"
description: "References"
date: "2024-10-30"
categories: ["Python","AI"]
tags: []
slug: "langflow1"
image: "/assets/images/85702467-200x200.png"
---



Langflow is a tool designed to simplify the development of applications using large language models (LLMs).

OpenAI's text-to-speech (TTS) technology is designed to convert written text into natural-sounding speech.

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*I used brew to install python version 3.10*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.02.16pm-1836x399.png)
*I used the Visual Studio Code Python Extension to create a Python Environment*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.02.27pm-1836x446.png)
*I selected Venv*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.05.23pm-1836x475.png)
*I selected Python 3.10*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.06.26pm-1836x657.png)
*I installed langflow*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.10.24pm-1836x567.png)
*I used python -m langflow run to start langflow*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.10.44pm-1836x1053.png)
*I opened a browser and navigated to http://127.0.0.1:7860*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.10.55pm-1836x1062.png)
*I selected the Blank Flow template*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.11.17pm-1836x1062.png)
*I clicked in the Untitled document box and selected the Import menu item*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.11.36pm-1836x1059.png)
*I selected the Doc to Podcast (Langflow).json flow*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.16.40pm-1836x425.png)
*I selected the Settings menu item*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.16.51pm-1836x664.png)
*I selected the Global Variables menu item*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.18.50pm-1836x1011.png)
*I added an openai_api_key variable*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.19.02pm-1836x1020.png)
*The variable was listed*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.19.31pm-1836x1019.png)
*I added the openai_api_key value to the LLM step*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.20.05pm-1836x1019.png)
*added the openai_api_key value to the text-to-speech step*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.23.58pm-1836x1017.png)
*I clicked on the File step to select a podcast source document*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.25.40pm-1836x1024.png)
*I selected a Power Pages (Part 1).pdf source document*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.26.47pm-1836x1032.png)
*I clicked the play button on the last step and ran into an issue*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.28.17pm-1836x574.png)
*I terminated langflow and used pip to install pydub. I restarted langflow.*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.28.49pm-1836x1013.png)
*I clicked play on the last flow step*

![](/assets/images/langflow1/screenshot-2024-10-30-at-6.15.08pm-1164x784.png)
*While I was waiting I clicked the Inspect Output menu item in the Extract Block From Markdown step*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.31.05pm-1836x1015.png)
*I reviewed the podcast script*

![](/assets/images/langflow1/screenshot-2024-10-30-at-5.53.41pm-1836x1212.png)
*Once the flow finished running I reviewed the result (see below)*


## References

- [Podcast](https://haddley.github.io/podcast/audio_customer_portal.mp3)
- [Doc2Podcast](https://github.com/misbahsy/Doc2Podcast)

---

## leaflet

**Source file:** `leaflet.md`

---
title: "Leaflet"
description: "An open-source JavaScript libraryfor mobile-friendly interactive maps"
date: "2022-02-21"
categories: ["Maps","Azure"]
tags: []
slug: "leaflet"
image: "/assets/images/leaflet-upic-200x200.png"
---



Leaflet is an open-source Geographic Information System (GIS) JavaScript library for mobile-friendly interactive maps. 

Leaflet has all the mapping features most developers need.


## Quick start

The Leaflet web site provides a quick start tutorial.

To follow the tutorial I created an index.html page using Visual Studio Code.

![](/assets/images/leaflet/screen-shot-2022-02-21-at-9.01.31-am-1836x610.png)
*emmet*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-9.01.47-am-1836x604.png)
*template html page*


## Leaflet code

I added the leaflet css styles and javascript to create an interactive map.

The letter L is used to access Leaflet.

Here I replace the div element with id 'map' with the Leaflet map. 

**var map = L.map('map').setView([51.505, -0.09], 13);**

Here I add the arcgisonline.com tiles:

**        L.tileLayer('//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg').addTo(map);**

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.00.34-am-1836x1102.png)
*index.html from localhost*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.07.37-am-1836x847.png)
*Deploying index.html page to Azure Storage*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.08.45-am-1548x254.png)
*Creating a new Storage Account*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.09.01-am-1516x232.png)
*Providing a unique name*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.09.10-am-952x128.png)
*Storage account is created*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.09.50-am-954x384.png)
*Browse to web site button*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.11.31-am-1836x1106.png)
*index.html from azure to laptop*

![](/assets/images/leaflet/273975021-368817684761513-1776904781628079268-n-750x1334.jpg)
*index.html from azure to iPhone (safari)*


## Tile layer

Leaflet has to determine which tiles are needed to render the map.

The tiles are downloaded from a tile server (arcgisonline.com in this case).

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.34.22-am-1836x947.png)
*network requests*

![](/assets/images/leaflet/screen-shot-2022-02-21-at-10.35.49-am-1836x947.png)
*A single tile from arcgisonline.com*


## Calculating a tile url

To determine which tile is needed to display a given location leaflet needs to convert from a given latitude and longitude to a given tile url.

The calculations are described here:

[https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames#Tile_servers](https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames#Tile_servers)

Example code:

![](/assets/images/leaflet/screen-shot-2022-02-21-at-11.45.50-am-1836x981.png)
*display a given location*


## To display a given area

To determine which tiles need to be downloaded to display a given area at a given zoom level leaflet needs to convert from a pair of latitude and longitude co-ordinates to a set of tile urls.

Example code:

**var zoom        = 9;
var top_tile    = lat2tile(north_edge, zoom); // eg.lat2tile(34.422, 9);
var left_tile   = lon2tile(west_edge, zoom);
var bottom_tile = lat2tile(south_edge, zoom);
var right_tile  = lon2tile(east_edge, zoom);
var width       = Math.abs(left_tile - right_tile) + 1;
var height      = Math.abs(top_tile - bottom_tile) + 1;

// total tiles
var total_tiles = width * height; // -> eg. 377**

![](/assets/images/leaflet/screen-shot-2022-02-21-at-12.50.32-pm-1836x1228.png)
*display a given area*


## Leaflet can be used to add shapes and markers to a map

I added a triangle to a Leaflet map this code:

**var polygon = L.polygon([
            [51.509, -0.08],
            [51.503, -0.06],
            [51.51, -0.047]
        ]).addTo(map);**

![](/assets/images/leaflet/screen-shot-2022-02-21-at-12.54.28-pm-1836x1235.png)
*adding a triangle to a Leaflet map*


## Leaflet controls can be added to a map

A number of controls are included with Leaflet.

I used this code to add a scale control to a map:

**L.control.scale().addTo(map);**

![](/assets/images/leaflet/screen-shot-2022-02-21-at-12.58.04-pm-384x132.png)
*scale control*


## Creating new controls

New Leaflet controls can be created by extending L.Control.

I created a "LocationSelect" control that allows users to "fly" between locations (based on [this](https://gis.stackexchange.com/questions/327271/adding-feature-property-values-to-filter-drop-down-option-in-leaflet-instead-of/327336?noredirect=1) post)

Click [here](https://haddley.github.io/leaflet/index.html) to navigate to a [demo page](https://haddley.github.io/leaflet/index.html).

![](/assets/images/leaflet/screen-shot-2022-02-21-at-2.02.15-pm-1836x894.png)
*travel by map*


## index.html

```text
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>
</html>
```

## index.html

```text
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

</head>

<body>
    <div id="map" style="height: 100vh"></div>

    <script>
        var map = L.map('map').setView([51.505, -0.09], 13);

        L.tileLayer('//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg').addTo(map);
    </script>
</body>

</html>
```

## map.html

```text
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script>
        function lon2tile(lon, zoom) { return (Math.floor((lon + 180) / 360 * Math.pow(2, zoom))); }
        function lat2tile(lat, zoom) { return (Math.floor((1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180)) / Math.PI) / 2 * Math.pow(2, zoom))); }
    </script>
</head>

<body>
    <img id="tile">

    <script>
        const latlng = [51.505, -0.09]
        const zoom = 13

        const z = zoom
        y = lat2tile(latlng[0], zoom)
        x = lon2tile(latlng[1], zoom)

        const url = `https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/${z}/${y}/${x}.jpg`
        document.getElementById("tile").src = url
    </script>
</body>

</html>
```

## map.html

```text
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script>
        function lon2tile(lon, zoom) { return (Math.floor((lon + 180) / 360 * Math.pow(2, zoom))); }
        function lat2tile(lat, zoom) { return (Math.floor((1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180)) / Math.PI) / 2 * Math.pow(2, zoom))); }
    </script>
</head>

<body>
    <div id="map" style="position: relative;">

        <script>

            // [HOW FAR NORTH, HOW FAR WEST]
            const latlngnorthwest = [51.51, -0.08]
            const latlngsoutheast = [51.503, -0.047]

            const zoom = 13

            const north_edge = latlngnorthwest[0]
            const west_edge = latlngnorthwest[1]
            const south_edge = latlngsoutheast[0]
            const east_edge = latlngsoutheast[1]

            const top_tile = lat2tile(north_edge, zoom);
            const left_tile = lon2tile(west_edge, zoom);
            const bottom_tile = lat2tile(south_edge, zoom);
            const right_tile = lon2tile(east_edge, zoom);

            console.log({ top_tile, left_tile, bottom_tile, right_tile })

            const width = Math.abs(left_tile - right_tile) + 1;
            const height = Math.abs(top_tile - bottom_tile) + 1;

            const total_tiles = width * height; // -> eg. 377

            console.log({ width, height, total_tiles })

            const tileSize = 256

            document.getElementById("map").style.width = tileSize * width + "px";
            document.getElementById("map").style.height = tileSize * height + "px";

            let innerHTML = ""

            for (let top = 0; top < height; top++) {
                for (let left = 0; left < width; left++) {
                    toptobottom = top_tile + top
                    lefttoright = left_tile + left

                    innerHTML += `<img style="position:absolute;top:${top * tileSize}px;left:${left * tileSize}px;height:${tileSize}px;width:${tileSize}px" src=https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/${zoom}/${toptobottom}/${lefttoright}.jpg>`
                }
            }
            document.getElementById("map").innerHTML = innerHTML

        </script>
</body>

</html>
```

## index.html

```text
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

</head>

<body>
    <div id="map" style="height: 100vh"></div>

    <script>
        var map = L.map('map').setView([51.505, -0.09], 13);

        L.tileLayer('//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg').addTo(map);

        var polygon = L.polygon([
            [51.509, -0.08],
            [51.503, -0.06],
            [51.51, -0.047]
        ]).addTo(map);

    </script>
</body>

</html>
```

## index.html

```text
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

</head>

<body>
    <div id="map" style="height: 100vh"></div>

    <script>

        L.LocationSelect = L.Control.extend({
            options: {
                position: 'topright',
                locations: []
            },
            onAdd: function (map) {
                this.div = L.DomUtil.create('div', 'leaflet-siteselect-container');
                this.select = L.DomUtil.create('select', 'leaflet-siteselect', this.div);
                var content = '';

                var locationKeys = Object.keys(this.options.locations)
                for (let key in locationKeys) {
                    content += '<option>' + locationKeys[key] + '</option>';
                }

                this.select.innerHTML = content;
                this.select.onmousedown = L.DomEvent.stopPropagation;
                return this.div;
            },

            on: function (type, handler) {
                if (type == 'change') {
                    this.onChange = handler;
                    L.DomEvent.addListener(this.select, 'change', this._onChange, this);
                } else if (type == 'click') { //don't need this here probably, but for convenience?
                    this.onClick = handler;
                    L.DomEvent.addListener(this.select, 'click', this.onClick, this);
                } else {
                    console.log('LocationSelect - cannot handle ' + type + ' events.')
                }
            },

            _onChange: function (e) {
                var selectedLocation = this.select.options[this.select.selectedIndex].value;
                e.details = this.options.locations[selectedLocation];
                this.onChange(e);
            }
        })

        L.locationSelect = function (id, options) {
            return new L.LocationSelect(id, options);
        }

    </script>

    <script>

        const locations = {
            "London": { latlng: [51.5283063, -0.3824737], zoom: 9 },
            "Auckland": { latlng: [-36.8594804, 174.4252343], zoom: 9 },
            "Sydney": { latlng: [-33.8473567, 150.6517868], zoom: 9 },
            "New York": { latlng: [40.6976701, -74.2598693], zoom: 9 }
        }

        const startcity = "London"
        var map = L.map('map').setView(locations[startcity].latlng, locations[startcity].zoom);

        L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        var select = L.locationSelect({ position: 'topright', locations }).addTo(map);

        select.on('change', function (e) {
            if (e.details === undefined) {
                return;
            }
            this._map.flyTo(e.details.latlng, e.details.zoom)
        });

    </script>
</body>

</html>
```

## References

- [Central Coast](https://haddley.github.io/leaflet/houseHunting.html)

---

## llamacorp

**Source file:** `llamacorp.md`

---
title: "LlamaCpp"
description: "Accessing the llama.cpp model from Python"
date: "2023-08-03"
categories: ["AI","Python"]
tags: []
slug: "llamacorp"
image: "/assets/images/jupyter.svg"
---



The llama.cpp project provides Large Language Models.

The llama-cpp-python module allowed me to access the llama.cpp model from Python.

![](/assets/images/llamacorp/screenshot-2023-08-04-at-7.50.41-am-1746x1230.png)
*What is the Capital of England? First response.streamlit run app1a.py*

![](/assets/images/llamacorp/screenshot-2023-08-04-at-8.17.37-am-1734x1226.png)
*What is the Capital of England? Second response.*


## Requirements

$ conda create --name llama jupyterlab ipykernel ipywidgets
$ conda activate llama
$ pip install -r requirements.txt


## LangChain

I updated my [LangChain to create a medical report application](langchain.html) to work with Llama.cpp

![](/assets/images/llamacorp/screenshot-2023-08-08-at-1.42.34-pm-1836x923.png)
*streamlit run app2a.py*


## Pirate Jack

I updated a Llama2 Chat code sample to create a "Pirate Jack" application.

![](/assets/images/llamacorp/screenshot-2023-08-08-at-1.31.43-pm-1836x1395.png)
*If I have 17 Doubloons and spend 6 on a Pistol how many would I have have left? (using M2 apple silicon GPU)streamlit run app3a.py*

![](/assets/images/llamacorp/screenshot-2023-08-08-at-1.33.17-pm-1836x669.png)
*How much does a Cutlass cost? (from "memory"... it be costin' 3 Doubloons, savvy?)*

![](/assets/images/llamacorp/screenshot-2023-08-08-at-1.34.40-pm-1289x518.png)
*Chat application's memory*


## requirements.txt

```text
streamlit
langchain
openai
tiktoken
streamlit
llama-cpp-python
pypdf
torch
InstructorEmbedding
sentence_transformers
chromadb
```

## app1a.py

```text
# from langchain.llms import OpenAI
from langchain.llms import  LlamaCpp
import streamlit

# llm = OpenAI(temperature=0.9)
llm = LlamaCpp(
    model_path="llama-2-7b-chat.ggmlv3.q4_0.bin",
    verbose=True,
)

prompt = streamlit.text_input('Input your prompt')

if prompt:
    response = llm(prompt)
    streamlit.write(response)
```

## hp4.ipynb

```text
from langchain.document_loaders import PyPDFLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.vectorstores import Chroma

loader = PyPDFLoader('hp4.pdf')
pages = loader.load_and_split()

# Define chunk size, overlap and separators

text_splitter = RecursiveCharacterTextSplitter(
    # Set a really small chunk size, just to show.
    chunk_size = 1024,
    chunk_overlap  = 40,
    length_function = len,
    separators=["\n \n", " ", ""]
)

# split the pages into paragraphs as defined above

paragraphs = text_splitter.split_documents(pages)

---

# save OpenAIEmbeddings to "Chroma" directory

from langchain.embeddings import OpenAIEmbeddings

embeddings=OpenAIEmbeddings()

save_directory = "Chroma"

store = Chroma.from_documents(paragraphs, embeddings, collection_name='hp4', persist_directory=save_directory)
store.persist()

# search for similar paragraphs
search = store.similarity_search_with_score('Does the patient smoke?')

print(search)

---

# save HuggingFaceInstructEmbeddings to "Chroma2" directory

from langchain.embeddings import HuggingFaceInstructEmbeddings

embeddings2 = HuggingFaceInstructEmbeddings()

save_directory2 = "Chroma2"

store2 = Chroma.from_documents(paragraphs, embeddings2, collection_name='hp4', persist_directory=save_directory2)
store2.persist()

# search for similar paragraphs
search2 = store2.similarity_search_with_score('Does the patient smoke?')

print(search2)
```

## app2a.py

```text
import streamlit as st

# from langchain.llms import OpenAI
from langchain.llms import  LlamaCpp

#from langchain.embeddings import OpenAIEmbeddings
from langchain.embeddings import HuggingFaceInstructEmbeddings


from langchain.vectorstores import Chroma

from langchain.agents.agent_toolkits import (
    create_vectorstore_agent,
    VectorStoreToolkit,
    VectorStoreInfo
)

from langchain.vectorstores import Chroma

from langchain.agents.agent_toolkits import (
    create_vectorstore_agent,
    VectorStoreToolkit,
    VectorStoreInfo
)

#embeddings=OpenAIEmbeddings()
embeddings = HuggingFaceInstructEmbeddings()

# llm = OpenAI(temperature=0.9,verbose=True)

# https://python.langchain.com/docs/integrations/llms/llamacpp
# https://github.com/langchain-ai/langchain/issues/8004
# https://github.com/abetlen/llama-cpp-python/blob/main/docs/install/macos.md

llm = LlamaCpp(
    model_path="llama-2-7b-chat.ggmlv3.q4_0.bin",
    verbose=True,
    temperature=1,
    max_tokens=2048,  # 256
    n_gpu_layers=1,
    n_batch=512,
    f16_kv=True,  # MUST set to True, otherwise you will run into problem after a couple of calls
    n_ctx=10240 # Context Length
)

load_directory = "Chroma2"

# load embeddings from "Chroma" directory
db = Chroma(persist_directory=load_directory,collection_name='hp4',embedding_function=embeddings)

vectorstore_info = VectorStoreInfo(
    name="hp4",
    description="embeddings generated from the pdf document",
    vectorstore=db
)

toolkit = VectorStoreToolkit(vectorstore_info=vectorstore_info)

agent_executor = create_vectorstore_agent(
    llm=llm,
    toolkit=toolkit,
    verbose=True
)

prompt = st.text_input('Input your prompt')

if prompt:
    response = agent_executor.run(prompt)
    st.write(response)

    with st.expander('Document Similarity Search'):
        search = db.similarity_search_with_score(prompt)
        st.write(search)
```

## app3a.py

```text
#!pip install streamlit
#!pip install llama-cpp-python
#!pip install watchdog

from dotenv import load_dotenv, find_dotenv
from langchain.callbacks import get_openai_callback
from langchain.chat_models import ChatOpenAI
from langchain.schema import SystemMessage, HumanMessage, AIMessage
from langchain.llms import LlamaCpp
from langchain.callbacks.manager import CallbackManager
from langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler
import streamlit as st

from typing import Union
from typing import List


def init_page() -> None:
    st.set_page_config(page_title="Pirate Jack")
    st.header("Pirate Jack")
    st.sidebar.title("Options")


def init_messages() -> None:
    clear_button = st.sidebar.button("Clear Conversation", key="clear")
    if clear_button or "messages" not in st.session_state:
        st.session_state.messages = [
            SystemMessage(
                # content="You are a helpful AI assistant. Reply your answer in mardkown format.")
                content="You are now Pirate Jack. Always talk like a pirate. Let's think step by step."
            )
        ]
        st.session_state.costs = []


def select_llm() -> Union[ChatOpenAI, LlamaCpp]:
    model_name = st.sidebar.radio(
        "Choose LLM:",
        (
            "llama-2-7b-chat.ggmlv3.q2_K",
            "codeup-llama-2-13b-chat-hf.ggmlv3.q2_K",
            "stablebeluga-13b.ggmlv3.q4_K_S",
            "gpt-3.5-turbo-0613",
            "gpt-4",
        ),
    )

    temperature = st.sidebar.slider(
        "Temperature:", min_value=0.0, max_value=1.0, value=0.0, step=0.01
    )
    if model_name.startswith("gpt-"):
        return ChatOpenAI(temperature=temperature, model_name=model_name)
    elif (
        model_name.startswith("llama-2-")
        or model_name.startswith("codeup-llama-2-")
        or model_name.startswith("stablebeluga-")
    ):
        callback_manager = CallbackManager([StreamingStdOutCallbackHandler()])

        if model_name.startswith("llama-2-"):
            return LlamaCpp(
                model_path=f"./{model_name}.bin",
                callback_manager=callback_manager,
                verbose=True,  # False,  # True
                temperature=temperature,
                max_tokens=2048,  # 256
                n_ctx=1024,  # Context Length
                n_gpu_layers = 1,  # Metal set to 1 is enough.
                n_batch = 4,  # Should be between 1 and n_ctx, consider the amount of RAM of your Apple Silicon Chip.
                f16_kv=True,  # MUST set to True, otherwise you will run into problem after a couple of calls
            )
        else:
            return LlamaCpp(
                model_path=f"./{model_name}.bin",
                callback_manager=callback_manager,
                verbose=True,  # False,  # True
                temperature=temperature,
                max_tokens=2048,  # 256
            )



def get_answer(llm, messages) -> tuple[str, float]:
    if isinstance(llm, ChatOpenAI):
        with get_openai_callback() as cb:
            answer = llm(messages)
        return answer.content, cb.total_cost
    if isinstance(llm, LlamaCpp):
        answer = llm(llama_v2_prompt(convert_langchainschema_to_dict(messages)))
        return (answer, 0.0)


def find_role(message: Union[SystemMessage, HumanMessage, AIMessage]) -> str:
    """
    Identify role name from langchain.schema object.
    """
    if isinstance(message, SystemMessage):
        return "system"
    if isinstance(message, HumanMessage):
        return "user"
    if isinstance(message, AIMessage):
        return "assistant"
    raise TypeError("Unknown message type.")


def convert_langchainschema_to_dict(
    messages: List[Union[SystemMessage, HumanMessage, AIMessage]]
) -> List[dict]:
    """
    Convert the chain of chat messages in list of langchain.schema format to
    list of dictionary format.
    """
    return [
        {"role": find_role(message), "content": message.content} for message in messages
    ]


def llama_v2_prompt(messages: List[dict]) -> str:
    """
    Convert the messages in list of dictionary format to Llama2 compliant format.
    """
    B_INST, E_INST = "[INST]", "[/INST]"
    B_SYS, E_SYS = "<<SYS>>\n", "\n<</SYS>>\n\n"
    BOS, EOS = "<s>", "</s>"
    DEFAULT_SYSTEM_PROMPT = f"""You are a helpful, respectful and honest assistant. Always answer as helpfully as possible, while being safe. Please ensure that your responses are socially unbiased and positive in nature. If a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information."""

    if messages[0]["role"] != "system":
        messages = [
            {
                "role": "system",
                "content": DEFAULT_SYSTEM_PROMPT,
            }
        ] + messages
    messages = [
        {
            "role": messages[1]["role"],
            "content": B_SYS + messages[0]["content"] + E_SYS + messages[1]["content"],
        }
    ] + messages[2:]

    messages_list = [
        f"{BOS}{B_INST} {(prompt['content']).strip()} {E_INST} {(answer['content']).strip()} {EOS}"
        for prompt, answer in zip(messages[::2], messages[1::2])
    ]
    messages_list.append(
        f"{BOS}{B_INST} {(messages[-1]['content']).strip()} {E_INST} {EOS}"
    )

    result = "".join(messages_list)
    print(result)

    return result


def main() -> None:
    _ = load_dotenv(find_dotenv())

    init_page()
    llm = select_llm()
    init_messages()

    # Supervise user input
    if user_input := st.chat_input("Input your question!"):
        st.session_state.messages.append(HumanMessage(content=user_input))
        with st.spinner("Pirate Jack be thinking ..."):
            result = get_answer(llm, st.session_state.messages)
            if result == None:
                st.session_state.messages.append(
                    AIMessage(content="Sorry, I don't know the answer.")
                )
            else:
                answer, cost = result
                st.session_state.messages.append(AIMessage(content=answer))
                st.session_state.costs.append(cost)

    # Display chat history
    messages = st.session_state.get("messages", [])
    for message in messages:
        if isinstance(message, AIMessage):
            with st.chat_message("assistant"):
                st.markdown(message.content)
        elif isinstance(message, HumanMessage):
            with st.chat_message("user"):
                st.markdown(message.content)

    costs = st.session_state.get("costs", [])
    st.sidebar.markdown("## Costs")
    st.sidebar.markdown(f"**Total cost: ${sum(costs):.5f}**")
    for cost in costs:
        st.sidebar.markdown(f"- ${cost:.5f}")


# streamlit run app.py
if __name__ == "__main__":
    main()
```

---

## lmstudio

**Source file:** `lmstudio.md`

---
title: "Meta"
description: "LM Studio"
date: "2023-08-05"
categories: []
tags: []
slug: "lmstudio"
image: "/assets/images/mediamodifier-design.png"
---



I used LM Studio to test Large Language Models (LLMs) on my laptop.

![](/assets/images/lmstudio/screenshot-2023-08-05-at-3.47.29-pm-1836x1117.png)
*LLM Studio with Meta's Llama 2 chat 7B*

![](/assets/images/lmstudio/answer-the-following-ques...-1650x1120.png)
*Answer the following question by reasoning step by step. The cafeteria had 23 apples. If they used 20 for lunch, and bought 6 more, how many apples do they have?*


## System prompt

LM Studio allowed me to update the system prompt and prefix suffix settings (on the right of the user interface).

![](/assets/images/lmstudio/the-cafeteria-had-23-appl...-1650x986.png)
*System prompt: Perform the instructions as a preschooler would.*

![](/assets/images/lmstudio/teacher-the-cafeteria-had-23-appl...-1650x986.png)
*System prompt: Perform the instructions as a high school maths teacher would.*
## References

- [LM Studio](https://lmstudio.ai)

---

## m365commandlineinterface

**Source file:** `m365commandlineinterface.md`

---
title: "Microsoft 365 command line interface"
description: "Manage Microsoft 365 tenants and SharePoint Framework projects"
date: "2021-02-22"
categories: ["Microsoft 365","DevOps"]
tags: []
slug: "m365commandlineinterface"
image: "/assets/images/office-365-icon-500x500.png"
---


## m365

Why not use the supported [docker](dockerandubernetes.html) image?

$ docker run --rm -it m365pnp/cli-microsoft365

In the context of the docker image we use the m365 command to:

**login to a Microsoft Office 365 tenant****create a SharePoint Site; and****apply a [Site Design](sharepointsitedesignsandsitescripts.html).**

I used these commands:

~$ m365 login
~$ m365 spo site add --alias todoSite --title "Site with To Do"
~$ m365 spo sitedesign list
~$ m365 spo sitedesign apply --webUrl https://haddleyoffice365.sharepoint.com/sites/todoSite --id 789673f0-178d-4c9a-913c-e3187b7e2f13

To login to Microsoft 365, to create a SharePoint Site, to review the registered site designs and to apply one of the site designs to the newly created sites (adding a ToDo list).

![Docker image](/assets/images/m365commandlineinterface/screen-shot-2021-02-22-at-4.33.38-pm-1134x740.png)
*Using Docker*

![Login](/assets/images/m365commandlineinterface/screen-shot-2021-02-22-at-6.00.26-pm-1136x736.png)
*m365 login*

![](/assets/images/m365commandlineinterface/screen-shot-2022-05-01-at-4.08.39-pm-1424x1118.png)
*Login successful*

![Add Site](/assets/images/m365commandlineinterface/screen-shot-2021-02-22-at-6.29.56-pm-1136x740.png)
*Site add*

![Apply Site Design](/assets/images/m365commandlineinterface/screen-shot-2021-02-22-at-6.31.57-pm-1126x736.png)
*Apply Site Design*

![Site with To Do List](/assets/images/m365commandlineinterface/screen-shot-2021-02-22-at-7.15.43-pm-1836x1075.png)
**New* Site with To Do List*

I used these commands:

~$ m365 login
~$ m365 teams team add --name "TeamToDo" --description "Team with Site with To Do" --wait
~$ m365 spo sitedesign apply --webUrl https://haddleyoffice365.sharepoint.com/sites/TeamToDo --id 789673f0-178d-4c9a-913c-e3187b7e2f13
~$ m365 teams channel add --teamName "TeamToDo" --name "Channel" --description "Custom Channel"

To login to Microsoft 365, to create a Teams Team, to apply a site design to the newly created Teams/SharePoint sites (adding a ToDo list) and to add a channel to the Teams Team.

![](/assets/images/m365commandlineinterface/screen-shot-2022-05-01-at-5.06.00-pm-1487x828.png)
*Teams Site created*

![](/assets/images/m365commandlineinterface/screen-shot-2022-05-01-at-5.11.22-pm-1487x789.png)
*SharePoint Site created (with channels)*

---

## macbook

**Source file:** `macbook.md`

---
title: "Apple MacBook Air with M2 chip"
description: "Train and evaluate deep learning models"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/macbook/hero.png"
tags: ["python","ai"]
hidden: true
slug: "macbook"
---


## Apple MacBook Reset

I wanted to reset my Apple MacBook laptop before installing Python.

I restarted my laptop and held down the power button until I was able to  recovery menu was


## Install Anaconda Distribution

$ sdsddsdsdsdsd


---

## machinelearning

**Source file:** `machinelearning.md`

---
title: "Machine Learning"
description: "Finding patterns and making predictions"
date: "2025-09-20"
categories: ["AI/ML"]
image: "/assets/images/machinelearning/hero.png"
tags: ["sql","ai","machine learning"]
hidden: true
slug: "machinelearning"
---



## What is Machine Learning?

[Machine Learning is the art and science of finding patterns in data that allow you to make predictions](https://www.youtube.com/watch?v=BjTNJSQLIeA). 

For a Science Fair in 2019 I helped two of my children build a [learning machine](https://www.instructables.com/Matchbox-Mini-Chess-Learning-Machine/?fbclid=IwAR0g2mf_HQBxdJJIuQaeSfAbF3Hui4QoTPBuI18YoYVlKFIr4Bv8OX0diTw) using matchboxes and colored beads.


---

## machinelearning1

**Source file:** `machinelearning1.md`

---
title: "Machine Learning (Part 1)"
description: "What is Machine Learning?"
date: "2022-06-05"
categories: ["AI"]
tags: []
slug: "machinelearning1"
image: "/assets/images/tensorflow-logo.svg"
---



For a science fair in 2019 I helped two of my children build an [instructables.com project](https://www.instructables.com/Matchbox-Mini-Chess-Learning-Machine/?fbclid=IwAR0g2mf_HQBxdJJIuQaeSfAbF3Hui4QoTPBuI18YoYVlKFIr4Bv8OX0diTw) using matchboxes and colored beads.


## Hexapawn Educable Robot

The project is based on the matchbox computer described by Martin Garner.

In [his article](https://www.cs.williams.edu/~freund/cs136-073/GardnerHexapawn.pdf) Martin explains that learning machines are computers that improve with experience.

This learning machine improves over time through [reinforcement learning](https://www.techtarget.com/searchenterpriseai/definition/reinforcement-learning).

Reinforcement learning is a training method based on rewarding desired behaviors and/or punishing undesired ones (by removing a colored bead in this case).


## YOLO (you only look once)

For the same science fair I helped my children to configure a Raspberry Pi to track objects using the [YOLO](https://www.v7labs.com/blog/yolo-object-detection) v3 Tiny model.

Details of the Raspberry Pi setup are provided in Xiang Zhai's article [Deep Learning with Raspberry Pi -- Real-time object detection with YOLO v3 Tiny!](https://funofdiy.blogspot.com/2018/08/deep-learning-with-raspberry-pi-real.html)

The YOLO v3 Tiny model was trained using [Supervised learning](https://www.ibm.com/cloud/learn/supervised-learning). A labelled set of photographs was used to train the model.

The people at the science fair were less interested in the computer vision demonstration.

---

## machinelearning2

**Source file:** `machinelearning2.md`

---
title: "Machine Learning (Part 2)"
description: "What apps can be written quickly?"
date: "2022-06-05"
categories: ["AI"]
tags: []
slug: "machinelearning2"
image: "/assets/images/tensorflow-logo.svg"
---



In her [YouTube video](https://www.youtube.com/watch?v=BjTNJSQLIeA) Dale Markowitz explains why some machine learning powered applications can be built quickly and why others can not.

Dale explains that machine learning applications can be built quickly and easily if you can reuse a pre-trained model created by someone else. 

Dale demonstrates how she created a natural language translation application and a computer vision object tracking application using existing models.


## TensorFlow.js

[TensorFlow.js](https://www.tensorflow.org/js/demos) is an open source machine learning library that can run anywhere JavaScript can. TensorFlow.js is based upon the original TensorFlow library written in Python.

ModelDepot.io created a [project](https://github.com/ModelDepot/tfjs-yolo-tiny) that demonstrates how a [YOLO Tiny model](machineLearning1.html) can be reused in a TensorFlow.js app ([running in a browser](https://modeldepot.github.io/tfjs-yolo-tiny-demo/)).

![](/assets/images/machinelearning2/283720320-1067547677519021-4870542019071843454-n-1836x848.jpg)
*Live demonstration*


## Emoji scavenger hunt

The [emoji scavenger hunt](https://emojiscavengerhunt.withgoogle.com) is a fun browser-based game built using [TensorFlow.js](https://www.tensorflow.org/js/demos) (works best on smart mobile phones).

---

## machinelearning3

**Source file:** `machinelearning3.md`

---
title: "Machine Learning (Part 3)"
description: "Creating models"
date: "2022-06-05"
categories: ["AI","DevOps"]
tags: []
slug: "machinelearning3"
image: "/assets/images/tensorflow-logo.svg"
---


## Teachable Machine

[Teachable Machine](https://teachablemachine.withgoogle.com) is a web-based tool that makes creating ([supervised](machineLearning1.html)) machine learning ([classification](https://www.edureka.co/blog/classification-in-machine-learning/)) models fast, easy, and accessible to everyone. No prerequisite machine learning knowledge required.

I used Teachable Machines to create a [squishmallows](https://squishmallows.com/) recognizing application based on TensorFlow.js

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.11.56-pm-1836x977.png)
*New Image Project*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.12.23-pm-1836x974.png)
*Add a third (classification) class*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.16.41-pm-1836x975.png)
*rename the three classes (one class for each squishmallow)*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.19.51-pm-1836x968.png)
*Use the Webcam button to create a set of images (for each squishmallow)*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.21.15-pm-1836x971.png)
*Click the train model button*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.22.34-pm-1836x974.png)
*Model training complete*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.23.45-pm-1836x980.png)
*Use the preview window to test the model*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.24.51-pm-1836x975.png)
*Download the model and sample web page*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-7.59.46-pm-1836x881.png)
*Copy the sample web page to Visual Studio Code to test*

![](/assets/images/machinelearning3/screen-shot-2022-06-05-at-8.25.43-pm-1538x810.png)
*The application is 100% certain that the webcam is pointing at the Apple squishmallow.*


## squish.html

```text
<div>Teachable Machine Image Model</div>
<button type="button" onclick="init()">Start</button>
<div id="webcam-container"></div>
<div id="label-container"></div>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
<script type="text/javascript">
    // More API functions here:
    // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

    // the link to your model provided by Teachable Machine export panel
    // const URL = "./my_model/";
    const URL = "";

    let model, webcam, labelContainer, maxPredictions;

    // Load the image model and setup the webcam
    async function init() {

        debugger

        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        // load the model and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // or files from your local hard drive
        // Note: the pose library adds "tmImage" object to your window (window.tmImage)
        model = await tmImage.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();

        // Convenience function to setup a webcam
        const flip = true; // whether to flip the webcam
        webcam = new tmImage.Webcam(200, 200, flip); // width, height, flip
        await webcam.setup(); // request access to the webcam
        await webcam.play();
        window.requestAnimationFrame(loop);

        // append elements to the DOM
        document.getElementById("webcam-container").appendChild(webcam.canvas);
        labelContainer = document.getElementById("label-container");
        for (let i = 0; i < maxPredictions; i++) { // and class labels
            labelContainer.appendChild(document.createElement("div"));
        }
    }

    async function loop() {
        webcam.update(); // update the webcam frame
        await predict();
        window.requestAnimationFrame(loop);
    }

    // run the webcam image through the image model
    async function predict() {
        // predict can take in an image, video or canvas html element
        const prediction = await model.predict(webcam.canvas);
        for (let i = 0; i < maxPredictions; i++) {
            const classPrediction =
                prediction[i].className + ": " + prediction[i].probability.toFixed(2);
            labelContainer.childNodes[i].innerHTML = classPrediction;
        }
    }
</script>
```

---

## machinelearning4

**Source file:** `machinelearning4.md`

---
title: "Machine Learning (Part 4)"
description: "Colab"
date: "2022-06-08"
categories: ["Python","AI"]
tags: []
slug: "machinelearning4"
image: "/assets/images/tensorflow-logo.svg"
---



Colab is Google's implementation of [Jupyter Notebooks](https://jupyter.org).

 A Colab consists of [text comments and code](https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/numpy_ultraquick_tutorial.ipynb?utm_source=mlcc&utm_campaign=colab-external&utm_medium=referral&utm_content=numpy_tf2-colab&hl=en#scrollTo=vO47lN3aDOAv)


## NumPy

[NumPy](https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/numpy_ultraquick_tutorial.ipynb?utm_source=mlcc&utm_campaign=colab-external&utm_medium=referral&utm_content=numpy_tf2-colab&hl=en#scrollTo=HF-flFfs9r0q) is a Python library for creating and manipulating vectors and matrices.

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.23.23-pm-757x144.png)
*import numpy as np*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.24.04-pm-745x209.png)
*np.array([...])*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.25.18-pm-764x221.png)
*np.array([[...],[...],...,[...]]*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.27.05-pm-755x262.png)
*a sequence from 5 to 11*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.28.11-pm-783x247.png)
*6 random values between 50 and 100*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.29.30-pm-788x165.png)
*5 random floating point values between 0 and 1*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.33.42-pm-788x475.png)
*feature and label*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.36.16-pm-788x402.png)
*adding noise*


## Pandas

[Pandas DataFrames](https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/pandas_dataframe_ultraquick_tutorial.ipynb?utm_source=mlcc&utm_campaign=colab-external&utm_medium=referral&utm_content=pandas_tf2-colab&hl=en) are similar to spreadsheets. DataFrames have columns and rows.

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.49.03-pm-787x164.png)
*import numpy and pandas*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.50.52-pm-789x650.png)
*pd.DataFrame(data=<data cell values>, columns=<column names>)*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.54.36-pm-779x348.png)
*<dataframe>["<new column name>"] = <dataframe>["<existing column name>"] + <constant>*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-6.58.28-pm-787x739.png)
*<dataframe>[<start index>,<end index + 1>]*

![](/assets/images/machinelearning4/screen-shot-2022-06-08-at-7.01.31-pm-786x991.png)
*<dataframe>.copy()*

---

## machinelearning5

**Source file:** `machinelearning5.md`

---
title: "Machine Learning (Part 5)"
description: "Excel"
date: "2022-06-11"
categories: ["AI"]
tags: []
slug: "machinelearning5"
image: "/assets/images/tensorflow-logo.svg"
---



Can we predict a person's glucose levels based on their age?

If one thing depends on another thing in a linear way the least squares method can be used to predict the dependent thing (y) given the independent thing (x).

If there is a linear relationship between glucose levels and age we should be able to summarize that relationship using an equation of the form **y = mx + b**.

In this formula **y** would be the (predicted) thing (glucose level) and **x** would be the given thing (the person's age).

In this formula **m** is the slope of the linear relationship (weight) and **b** is the y-intercept constant (bias).

If a linear relationship exists and we can collect enough data we should be able to calculate the value of m and b and to predict the value of a person's glucose levels based on their age.

This [youtube video](https://www.youtube.com/watch?v=p_fu7gIikxY) explains how we can calculate the slope and y-intercept values by hand  using the least squares method.

As an exercise I wanted to use Excel and machine learning to calculate the line of best fit.


Excel has built in "slope()" and "intercept()" functions that can be used to calculate the slope (m) and y-intercept (b) for a set of dependent and independent data points.

The youtube video referenced [above](https://www.youtube.com/watch?v=p_fu7gIikxY) explains how these functions work.

![](/assets/images/machinelearning5/screen-shot-2022-06-10-at-9.03.43-am-629x414.png)
*slope and y-intercept calculated by Excel*


## Calculating the line of best fit using the sklearn LinearRegression model

A Colab Notepad can be used to show data points and the line of best fit.

Predicting a person's glucose levels based on their age.

![](/assets/images/machinelearning5/screen-shot-2022-06-13-at-10.38.18-am-987x1048.png)
*A scatter plot of the glucose level data with a line of best fit added in red ('r')*


## Making a prediction

Once a model has been trained it can be used to make predictions.

In the example above we can provide a person's age and predict what their glucose level might be (based on the data used to train the model).

![](/assets/images/machinelearning5/screen-shot-2022-06-13-at-1.38.01-pm-831x71.png)
*What would we expect a person's glucose level to be if they were aged 50?*


## A larger data set

[Plotly Sample Datasets](https://github.com/plotly/datasets) includes a larger diabetes dataset.

A Colab Notepad can used to show data points from the dataset and a description of the dataset.

![](/assets/images/machinelearning5/screen-shot-2022-06-11-at-2.03.18-pm-1007x671.png)
*Diabetes Dataset*

![](/assets/images/machinelearning5/screen-shot-2022-06-11-at-2.03.38-pm-1189x503.png)
*Description of Diabetes Dataset*


## Excel

Again we can use Excel to calculate a line of best fit.

![](/assets/images/machinelearning5/screen-shot-2022-06-11-at-1.52.11-pm-891x413.png)
*Using Excel to calculate the line of best fit for Glucose (y) given Age (x)*


## Calculating the line of best fit using the sklearn LinearRegression model

A Colab Notepad can be used to show data points and the line of best fit.

Predicting a person's glucose levels based on their age.

![](/assets/images/machinelearning5/screen-shot-2022-06-13-at-10.59.36-am-981x1033.png)
*A scatter plot of the glucose level and age data with a line of best fit added in red ('r')*


## Implementing Linear Regression with two input variables using the sklearn LinearRegression model

Predicting a person's glucose levels based on their age and BMI.

![](/assets/images/machinelearning5/screen-shot-2022-06-13-at-12.09.40-pm-803x1187.png)
*Predicting a person's glucose levels based on their age and BMI*

![](/assets/images/machinelearning5/screen-shot-2022-06-13-at-12.09.50-pm-678x371.png)
*3D scatter plot of the glucose level, age and BMI data with the of best fit (surface) added in red ('red')*


## Making a prediction

Once a model has been trained it can be used to make predictions.

In the example above we can provide a person's age and BMI and predict what their glucose level might be (based on the data used to train the model).

![](/assets/images/machinelearning5/screen-shot-2022-06-13-at-1.54.58-pm-830x100.png)
*What would we expect a person's glucose level to be if they were aged 50 with a BMI of 70?*

---

## machinelearning6

**Source file:** `machinelearning6.md`

---
title: "Machine Learning (Part 6)"
description: "Splitting into training and test dataframes"
date: "2022-06-11"
categories: ["AI"]
tags: []
slug: "machinelearning6"
image: "/assets/images/tensorflow-logo.svg"
---



Can we predict if a person will develop diabetes based on their Pregnancy Count, Glucose level, Blood Pressure, Skin Thickness, Insulin, BMI, DiabetesPedigreeFunction and Age?

![](/assets/images/machinelearning6/screen-shot-2022-06-11-at-4.04.28-pm-1135x418.png)
*Summary of the diabetes data*


There are 768 data items in the diabetes data.

We will need to split the 768 data items into a training set and a testing set.

The "Outcome" column allows us to see which people have been diagnosed with diabetes.

I removed the Outcome column from the training set (using "pop").

![](/assets/images/machinelearning6/screen-shot-2022-06-13-at-2.07.48-pm-815x678.png)
*Splitting data into training and testing dataframes*


## Normalize

Then I normalized the feature columns.

(Notice that one way to normalize numeric data is to calculate the mean of each column and then replacing the original value in each cell with the number of standard deviations the original value was from the mean of that column.)

![](/assets/images/machinelearning6/screen-shot-2022-06-13-at-2.09.21-pm-820x743.png)
*The training data X*


## Training the sklearn model

I trained a sklearn model using the normalized features in the training set and the labels in the training set.

The actual and predicted results are shown below

![](/assets/images/machinelearning6/screen-shot-2022-06-13-at-2.09.56-pm-820x625.png)
*Training the sklearn model and predicting results*

---

## machinelearning7

**Source file:** `machinelearning7.md`

---
title: "Machine Learning (Part 7)"
description: "Google Cloud Platform"
date: "2022-06-11"
categories: ["AI"]
tags: []
slug: "machinelearning7"
image: "/assets/images/tensorflow-logo.svg"
---



AutoML enables developers to train high-quality models specific to their business needs.

I used AutoML to build and use the diabetes binary classification model I described [here](machinelearning6.html).

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.05.35-pm-1240x869.png)
*I created a new dataset*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.06.45-pm-1244x866.png)
*I uploaded the csv file (minimum size is 1000 rows)*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.06.57-pm-1244x866.png)
*The data was imported*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.10.36-pm-1241x864.png)
*AutoML detected 9 columns*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.11.19-pm-1247x860.png)
*I selected "Outcome" as the Target column*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.11.54-pm-1241x862.png)
*I trained the AutoML model*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.12.20-pm-1238x916.png)
*I specified a budget of one hour*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.12.31-pm-1241x858.png)
*Training started*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-4.58.14-pm-1241x904.png)
*Training progressed*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-5.00.00-pm-1243x910.png)
*Training completed*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-5.01.25-pm-1354x1310.png)
*I reviewed the Confusion matrix (the true positives. false positives, true negatives and false negatives)*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-5.02.29-pm-1351x1325.png)
*I reviewed the Feature importance summary*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-5.03.32-pm-1367x330.png)
*I deployed the model to the cloud*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-5.03.43-pm-1061x363.png)
*I clicked the DEPLOY button*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-5.01.25-pm-1354x1310.png)
*The deployment completed*

![](/assets/images/machinelearning7/screen-shot-2022-06-12-at-5.34.27-pm-1366x1319.png)
*I entered test data and asked the model to predict the "Outcome" value*

---

## machinelearning8

**Source file:** `machinelearning8.md`

---
title: "Machine Learning (Part 8)"
description: "Stealing Baseball Signs"
date: "2022-06-12"
categories: ["AI"]
tags: []
slug: "machinelearning8"
image: "/assets/images/tensorflow-logo.svg"
---



Can we predict when a baseball player is going to try to "steal"?

Mark Rober and [Jabril](https://www.youtube.com/channel/UCQALLeQPoZdZC4JNUboVEUg) created an application to predict when a Baseball player had been directed to "steal".


## How does the application work?

Jabril hosts a copy of his application on [his web site](https://jabrils.com/sp/) and the source code of the application is available on [GitHub](https://github.com/Jabrils/Uncle-Rober-Baseball-Predictor/blob/master/simple%20model%20website/index.html).

I reviewed the code to see how the application worked.


## Sequence

Mark and Jabril created a way to encode Baseball signals using letters. 

Each Baseball coach will use a unique set of signals to communicate with her players.

The coach in the example below signals to her players by touching her nose, touching her right ear, touching her right arm, touching her chin, touching her left ear, touching her left arm, touching her chest, touching her hat or touching her belt.

![](/assets/images/machinelearning8/screen-shot-2022-06-11-at-7.25.24-pm-1271x712.png)
*Baseball signal encoding*


## Encode

Internally the application works with sequences of letters. To make the application easier to operate a user can enter a description for each signal.

![](/assets/images/machinelearning8/screen-shot-2022-06-14-at-7.35.41-pm-1536x797.png)
*A description for each signal*


## Apply

When Apply is pressed the Encode() function is run.

![](/assets/images/machinelearning8/screen-shot-2022-06-14-at-7.37.52-pm-1536x826.png)
*The Apply button*


## Encode()

When the Encode() function executes the descriptions provided by the user are copied to the the web page's HTML.

![](/assets/images/machinelearning8/screen-shot-2022-06-14-at-7.42.56-pm-1536x796.png)
*When the Encode() function executes*


## CheckSeq()

The user watches the coach communicating with the players and records the signals. 

As a sequence is entered into the app the CheckSeq() function is used to make a live prediction.

![](/assets/images/machinelearning8/screen-shot-2022-06-14-at-8.57.22-pm-1536x825.png)
*The dict variable contains an entry for every possible two letter combination. A value of 1 is used to mark all combinations that are present in the *current* sequence.*


## Dataset

After the pitch is made the user watches to see if a player attempts to steal a base. 

If there is an attempt to steal a base the user clicks the "Steal" button.

If there is no attempt to steal a base the user clicks the "Not Steal" button.

Every time the Steal or No Steal button is pressed the app has new intelligence and the Label() function is called.

The Label() function adds the current sequence and label (steal 1 or no steal 0) to the page's HTML, adds the current sequence and label to a "dataset" variable and then calls the FindSteal() function.

![](/assets/images/machinelearning8/screen-shot-2022-06-11-at-7.22.42-pm-1272x715.png)
*The Label() function adds the current sequence and label (steal 1 or no steal 0) to the page's HTML*

![](/assets/images/machinelearning8/screen-shot-2022-06-14-at-8.16.13-pm-1536x784.png)
*The Label() function adds the current sequence and label to a "dataset" variable and then calls the FindSteal() function.*


## FindSteal()

The variable "top" in the FindSteal() function is used to score all possible two letter combinations as candidates (based on all of the labeled sequences in the dataset).

The web page is updated to show the most likely candidate.

![](/assets/images/machinelearning8/screen-shot-2022-06-15-at-8.45.57-am-1536x892.png)
*The variable "top"*

![](/assets/images/machinelearning8/screen-shot-2022-06-15-at-8.53.55-am-1126x330.png)
*updated prediction*


## Machine learning?

The application developed by Jabril and demonstrated by Mark is a nice [reinforcement learning](https://www.techtarget.com/searchenterpriseai/definition/reinforcement-learning) example (just as [Hexapawn](machineLearning1.html) is).

---

## machinelearning9

**Source file:** `machinelearning9.md`

---
title: "Machine Learning (Part 9)"
description: "MNIST"
date: "2022-06-17"
categories: ["AI"]
tags: []
slug: "machinelearning9"
image: "/assets/images/tensorflow-logo.svg"
---



The MNIST database of handwritten digits has a training set of 60,000 examples, and a test set of 10,000 examples.

The digits have been size-normalized and centered in a fixed-size image.

Keras is aware of the MNIST database. The database can be loaded using the mnist.load_data() function.

A random image from the MNIST database can be viewed using the pyplot.imshow() function.

![](/assets/images/machinelearning9/screen-shot-2022-06-17-at-6.38.18-pm-1704x1296.png)
*An image from the MNIST database*


## normalization

Normalization refers to a process that makes something more normal or regular.

Here the each image pixel value (0-255) is converted to a float value between 0 and 1.

Each label (an integer between 0 and 9) is converted to a matrix of eight zeros and a single one.

![](/assets/images/machinelearning9/screen-shot-2022-06-17-at-6.39.57-pm-1700x846.png)
*Normalized*


## model

The keras Sequential model is commonly used.

I added a Dense layer with 512 units and 784 (28*28) inputs (there are 784 pixels in each image).
I added a Dense hidden layer with 512 units.
I added a Dense output layer with 10 units (each unit corresponding to a category value from 0 to 9).

![](/assets/images/machinelearning9/screen-shot-2022-06-17-at-6.41.19-pm-1648x1296.png)
*model*


## compile and fit

After creating the model I configured and trained it.

I used the compile() function to configure the model.

I used the fit() function to train the model.

![](/assets/images/machinelearning9/screen-shot-2022-06-17-at-6.44.24-pm-1718x658.png)
*compile and fit*


## predict

I used the predict() function to "recognize" the test images.

![](/assets/images/machinelearning9/screen-shot-2022-06-17-at-6.45.08-pm-1712x1216.png)
*predict (recognizing the handwritten digits)*

---

## machinelearningwip

**Source file:** `machinelearningwip.md`

---
title: "Machine Learning (WIP)"
description: "WIP"
date: "2025-09-20"
categories: ["AI/ML"]
image: "/assets/images/machinelearningwip/hero.png"
tags: ["ai","ml","machine learning","git","github"]
hidden: true
slug: "machinelearningwip"
---


## NVIDIA

The NVIDIA web site includes a number of [tutorials](https://developer.nvidia.com/embedded/learn/tutorials) and [training courses](https://www.nvidia.com/en-us/training/). 

I completed the "Getting Started with Image Segmentation" course and provide a summary here.

http://www.cardiacatlas.org/studies/sunnybrook-cardiac-data/


## Google

https://developers.google.com/machine-learning/crash-course

https://www.youtube.com/watch?v=PmlRbfSavbI

Stealing Baseball Signs with a Phone (Machine Learning)

https://www.youtube.com/watch?v=TI4HRR3Hd9A RNN 

app: https://jabrils.com/sp/

source: https://github.com/Jabrils/Uncle-Rober-Baseball-Predictor

Sequence-Domain Encompassed Correlations ([SDEC](https://github.com/Jabrils/Uncle-Rober-Baseball-Predictor/tree/master/SDEC%20(Init)))

https://github.com/Jabrils/SDEC

I have a confession

https://www.youtube.com/watch?v=PmlRbfSavbI&t=426s

**An Absolute Beginner's Guide to Deep Learning with Keras | Dr. Brian Spiering @ PyBay2018**

https://www.youtube.com/watch?v=yJm2l2Mh7nQ


---

## macscreensharing

**Source file:** `macscreensharing.md`

---
title: "Mac Screen Sharing"
description: "Screen Sharing VNC"
date: "2025-08-18"
categories: []
tags: []
slug: "macscreensharing"
image: "/assets/images/apple-logo-black.svg"
---



To share your macOS screen using VNC, enable Screen Sharing in System Settings, then use a VNC viewer on another device to connect to your Mac's IP address or hostname, using the password you set.

![](/assets/images/macscreensharing/screenshot202025-08-1820at2011.28.53e280afam-1022x672.png)
*I clicked on the apple | System Setting | General | Sharing menu item on the machine I wanted remote access to.*

![](/assets/images/macscreensharing/screenshot202025-08-1820at2011.29.30e280afam-1022x756.png)
*I enabled Screen Sharing and Remote Login*

![](/assets/images/macscreensharing/screenshot202025-08-1820at2011.24.43e280afam-2136x131.png)
*I entered the url vnc://192.168.20.42 into a copy of safari I wanted to access the remote desktop from*

![](/assets/images/macscreensharing/screenshot202025-08-1820at2011.24.58e280afam-888x202.png)
*Safari started Screen Sharing*

![](/assets/images/macscreensharing/screenshot202025-08-1820at2011.56.26e280afam-858x522.png)
*I entered my login details*

![](/assets/images/macscreensharing/screenshot202025-08-1820at2011.25.30e280afam-856x432.png)
*I selected Standard*

![](/assets/images/macscreensharing/screenshot202025-08-1820at2011.26.42e280afam-2136x1300.png)
*I was able to access the desktop remotely*


## Remote Terminal SSH

To connect to a remote Mac using the command-line terminal, the primary method involves using Secure Shell (SSH). This allows you to execute commands on the remote machine as if you were directly interacting with its local terminal.

![](/assets/images/macscreensharing/screenshot202025-08-1820at203.42.57e280afpm-1134x474.png)
*I connected to my mac mini using ssh*

---

## mapextension

**Source file:** `mapextension.md`

---
title: "Map Extension"
description: "Map Extension"
date: "2023-09-01"
categories: ["Microsoft Dynamics","Business Central","Maps","Microsoft Dynamics"]
tags: []
slug: "mapextension"
image: "/assets/images/dynamics365-color.svg"
---



The Microsoft Dynamics 365 Business Central Extension described here allows users to view Customer locations in a map.


## ChatGPT

**Please explain this Business Central AL code**

The provided Business Central AL (Application Language) code is defining an extension for a Business Central application that adds a Leaflet map visualization to customer-related pages in the application. Let's break down the code step by step:

**Control Add-in Definition (LeafletMapsFactBox):**
This section defines a control add-in named LeafletMapsFactBox. Control add-ins are used to integrate external controls or web content into Business Central pages.

RequestedHeight and MaximumHeight specify the height of the control.
VerticalStretch and VerticalShrink control the vertical resizing behavior.
HorizontalStretch and HorizontalShrink control the horizontal resizing behavior.
Scripts specifies JavaScript files that are needed for the control add-in. It includes two URLs, one for Leaflet.js and another for LeafletMapsFunctions.js.
Stylesheets specifies the CSS styles needed for the control add-in, including the Leaflet CSS.

The ControlReady event is defined, which will be triggered when the control is ready. Additionally, there's a procedure CreateSidebar defined.

**Page 50101 (LeafletMapsCustListFactBoxPart):**
This section defines a page named LeafletMapsCustListFactBoxPart. It is a fact box part that extends the Customer table and is intended to display on a card page.

PageType specifies that this is a card part.
SourceTable specifies that this part is related to the "Customer" table.

In the layout section, it defines a user control (Sidebar) that references the LeafletMapsFactBox control add-in defined earlier. This user control will be placed in the "Content" area of the page.
The OnAfterGetRecord trigger is defined. It is executed after a record is retrieved. It calls the CreateSidebar procedure defined in the LeafletMapsFactBox control add-in, passing the customer's number and city as parameters.

**Page Extension 50102 (LeafletMaps Cust Card):**
This section defines a page extension that extends the "Customer Card" page. It adds a fact box part, LeafletMapsCustListFactBoxPart, to the "Customer Card" page.

It places the fact box part in the "FactBoxes" area.
ApplicationArea specifies that this extension is applicable to all areas.
Caption sets the caption for the fact box part to "Customer Map."
SubPageLink indicates that this fact box is linked to the customer number ("No.").

**Page Extension 50103 (LeafletMaps Cust List):**
This section defines a page extension that extends the "Customer List" page. Similar to the previous extension, it adds the LeafletMapsCustListFactBoxPart fact box part to the "Customer List" page.

It also places the fact box part in the "FactBoxes" area.
ApplicationArea specifies that this extension is applicable to all areas.
Caption sets the caption for the fact box part to "Customer Map."
SubPageLink indicates that this fact box is linked to the customer number ("No.").

In summary, this code extends customer-related pages in a Business Central application to include a fact box displaying a Leaflet map. The map is populated with customer data, and users can interact with it to visualize customer locations. The LeafletMapsFactBox control add-in provides the functionality for rendering the map, and the code specifies when and where this control should be displayed on customer card and list pages.

![](/assets/images/mapextension/20230901image01-1333x810.png)
*Customer Adatum Corporation is based in Atlanta*

![](/assets/images/mapextension/20230901image02-1333x809.png)
*Customer Trey Research is based in Chicago*

![](/assets/images/mapextension/20230901image03-1332x807.png)
*Customer School of Fine Art is based in Miami*

![](/assets/images/mapextension/20230901image04-1331x808.png)
*Customer Relecloud is based in Atlanta*


## Upload and deploy extension

To upload and deploy an extension to Microsoft Dynamics 365 Business Central, you'll need to follow a series of steps. Extensions in Business Central typically come in the form of [.app](https://haddley.github.io/businesscentral/Haddley_haddley-app_1.0.0.0.app) files or .zip files containing the extension's artifacts and metadata. Here's a step-by-step guide on how to do this:

Prerequisites:

You should have an extension package ready (either a .app file or a .zip file) that you want to upload and deploy.
You should have the necessary permissions to perform these actions in your Business Central instance.
Steps:

Access Your Business Central Environment:
Log in to your Microsoft Dynamics 365 Business Central environment with the appropriate credentials.
Access the Extension Management Page:
Depending on the version of Business Central you're using, the exact path to the Extension Management page may vary. Generally, you can find it under "Extension Management" or "Extensions."
Upload the Extension Package:
Look for an option to "Upload Extension" or something similar. This will allow you to select and upload the extension package (the .app or .zip file) from your local machine.
Provide Necessary Information:
Depending on your extension, you may need to provide some configuration details or permissions. Follow the on-screen instructions to configure the extension correctly.
Install the Extension:
After uploading the extension, you'll typically see an option to "Install" or "Publish" it. Click this option to initiate the installation process.
Monitor Installation Progress:
Business Central will begin installing the extension. You can monitor the installation progress, and if any issues arise, you'll receive error messages indicating what needs to be resolved.
Check the Status:
Once the installation is complete, check the status of the extension to ensure it's successfully installed and deployed. You should see it listed among your installed extensions.
Enable or Configure the Extension:
Depending on the extension, you may need to enable or configure it further to make it functional. This can include setting up permissions, defining data mappings, or configuring integration points.
Test and Validate:
Before using the extension in a production environment, it's a good practice to thoroughly test it in a sandbox or testing environment to ensure it works as expected and doesn't conflict with existing functionality.
Go Live:
Once you are satisfied with the extension's performance in your testing environment, you can deploy it to your production environment by following similar steps. Make sure to have a backup and a rollout plan in case any issues arise during deployment.
Remember that the exact steps and options may vary slightly depending on the version of Business Central you're using and the specific requirements of the extension you are deploying. Always refer to the official documentation for your version of Business Central for detailed instructions and troubleshooting guidance.

![](/assets/images/mapextension/20230903image01-1340x889.png)
*Advanced Settings*

![](/assets/images/mapextension/20230903image02-1336x887.png)
*Upload And Deploy Extension*

![](/assets/images/mapextension/20230903image03-1333x808.png)
*Deploy*

![](/assets/images/mapextension/20230903image04-1330x805.png)
*Installation in progress*

![](/assets/images/mapextension/20230903image05-1337x885.png)
*Extension running in the cloud*


## LeafletMapsExtension.al

```text
controladdin LeafletMapsFactBox
{
    RequestedHeight = 400;
    MaximumHeight = 600;
    VerticalStretch = false;
    VerticalShrink = false;
    HorizontalStretch = true;
    HorizontalShrink = true;
    Scripts = 'https://unpkg.com/leaflet@1.7.1/dist/leaflet.js', 'LeafletMapsFunctions.js';
    Stylesheets = 'https://unpkg.com/leaflet@1.7.1/dist/leaflet.css';


    event ControlReady()
    procedure CreateSidebar(no: Text; city: Text);
}


page 50101 LeafletMapsCustListFactBoxPart
{
    PageType = CardPart;
    SourceTable = "Customer";


    layout
    {
        area(Content)
        {
            usercontrol(Sidebar; LeafletMapsFactBox)
            {
                ApplicationArea = All;
            }
        }
    }


    trigger OnAfterGetRecord()
    begin
        CurrPage.Sidebar.CreateSidebar(rec."No.", rec.City);
    end;
}




pageextension 50102 "LeafletMaps Cust Card" extends "Customer Card"
{
    layout
    {
        addfirst(FactBoxes)
        {
            part(LeafletMapsCustListFactBoxPart; LeafletMapsCustListFactBoxPart)
            {
                ApplicationArea = All; //Basic, Suite;// all;
                Caption = 'Customer Map';
                SubPageLink = "No." = FIELD("No.");


            }
        }
    }




}


pageextension 50103 "LeafletMaps Cust List" extends "Customer List"
{


    layout
    {
        addfirst(FactBoxes)
        {
            part(LeafletMapsCustListFactBoxPart; LeafletMapsCustListFactBoxPart)
            {
                ApplicationArea = all;
                caption = 'Customer Map';
                SubPageLink = "No." = FIELD("No.");
            }
        }


    }


}
```

## LeafletMapsFunctions.js

```text
function CreateSidebar(no, city) {
    debugger;
    var __div = document.getElementById('controlAddIn');


    // clear contents of controlAddIn div
    __div.innerHTML = '';


    // create the map div
    var __innerDiv = document.createElement("div");
    __innerDiv.id = 'map';
    __innerDiv.style = 'height: 100vh'


    // add the map div to the controlAddIn div
    __div.appendChild(__innerDiv);


    // get latitude and longitude position for this city
    var location = GetCityLocation(city)


    // What map zoom level should we use?
    var zoomLevel = 9;


    // create the Leaflet Map
    var map = L.map('map').setView(location, zoomLevel);


    // add a tile layer
    L.tileLayer('//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg').addTo(map);


    // add a marker
    var newMarker = new L.marker(location).addTo(map);


    Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("ControlReady");


}


function GetCityLocation(city) {
    if (city == "Atlanta")
        return [33.7674828, -84.5025308]


    if (city == "Miami")
        return [25.782479, -80.2706579]


    if (city == "Chicago")
        return [41.833871, -87.8967688]


    // else return London's location
    return [51.505, -0.09]
}
```

## References

- [Map Extension](https://haddley.github.io/businesscentral/Haddley_haddley-app_1.0.0.0.app)

---

## mcpserver

**Source file:** `mcpserver.md`

---
title: "Model Context Protocol (Part 1)"
description: "Typescript quick start"
date: "2025-08-13"
categories: ["TypeScript","AI"]
tags: []
slug: "mcpserver"
image: "/assets/images/mcp-1024x1024.png"
---



Model Context Protocol (MCP) is a framework designed to enhance the reasoning and planning capabilities of AI agents.

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.17.09e280afpm-2136x1248.png)
*In my Prompt flow with Semantic Kernel and Planner post I demonstrated that large language models rely on tools to do maths.*

![](/assets/images/mcpserver/screenshot202025-08-1320at201.17.25e280afpm-2136x1373.png)
*The model context protocol Typescript quick start demonstrates how to create a model context protocol server with an addition tool. I added a multiplication tool to the model context protocol sample (see the updated code below).*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.40.02e280afpm-2136x895.png)
*I used the model context protocol inspector to test the server*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.40.23e280afpm-2136x1380.png)
*I clicked Connect*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.40.34e280afpm-2136x1374.png)
*I clicked Tools*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.44.46e280afpm-2136x1377.png)
*I clicked on the mulipy tool, entered arguments and clicked Run Tool*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.47.03e280afpm-2136x432.png)
*I clicked the Visual Studio Code Command Palette menu item and entered mcp*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.47.21e280afpm-2136x328.png)
*I selected Command*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.48.16e280afpm-2136x407.png)
*I entered the command needed to run the mcp server npx -y tsx main.ts*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.48.46e280afpm-2136x301.png)
*I accepted the generated name*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.48.56e280afpm-2136x388.png)
*I selected Workspace*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.49.16e280afpm-1052x504.png)
*I clicked Trust*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.54.49e280afpm-2136x1263.png)
*I used Visual Studio Code's chat window to ask the Large Language Model to multiply 2134.567 by 653.23*

![](/assets/images/mcpserver/screenshot202025-08-1320at2012.55.18e280afpm-2136x1256.png)
*With the help of the multiply tool the Large Language Model was able to provide the correct answer*


```text
import { McpServer, ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import { z } from "zod";

// Create an MCP server
const server = new McpServer({
  name: "demo-server",
  version: "1.0.0"
});

// Add an addition tool
server.registerTool("add",
  {
    title: "Addition Tool",
    description: "Add two numbers",
    inputSchema: { a: z.number(), b: z.number() }
  },
  async ({ a, b }) => ({
    content: [{ type: "text", text: String(a + b) }]
  })
);

// Add a multiplication tool
server.registerTool("muliply",
  {
    title: "Multiply Tool",
    description: "Multiply two numbers",
    inputSchema: { a: z.number(), b: z.number() }
  },
  async ({ a, b }) => ({
    content: [{ type: "text", text: String(a * b) }]
  })
);


// Add a dynamic greeting resource
server.registerResource(
  "greeting",
  new ResourceTemplate("greeting://{name}", { list: undefined }),
  { 
    title: "Greeting Resource",      // Display name for UI
    description: "Dynamic greeting generator"
  },
  async (uri, { name }) => ({
    contents: [{
      uri: uri.href,
      text: `Hello, ${name}!`
    }]
  })
);

// Start receiving messages on stdin and sending messages on stdout
const transport = new StdioServerTransport();
await server.connect(transport);
```
## References

- [Building Your First MCP Server: A Beginners Tutorial](https://dev.to/debs_obrien/building-your-first-mcp-server-a-beginners-tutorial-5fag)
- [New Lab! Learn How to Connect MCP to Copilot Studio](https://www.youtube.com/watch?v=jG-XTzXxFCk)

---

## mcpserver2

**Source file:** `mcpserver2.md`

---
title: "Model Context Protocol (Part 2)"
description: "Business Central"
date: "2025-09-21"
categories: ["Microsoft Dynamics","Business Central","TypeScript","DevOps"]
tags: []
image: "/assets/images/mcpserver2/mcp-1024x1024.png"
slug: "mcpserver2"
hidden: true
---


I created a Model Context Protocol (MCP) server for Microsoft Business Central

![](/assets/images/mcpserver2/screenshot202025-08-2220at205.09.49e280afpm-2136x1239.png)
*I created a business-central-mcp folder. I ran npm init -y. I updated the generated package.json file adding type: "module".*

![](/assets/images/mcpserver2/screenshot202025-08-2220at205.10.58e280afpm-2136x1239.png)
*I ran npm install @modelcontextprotocol/sdk and npm install zod.*

![](/assets/images/mcpserver2/screenshot202025-08-2220at205.47.16e280afpm-2136x1093.png)
*I ran npx -y @modelcontextprotocol/inspector npx -y tsx main.ts.*

![](/assets/images/mcpserver2/screenshot202025-08-2220at205.48.28e280afpm-2136x1239.png)
*The hello tool returned success*

![](/assets/images/mcpserver2/screenshot202025-08-2220at206.30.50e280afpm-2136x1425.png)
*I replaced the hello tool with a get-vendors tool*

![](/assets/images/mcpserver2/screenshot202025-08-2220at206.35.00e280afpm-2136x1369.png)
*I ran npx -y @modelcontextprotocol/inspector npm run dev. The get_vendors tools returned success.Later I ran npm run build and then npx -y @modelcontextprotocol/inspector npm run start*

For remote servers, set up a Streamable HTTP transport that handles both client requests and server-to-client notifications.

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.10.09e280afpm-2136x1326.png)
*I ran docker build -t business-central-mcp .then npm run docker:run*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.12.04e280afpm-2136x860.png)
*I ran npx -y @modelcontextprotocol/inspector*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.12.56e280afpm-1619x886.png)
*I ran the get_vendors tool*

The Azure Container Apps extension for Visual Studio Code enables you to choose existing Container Apps resources, or create new ones to deploy your applications to.

[https://learn.microsoft.com/en-us/azure/container-apps/deploy-visual-studio-code](https://learn.microsoft.com/en-us/azure/container-apps/deploy-visual-studio-code)

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.28.35e280afpm-2136x374.png)
*I entered the name of new container apps environment*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.28.44e280afpm-2136x413.png)
*I selected a location*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.35.46e280afpm-2136x185.png)
*I selected the Deploy Project from Workspace... menu item*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.36.13e280afpm-2136x303.png)
*I accepted the generated container app name*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.36.27e280afpm-2136x250.png)
*I selected the Managed Identity option*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.36.36e280afpm-2136x205.png)
*I selected the .env file*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.39.11e280afpm-2136x1314.png)
*The deployment finished*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.41.17e280afpm-2136x1079.png)
*I ran a fresh copy of the inspector*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.41.01e280afpm-1620x891.png)
*I tested the deployment using the URL https://business-central-mcp-new.thankfulsea-b533246e.eastus.azurecontainerapps.io/mcp*

I used a Custom Connector to connect Copilot Studio to the Model Context Protocol server.

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.42.53e280afpm-1617x848.png)
*I created an Agent. I selected the Tools tab. I clicked the + Add a tool button*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.45.22e280afpm-1620x601.png)
*I selected Custom connector*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.45.52e280afpm-1619x413.png)
*I selected the Import from Github option*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.46.30e280afpm-1618x747.png)
*I selected the Custom radio button, I selected the dev branch, I selected the MCP-Streamable-HTTP Connector*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.47.14e280afpm-1618x891.png)
*I entered the server url https://business-central-mcp-new.thankfulsea-b533246e.eastus.azurecontainerapps.io/mcp*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.49.34e280afpm-1616x683.png)
*I refreshed the Model Context Protocol options*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.49.48e280afpm-1615x765.png)
*I clicked on the MCP Server Streamable HTTP option*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.49.58e280afpm-1619x788.png)
*I clicked the Create button*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.50.08e280afpm-1617x789.png)
*I clicked the Add and configure button*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.50.48e280afpm-1619x841.png)
*The get_vendors tool was displayed*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.51.42e280afpm-1618x861.png)
*I was directed to the Create or pick a connection form. I clicked the Submit button*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.51.52e280afpm-1619x378.png)
*The status if MCP-Streamable-HTTP was updated to Connected*

![](/assets/images/mcpserver2/screenshot202025-08-2720at206.00.11e280afpm-1728x341.png)
*I had entered this prompt Please show me a table of vendors*

![](/assets/images/mcpserver2/screenshot202025-08-2720at205.52.48e280afpm-1729x924.png)
*Copilot Studio's Large Language Model used the get_vendors tool to establish the context.*

Open LM Studio and navigate to the "Program" tab in the right sidebar.
Click on "Install" and select "Edit mcp.json". This opens the mcp.json file in LM Studio's in-app editor.
Add your MCP server configuration to the mcp.json file.

![](/assets/images/mcpserver2/screenshot202025-08-2820at202.32.16e280afpm-2136x593.png)
*I selected Chats in the left hand menu. I clicked the show settings button at the top right of the LM Studio application. I added the business central mcp server using the url https://business-central-mcp-new.thankfulsea-b533246e.eastus.azurecontainerapps.io/mcp. I enabled the mcp server connection.*

![](/assets/images/mcpserver2/screenshot202025-08-2820at202.18.21e280afpm-2136x1245.png)
*I entered the prompt show me a table of vendor details*


## main.ts

```text
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import { z } from "zod";

const server = new McpServer({
    name: "Business Central MCP Server",
    version: "1.0.0"
});

server.tool(
    'hello',
    'A simple hello world tool',
    {
        name: z.string().describe("The name to greet")
    },
    async ({ name }) => {
        return {
            content: [
                {
                    type: "text",
                    text: `Hello, ${name}!`
                }
            ]
        }
    }
);

const transport = new StdioServerTransport();
server.connect(transport);
```

## package.json

```text
{
    "name": "business-central-mcp",
    "version": "1.0.0",
    "main": "index.js",
    "scripts": {
        "test": "echo \"Error: no test specified\" && exit 1"
    },
    "keywords": [],
    "author": "",
    "license": "ISC",
    "description": "",
    "type": "module",
    "dependencies": {
        "@modelcontextprotocol/sdk": "^1.17.3",
        "zod": "^3.25.76"
    }
}
```

## srcmain.ts

```text
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import { z } from "zod";
import { ensureAuthenticated, makeApiCall } from "./business-central-auth.js";

import { configDotenv } from "dotenv";
configDotenv();

const server = new McpServer({
    name: "Business Central MCP Server",
    version: "1.0.0"
});


server.tool(
  'get_vendors',
  'Retrieves vendor list from Business Central',
  {
    filter: z.string().optional().describe('OData filter for vendors'),
    top: z.number().optional().describe('Maximum number of results')
  },
  async ({ filter, top = 100 }) => {
    await ensureAuthenticated();

    const params: any = {
      $top: top
    };
    
    if (filter) {
      params.$filter = filter;
    }

    const result = await makeApiCall('vendors', params);
    
    return {
      content: [
        {
          type: "text",
          text: JSON.stringify({
            success: true,
            data: result.value || [],
            count: result.value?.length || 0
          }, null, 2)
        }
      ]
    };
  }
);


const transport = new StdioServerTransport();
server.connect(transport);
```

## srcbusiness-central-auth.ts

```text
import axios from 'axios';
import qs from 'querystring';

// Configuration interface
interface BusinessCentralConfig {
  tenantId: string;
  clientId: string;
  clientSecret: string;
  baseUrl: string;
  environment: string;
  companyId: string;
}

// Token storage
let accessToken: string | null = null;
let tokenExpiry: Date | null = null;

// Get configuration from environment variables
function getConfig(): BusinessCentralConfig {
  return {
    tenantId: process.env.BC_TENANT_ID || '',
    clientId: process.env.BC_CLIENT_ID || '',
    clientSecret: process.env.BC_CLIENT_SECRET || '',
    baseUrl: process.env.BC_BASE_URL || '',
    environment: process.env.BC_ENVIRONMENT || 'Sandbox',
    companyId: process.env.BC_COMPANY_ID || ''
  };
}

// Authenticate with Business Central
export async function ensureAuthenticated(): Promise<void> {
  if (accessToken && tokenExpiry && new Date() < tokenExpiry) {
    return;
  }

  const config = getConfig();
  
  try {
    const tokenUrl = `https://login.microsoftonline.com/${config.tenantId}/oauth2/v2.0/token`;
    
    const tokenData = {
      grant_type: 'client_credentials',
      client_id: config.clientId,
      client_secret: config.clientSecret,
      scope: 'https://api.businesscentral.dynamics.com/.default'
    };

    const response = await axios.post(tokenUrl, qs.stringify(tokenData), {
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    });

    accessToken = response.data.access_token;
    tokenExpiry = new Date(Date.now() + (response.data.expires_in * 1000));
    
  } catch (error: any) {
    throw new Error(`Authentication failed: ${error.response?.data?.error_description || error.message}`);
  }
}

// Make API call to Business Central
export async function makeApiCall(endpoint: string, params: any = {}): Promise<any> {
  const config = getConfig();
  const url = `${config.baseUrl}/${config.environment}/api/v2.0/companies(${config.companyId})/${endpoint}`;
  
  if (!accessToken) {
    throw new Error('Not authenticated. Call ensureAuthenticated first.');
  }
  
  try {
    const response = await axios.get(url, {
      headers: {
        'Authorization': `Bearer ${accessToken}`,
        'Accept': 'application/json'
      },
      params
    });
    
    return response.data;
  } catch (error: any) {
    throw new Error(`API call failed: ${error.response?.data?.error?.message || error.message}`);
  }
}

// Clear authentication (useful for testing or re-authentication)
export function clearAuthentication(): void {
  accessToken = null;
  tokenExpiry = null;
}
```

## package.json

```text
{
    "name": "business-central-mcp",
    "version": "1.0.0",
    "main": "index.js",
    "scripts": {
        "build": "tsc --outDir dist",
        "start": "node ./dist/main.js",
        "dev": "tsx main.ts"
    },
    "keywords": [],
    "author": "",
    "license": "ISC",
    "description": "",
    "type": "module",
    "dependencies": {
        "@modelcontextprotocol/sdk": "^1.17.3",
        "axios": "^1.11.0",
        "dotenv": "^17.2.1",
        "zod": "^3.25.76"
    },
    "devDependencies": {
        "@types/node": "^24.3.0",
        "@typescript-eslint/eslint-plugin": "^8.41.0",
        "@typescript-eslint/parser": "^8.41.0",
        "tsx": "^4.20.5",
        "typescript": "^5.9.2"
    }
}
```

## tsconfig.json

```text
{
  // Visit https://aka.ms/tsconfig to read more about this file
  "compilerOptions": {
    // File Layout
    // "rootDir": "./src",
    // "outDir": "./dist",

    // Environment Settings
    // See also https://aka.ms/tsconfig/module
    "module": "nodenext",
    "target": "esnext",
    "types": [],
    // For nodejs:
    // "lib": ["esnext"],
    // "types": ["node"],
    // and npm install -D @types/node

    // Other Outputs
    "sourceMap": true,
    "declaration": true,
    "declarationMap": true,

    // Stricter Typechecking Options
    "noUncheckedIndexedAccess": true,
    "exactOptionalPropertyTypes": true,

    // Style Options
    // "noImplicitReturns": true,
    // "noImplicitOverride": true,
    // "noUnusedLocals": true,
    // "noUnusedParameters": true,
    // "noFallthroughCasesInSwitch": true,
    // "noPropertyAccessFromIndexSignature": true,

    // Recommended Options
    "strict": true,
    "jsx": "react-jsx",
    "verbatimModuleSyntax": true,
    "isolatedModules": true,
    "noUncheckedSideEffectImports": true,
    "moduleDetection": "force",
    "skipLibCheck": true,
  }
}
```

## .env

```text
# Configurazione Business Central OAuth 2.0
BC_TENANT_ID=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
BC_CLIENT_ID=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
BC_CLIENT_SECRET=XXXXX~XX-XXXXXXXXXXXXXXXXXXXXXXXXXX.XXXX

# Business Central API base URL
BC_BASE_URL=https://api.businesscentral.dynamics.com/v2.0/XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX

# Business Central Company ID
BC_COMPANY_ID=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX

# Sandbox or Production?
BC_ENVIRONMENT=Production
```

## srcmain.ts

```text
import express from "express";
import { randomUUID } from "node:crypto";
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StreamableHTTPServerTransport } from "@modelcontextprotocol/sdk/server/streamableHttp.js";
import { isInitializeRequest } from "@modelcontextprotocol/sdk/types.js"
import { ensureAuthenticated, makeApiCall } from "./business-central-auth.js";
import { z } from "zod";

const app = express();
app.use(express.json());

// Map to store transports by session ID
const transports: { [sessionId: string]: StreamableHTTPServerTransport } = {};

// Handle POST requests for client-to-server communication
app.post('/mcp', async (req, res) => {
  // Check for existing session ID
  const sessionId = req.headers['mcp-session-id'] as string | undefined;
  let transport: StreamableHTTPServerTransport;

  if (sessionId && transports[sessionId]) {
    // Reuse existing transport
    transport = transports[sessionId];
  } else if (!sessionId && isInitializeRequest(req.body)) {
    // New initialization request
    transport = new StreamableHTTPServerTransport({
      sessionIdGenerator: () => randomUUID(),
      onsessioninitialized: (sessionId) => {
        // Store the transport by session ID
        transports[sessionId] = transport;
      },
      // DNS rebinding protection is disabled by default for backwards compatibility. If you are running this server
      // locally, make sure to set:
      // enableDnsRebindingProtection: true,
      // allowedHosts: ['127.0.0.1'],
    });

    // Clean up transport when closed
    transport.onclose = () => {
      if (transport.sessionId) {
        delete transports[transport.sessionId];
      }
    };
    const server = new McpServer({
      name: "example-server",
      version: "1.0.0"
    });

    // ... set up server resources, tools, and prompts ...

    server.tool(
      'get_vendors',
      'Retrieves vendor list from Business Central',
      {
        filter: z.string().optional().describe('OData filter for vendors'),
        top: z.number().optional().describe('Maximum number of results')
      },
      async ({ filter, top = 100 }) => {
        await ensureAuthenticated();
        const params: any = { $top: top };
        if (filter) params.$filter = filter;

        const result = await makeApiCall('vendors', params);
        return {
          content: [{
            type: "text",
            text: JSON.stringify({
              success: true,
              data: result.value || [],
              count: result.value?.length || 0
            }, null, 2)
          }]
        };
      }
    );

    // Connect to the MCP server
    await server.connect(transport);
  } else {
    // Invalid request
    res.status(400).json({
      jsonrpc: '2.0',
      error: {
        code: -32000,
        message: 'Bad Request: No valid session ID provided',
      },
      id: null,
    });
    return;
  }

  // Handle the request
  await transport.handleRequest(req, res, req.body);
});

// Reusable handler for GET and DELETE requests
const handleSessionRequest = async (req: express.Request, res: express.Response) => {
  const sessionId = req.headers['mcp-session-id'] as string | undefined;
  if (!sessionId || !transports[sessionId]) {
    res.status(400).send('Invalid or missing session ID');
    return;
  }

  const transport = transports[sessionId];
  await transport.handleRequest(req, res);
};

// Handle GET requests for server-to-client notifications via SSE
app.get('/mcp', handleSessionRequest);

// Handle DELETE requests for session termination
app.delete('/mcp', handleSessionRequest);

app.listen(3000);
```

## package.json

```text
{
    "name": "business-central-mcp",
    "version": "1.0.0",
    "main": "index.js",
    "scripts": {
        "build": "tsc --outDir dist",
        "start": "TRANSPORT=http node ./dist/main.js",
        "dev:stdio": "tsx ./src/main.ts",
        "dev:http": "TRANSPORT=http tsx ./src/main.ts",
        "docker:build": "docker build -t business-central-mcp .",
        "docker:run": "docker run -p 3000:3000 --env-file .env business-central-mcp"
    },
    "keywords": [],
    "author": "",
    "license": "ISC",
    "description": "",
    "type": "module",
    "dependencies": {
        "@modelcontextprotocol/sdk": "^1.17.3",
        "axios": "^1.11.0",
        "cors": "^2.8.5",
        "dotenv": "^17.2.1",
        "express": "^5.1.0",
        "zod": "^3.25.76"
    },
    "devDependencies": {
        "@types/cors": "^2.8.19",
        "@types/express": "^5.0.3",
        "@types/node": "^24.3.0",
        "@typescript-eslint/eslint-plugin": "^8.41.0",
        "@typescript-eslint/parser": "^8.41.0",
        "tsx": "^4.20.5",
        "typescript": "^5.9.2"
    }
}
```

## dockerfile

```text
FROM node:20-alpine
WORKDIR /app

# Install dependencies
COPY package*.json ./
RUN npm ci --only=production

# Copy source code
COPY . .

# Expose port
EXPOSE 3000

# Set environment variables
ENV TRANSPORT=http
ENV PORT=3000

# Start the server
CMD ["npm", "start"]
```

## docker-compose.yml

```text
services:
  business-central-mcp:
    build: .
    ports:
      - "3000:3000"
    environment:
      - TRANSPORT=http
      - PORT=3000
      # Add your Business Central environment variables here
      - BC_TENANT_ID=${BC_TENANT_ID}
      - BC_CLIENT_ID=${BC_CLIENT_ID}
      - BC_CLIENT_SECRET=${BC_CLIENT_SECRET}
      - BC_BASE_URL=${BC_BASE_URL}
      - BC_COMPANY_ID=${BC_COMPANY_ID}
      - BC_ENVIRONMENT=${BC_ENVIRONMENT}
    restart: unless-stopped
```
## References

- [Talk to Your Data: Build an MCP local Server in JavaScript (Node.js) that Understands Business Central](https://danieleincalza.blogspot.com/2025/07/talk-to-your-data-build-mcp-local.html?fbclid=IwZXh0bgNhZW0CMTEAAR6ieJAE0Jk-FhoJQxOcwj7yS9iaYnf7iBIpmzQFTi_bjspiOwed4cTkZ7AfKg_aem__GvqVa0pGPLHMYsfhixUdw)
- [How to add MCP Model Context Protocol to Copilot Studio via Custom Connector](https://www.youtube.com/watch?v=qjMBkk0R_7s&t=292s)

---

## microsoftdynamics365appforoutlook

**Source file:** `microsoftdynamics365appforoutlook.md`

---
title: "Microsoft Dynamics 365 App for Outlook"
description: "References"
date: "2025-09-20"
categories: ["Microsoft Dynamics","Power Platform"]
tags: []
image: "/assets/images/microsoftdynamics365appforoutlook/office-365-icon-500x500.png"
slug: "microsoftdynamics365appforoutlook"
hidden: true
---




**Microsoft Dynamics 365 App for Outlook** connects a Dataverse Model Driven app to Outlook.

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.04.36pm-2136x1234.png)
*I reviewed Outlook*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.04.59pm-2136x1234.png)
*I created a new Power Platform Environment*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.05.33pm-2136x1237.png)
*I entered a unique url https://darkblueduck.crm.dynamics.com*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.05.50pm-2136x1239.png)
*Preparing...*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.07.17pm-2136x1112.png)
*Ready*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.07.34pm-2136x1241.png)
*I navigated using the Settings | Mailboxes link*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.08.19pm-2136x1184.png)
*I clicked Close*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.08.58pm-2136x612.png)
*I clicked APPROVE EMAIL*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.09.06pm-2136x853.png)
*I clicked OK*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.09.22pm-2136x600.png)
*I clicked TEST & ENABLE MAILBOXES*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.09.30pm-2136x895.png)
*I clicked OK*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.12.04pm-2136x757.png)
*In progress (takes a long time)*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.42.25pm-2136x641.png)
*Success*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.42.48pm-2136x1100.png)
*Notification*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.44.58pm-2136x1160.png)
*I created a "Customer Relationship Management" solution*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.45.56pm-2136x1094.png)
*I added the existing Account and Contact tables*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.46.20pm-2136x1099.png)
*I reviewed the Contact table's Main form*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.47.00pm-2136x1099.png)
*The Main form included a Timeline control*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.47.22pm-2136x683.png)
*I created a new Model-driven app*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.47.39pm-2136x881.png)
*I named the app Sales*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.48.42pm-2136x1104.png)
*I added the Account and Contact tables*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.48.54pm-2136x1094.png)
*I clicked the Play button*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.49.50pm-2136x1100.png)
*I created a new Contact (using my personal email address)*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.50.15pm-2136x1099.png)
*I used the Timeline control to create an Email*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.55.35pm-2136x1100.png)
*I clicked Send*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.55.49pm-2136x1100.png)
*The email was added to the Dataverse mailbox*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.56.11pm-2136x1097.png)
*The email was sent by support@darkblueduck.com*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.58.01pm-1194x1260.png)
*I composed a response*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.58.48pm-2136x1100.png)
*The response was received and marked as "Tracked To Dynamics"*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-2.59.10pm-2136x1101.png)
*The response was displayed in the Timeline*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.05.55pm-2136x465.png)
*I reviewed the Dynamics 365 apps associated with the Envrionment*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.06.27pm-2136x1099.png)
*I clicked the Open AppSource button*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.07.11pm-2136x1154.png)
*I located the Microsoft Dynamics 365 App for Outlook app and clicked the Get it now button*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.07.20pm-2136x1099.png)
*I clicked the Get it now button*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.07.42pm-2136x1093.png)
*I selected the Develop Environment*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.08.04pm-2136x1097.png)
*Installing*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.10.43pm-2136x1097.png)
*I clicked the Settings | Resources | Dynamics 365 App for Outlook link*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.11.15pm-2136x1165.png)
*I reviewed the requirements*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.11.49pm-2136x1093.png)
*I navigated to the Settings | Users page, selected the account and clicked the Manage roles link*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.12.06pm-2136x1099.png)
*I selected the Dynamics 365 App for Outlook User role and clicked Save*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.12.17pm-2136x1096.png)
*The Dynamics 365 App for Outlook User role was added to the account*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.12.31pm-2136x1171.png)
*I selected the account and clicked ADD APP TO OUTLOOK*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.12.45pm-2136x1164.png)
*pending*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.15.30pm-2136x1164.png)
*Added to Outlook*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.16.12pm-2136x1100.png)
*I checked that the Dynamics 365 App for Outlook was added*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-3.25.26pm-2136x1099.png)
*I selected the notification email and clicked the Dynamics 365 app*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.39.12pm-2136x1167.png)
*I could select a Dataverse Account or a Contact*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.25.28pm-2136x1094.png)
*I added an Opportunity table to the Customer Relationship Management solution*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.26.26pm-2136x1091.png)
*I updated the Name column to be an automatically generated value*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.27.45pm-2136x1090.png)
*I added an estimated close date column*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.28.30pm-2136x1097.png)
*I added an estimated revenue column*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.29.26pm-2136x1096.png)
*I added a Contact table lookup column*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.29.57pm-2136x1099.png)
*I added an Account table lookup column*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.30.35pm-2136x1100.png)
*I checked the "Creating a new activity" option*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.31.22pm-2136x1096.png)
*I added the existing Dynamics 365 App for Outlook app*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.40.16pm-2136x1099.png)
*I ignored the error*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.40.30pm-2136x1097.png)
*I added a Dataverse table page*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.40.58pm-2136x1099.png)
*I added the Opportunity table (no need to show in navigation)*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.41.24pm-2136x1097.png)
*The Opportunity page was created*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.45.11pm-2136x1097.png)
*I clicked on the notification email again. Now 3 types of records.*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.45.23pm-2136x1091.png)
*I selected Opportunities*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.45.49pm-2136x1094.png)
*I was able to select the new opportunity*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.48.38pm-2136x1093.png)
*I updated the Opportunity Quick View Form*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.47.28pm-2136x1096.png)
*I removed the Name and added Est. Close Date... fields*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-4.51.26pm-2136x1099.png)
*Clicking on the Tracked email displays the Quick View form contents*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-5.28.07pm-2136x1097.png)
*The email was displayed in the Related Activities tab*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-5.29.45pm-2136x1094.png)
*I added a Timeline control to the Opportunities Main form*

![](/assets/images/microsoftdynamics365appforoutlook/screenshot-2024-06-29-at-5.30.54pm-2136x1100.png)
*The related email was displayed*

![](/assets/images/microsoftdynamics365appforoutlook/449040931-1700129710754304-1985864385832439929-n-1242x2688.jpg)
*Sales app running on a mobile phone*

- [Working with the Dynamics 365 App for Outlook](https://www.youtube.com/watch?v=gqX5aJMDHf8) - YouTube tutorial on using the Dynamics 365 App for Outlook
- [Microsoft Dynamics 365 App for Outlook Introduction](https://commons.wikimedia.org/wiki/File:Microsoft_Dynamics_365_App_for_Outlook_Introduction.webm) - Introduction video from Wikimedia Commons

---

## microsoftgraph

**Source file:** `microsoftgraph.md`

---
title: "Microsoft Graph"
description: "Graph Explorer"
date: "2022-05-26"
categories: ["Microsoft 365","Microsoft Dynamics"]
tags: []
slug: "microsoftgraph"
image: "/assets/images/office-365-icon-500x500.png"
---



[Microsoft Graph](https://docs.microsoft.com/en-us/graph/overview) is a REST API that can be used to access: Microsoft 365, Azure Active Directory, Windows and Dynamics 365.

[Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer) is a developer tool that allows a developer to make Microsoft Graph REST API requests and view corresponding responses.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.26.35-am-1235x617.png)
*Here I am using the Graph Explorer without signing in to my Active Directory account (using a sample account)*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.29.31-am-485x209.png)
*Here I am signing into my Microsoft 365 E5 developer subscription pre-provisioned with Microsoft 365 apps*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.29.46-am-485x189.png)
*Here I am entering my password*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.30.14-am-484x195.png)
*I am required to approve the sign in request using my mobile phone (two factor authentication)*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.30.49-am-1234x619.png)
*I can retrieve my profile details using a "/me/" request. GET my profile - https://graph.microsoft.com/v1.0/me/*


## Graph Explorer permissions

Before the Graph Explorer is able to retrieve email messages using Microsoft Graph the user (or an administrator) has to provide consent. The user is agreeing that the client application (Graph Explorer in this case) can access parts of the Microsoft Graph on their behalf.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.31.38-am-1234x618.png)
*access denied - https://graph.microsoft.com/v1.0/me/messages*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.33.13-am-1400x657.png)
*Here the administrator grants this application (Graph Explorer) permission to access a user's email messages (on that user's behalf).*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.33.49-am-1400x655.png)
*GET my mail - https://graph.microsoft.com/v1.0/me/messages*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.34.16-am-1401x656.png)
*A second consent is needed to allow this application (Graph Explorer) to access a user's One drive and SharePoint online files (on that user's behalf) - https://graph.microsoft.com/v1.0/me/drive/root/children*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.36.19-am-1401x657.png)
*Here the administrator grants this application (Graph Explorer) permission to access the user's (One drive and SharePoint online) files*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-6.18.08-pm-1401x792.png)
*GET all the items in my (one) drive (root folder) - https://graph.microsoft.com/v1.0/me/drive/root/children*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.40.21-am-1401x656.png)
*At this time there were no files in my one drive's root folder*


## Teams/SharePoint Online/One Drive files

Microsoft Teams channels include a "Files" tab.

Files uploaded to the Team's channel are stored in SharePoint Online.

All files uploaded to all public channels are stored in a shared Document Library in a Team specific SharePoint Online Site (Site Collection).

This SharePoint online Document Library can also be accessed using the One Drive application.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.04.41-am-1399x654.png)
*The Mark 8 Project Team's Team includes a General and a Design channel.*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.05.14-am-1398x653.png)
*The Design channel's files can be accessed without leaving the Teams application. The Design channel's files can also be accessed using the SharePoint user interface (using the "Open in SharePoint" menu item)*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.05.42-am-1400x578.png)
*In the SharePoint user interface it is clear that the Design channel's files are stored a the "Design" Folder in the shared "Documents" Document Library in the "Mark 8 Project Team" SharePoint site*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.06.40-am-1400x574.png)
*The "Documents" Document Library in the "Mark 8 Project Team" site can also be accessed using the One Drive user interface.*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-6.52.10-pm-1398x792.png)
*The One Drive user interface can be used to show that there is a second "Confidential" Document Library in the "Mark 8 Project Team" Site.*


## Using Microsoft Graph to access Teams/SharePoint Online/One Drive files

Graph explorer can be used to access [Teams/SharePoint Online/One Drive files](https://docs.microsoft.com/en-us/graph/api/driveitem-list-children?view=graph-rest-1.0&tabs=http)

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.20.13-am-1399x618.png)
*GET SharePoint site based on relative path to (the "Mark8Project") site - https://graph.microsoft.com/v1.0/sites/{host-name}:/{server-relative-path} - https://graph.microsoft.com/v1.0/sites/p8lf.sharepoint.com:/sites/Mark8ProjectTeam*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.22.54-am-1397x617.png)
*GET enumerate the document libraries under the (the "Mark8Project") site - https://graph.microsoft.com/v1.0/sites/{siteid}/drives - https://graph.microsoft.com/v1.0/sites/p8lf.sharepoint.com,93621faf-8562-41e0-ac8c-13117ad3494a,c62f05b5-b3b9-45af-9935-0d5adca1a908/drives*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.31.55-am-1401x618.png)
*GET all the items in specified drive - https://graph.microsoft.com/v1.0/drives/{driveid}/root/children -https://graph.microsoft.com/v1.0/drives/b!rx9ik2KF4EGsjBMRetNJSrUFL8a5s69FmTUNWtyhqQioATjXxIu7Q6WHB3PuAtBi/root/children*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-7.47.54-pm-1397x793.png)
*GET all the items in specified folder in the specified drive - https://graph.microsoft.com/v1.0/drives/{driveid}/items/{folderid}/childrenhttps://graph.microsoft.com/v1.0/drives/b!rx9ik2KF4EGsjBMRetNJSrUFL8a5s69FmTUNWtyhqQioATjXxIu7Q6WHB3PuAtBi/items/0165QRNMIDD63SJ6RBTFHZY2G4LDYN6K7M/children*


## Items trending around me

M365 is able to keep track of documents a user has recently accessed.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.14.25-am-1396x576.png)
*recently accessed*


## Items trending

Items trending around me can also be accessed using Microsoft Graph.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.15.34-am-1398x618.png)
*GET items trending around me - https://graph.microsoft.com/beta/me/insights/trending*


## Code snippets

Graph Explorer is also able to provide sample JavaScript code that could be used to access Microsoft Graph

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.39.30-am-1399x733.png)
*Sample JavaScipt code*

---

## modeldriven1

**Source file:** `modeldriven1.md`

---
title: "Model Driven Apps (Part 1)"
description: "Users"
date: "2023-09-18"
categories: ["Power Platform","DevOps","Microsoft 365"]
tags: []
slug: "modeldriven1"
image: "/assets/images/office-365-icon-500x500.png"
---



The illustration below shows p8lf's organization structure.

The individuals listed below will receive Dataverse security roles aligned with their duties.

![](/assets/images/modeldriven1/screenshot-2023-09-19-at-7.50.16-am-1586x1204.png)
*p8lf users*


## Environments

Power Apps environments are logical containers within the Microsoft Power Platform where you can build, test, and deploy apps, flows, and other solutions. These environments provide a structured way to manage and govern your Power Apps and Power Automate (formerly known as Microsoft Flow) resources. Here are some key aspects of Power Apps environments:

Isolation: Environments provide a way to isolate different projects, teams, or departments within your organization. Each environment has its own set of resources and settings, making it easier to manage and control access to data and solutions.

Security: Environments allow you to define security policies and permissions at the environment level. This means you can control who has access to the resources and data within a particular environment.
Development and Testing: Environments support the development and testing lifecycle of your Power Apps and Power Automate solutions. You can create a development environment for building and testing your applications before promoting them to a production environment.

Data Sources: You can connect environments to different data sources, such as SharePoint, SQL databases, or custom connectors. This allows you to access and manipulate data as needed for your apps and flows.

Deployment: Environments facilitate the deployment of solutions from one environment to another. You can move apps, flows, and other components from a development or test environment to a production environment when they are ready for use.

Governance: Environments help organizations enforce governance policies by separating environments for different purposes and controlling access to resources. This is crucial for maintaining data integrity and security.

Versioning: You can maintain different versions of apps and flows in separate environments. This allows you to keep track of changes and revert to previous versions if necessary.

Sandbox Environments: Power Apps also offer sandbox environments, which are ideal for testing and experimentation. They provide a safe space to try out new ideas without affecting production environments.

In summary, Power Apps environments are essential for managing and organizing your Power Platform resources effectively. They provide a structured approach to development, testing, deployment, and security, helping organizations make the most of the Power Apps and Power Automate capabilities while maintaining control and governance.

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.26.35-pm-1836x744.png)
*I created the Develop environment. The p8lf (default) environment was provided by Microsoft.*


## Solutions

In the context of Microsoft Power Platform, "Solutions" refer to containers or packages that allow you to group and manage related components such as apps, flows, custom connectors, and more. Solutions provide a way to organize, deploy, and package your Power Platform assets, making it easier to manage and transport them across different environments. Here are some key aspects of Power Platform Solutions:

Organizational Structure: Solutions help you organize your Power Platform assets logically. You can group components that belong to a specific project, department, or business process within a solution.

Version Control: Solutions support version control for your components. You can maintain multiple versions of a solution, allowing you to track changes, implement updates, and roll back to previous versions if needed.
Portability: Solutions make it easy to transport your apps, flows, and other components between different environments, such as from a development environment to a production environment. This simplifies the deployment process.

Dependency Management: Solutions automatically manage dependencies between components. When you include a component in a solution, it will also include any related components required for it to function properly.

Managed and Unmanaged Solutions: There are two types of solutions: managed and unmanaged. Managed solutions are typically used for distributing and protecting your intellectual property, as they prevent users from modifying the included components. Unmanaged solutions, on the other hand, allow users to make changes to components within the solution.

Security: Solutions allow you to specify security roles and permissions for the components within them. This ensures that only authorized users have access to specific parts of the solution.

Distribution: You can distribute solutions to other organizations or tenants, making it easier to share your applications and customizations with external parties or clients.

Export and Import: You can export solutions as package files (managed or unmanaged) and import them into other environments or instances of the Power Platform. This is particularly useful for promoting changes from development to testing and production environments.

Lifecycle Management: Solutions are a key component of the Power Platform's application lifecycle management (ALM) process, allowing you to define and manage the various stages of development, testing, and deployment.

Overall, Power Platform Solutions are essential for structuring, managing, and controlling your Power Platform assets, ensuring that you can efficiently develop, maintain, and distribute applications and customizations within your organization and across different environments.

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.43.15-pm-2136x586.png)
*Solutions in the Develop environment*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.37.13-pm-1836x998.png)
*Publishers in the Develop environment*


## Suggestions

As a demonstration I created a Suggestions model driven app.

The steps are shown below.

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.43.42-pm-1836x997.png)
*I created a Suggestions solution in the Develop environment*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.46.11-pm-1836x998.png)
*I added a Suggestion table to the Suggestions solution*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.47.44-pm-1836x996.png)
*I updated the type of the Name column from Single line of text to Autonumber*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.49.21-pm-1836x997.png)
*I added an Autonumber prefix (and updated Required to Optional)*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.51.34-pm-1836x996.png)
*I added a Suggested Details column*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.53.37-pm-1836x993.png)
*I updated the Active Suggestions view (I clicked the Save and publish button)*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.36.49-pm-1836x642.png)
*I updated the Main form (I clicked the Save and publish button)*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-6.58.41-pm-1836x998.png)
*I created a model driven app*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.00.19-pm-1836x996.png)
*I added a page to the model driven app*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.01.12-pm-1836x334.png)
*I clicked the Publish button*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.02.02-pm-1836x452.png)
*I clicked the Export solution button*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.03.54-pm-1836x1000.png)
*I clicked the Export button*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.04.40-pm-1836x245.png)
*I downloaded the solution*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.05.54-pm-1836x564.png)
*I switched to the p8lf (default) environment*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.07.34-pm-1836x372.png)
*I imported the managed solution*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.12.13-pm-1836x476.png)
*The suggestions solution was imported successfully*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.13.50-pm-1836x341.png)
*The Suggestion table was created*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.14.49-pm-1836x439.png)
*The Suggestions app was created*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.15.41-pm-1836x619.png)
*Clicking the Suggestions button on the navigation menu opened the Active Suggestions view*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.44.05-pm-1836x486.png)
*I created a new Suggestion and clicked Save & Close*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.44.17-pm-1836x520.png)
*I can see my suggestions*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.47.23-pm-1836x726.png)
*What can Isaiah see?*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-7.57.27-pm-1836x842.png)
*Logged into office.com as IsaiahL@p8lf.onmicrosoft.com*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.02.05-pm-1836x842.png)
*Isaiah is unable to run the Suggestions app*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.04.42-pm-1836x931.png)
*I checked what security roles were enabled for Isaiah*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.05.36-pm-1836x928.png)
*Basic User security role was enabled*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.05.46-pm-1836x925.png)
*Environment Maker security role was enabled*


## Environments and Solutions

The [Basic User](https://learn.microsoft.com/en-us/power-platform/admin/database-security) security role grants privileges to the core business tables, such as Account, Contact, and Activity. Basic Users can access out-of-the-box entities only. Basic Users can run an app in the environment and perform common tasks on the records they own.

An [Environment Maker](https://learn.microsoft.com/en-us/power-platform/admin/database-security) can create new resources associated with an environment, including apps, connections, custom APIs, gateways, and flows using Microsoft Power Automate. However, this role doesn't have any privileges to access data in an environment.

Neither of these security roles allowed Isaiah to access the Suggestions table (or to run the Suggestions app)

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.11.10-pm-1836x787.png)
*Isaiah is unable to access the Suggestions table (or to run the Suggestions app)*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.15.37-pm-1836x695.png)
*I returned to the Develop environment and added a Security role*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.22.13-pm-1836x339.png)

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.22.45-pm-1836x208.png)
*The quarter yellow circle shows that the permissions apply to the record owner.Suggestion table permissions (User)*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.26.15-pm-1836x740.png)
*I exported the updated solution*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.31.45-pm-1836x255.png)
*I imported the updated solution*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.34.49-pm-1836x612.png)
*I added Suggestions Maker role to user Isaiah*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.36.36-pm-1836x198.png)
*Security roles have been updated for Isaiah Langer*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.41.06-pm-1836x461.png)
*Isaiah added a Suggestion*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-8.41.16-pm-1836x410.png)
*Isaiah could only see his suggestion*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.22.05-pm-1836x422.png)
*Lidia can not see Isaiah's suggestion*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.22.45-pm-1836x494.png)
*Lidia added a suggestion*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.22.57-pm-1836x516.png)
*Lidia can only see her suggestion*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.37.04-pm-1836x426.png)
*Lynne can not see Lidia or Isaiah's suggestions*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.37.35-pm-1836x489.png)
*Lynne added a suggestion*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.37.46-pm-1836x497.png)
*Lynne can only see her suggestion*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.41.31-pm-1836x719.png)
*I can see all of the suggestions because I am an administrator*


## Business Units

Lee and Lidia are in the same Manufacturing Business Unit.

As Director of the Manufacturing we would like Lee to be able to read and manage all suggestions made by anyone in his Business Unit.

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.50.55-pm-2136x1004.png)
*I added a security role that will allow a user to manage Suggestions for their Business Unit*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.52.04-pm-2136x1002.png)
*The half yellow circle shows that the permissions apply to the business unit.Suggestion table permissions (Business Unit)*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.55.39-pm-1754x1258.png)
*I created a Sales & Marketing business unit*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.56.22-pm-1758x558.png)
*I created an Operations business unit*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.56.44-pm-1758x610.png)
*I created a Manufacturing business unit*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-10.05.25-pm-2136x996.png)
*The org6bf9e824 Business Unit is the parent of the Sales & Marketing, Manufacturing and Operations Business Units*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-9.57.19-pm-2136x423.png)
*I set the Business Unit for Adele Vance (and the other users)*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-10.00.23-pm-2136x359.png)
*I updated Lee Gu's security roles*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-10.06.14-pm-2136x1240.png)
*I added the Suggestions for Business Unit Security Role*

![](/assets/images/modeldriven1/screenshot-2023-09-18-at-10.11.03-pm-2136x588.png)
*Lee can see the Suggestion made by Lindia because Lee has the Suggestions For Business Role and Lindia and Lee are both in the Manufacturing Business Unit*

---

## modeldriven2

**Source file:** `modeldriven2.md`

---
title: "Model Driven Apps (Part 2)"
description: "Environments"
date: "2023-10-05"
categories: ["Power Platform","Microsoft Dynamics"]
tags: []
slug: "modeldriven2"
image: "/assets/images/office-365-icon-500x500.png"
---



Business process flows help people complete their tasks. They offer an interface that guides individuals through the steps defined.

I created a **Project** table and a four step business process flow.


The random urls assigned to Power Platform Environments can be updated.

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-7.58.33-am-2136x1321.png)
*I reset my Developer environment and updated the url to https://haddley-develop.crm.dynamics.com.*


## Published Apps

When I navigate to [https://haddley-develop.crm.dynamics.com](https://haddley-develop.crm.dynamics.com) I see a list of Published Apps.

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-8.54.54-am-2136x1083.png)
*Published Apps*


## Projects

I created a Project table with these columns:

Business Need (required)
Project Description (recommended)
Estimated Cost $
Program {Asset Management, Corp. Website, CRM, Highway Improvement, Inventory}
Actual Cost $; and
Project Closeout

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.36.30-am-2136x1078.png)
*I selected my Development environment*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.37.25-am-2136x998.png)
*I started to create a Project Solution*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.37.45-am-2136x998.png)
*I added a Publisher*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.38.00-am-2136x999.png)
*I provided my email address*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.38.14-am-2136x997.png)
*I selected the *new* publisher and clicked the Create button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.39.14-am-2136x999.png)
*I added a Table to the new solution*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.39.55-am-2136x997.png)
*I called my table Project*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.43.13-am-2136x998.png)
*I wanted to set a custom image for the new table*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.43.57-am-2136x1001.png)
*I downloaded an image (Project icons created by Freepik - Flaticon)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.44.40-am-2136x996.png)
*I clicked the "Creating a new activity" option - adding support for activities*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.46.46-am-2136x996.png)
*I updated the Primary name column to be an Autonumber column*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.47.13-am-2136x998.png)
*I set the Primary name column to be Optional, provided prefix "project", updated the number of digits to 6 and updated the seed value*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.45.34-am-2136x485.png)
*I clicked the + New column button to add a column to the Project table*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.47.46-am-2136x996.png)
*I added a Business Need column (required)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.51.02-am-2136x996.png)
*I added a Project Description column (recommended)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.51.45-am-2136x996.png)
*I added an Estimated Cost column (Currency $)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.53.47-am-2136x1000.png)
*I added a Program column (Choice)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.54.21-am-2136x999.png)
*I clicked the + New Choice button to create a global choice (set)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.57.19-am-2136x999.png)
*I entered the possible Program values*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.57.44-am-2136x997.png)
*I selected the *new* Program global choice (set)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.58.29-am-2136x998.png)
*I created an Actual Cost column (Currency $)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.59.04-am-2136x1000.png)
*I created a Project Closeout column (Text area)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.59.17-am-2136x999.png)
*I set the Project Closeout column's Maximum character count to 4000*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-11.59.47-am-2136x999.png)
*I updated the Project table's Main form*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.00.09-pm-2136x1001.png)
*I moved the Name and Owner columns to the Form Header*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.01.53-pm-2136x1001.png)
*I added the new columns to the General tab*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.02.26-pm-2136x1098.png)
*I added a Timeline control to display activity information (Meetings, Phone calls, etc. related to each Project)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.03.25-pm-2136x717.png)
*I created a new Model Driven App*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.03.38-pm-2136x923.png)
*I called the new app Projects*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.03.59-pm-2136x1023.png)
*I added a page to the app*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.04.25-pm-2136x1091.png)
*I selected the Project table*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.05.06-pm-2136x1096.png)
*I renamed the Group Label to Main*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.06.15-pm-2136x693.png)
*A Projects menu item has been added to the left hand navigation (using the custom icon)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.06.38-pm-2136x1053.png)
*I clicked the + New button to navigate to the form*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.07.06-pm-2136x1095.png)
*I created a Business process flow to provide some guidance to the user*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.07.52-pm-2136x1096.png)
*I called the new business process flow Project Flow*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.08.05-pm-2136x1095.png)
*A dialog was opened in the solution page*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.08.54-pm-2136x1056.png)
*The Business Process Flow editor was opened in another browser tab.I renamed the first step 01 - Initiation and clicked the Apply button.*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.09.18-pm-2136x1050.png)
*I updated the Data Step's Data Field (Column) to Business Need*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.11.11-pm-2136x1053.png)
*I clicked the Apply button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.11.34-pm-2136x1053.png)
*Notice that the Step Name was automatically updated to match the selected Data Field (Column)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.11.46-pm-2136x1049.png)
*I clicked the Add Data Step menu item to add a Data Step*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.11.59-pm-2136x1049.png)
*I clicked the plus button under the existing Business Need data step*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.12.36-pm-2136x1106.png)
*I selected the Project Description Data field (Column)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.12.48-pm-2136x1103.png)
*I clicked the Apply button. Notice that I did not click the Required option (yet)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.13.10-pm-2136x736.png)
*I clicked the Add Stage menu item*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.13.22-pm-2136x731.png)
*I clicked the plus button to the right of the existing stage*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.13.56-pm-2136x1101.png)
*I updated new stage's display name to 02 - Planning. I clicked the Apply button.*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.14.21-pm-2136x1104.png)
*I updated the provided Data Step to use the Estimated Cost Data Field (Column)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.14.35-pm-2136x1100.png)
*I clicked the Apply button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.14.50-pm-2136x786.png)
*The change was saved and the diagram was updated*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.15.06-pm-2136x883.png)
*I added another Data Step*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.15.31-pm-2136x1106.png)
*I set the Data Step to use the Program Data field (Column)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.15.43-pm-2136x1106.png)
*I did not check the Required box (yet). I clicked the Apply button to save the changes*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.16.06-pm-2136x649.png)
*I clicked the Add Stage menu item*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.16.29-pm-2136x738.png)
*I clicked the plus button to add a Stage*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.17.16-pm-2136x1105.png)
*I named the new stage 03 - Execution*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.17.35-pm-2136x861.png)
*I updated the existing Data Step to use the Actual Cost Data Field (Column)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.17.53-pm-2136x1099.png)
*I did not check the Required box (yet). I clicked the Apply button to save the changes*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.18.06-pm-2136x810.png)
*I clicked the Add Stage menu item*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.18.18-pm-2136x698.png)
*I clicked the plus button to add a Stage*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.18.39-pm-2136x1101.png)
*I named the new stage 04 - Close. I clicked the Apply button to save the changes*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.18.59-pm-2136x1103.png)
*I updated the existing Data Step to use the Project Closeout Data Field (Column)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.19.12-pm-2136x1100.png)
*I did not check the Required box. I clicked the Apply button to save the changes*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.19.36-pm-2136x248.png)
*I clicked the Activate menu item*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.19.49-pm-2136x778.png)
*I clicked the Activate button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.20.02-pm-2136x832.png)
*I reviewed the dialog and closed the browser tab*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.20.28-pm-2136x737.png)
*I used the + Add required objects menu item*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.20.56-pm-2136x804.png)
*The + Add required objects menu item added the Project Flow table (used by the Business Process Flow to keep track)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.21.25-pm-2136x265.png)
*I clicked the Publish all customizations button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.22.38-pm-2136x664.png)
*Clicked the Projects app to launch it*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.24.05-pm-2136x590.png)
*The app opened with url haddley-dev.crm.dynamics.com*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.24.24-pm-2136x735.png)
*Clicking in the business process flow I can see that Business Need and Project Descriptions are important to the first step.*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.25.29-pm-2136x794.png)
*I entered a Business Need value and clicked on the Business Process Flow again (notice the check mark)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.26.11-pm-2136x786.png)
*I entered a Project Description value and clicked Save to save the row (record)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.26.24-pm-2136x798.png)
*Once the record has been saved the Primary name is available and the Next Stage button is shown in the Business Process Process*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.27.28-pm-2136x896.png)
*I removed the Project Description value and clicked the Next Stage button.*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.28.23-pm-2136x778.png)
*I clicked the Next Stage button again*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.28.39-pm-2136x774.png)
*Then I clicked on the 02 - Planning Step and clicked the Set Active button to return the process to the 02 - Planning Step*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.29.31-pm-2136x1105.png)
*I updated the Business Process Flow setting Estimated Cost to Required*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.29.48-pm-2136x1108.png)
*I updated the Business Process Flow setting Program to Required*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.30.03-pm-2136x1111.png)
*I updated the Business Process Flow setting Actual Cost to Required*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.30.23-pm-2136x1106.png)
*I did not set Project Closeout to Required*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.30.35-pm-2136x271.png)
*I clicked the Update button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.32.14-pm-2136x1106.png)
*I returned to the project-100000 record and clicked the Next Stage button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.32.42-pm-2136x1102.png)
*I provided Estimated Cost and Program values and clicked the Next Stage button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.32.54-pm-2136x1104.png)
*I clicked the Next Stage button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.33.23-pm-2136x1104.png)
*I provided an Actual Cost value (in the business process flow box) and clicked the Next Stage button (again)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.33.37-pm-2136x1106.png)
*I did not click the Finish button (yet)*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.37.16-pm-2136x541.png)
*I added a new Contact Steak Holder*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.39.55-pm-2136x1108.png)
*I added a phone call activity to project-100000. The Timeline control displays details of the call.*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.40.10-pm-2136x1108.png)
*I clicked the Finish button*

![](/assets/images/modeldriven2/screenshot-2023-10-05-at-12.40.21-pm-2136x786.png)
*The Business Process Flow is complete*

---

## modeldriven3

**Source file:** `modeldriven3.md`

---
title: "Model Driven Apps (Part 3)"
description: "JavaScript to update a Business Process Flow Stage"
date: "2023-10-08"
categories: ["JavaScript","Power Platform","AI"]
tags: []
slug: "modeldriven3"
image: "/assets/images/office-365-icon-500x500.png"
---


JavaScript can be used to extend model driven apps.

It is possible to configure model driven apps to call a JavaScript function:

When a form has loaded (OnLoad)
When a user make a change to a control (OnChange)
When a user saves a record (OnSave); and
When a user clicks a button

The JavaScript function called might:

Validate user input
Show or Hide part of the form
Update a Business Process Flow
Display a Notification; or
Create a new Record

See also: [Power Apps Component Framework](componentFramework.html)


Xrm.Page.data.process.moveNext() and Xrm.Page.data.process.movePrevious() can be used to update a Business Process Flow Stage.

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-1.01.56-pm-2136x1053.png)
*const process = Xrm.Page.data.process*

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-1.02.31-pm-2136x1049.png)
*process.moveNext()*

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-1.03.50-pm-2136x1051.png)
*process.moveNext()*

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-1.09.42-pm-2136x1011.png)
*process.movePrevious()*


## JavaScript to Show or Hide a Tab

Xrm.Page.data.ui.tabs.get("<tab name>").setVisible(false) and Xrm.Page.data.ui.tabs.get("<tab name>").setVisible(true) can be used to hide or show a tab.

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-1.48.25-pm-2136x770.png)
*Xrm.Page.ui.tabs.get('{f3ca5bbd-8896-40c1-9cb2-bc5a744ac9f7}').setVisible(true)*

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-1.53.15-pm-2136x596.png)
*Xrm.Page.ui.tabs.get('{f3ca5bbd-8896-40c1-9cb2-bc5a744ac9f7}').setVisible(false)*


## JavaScript to Read and Update Field/Control/Attribute Values

Xrm.Page.getAttribute('nh_businessneed').getValue() and Xrm.Page.getAttribute('nh_businessneed').setValue('Hello') can be used to read or update a field/column/attribute value.

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-2.40.25-pm-2136x729.png)
*Xrm.Page.data.entity.attributes._collection to view attribute namesXrm.Page.getAttribute('nh_businessneed').getValue()*

![](/assets/images/modeldriven3/screenshot-2023-10-06-at-2.41.43-pm-2136x764.png)
*Xrm.Page.getAttribute('nh_businessneed').setValue('Hello')*


## JavaScript to clone a record

![](/assets/images/modeldriven3/screenshot-2023-10-08-at-7.39.02-pm-2136x647.png)
*Clone the current Project table record*


## Configuring a model driven app to call a JavaScript function

I added a Clone button to a model driven app's form command bar and used JavaScript to implement the record copying functionality

Notice that [in the Modern Command Designer](https://venkatasubbaraopolisetty.com/2022/12/31/back-to-basics-69-usage-of-parameters-from-modern-command-designer-in-dynamics-crm/) the execution context is not passed to a JavaScript handler function as a parameter.

![](/assets/images/modeldriven3/screenshot-2023-10-09-at-11.46.53-am-1471x582.png)
*This Clone function expects to be passed the primaryControl*

![](/assets/images/modeldriven3/screenshot-2023-10-09-at-11.48.07-am-1471x760.png)
*This JavaScript file is uploaded (and updated) as a Web resource*

![](/assets/images/modeldriven3/screenshot-2023-10-09-at-11.50.04-am-1471x569.png)
*After every update the Web resource should be published*

![](/assets/images/modeldriven3/screenshot-2023-10-09-at-11.50.42-am-1471x759.png)
*I added a Clone button*

![](/assets/images/modeldriven3/screenshot-2023-10-09-at-12.20.39-pm-2136x1079.png)
*I clicked the clone command and generated a new record*

---

## modeldriven4

**Source file:** `modeldriven4.md`

---
title: "Model Driven Apps (Part 4)"
description: "Power FX"
date: "2023-10-09"
categories: ["Power Platform"]
tags: []
slug: "modeldriven4"
image: "/assets/images/office-365-icon-500x500.png"
---


Power FX is a domain-specific programming language developed by Microsoft for creating custom expressions and formulas in various Microsoft products and services, primarily within the Power Platform ecosystem. The Power Platform includes tools like Power Apps, Power Automate (formerly known as Microsoft Flow), Power BI, and Power Virtual Agents. Power FX is designed to be a low-code language, which means it is designed to be user-friendly and accessible to people with limited programming experience.

Key features and characteristics of Power FX include:

Formula Language: Power FX is primarily a formula language used for creating expressions and calculations within the Power Platform applications. Users can write formulas to manipulate data, create custom business logic, and automate processes.

Excel-Like Syntax: Power FX has a syntax that is similar to Microsoft Excel formulas, making it familiar to users who are already comfortable with Excel.

Integration: Power FX is tightly integrated with various Microsoft products and services, allowing users to create custom logic and automation within their applications and workflows.

Low-Code: Power FX is designed to be accessible to users who may not have extensive programming experience. It aims to simplify the process of creating custom logic without the need for traditional coding skills.

Extensibility: Power FX can be extended with custom connectors and functions, enabling users to integrate with external systems and services.

Cross-Platform: While initially designed for the Power Platform, Microsoft has plans to make Power FX available in other products and services, further expanding its reach.

Power FX is intended to empower business users and citizen developers to create customized solutions and automate processes within the Microsoft ecosystem. It provides a way to add flexibility and automation to applications and workflows without the need for extensive software development.


## Clone a Record

I used Power FX to add a Clone button to my Project Model Driven App's Main Form Command Bar.

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.00.42-pm-2136x1080.png)
*I selected Projects view and selected the "Edit command bar" menu item*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.01.14-pm-2136x1010.png)
*I selected the Main form command bar*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.03.28-pm-2136x1013.png)
*I added a new command*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.05.32-pm-2136x1012.png)
*I named the command Clone, selected the Clone Icon and selected the Run formula action*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.10.41-pm-2136x1010.png)
*I selected the Show on condition from formula visibility option*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.11.08-pm-2136x1014.png)
*I only wanted the Clone command to be visible when the State...*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.11.33-pm-2136x1012.png)
*... was not FormMode.New*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.11.53-pm-2136x386.png)
*I clicked the Save and Publish button*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.12.58-pm-2136x711.png)
*The Clone command does not appear when the user is creating a new record*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.16.12-pm-2136x642.png)
*The Clone command appears when the user is viewing an existing record*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.19.13-pm-2136x879.png)
*I updated the Run formula action*


## Power FX

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.34.27-pm-2136x219.png)
*I clicked the Save and Publish button and the Play button*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.34.52-pm-2136x651.png)
*I opened an existing record and clicked the Clone button*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.35.05-pm-2136x787.png)
*The Power FX formula created a new record (using record defaults and the original record's Business Need value), navigated the user to the new record and displayed a "Project Item Copied" message.*

![](/assets/images/modeldriven4/screenshot-2023-10-08-at-12.50.47-pm-2136x892.png)
*The browser's developer tools shows the JavaScript generated from the Power FX formula*

---

## modeldrivenapps

**Source file:** `modeldrivenapps.md`

---
title: "Model Driven Apps"
description: "A Short History of Microsoft Dynamics and Microsoft Dataverse"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/modeldrivenapps/hero.png"
tags: ["cloud","dotnet","ai","ml","dynamics"]
hidden: true
slug: "modeldrivenapps"
---




## Microsoft to Acquire Great Plains Software Inc.

December 21, 2000 |

REDMOND, Wash., and FARGO, ND, Dec. 21, 2000 — Microsoft Corp. and Great Plains Software Inc. today announced plans to join forces in an acquisition designed to provide small and medium companies with the technology necessary to thrive in an increasingly interconnected economy. The acquisition, according to Microsoft, represents a major step in the company’s entry into the small and medium business applications market.
Drawing on Microsoft’s global scale and .NET platform technology and Great Plains’ expertise in business applications for small and medium companies, both corporations say they view this as an opportunity to help small and medium business be more efficient and agile by automating interconnected business processes, bridging the gap between on-premise software and next generation connected software and services. This is also an important part of Microsoft’s strategy to deliver the power of the .NET platform to small and medium companies. At the same time, Microsoft and Great Plains will create new opportunities for partners to grow their businesses by delivering and integrating next generation solutions that take advantage of the powerful .NET foundation for small and medium business applications that Microsoft and Great Plains will provide.
On the eve of the announcement, key strategists from both corporations — Group Vice President Jeff Raikes, of Microsoft’s Productivity and Business Services Group, and Great Plains’ CEO Doug Burgum — took a few moments to sit down with PressPass to discuss the intricacies of acquisition, the significance of the deal to small and medium companies and about the new opportunities this will create for existing Microsoft and Great Plains partners.


## Microsoft Acquire iCommunicate

In 2001 Microsoft acquired iCommunicate, which had 10 employees at the time. The developers behind iCommunicate.NET moved to Redmond and started developing a modern, web based CRM application together with Microsoft’s team. 

[https://jukkaniiranen.com/2013/09/history-of-microsoft-crm/](https://jukkaniiranen.com/2013/09/history-of-microsoft-crm/)

[http://www.ithell.com/Software/CRM_isn_t_a_bad_word/crm_isn_t_a_bad_word.html](http://www.ithell.com/Software/CRM_isn_t_a_bad_word/crm_isn_t_a_bad_word.html)


## Microsoft Announces New Customer Relationship Management Solution

**Microsoft Business Solutions Customer Relationship Management 1.0**

FARGO, N.D., Feb. 25, 2002 — Microsoft Corp. today announced it will deliver Microsoft® Customer Relationship Management (CRM), the first Microsoft business solution built on .NET, later this year. Accessible from Microsoft Outlook® and the Web, Microsoft Customer Relationship Management will enable small and medium sized businesses to build more profitable customer relationships through increased sales effectiveness and more consistent customer service. Microsoft Customer Relationship Management is designed for rapid deployment, ease of use, and integration with Microsoft Office and Microsoft Great Plains' back-office solutions, increasing information reliability, employee usage and productivity.

"Microsoft Customer Relationship Management fills a significant need for a single integrated view of customers that delivers on the promise of increasing customer satisfaction, customer loyalty and more profitable customer relationships," said Doug Burgum, senior vice president at Microsoft Corp. and president of Microsoft Great Plains Business Solutions. "Microsoft Customer Relationship Management represents a substantial business opportunity for our partners to deliver an entirely new category of integrated solutions specifically designed for the unique needs of our small and medium-sized customers."

Microsoft Customer Relationship Management will be available as a standalone product as well as an integrated solution to Microsoft Great Plains® Dynamics, Solomon and eEnterprise. Its expected availability in North America is in the fourth quarter of 2002. Availability outside of North America will be phased and is expected to begin in the first quarter of 2003. It will be sold and implemented through Microsoft Great Plains' reselling partner channel, and support will be provided by partners and Microsoft Great Plains' award-winning customer support team. The solution will be available on-premise or as a hosted solution through select partners.

"We're excited about Microsoft Customer Relationship Management and what it means for us and for customers," said Dan Taylor, president and CEO of ManagedOps.com Inc. "As a partner, it's a significant addition to our solution offerings, and customers can be assured of the commitment and service Microsoft Great Plains is known for."

[https://web.archive.org/web/20051013143714/http://www.microsoft.com/presspass/press/2002/feb02/02-26midmarketpr.mspx](https://web.archive.org/web/20051013143714/http://www.microsoft.com/presspass/press/2002/feb02/02-26midmarketpr.mspx)


## Microsoft Acquire Navision

Microsoft to Acquire Navision
May 7, 2002 |

COPENHAGEN, Denmark, May 7, 2002 — Microsoft Corp. today announced it has reached an agreement to acquire Navision, a global provider of integrated business software solutions. The acquisition will bring together the complementary geographic and product strengths of Navision with Microsoft Great Plains Business Solutions, enhancing Microsofts ability to deliver interconnected .NET business solutions for small and midmarket businesses.
The acquisition is structured as a stock and cash purchase based on an offer to shareholders of 300DKK per share. The total transaction value is estimated at approximately $1.3 billion (U.S.)/1.4 billion EUR/10.8 billion DKK.

[https://news.microsoft.com/2002/05/07/microsoft-to-acquire-navision/](https://news.microsoft.com/2002/05/07/microsoft-to-acquire-navision/)


## Microsoft CRM 1.0 was released in January 2003.

Microsoft Business Solutions Customer Relationship Management 1.0 was released in January 2003.

https://jukkaniiranen.com/2013/09/history-of-microsoft-crm/


## Project Green

The rationale for Project Green was that, in order to get the kind of deep and wide integration that increasingly defines all Microsoft software, the company had to write applications using its own programming languages, development tools, and APIs.

In 2003 Satya Nadella (then Microsoft Business Solutions division's corporate VP of product development) explained that Project Green was an effort involving about 40% of Business Solutions' 1,700 programmers.

[https://www.informationweek.com/software/microsoft-is-keen-on-green](https://www.informationweek.com/software/microsoft-is-keen-on-green)


## In September 2005 Project Green was renamed "Microsoft Dynamics"

In 2005 Project Green was renamed "Microsoft Dynamics"


## Microsoft Dynamics

'Project Green' Renamed Microsoft Dynamics
BY SCOTT BEKKER SEPTEMBER 07, 2005
The realignment of the Microsoft Business Solutions product set previously referred to as "Project Green" got its official name Wednesday -- Microsoft Dynamics.
The announcement came out of Microsoft's new Business Summit on the Redmond campus, where the company is focusing on the needs of medium-sized businesses, which the company defines as having 25 to 500 PCs.

In an executive e-mail sent early Wednesday, Microsoft CEO Steve Ballmer framed the problem by saying that in doing market research at midsize companies, Microsoft found that "today's business software doesn't look enough like today's businesses."

"We have designed the next generation of our business solutions, which we're calling Dynamics, around 50 of the most common roles in a midsize company. These solutions expose and connect the specific activities, processes and reports people need for real jobs inside a company, whether they're the president, the finance manager, the warehouse worker or the support clerk. And they'll have the familiar look and feel people know from using Microsoft Windows and Microsoft Office today," Ballmer wrote.

Microsoft will rebrand the core Microsoft Business Solutions products with the Dynamics name as new versions roll out next year. The grand plan is to roll four of the core products into one product in 2008, while offering Microsoft's CRM product both as part of the suite or separately.

In 2006 the product names will change from:

Microsoft CRM to Microsoft Dynamics CRM
Microsoft Business Solutions-Great Plains to Microsoft Dynamics GP
Microsoft Business Solutions-Axapta to Microsoft Dynamics AX
Microsoft Business Solutions-Navision to Microsoft Dynamics NAV
Microsoft Business Solutions-Solomon to Microsoft Dynamics SL.

The 2006 releases, called the wave 1 releases of Microsoft Dynamics, will include a more unified look and feel, contextual business intelligence, a greater emphasis on portals and increased integration with Web services.

Wave 2, in 2008, is supposed to deliver "best of" features and functionality of Axapta, Great Plains, Navision and Solomon. A separate version of Microsoft CRM that will be released in wave 2 will be available with or without the rest of Microsoft Dynamics.

To reduce the licensing uncertainty surrounding product consolidations, Microsoft is promoting a current licensing option called Transformational Assurance. "The Transitional Assurance benefit of the Enhancement Program is that when customers license Microsoft Business Solutions-Solomon, including the Standard editions, as well as Microsoft CRM, and stay current on the Microsoft Business Solutions Enhancement Program, they will be able to move to the future business application suite without having to reacquire the functionality they already license," Microsoft corporate vice president in the Microsoft Business Solutions Group Tami Reller said in a Q&A posted on Microsoft's site.

Microsoft Business Solutions is one of seven divisions at Microsoft. The company will continue to refer to the division by that name internally. Microsoft will also keep the current names for the division's other products: Microsoft Point of Sale, Microsoft Retail Management System, Microsoft FRx and Microsoft C5.

[https://rcpmag.com/articles/2005/09/07/project-green-renamed-microsoft-dynamics.aspx](https://rcpmag.com/articles/2005/09/07/project-green-renamed-microsoft-dynamics.aspx)


## In December of 2005, Microsoft released Microsoft Dynamics CRM 3.0

*So in December of 2005, Microsoft released Microsoft Dynamics CRM 3.0, the first to carry the Dynamics brand name. 3.0 was also the first release to include basic marketing including campaigns and static marketing lists. Professionally I had moved onto another Microsoft partner and was becoming interested in Dynamics CRM 3.0 as an application platform. I invested in this book and read it in a weekend. I still have a copy of this book about five feet from me, and while I haven’t opened the book in years it is a reminder of the early days of Dynamics CRM.

Dynamics 3.0 introduced the idea of XRM – CRM could be extended beyond simple contact and sales management. Instead, CRM 3.0 made customization simple but still not as simple as CRM today. While forms could be customized within the applications, Workflows were developed in an external Workflow manager that existed on the CRM server.*

[https://www.encloud9.com/blog/dynamics-crm-personal-history/](https://www.encloud9.com/blog/dynamics-crm-personal-history/)


## The xRM platform

In 2006, (Project Green) Microsoft Dynamics CRM 3.0 was released. 

 Microsoft Dynamics CRM 3.0 allowed the creation of custom entities. 

 Microsoft explained that the [xRM](https://learn.microsoft.com/en-us/dotnet/api/microsoft.xrm.sdk?view=dataverse-sdk-latest) platform that Microsoft Dynamics CRM 3.0 was built on could be used to many types of business application.

Here is description for the Microsoft Video:

One Platform.  Many Applications.  Infinite Possibilities.  

Introducing the xRM platform underlying Microsoft Dynamics CRM that allows organizations to rapidly develop many different unique line of business applications, ranging from the simple to the most complex.

[https://www.youtube.com/watch?v=Yru5CkANOKA&t=34s](https://www.youtube.com/watch?v=Yru5CkANOKA&t=34s)


## In October 2016 Microsoft announced the general availability of PowerApps and Common Data Service (1.0)

[https://powerapps.microsoft.com/en-us/blog/announcing-general-availability/](https://powerapps.microsoft.com/en-us/blog/announcing-general-availability/)

Announcing general availability of PowerApps
Headshot of article author Darshan Desai
Darshan Desai, Group Program Manager, PowerApps, Monday, October 31, 2016
 Facebook  Twitter  LinkedIn
We introduced the public preview of PowerApps in April 2016. In the six months since, over 124,000 users from 46,000 organizations in 143 countries have created web and mobile apps using PowerApps. We thank all of our preview users for their invaluable feedback, which has helped shape PowerApps into a better product.

Today, we are very happy to announce the general availability of PowerApps. PowerApps is ready for production use, across 6 regions and in 42 languages, with the 99.9% SLA customers expect from a Microsoft service.

In this release, we are pleased to announce a lot of new capabilities, and here are the key new features.

PowerApps Red heart SharePoint: fully integrated with SharePoint lists

In August, we started rolling out the preview of PowerApps integrated in SharePoint Online modern lists. You can create an app right from the command bar of a SharePoint Online custom list. That app then appears as a custom view of your SharePoint Online list, and users can access it both from the web as well as from the SharePoint Mobile app. This experience is now available to all SharePoint Online users. PowerApps also supports connecting to on-premises SharePoint lists for SharePoint 2013 and 2016 using the on-premises data gateway. Learn more about creating apps from SharePoint Online modern lists.

SPO-PowerApps

 

General availability of Common Data Service

With the general availability of PowerApps, Common Data Service is also now ready for global production use. Common Data Service is included as part of PowerApps plans and is the unifying backbone for your business data across PowerApps, Microsoft Flow, and pro-development tools. It provides an instantly available and scalable data store and a common data model with standard entity schema and behavior. It also provides a powerful data access layer with support for data import and export, security, and integration with Microsoft Office for Excel and Outlook. We’ll soon provide a software development kit (SDK) for professional development scenarios. We’ve incorporated lot of feedback from our preview users as well as from customers who are building business apps using Dynamics 365 and Office 365. You can learn more about the new features and the roadmap for Common Data Service in Arif’s blog post.

CDS-Overview


## In March 2018 Microsoft announces the general availability model-driven apps and Common Data Service (2.0)

[https://powerapps.microsoft.com/en-us/blog/introducing-model-driven-apps/](https://powerapps.microsoft.com/en-us/blog/introducing-model-driven-apps/)

Introducing model-driven apps – a new way to create
Headshot of article author Adrian Orth
Adrian Orth, Principal Program Manager, Wednesday, March 21, 2018

We are happy to announce the preview of the Model-Driven Apps within PowerApps.  PowerApps is the platform on which Dynamics 365 apps are natively built.  Model-driven apps provides a no-code or low-code component approach to app development. 

Model-driven apps run with the new Unified Interface client which provides a responsive accessible design running in browsers and on popular mobile devices.  This app type composes multiple component types including dashboards, forms, views, charts, and business processes which together form a great UI.  If you are familiar with the Dynamics 365 platform, you are already familiar with the PowerApps platform and Model-driven Apps.

Both model-driven and canvas apps allow you to easily build business apps.  They both share access to the Common Data Service providing standard and custom entities.  Canvas apps start with your user experience, crafting a highly tailored interface with the power of a blank canvas and connecting it to 200 data sources. Canvas apps can be built for web, mobile, and tablet applications. Model-driven apps start with your data model – building up from the shape of your core business data and processes in the Common Data Service to model forms, views, and other components. Model-driven apps automatically generate great UI that is responsive across devices.


## In July 2020 Microsoft announces the general availability of Dataverse

[https://powerapps.microsoft.com/fr-ca/blog/introducing-project-oakdale-a-new-low-code-data-platform-for-microsoft-teams/](https://powerapps.microsoft.com/fr-ca/blog/introducing-project-oakdale-a-new-low-code-data-platform-for-microsoft-teams/)

Introducing Dataverse, a new low-code data platform for Microsoft Teams
Headshot of article author Charles Lamanna
Charles Lamanna, CVP, Low Code Application Platform, Tuesday, July 21, 2020
 Facebook  Twitter  LinkedIn
The COVID-19 crisis has rapidly changed the way we live and work, and many organizations have shifted to remote work or are implementing a hybrid remote work approach as they reopen physical locations. To support this shift to hybrid remote work, we continue to improve the Microsoft Power Platform integration with Microsoft Teams to enable our customers to tailor Microsoft 365 to their needs and empower everyone to be a developer using low-code tools.

Today, we are excited to announce the release of Dataverse. Dataverse delivers a built-in low code data platform for Microsoft Teams, and provides relational data storage, rich data types, enterprise grade governance, and one-click solution deployment. Dataverse enables everyone to easily build and deploy apps and intelligent chatbots in Teams with Power Apps and Power Virtual Agents. Dataverse is built atop the Common Data Service, which reached general availability four years ago. Since that time, the Common Data Service added over 1,000 features and introduced support for Dynamics 365 and Power Apps.


## October 12, 2022 general availability of Managed Environments

[https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments](https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments)

Announcing the general availability of Managed Environments
Headshot of article author Ryan Cunningham
Ryan Cunningham, VP, Power Apps, Wednesday, October 12, 2022
 Facebook  Twitter  LinkedIn
We are pleased to announce the general availability of Managed Environments.

Enabling people with diverse technical and nontechnical skills to contribute to the development process through low-code tools has unlocked an explosion of apps. While low-code has accelerated companies’ abilities to innovate, it has also introduced new dimensions to scaling and managing your developer community.

For IT, the rapid growth of apps brings new challenges of managing, securing, and governing these decentralized technology stacks. With so many apps being created, we need to make sure they are secure and scalable. Figuring out the right way to balance governance without stifling innovation is not easy. That’s why we created Managed Environments—to make it easier than ever to govern low-code apps and ensure they’re safe for the entire organization. With just a few clicks, IT administrators can immediately light up features that give more visibility, more control, and require less effort to manage all of their low-code assets.

Dive deeper in our Managed Environments general availability announcement and learn how you can gain more visibility and control over your application ecosystem today.

[https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments/](https://powerapps.microsoft.com/en-us/blog/announcing-the-general-availability-of-managed-environments/)


---

## modeldrivenpurchaseorderlines

**Source file:** `modeldrivenpurchaseorderlines.md`

---
title: "Model Driven Purchase Order Lines"
description: "manage Business Central Purchase Order Lines"
date: "2024-03-03"
categories: ["Microsoft Dynamics","Business Central","Power Platform"]
tags: []
slug: "modeldrivenpurchaseorderlines"
image: "/assets/images/office-365-icon-500x500.png"
---


I created a Power Platform Model Driven application to manage Business Central Purchase Order Lines.

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.17.24-pm-1836x943.png)
*I set the General Section to 2 columns and moved the Quick View form into that section.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.18.11-pm-1836x885.png)
*I set the General Tab to be 1 column*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.19.33-pm-1836x890.png)
*I added a new section below the General Section*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.19.50-pm-1836x883.png)
*I added a Purchase Order Lines Subgrid to the New Section (with the Show related records checkbox selected).*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.21.22-pm-1836x889.png)
*I hid the Section and Subgrid labels*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.22.37-pm-1836x944.png)
*A row was added to the Subgrid for every Purchase Order Line.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.24.17-pm-1836x614.png)
*I navigated into the Business Central solution.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.25.23-pm-1836x949.png)
*I added the "All Purchase Order Lines" view to the solution*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.26.21-pm-1836x942.png)
*I added the Amount Excluding Tax column to the All Purchase Order Lines view.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.26.32-pm-1836x945.png)
*I clicked the Save & Publish button*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.27.04-pm-1836x945.png)
*I refreshed the Business Central app.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.30.45-pm-1836x769.png)
*I added all of the other available columns to the view. I clicked the Save & Publish button*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.31.37-pm-1836x945.png)
*I refreshed the Business Central app.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.32.08-pm-1836x944.png)
*I clicked the + New Purchase Order Line button*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.32.29-pm-1836x939.png)
*I clicked the Save button and the application generated an error.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.33.25-pm-1836x945.png)
*I navigated to the Business Central solution*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.33.46-pm-1836x945.png)
*I added the Purchase Order Line Main Information form to the solution*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.34.04-pm-1836x947.png)
*I clicked the Edit button*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.36.43-pm-1836x943.png)
*I added the Line Type and Description fields*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.37.25-pm-1836x628.png)
*I ran the Business Central app. I tried to add a purchase order line.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.37.40-pm-1836x526.png)
*I selected Line Type "Comment" and provided a Description*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.38.02-pm-1836x727.png)
*The application generated an error.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.38.34-pm-1836x940.png)
*I added the Document Id to the form*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.39.22-pm-1836x942.png)
*I clicked the + New Purchase Order Line button again*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.39.31-pm-1836x546.png)
*The Document Id was automatically populated*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.39.41-pm-1836x662.png)
*I selected Line Type Comment.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.39.55-pm-1836x600.png)
*I provided a Description and clicked the Save button. The record was saved and the Line Object No. field was updated (cleared)*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.40.44-pm-1836x866.png)
*The Purchase Order Line was shown in the Subgrid*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.41.24-pm-1836x940.png)
*When I selected the record the menu options changed.*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.44.25-pm-1836x557.png)
*I returned to the Business Central Configuration app and selected the Item table*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.44.36-pm-1836x657.png)
*I updated the Item table to Visible*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.48.17-pm-1836x940.png)
*I added the Item table to the Business Central solution*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.48.26-pm-1836x940.png)
*I clicked the Add button*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-03-at-3.14.00-pm-1836x709.png)
*I noticed that a Many-to-one relationship had been added to the Purchase Order Line table*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.49.38-pm-1836x945.png)
*I reviewed the records in the Business Central Item table*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.51.16-pm-1836x948.png)
*I added the Item Id column to the Purchase Order Line table's Main form*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.51.30-pm-1836x944.png)
*I clicked the Save and publish button*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.52.18-pm-1836x942.png)
*I clicked the + New Purchase Order Line button*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.52.30-pm-1836x943.png)
*I selected an Item*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.52.42-pm-1836x944.png)
*I set the Line Type value to Item*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.52.53-pm-1836x663.png)
*I clicked the Save button (notice that I did not enter a description)*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.53.08-pm-1836x713.png)
*Once the record had been saved a Line Object No. value was generated*

![](/assets/images/modeldrivenpurchaseorderlines/screenshot-2024-03-02-at-8.53.52-pm-1836x944.png)
*I clicked the back button to return to the Purchase Order form*

---

## modeldrivenpurchaseorders

**Source file:** `modeldrivenpurchaseorders.md`

---
title: "Model Driven Purchase Orders"
description: "Quick View"
date: "2024-03-02"
categories: ["Microsoft Dynamics","Business Central","Power Platform","AI"]
tags: []
slug: "modeldrivenpurchaseorders"
image: "/assets/images/office-365-icon-500x500.png"
---


I created a Power Platform Model Driven application to manage Business Central Purchase Orders.

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.16.37-pm-1836x827.png)
*I reset my Develop environment*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.17.39-pm-1836x819.png)
*I navigated to the Business Central Virtual Table app published on AppSource*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.18.12-pm-1836x821.png)
*I selected the Develop environment and clicked the Install button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.24.39-pm-1836x372.png)
*The Business Central Virtual Entity Dynamics 365 app was installed*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.25.57-pm-1836x771.png)
*I navigated to make.powerapps.com and ran the Business Central Configuration app*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.28.13-pm-1836x773.png)
*No tables were displayed*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.28.26-pm-1836x765.png)
*I navigated to the Configurations page and clicked on the Business Central item*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.29.49-pm-1836x820.png)
*I entered Production as the Environment name and Evaluation as the Default Company name*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.30.09-pm-1836x613.png)
*I clicked the Save & Close button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.40.38-pm-1836x641.png)
*I navigated to the Available Tables page and clicked on the purchaseOrder table*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.40.53-pm-1836x641.png)
*I updated the Visible value to Yes. I clicked the Save & Close button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.41.50-pm-1836x398.png)
*The purchaseOrder table was set to Visible*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.43.00-pm-1836x493.png)
*I navigated the the Power Apps Tables list and clicked on the Purchase Order Table*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.43.43-pm-1836x372.png)
*I clicked on the Relationships link and could see that there was a relationship between the Purchase Order table and the Company table*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.44.07-pm-1836x513.png)
*I returned to the Business Central Configuration app and selected the purchaseOrderLine table*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.44.20-pm-1836x628.png)
*I set the purchaseOrderTable to Visible. I clicked the Save & Close button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.45.10-pm-1836x447.png)
*The Visible property of the purchaseOrderLine table was updated*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.45.45-pm-1836x511.png)
*The purchaseOrderLine table was added to the Power Apps Tables list.*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.45.58-pm-1836x418.png)
*I reviewed the purchaseOrder table's Relationships. A Document Id relationship was shown between the purchaseOrder table and the purchaseOrderLine table*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.46.11-pm-1836x649.png)
*I returned to the Business Central Configuration app and selected the vendor table*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.46.24-pm-1836x644.png)
*I set the vendor to Visible. I clicked the Save & Close button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.47.16-pm-1836x619.png)
*The Visible property of the vendor table was updated*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.47.36-pm-1836x318.png)
*The vendor table was added to the Power Apps Tables list.*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.48.00-pm-1836x457.png)
*I reviewed the purchaseOrder table's Relationships. A Vendor Id relationship was shown between the purchaseOrder table and the vendor table*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.48.45-pm-1836x769.png)
*I created a new publisher*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.49.00-pm-1836x769.png)
*I created a new Business Central solution*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.49.19-pm-1836x639.png)
*A added a Model-driven app to the Business Central solution*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.49.43-pm-1836x658.png)
*I named the app Business Central*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.50.35-pm-1836x769.png)
*I added a page to the app*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.50.45-pm-1836x768.png)
*I selected the "Dataverse table" option and clicked the Next button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.51.09-pm-1836x774.png)
*I selected the Purchase Order table and checked the Show in navigation checkbox*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.51.56-pm-1836x774.png)
*The Model-driven app opened.*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.54.22-pm-1836x776.png)
*I clicked the Edit View link on the Purchase Orders view item*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.54.44-pm-1836x767.png)
*At this point the "All Purchase Orders" view Only included the Purchase Order number (No.) column*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.55.45-pm-1836x768.png)
*I added the Order Date, Status, Total Amount Excluding Tax and Total Amount Including Tax columns to the view*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.57.27-pm-1836x778.png)
*I ran the model driven app. The Purchase Orders tab was selected and a list of Business Central Purchase Orders were displayed. I clicked the + New button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.57.40-pm-1836x772.png)
*The New Purchase Order form was displayed. I clicked the Save button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.57.55-pm-1836x776.png)
*The model driven app displayed an error (because to create a Purchase Order I needed to at least provide a Vendor)*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.58.32-pm-1836x769.png)
*I clicked the Edit form link on the Purchase Orders form*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-2.58.58-pm-1836x773.png)
*I searched for the Vendor Id column.*


## Quick View

I configured the General tab to have [two columns](https://www.youtube.com/watch?v=LIC8DFW8fOE&t=5130s). I wanted to add a Quick View form to the right hand column. The Quick View form would allow a user to select a Vendor Id value on the left and to see corresponding Vendor details displayed on the right.

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.04.18-pm-1836x633.png)
*The Vendor Id column has been added to the Purchase Order form*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.08.35-pm-1836x481.png)
*I dragged the Purchase Order No. field into the header of the form (into the top right of the form)*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.17.50-pm-1836x632.png)
*I added the Order Date, Status, Total Amount Excluding Tax and Total Amount Including Tax columns into the General Section*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.18.06-pm-1836x632.png)
*I selected the General Tab and selected 2 columns*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.18.17-pm-1836x634.png)
*A new section "New Section" was added to the General Tab*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.18.56-pm-1836x632.png)
*I selected the Quick view component*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.19.19-pm-1836x631.png)
*I selected the Vendor Id Lookup and the Vendor Information Quick View form*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.19.43-pm-1836x628.png)
*I dragged the Quick View component to the right hand column (and hid the "New Section" label)*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.21.02-pm-1836x633.png)
*I added the Vendor Quick View form to the solution*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.21.17-pm-1836x629.png)
*I edited the Quick View form*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.22.30-pm-1836x627.png)
*I added the No. field*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.22.51-pm-1836x630.png)
*I added the Address Line 1 and Address Line 2 fields*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.23.06-pm-1836x636.png)
*I added the City field*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.23.23-pm-1836x633.png)
*I added the State field*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.23.34-pm-1836x633.png)
*I added the Zip Code field*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.23.44-pm-1836x632.png)
*I clicked Save & Publish*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.26.11-pm-1836x630.png)
*I ran the Business Central app. I clicked the + New button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.28.17-pm-1836x632.png)
*I selected a Vendor*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.28.28-pm-1836x631.png)
*The Vendor Id field was populated and the Quick View form was shown on the right hand side.*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.29.18-pm-1836x632.png)
*I clicked the Save button*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.29.31-pm-1836x633.png)
*The record was saved to Business Central and No. value 106034 automatically assigned*

![](/assets/images/modeldrivenpurchaseorders/screenshot-2024-03-02-at-6.29.47-pm-1836x629.png)
*The new purchase order was shown at the bottom of the "All Purchase Orders" view*

---

## mssqlserver

**Source file:** `mssqlserver.md`

---
title: "Microsoft SQL Server (Part 1)"
description: "Microsoft SQL Server 2019 Docker image."
date: "2021-03-14"
categories: ["SQL","Java","DevOps"]
tags: []
slug: "mssqlserver"
image: "/assets/images/ads.svg"
---


## Docker image

Downloading and running amd64 Docker image from [https://hub.docker.com/_/microsoft-mssql-server](https://hub.docker.com/_/microsoft-mssql-server)

**$ docker run -e "ACCEPT_EULA=Y" -e "SA_PASSWORD=Passw0rd****123" -p 1433:1433 --name sql -d mcr.microsoft.com/mssql/server:****2019-latest**

![](/assets/images/mssqlserver/image-28-651x336.png)
*docker run*

![](/assets/images/mssqlserver/screen-shot-2021-03-14-at-5.03.27-pm-1538x1266.png)
*Azure Data Studio - New Connection*

![](/assets/images/mssqlserver/screen-shot-2021-03-14-at-5.05.30-pm-1540x1264.png)
*Connected to database instance running on 192.168.68.109*


## RESTORE DATABASE

Open shell for Docker image and download the AdventureWorks2019.bak database backup

**$ cd /usr**

**$ wget https://github.com/Microsoft/sql-server-samples/releases/download/adventureworks/AdventureWorks2019.bak**

Open a database query window and execute this query

RESTORE DATABASE AdventureWorks2019 
FROM DISK = N'/usr/AdventureWorks2019.bak'
WITH MOVE 'AdventureWorks2017' TO '/usr/AdventureWorks2019.mdf',
MOVE 'AdventureWorks2017_Log' TO '/usr/AdventureWorks2019_Log.ldf'

![](/assets/images/mssqlserver/screen-shot-2021-03-14-at-5.56.57-pm-1836x1029.png)
*RESTORE DATABASE*

![](/assets/images/mssqlserver/screen-shot-2021-03-14-at-6.08.10-pm-1836x1031.png)
*AdventureWorks Products*


## Product names in a .NET Core console app

```bash
% dotnet new sln
```

```bash
% dotnet new console -o dotnet-sql 
```

```bash
% dotnet sln add ./dotnet-sql/dotnet-sql.csproj
```

```bash
% cd dotnet-sql
% dotnet new gitignore
```

Add [NuGet](nuget.html) package

```bash
% dotnet add package System.Data.SqlClient
```

![](/assets/images/mssqlserver/screen-shot-2021-03-15-at-7.10.16-pm-1836x1133.png)
*dotnet add package System.Data.SqlClient*


## Program.cs

The code below retrieves details from the Product table using C#.

![](/assets/images/mssqlserver/screen-shot-2021-03-16-at-8.49.39-pm-1126x740.png)
*dotnet run*


## Product names in a Node console app

**$ node index.js**

The code below retrieves details from the Product table using JavaScript and the 'mssql' node module.

![](/assets/images/mssqlserver/screen-shot-2021-03-25-at-5.50.18-pm-1134x734.png)
*node index.js*


## Product names in a Java console app

**$ javac Program.java**

then

**$ java -cp ".:/Users/neilhaddley/sqljdbc_9.2/enu/mssql-jdbc-9.2.1.jre11.jar" Program**

or

**$ export CLASSPATH=.:/Users/neilhaddley/sqljdbc_9.2/enu/mssql-jdbc-9.2.1.jre11.jar

$ java Program**

The code below retrieves details from the Product table using Java.

![](/assets/images/mssqlserver/screen-shot-2021-03-25-at-5.48.28-pm-1134x736.png)
*java Program.java*

---

## mssqlserver2

**Source file:** `mssqlserver2.md`

---
title: "Microsoft SQL Server (Part 2)"
description: "T-SQL, Stored Procedures and Snapshot Isolation."
date: "2021-03-27"
categories: ["SQL","Java"]
tags: []
slug: "mssqlserver2"
image: "/assets/images/ads.svg"
---


## Stored procedures

Transact SQL (T-SQL) statements are used to create Microsoft SQL Server Stored Procedures.

Stored Procedures are maintained in the database making it easier to apply updates that improve the performance of all client applications.

Stored Procedures that help customers to purchase cinema tickets or reserve seats on airplanes need to be written with isolation levels in mind.


## Shuffling cards

Consider how a stored procedure might be used to shuffle the contents of a table representing a deck of playing cards.


## Swap cards

To shuffle a deck of standard playing cards we could select any two cards from the deck at random and swap their positions. If we did this enough times the deck would be shuffled.

Here is a stored procedure that will swap the data in two rows of the deck table.


## Pick two cards, swap and repeat

To test the SwapCards stored procedure we can create:

**a PickACard function **that selects a card from the deck at random
                        **a SwapCardsAtRandom stored procedure **that uses the PickACard function (twice) and the SwapCards stored procedure (above) to swap the random pair of cards; **and**
                        **client code **that calls the SwapCardsAtRandom stored procedure 1,000 times.


## With a single client

Running a single copy of client code that calls the SwapCardV1 stored procedure is fine.

The result is a shuffled deck with 13 cards of each suit.

![](/assets/images/mssqlserver2/screen-shot-2021-03-27-at-9.01.56-pm-1836x1139.png)
*Shuffle results single client*


## Concurrency issues

However, running multiple copies of the client code that calls the SwapCardV1 stored procedure reveals an issue.

![](/assets/images/mssqlserver2/screen-shot-2021-03-27-at-9.08.55-pm-1836x1136.png)
*Shuffle failure*


## Snapshot issolation

When concurrency is introduced our original SwapCards stored procedure does not work. No errors are being raised but transactions are stepping on each other.

We can use Snapshot isolation to address the issue.


## Multiple clients

With the updated SwapCard stored procedure we can run multiple updates concurrently.

![](/assets/images/mssqlserver2/screen-shot-2021-03-27-at-9.25.19-pm-1836x1138.png)
*Shuffle success*


## Catching the errors

Snapshot isolation guarantees that reads made in a transaction will see a consistent snapshot of the database and that the transaction will commit only if no update made in the transaction conflicts with another concurrent update.

With snapshot isolation enabled there is a chance that a commit will fail and that an error will be raised. This is a good thing.

In the code shown above if SwapCards throws an error the client code catches the error, prints a message and continues. Perhaps instead the client code should retry the swap?

![](/assets/images/mssqlserver2/screen-shot-2021-03-27-at-9.25.30-pm-1836x1131.png)
*Concurrency exceptions (that the client code needs to handle)*


## .NET Core console app

**$ dotnet run**

The code below calls the SwapCards stored procedure 1000 times using C#.**
**


## Node console app

**$ node index.js**

The code below calls the SwapCards stored procedure 1000 times using JavaScript and the 'mssql' node module.**
**


## Java console app

**$ javac Program.java**

then

**$ java -cp ".:/Users/neilhaddley/sqljdbc_9.2/enu/mssql-jdbc-9.2.1.jre11.jar" Program**

or

**$ export CLASSPATH=.:/Users/neilhaddley/sqljdbc_9.2/enu/mssql-jdbc-9.2.1.jre11.jar**

**$ java Program**

The code below calls the SwapCards stored procedure 1000 times using Java.


## Using cross join to create a table the represents ...

```text
-- Create the Deck
CREATE TABLE Cards
(
    Card CHAR(5) PRIMARY KEY
)
GO

INSERT INTO Cards
VALUES
    ('Ace'),
    ('2'),
    ('3'),
    ('4'),
    ('5'),
    ('6'),
    ('7'),
    ('8'),
    ('9'),
    ('10'),
    ('Jack'),
    ('Queen'),
    ('King')
GO

CREATE TABLE Suits
(
    Suit CHAR(8) PRIMARY KEY
)
GO

INSERT INTO Suits
VALUES
    ('Clubs'),
    ('Diamonds'),
    ('Hearts'),
    ('Spades')
GO

SELECT Id = IDENTITY(INT, 1, 1),
    Suits.Suit,
    Cards.Card
INTO Deck
FROM Cards
CROSS JOIN Suits
GO

ALTER TABLE Deck ADD CONSTRAINT Deck_PK PRIMARY KEY (Id)
GO
```

## SwapCardsV1

```text
-- Stored Procedure 'SwapCardsV1'
CREATE PROCEDURE SwapCardsV1
    @Card1 INT = 1,
    @Card2 INT = 52
AS
BEGIN
    
    BEGIN TRY
		BEGIN TRANSACTION

		SET NOCOUNT ON

		-- Store the first card's details
		SELECT *
        INTO #Temp
        FROM Deck
        WHERE Id = @Card1

		-- Move second card into first card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT d.Card,
            d.Suit
        FROM Deck d
        WHERE Id = @Card2
			) CardDetails
		WHERE Id = @Card1

		-- Move first card into second card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT Card,
            Suit
        FROM #temp
			) CardDetails
		WHERE Id = @Card2

		COMMIT TRANSACTION;
	END TRY

	BEGIN CATCH
		-- PRINT 'We were unable to make the swap rolling back [' + ERROR_MESSAGE() + '].';
		ROLLBACK TRANSACTION;
        THROW 51000, 'Unable to swap card.', 1; 
	END CATCH
END
GO
```

## SwapCards T-SQL Client Code

```text
-- User Defined Function 'PickACard'
CREATE FUNCTION PickACard (@RAND FLOAT)
RETURNS INT
AS
BEGIN
    RETURN (
			SELECT FLOOR(@RAND * (52 - 1 + 1)) + 1
			)
END
GO

-- Stored Procedure 'SwapCardsAtRandom'
CREATE PROCEDURE SwapCardsAtRandom
AS
BEGIN
    DECLARE @Rnd1 FLOAT

    SET @Rnd1 = RAND()

    DECLARE @Card1 INT

    SET @Card1 = (
			SELECT dbo.PickACard(@Rnd1)
			)

    DECLARE @Rnd2 FLOAT

    SET @Rnd2 = RAND()

    DECLARE @Card2 INT

    SET @Card2 = (
			SELECT dbo.PickACard(@Rnd2)
			)

    -- 'No need to swap a card with itself'
    IF @Card1 != @Card2
	BEGIN
        EXECUTE dbo.SwapCardsV1 @Card1,
			@Card2
    END -- IF @Card1 != @Card2
END -- CREATE PROCEDURE SwapCards
GO

-- Call Swap Cards Multiple times
DECLARE @Counter INT
SET @Counter = 0
DECLARE @ErrorCounter INT
SET @ErrorCounter = 0
WHILE (@Counter < 1000)
BEGIN

    BEGIN TRY
		EXECUTE SwapCardsAtRandom
	END TRY

	BEGIN CATCH
		SET @ErrorCounter = @ErrorCounter+1
        PRINT 'We were unable to swap cards [' + ERROR_MESSAGE() +']. Error Count ['+LTRIM(STR(@ErrorCounter,10))+']'  
	END CATCH
    
    SET @Counter = @Counter + 1
END
GO

-- Review results
SELECT COUNT(*)
FROM Deck
GROUP BY Suit
GO

SELECT *
FROM Deck
ORDER BY Card,Suit
GO
```

## SwapCards with snapshot isolation

```text
-- Stored Procedure 'SwapCards'
CREATE PROCEDURE SwapCards
    @Card1 INT = 1,
    @Card2 INT = 52
AS
BEGIN
    SET TRANSACTION ISOLATION LEVEL SNAPSHOT;

    BEGIN TRY
		BEGIN TRANSACTION

		SET NOCOUNT ON

		-- Store the first card's details
		SELECT *
        INTO #Temp
        FROM Deck
        WHERE Id = @Card1

		-- Move second card into first card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT d.Card,
            d.Suit
        FROM Deck d
        WHERE Id = @Card2
			) CardDetails
		WHERE Id = @Card1

		-- Move first card into second card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT Card,
            Suit
        FROM #temp
			) CardDetails
		WHERE Id = @Card2

		COMMIT TRANSACTION;
	END TRY

	BEGIN CATCH
		-- PRINT 'We were unable to make the swap rolling back [' + ERROR_MESSAGE() + '].';
		ROLLBACK TRANSACTION;
        THROW 51000, 'Unable to swap card.', 1; 
	END CATCH
END
GO
```

## Program.cs

```text
using System;
using System.Data.SqlClient;
using System.Data;

namespace dotnet_sql {
  class Program {
    static void Main(string[] args) {
      var cs = @ "User ID=sa;Password=Passw0rd123;Initial Catalog=Shuffle;Server=192.168.68.109;";

      using var con = new SqlConnection(cs);
      con.Open();

      using(SqlCommand cmd = new SqlCommand("dbo.SwapCards", con)) {
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.Add("@Card1", SqlDbType.Int);
        cmd.Parameters.Add("@Card2", SqlDbType.Int);

        int errorCounter = 0;
        for (int count = 0; count < 1000; count++) {
          Random rn = new Random();
          int card1 = rn.Next(1, 52);
          int card2 = rn.Next(1, 52);

          cmd.Parameters["@Card1"].Value = card1;
          cmd.Parameters["@Card2"].Value = card2;

          try {
            cmd.ExecuteNonQuery();
          } catch (Exception e) {
            errorCounter++;
            Console.WriteLine("We were unable to swap cards [" + e.Message + "]. Error Count [" +
              errorCounter + "]");
          }

        }
      }
    }
  }
}
```

## index.js

```text
const mssql = require('mssql')

const config = {
    user: 'sa',
    password: 'Passw0rd123',
    server: '192.168.68.109',
    database: 'Shuffle',
    options: { enableArithAbort: false }
};

const dbConn = mssql.connect(config, function (err) {

    if (err) {
        console.log(err);
        return
    }

    const request = new mssql.Request();

    request.input('Card1', mssql.Int);
    request.input('Card2', mssql.Int);

    let errorCounter = 0;

    (async () => {
        for (x = 0; x < 1000; x++) {

            const card1 = Math.floor(Math.random() * (52 - 1 + 1)) + 1
            const card2 = Math.floor(Math.random() * (52 - 1 + 1)) + 1

            request.parameters.Card1.value = card1;
            request.parameters.Card2.value = card2;

            if (card1 != card2) {

                try {
                    await request.execute('dbo.SwapCards')
                } catch (e) {
                    errorCounter++;
                    console.error("We were unable to swap cards [" + e.originalError.message + "]. Error Count [" + errorCounter + "]");
                }

            }
        }
        dbConn.close();

    })().catch(err => {
        console.error(err);
    });

})
```

## Program.java

```text
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.CallableStatement;
import java.util.Random;

public class Program {


    public static void main(String[] args) {

        String connectionUrl = "jdbc:sqlserver://192.168.68.109:1433;databaseName=Shuffle;user=sa;password=Passw0rd123";

        try (Connection con = DriverManager.getConnection(connectionUrl);) {

            CallableStatement callableStatement = con.prepareCall("{call dbo.SwapCards(?,?)}");

            int errorCounter = 0;
            for (int count = 0; count < 1000; count++) {

                Random rn = new Random();
                int card1 = rn.nextInt(52 - 1 + 1) + 1;
                int card2 = rn.nextInt(52 - 1 + 1) + 1;

                try {
                    if (card1 != card2) {
                        callableStatement.setInt(1, card1);
                        callableStatement.setInt(2, card2);
                        callableStatement.execute();
                    }
                } catch (SQLException e1) {
                    errorCounter++;
                    System.out.println("We were unable to swap cards [" + e1.getMessage() + "]. Error Count ["
                            + Integer.toString(errorCounter) + "]");
                }
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
```

## Full T-SQL code

```text
DROP DATABASE Shuffle
GO

-- Create the DB
CREATE DATABASE Shuffle
GO

-- Allow snapshot isolation
ALTER DATABASE Shuffle
SET ALLOW_SNAPSHOT_ISOLATION ON
GO

-- Enable accelerated database recovery
ALTER DATABASE Shuffle
SET ACCELERATED_DATABASE_RECOVERY = ON;
GO

-- Use Shuffle DB
USE Shuffle
GO

-- Create the Deck
CREATE TABLE Cards
(
    Card CHAR(5) PRIMARY KEY
)
GO

INSERT INTO Cards
VALUES
    ('Ace'),
    ('2'),
    ('3'),
    ('4'),
    ('5'),
    ('6'),
    ('7'),
    ('8'),
    ('9'),
    ('10'),
    ('Jack'),
    ('Queen'),
    ('King')
GO

CREATE TABLE Suits
(
    Suit CHAR(8) PRIMARY KEY
)
GO

INSERT INTO Suits
VALUES
    ('Clubs'),
    ('Diamonds'),
    ('Hearts'),
    ('Spades')
GO

SELECT Id = IDENTITY(INT, 1, 1),
    Suits.Suit,
    Cards.Card
INTO Deck
FROM Cards
CROSS JOIN Suits
GO

ALTER TABLE Deck ADD CONSTRAINT Deck_PK PRIMARY KEY (Id)
GO

-- User Defined Function 'PickACard'
CREATE FUNCTION PickACard (@RAND FLOAT)
RETURNS INT
AS
BEGIN
    RETURN (
			SELECT FLOOR(@RAND * (52 - 1 + 1)) + 1
			)
END
GO

-- Stored Procedure 'SwapCardsV1'
CREATE PROCEDURE SwapCardsV1
    @Card1 INT = 1,
    @Card2 INT = 52
AS
BEGIN
    
    BEGIN TRY
		BEGIN TRANSACTION

		SET NOCOUNT ON

		-- Store the first card's details
		SELECT *
        INTO #Temp
        FROM Deck
        WHERE Id = @Card1

		-- Move second card into first card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT d.Card,
            d.Suit
        FROM Deck d
        WHERE Id = @Card2
			) CardDetails
		WHERE Id = @Card1

		-- Move first card into second card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT Card,
            Suit
        FROM #temp
			) CardDetails
		WHERE Id = @Card2

		COMMIT TRANSACTION;
	END TRY

	BEGIN CATCH
		-- PRINT 'We were unable to make the swap rolling back [' + ERROR_MESSAGE() + '].';
		ROLLBACK TRANSACTION;
        THROW 51000, 'Unable to swap card.', 1; 
	END CATCH
END
GO

-- Stored Procedure 'SwapCards'
CREATE PROCEDURE SwapCards
    @Card1 INT = 1,
    @Card2 INT = 52
AS
BEGIN
    SET TRANSACTION ISOLATION LEVEL SNAPSHOT;

    BEGIN TRY
		BEGIN TRANSACTION

		SET NOCOUNT ON

		-- Store the first card's details
		SELECT *
        INTO #Temp
        FROM Deck
        WHERE Id = @Card1

		-- Move second card into first card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT d.Card,
            d.Suit
        FROM Deck d
        WHERE Id = @Card2
			) CardDetails
		WHERE Id = @Card1

		-- Move first card into second card's place
		UPDATE Deck
		SET Card = CardDetails.Card,
			Suit = CardDetails.Suit
		FROM (
			SELECT Card,
            Suit
        FROM #temp
			) CardDetails
		WHERE Id = @Card2

		COMMIT TRANSACTION;
	END TRY

	BEGIN CATCH
		-- PRINT 'We were unable to make the swap rolling back [' + ERROR_MESSAGE() + '].';
		ROLLBACK TRANSACTION;
        THROW 51000, 'Unable to swap card.', 1; 
	END CATCH
END
GO

-- Stored Procedure 'SwapCardsAtRandom'
CREATE PROCEDURE SwapCardsAtRandom
AS
BEGIN
    DECLARE @Rnd1 FLOAT

    SET @Rnd1 = RAND()

    DECLARE @Card1 INT

    SET @Card1 = (
			SELECT dbo.PickACard(@Rnd1)
			)

    DECLARE @Rnd2 FLOAT

    SET @Rnd2 = RAND()

    DECLARE @Card2 INT

    SET @Card2 = (
			SELECT dbo.PickACard(@Rnd2)
			)

    -- 'No need to swap a card with itself'
    IF @Card1 != @Card2
	BEGIN
        EXECUTE dbo.SwapCards @Card1,
			@Card2
    END -- IF @Card1 != @Card2
END -- CREATE PROCEDURE SwapCards
GO

-- Call SwapCardsAtRandom Multiple times
DECLARE @Counter INT
SET @Counter = 0
DECLARE @ErrorCounter INT
SET @ErrorCounter = 0
WHILE (@Counter < 1000)
BEGIN

    BEGIN TRY
		EXECUTE SwapCardsAtRandom
	END TRY

	BEGIN CATCH
		SET @ErrorCounter = @ErrorCounter+1
        PRINT 'We were unable to swap cards [' + ERROR_MESSAGE() +']. Error Count ['+LTRIM(STR(@ErrorCounter,10))+']'  
	END CATCH
    
    SET @Counter = @Counter + 1
END
GO

-- Review results
SELECT COUNT(*)
FROM Deck
GROUP BY Suit
GO

SELECT *
FROM Deck
ORDER BY Card,Suit
GO
```

---

## mssqlserver3

**Source file:** `mssqlserver3.md`

---
title: "Microsoft SQL Server (Part 3)"
description: "A Node, React and MS SQL Server App."
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/mssqlserver3/hero.png"
tags: ["react","javascript","typescript","azure","java"]
hidden: true
slug: "mssqlserver3"
---


## Create Database

Start by creating the SQL Server Database


## Use ToDo

Switch to ToDo Database


## Create Table

Create Tasks Table


## Add Sample Rows

Add sample rows to the Tasks table.


## npm init

npm init -y


## hapi

npm install @hapi/hapi


## eslint

$ npm install eslint --save-dev
$CONTENT$nbsp;npx eslint --init
> To check syntax, find problems, and enforce code style
> CommonJS (require/exports)
**React**
> Does your project use TypeScript? 
**No** / Yes
> Where does your code run? 
**Node**
> Use a popular style guide
**Answer questions about your style**
> What format do you want your config file to be in?
**JavaScript**
> What style of indentation do you use?
**Tabs**
> What quotes do you use for strings?
**Double**
> What line endings do you use? 
**Unix**
> Do you require semicolons?
**No**


## src/index.js

$ mkdir src
$ cd src
$ touch index.js


## src/server.js

$ touch server.js


## src/routes/index.js

$ mkdir routes
$ cd routes
$ touch index.js


## package.json

"main": "src/index.js",


## Run and test

$ node .

navigate to http://localhost:8080


## .env

$ npm install dotenv
$ touch .env


## src/config.js

$ cd src
$ touch config.js


## mssql fs-extra

$ npm install mssql
$ npm install fs-extra


## data access

$ cd src
$ mkdir data
$ cd data
$ touch index.js


## src/data/utils.js

Maintain sql statements as .sql files in src/data/... subfolders and read at runtime.

$ touch utils.js


## src/data/tasks folder

$ mkdir tasks
$ cd tasks
$ touch getTasks.sql
$CONTENT$nbsp;touch index.js


## src/plugins

$ mkdir plugins
$ cd plugins
$ touch index.js
$ touch sql.js


## src/routes/api

$ mkdir api
$ cd api
$ touch index.js
$ touch tasks.js


## Run and test

$ node .


## okta

okta is a service that simplifies identity management

![](/assets/images/mssqlserver3/screen-shot-2021-04-17-at-8.02.48-am-1836x926.png)
*esp8266*


## register app

https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app

![](/assets/images/mssqlserver3/screen-shot-2021-04-17-at-8.54.33-am-1130x744.png)
*esp8266*

![](/assets/images/mssqlserver3/screen-shot-2021-04-17-at-8.56.43-am-1678x964.png)
*esp8266*

![](/assets/images/mssqlserver3/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*


## workbench.aspx

https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationMenuBlade/Quickstart/quickStartType//sourceType/Microsoft_AAD_IAM/appId/c03242fe-84f5-4069-9507-3667965ba3af/objectId/3305d263-36f4-4639-899d-e5d34fd020df/isMSAApp//defaultBlade/Overview/appSignInAudience/AzureADandPersonalMicrosoftAccount/servicePrincipalCreated/true

![](/assets/images/mssqlserver3/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/mssqlserver3/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/mssqlserver3/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*


## okta - Add an external Identity Provider

https://developer.okta.com/docs/guides/add-an-external-idp/microsoft/create-an-app-at-idp/


## <TO DISCUSS>

NAMING CONVENTION FOR TABLE AND TABLE COLUMN NAMES (SQL Server or JavaScript friendly?)

1:26:50

![](/assets/images/mssqlserver3/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*


## error handling

// in production use hapi-pino, winston?


## Create Database

```text
-- Create a new database called 'ToDo'
-- Connect to the 'master' database to run this snippet
USE master
GO
-- Create the new database if it does not exist already
IF NOT EXISTS (
    SELECT [name]
        FROM sys.databases
        WHERE [name] = N'ToDo'
)
CREATE DATABASE ToDo
GO
```

## Use ToDo

```text
Use ToDo;
```

## Create Table

```text
-- Create a new table called '[Tasks]' in schema '[dbo]'
-- Drop the table if it already exists
IF OBJECT_ID('[dbo].[Tasks]', 'U') IS NOT NULL
DROP TABLE [dbo].[Tasks]
GO
-- Create the table in the specified schema
CREATE TABLE [dbo].[Tasks]
(
    [Id] INT IDENTITY PRIMARY KEY, -- Primary Key column
    [UserId] NVARCHAR(50) NOT NULL,
    [Title] NVARCHAR(50) NOT NULL,
    [Description] NVARCHAR(1000) NOT NULL,
    [DueDate] date NOT NULL,
    [DueTime] time(0) NULL,
    [IsDone] BIT default 'FALSE',
    INDEX idx_tasks_userId (UserId)
);
GO
```

## Insert into Tasks

```text
-- Insert rows into table 'Tasks' in schema '[dbo]'
INSERT INTO [dbo].[Tasks]
( -- Columns to insert data into
 [UserId], [Title], [Description], [DueDate], [DueTime]
)
VALUES
( -- First row: values for the columns in the list above
 'Doe', N'Shopping', N'Dinner Party Supplies','2021-12-31','19:00'
),
( -- Second row: values for the columns in the list above
'Doe', N'Yardwork', N'Mow Lawn','2021-12-15',null
)
-- Add more rows here
GO
```

## srcindex.js

```text
"use strict";

const server = require("./server");

const startServer = async () => {
    try {
        const config = {
            host: "localhost",
            port: "8080"
        };
        const app = await server(config);
        await app.start();

        console.log(`Server running at http://${config.host}:${config.port}`);
    } catch (err) {
        console.log("startup error", err);
    }
};

startServer();
```

## srcserver.js

```text
"use strict";

const hapi = require("@hapi/hapi");
const routes = require("./routes");

const app = async config => {
    const { host, port } = config;
    const server = hapi.server({ host, port });
    server.app.config = config;
    await routes.register(server);
    return server;
};

module.exports = app;
```

## srcroutesindex.js

```text
"use strict";

module.exports.register = async server => {
    server.route({
        method: "GET",
        path: "/",
        handler: async (request, h) => {
            return "Hapi server";
        }
    })
}
```

## .env

```text
# hapi
PORT=8080
HOST=localhost
HOST_URL=http://localhost:8080

# sql
SQL_USER=sa
SQL_PASSWORD=Passw0rd123
SQL_DATABASE=ToDo
SQL_SERVER=192.168.68.109
# true for Azure SQL Server
SQL_ENCRYPT=false

# azure active directory
AZURE_APP_CLIENT_ID=63fe01c7-f396-484e-8a48-760f********
AZURE_DIR_TENANT_ID=1661e837-0a95-4bc6-a655-8653********
AZURE_CLIENT_SECRET=-~nGgWS3F7y~-o2etNGc0BW_ik_*******
AZURE_CLOUD_INSTANCE_ID=https://microsoftonline.com
AZURE_GRAPH_ENDPOINT=https://graph.microsoft.com
```

## srcconfig.js

```text
"use strict";

const dotenv = require("dotenv");
const assert = require("assert");

dotenv.config();

const {
    PORT,
    HOST,
    HOST_URL,
    SQL_SERVER,
    SQL_DATABASE,
    SQL_USER,
    SQL_PASSWORD
} = process.env;

const sqlEncrypt = process.env.SQL_ENCRYPT === "true";

assert(PORT,"Port is required");
assert(HOST,"HOST is required");
assert(HOST_URL,"HOST_URL is required");
assert(SQL_SERVER,"SQL_SERVER is required");
assert(SQL_DATABASE,"SQL_DATABASE is required");
assert(SQL_USER,"SQL_USER is required");
assert(SQL_PASSWORD,"SQL_PASSWORD is required");

module.exports = {
    port: PORT,
    host: HOST,
    database: SQL_DATABASE,
    url: HOST_URL,
    sql: {
        server: SQL_SERVER,
        user: SQL_USER,
        password: SQL_PASSWORD,
        options: {
            encrypt: sqlEncrypt,
            enableArithAbort:true
        }
    }
}
```

## srcdataindex.js

```text
"use strict";

const tasks = require("./tasks");
const sql = require("mssql");

const client = async (server, config) => {
    let pool = null;

    const closePool = async () => {
        try {
            await pool.close();
            pool = null;
        } catch (err) {
            console.log(err);
        }
    };

    const getConnection = async () => {
        try {
            if (pool) {
                return pool;
            }
            pool = await sql.connect(config) // was connect() in previous version of mssql library
            pool.on("error", async err => {
                console.log(err);
                await closePool();
            })
            return pool;
        } catch (err) {
            console.log(err);
            pool = null;
        }
    };

    return {
        tasks: await tasks.register({ sql, getConnection })
    }

};

module.exports = client;
```

## srcdatautils.js

```text
"use strict";

const fs=require("fs-extra");
const {join}=require("path");

const loadSqlQueries=async folderName=>{

    const filePath = join(process.cwd(),"src","data",folderName);
    const files = await fs.readdir(filePath);
    const sqlFiles = files.filter( f=> f.endsWith(".sql"))
    const queries  = {};
    for(const sqlFile of sqlFiles){
        const query=fs.readFileSync(join(filePath,sqlFile),{encoding:"UTF-8"});
        queries[sqlFile.replace(".sql","")] = query;
    }
    return queries;
}

module.exports = {
    loadSqlQueries
};
```

## srcdatatasksgetTasks.sql

```text
SELECT TOP (1000) [Id],
	[UserId],
	[Title],
	[Description],
	[DueDate],
	[DueTime],
	[IsDone]
FROM [ToDo].[dbo].[Tasks]
WHERE [UserId] = @userId
ORDER BY [DueDate],
	[DueTime]
```

## srcdatatasksindex.js

```text
"use strict";

const utils = require("../utils");

const register = async ({ sql, getConnection }) => {
    const sqlQueries = await utils.loadSqlQueries("tasks");
    const getTasks = async userId => {
        const cnx = await getConnection();
        const request = await cnx.request();
        request.input("userId", sql.VarChar(50), userId);
        return request.query(sqlQueries.getTasks);
    }

    return {
        getTasks
    };
};

module.exports = { register };
```

## srcpluginsindex.js

```text
"use strict";

const sql=require("./sql");

module.exports.register = async server=>{
    await server.register(sql);
};
```

## srcpluginssql.js

```text
"use strict";

const dataClient = require("../data");

module.exports={
    name:"sql",
    version:"1.0.0",
    register:async server=>{
        const config= server.app.config.sql;
        const client = await dataClient(server,config);
        server.expose("client",client);
    }
}
```

## srcroutesapiindex.js

```text
"use strict";

const tasks = require("./tasks");

module.exports.register=async server=>{
    await tasks.register(server)
};
```

## srcroutesapitasks.js

```text
"use strict";

module.exports.register = async server => {
    server.route({
        method: "GET",
        path: "/api/tasks",
        handler: async request => {
            try {
    const db = request.server.plugins.sql.client;
                const userId = "Doe";
                const res = await db.tasks.getTasks(userId);
                return res.recordset;
            } catch (err) {
                console.log(err); 
            }
        }
    });
};
```
## References

- [Build a Secure Node.js App with SQL Server](https://www.youtube.com/watch?v=XJpYH7K7TGM)



---

## multiplayer

**Source file:** `multiplayer.md`

---
title: "Multiplayer Game"
description: "Creating a new firebase project"
date: "2023-05-09"
categories: ["Maps","DevOps"]
tags: []
slug: "multiplayer"
image: "/assets/images/logo-lockup-firebase-vertical.svg"
---


I created a firebase project using https://console.firebase.google.com

I deployed [Drew Conley's Multiplayer Game](https://www.youtube.com/watch?v=xhURh2RDzzg) to Firebase.

![](/assets/images/multiplayer/screen-shot-2023-05-09-at-9.26.22-am-1814x1582.png)
*https://haddley-multiplayer.web.app/*

![](/assets/images/multiplayer/screen-shot-2023-05-09-at-9.59.28-am-1536x959.png)
*Firebase project settings*

![](/assets/images/multiplayer/screen-shot-2023-05-08-at-5.19.41-pm-1470x786.png)
*firebase initfirebase deploy*


## Responding to updated state

The state of the games is maintained in a Firebase Realtime Database.

The allPlayersRef.on("XXX", (snapshot) => {...}) functions are called when a player joins the game, leaves the game or moves.

The   allCoinsRef.on("value", (snapshot) => {...}) functions are called when coins are created or collected.

![](/assets/images/multiplayer/screen-shot-2023-05-09-at-9.39.39-am-1836x1151.png)
*Realtime Database*


## ChatGPT's commentary

This code appears to be a JavaScript implementation of a game that involves players moving characters on a map and collecting coins. Let's go through the code and explain its different parts:

1. The mapData object defines the boundaries of the game map (minX, maxX, minY, maxY) and the coordinates of blocked spaces on the map (blockedSpaces).
2. The playerColors array contains different colors that can be assigned to players in the game.
3. The randomFromArray function takes an array as input and returns a random element from that array.
4. The getKeyString function takes x and y coordinates and returns a string in the format "x:y".
5. The createName function generates a random name for a player by combining a random prefix and a random animal name.
6. The isSolid function checks if a given coordinate (x, y) represents a solid space on the map. It returns true if the space is blocked or if the coordinates are outside the map boundaries.
7. The getRandomSafeSpot function returns a random coordinate from a predefined set of safe spots on the map where players can initially spawn.
8. The code then defines an immediately-invoked function expression (IIFE) that encapsulates the game logic. Inside this function, various variables are declared and initialized:
playerId and playerRef represent the unique ID and reference for the current player.
players is an object that stores information about all the players in the game.
playerElements is an object that stores references to DOM elements representing each player's character.
coins is an object that stores information about the coins present on the map.
coinElements is an object that stores references to DOM elements representing each coin.
9. The code selects relevant DOM elements using document.querySelector.
10. The placeCoin function is responsible for randomly placing a coin on the map. It selects a safe spot using getRandomSafeSpot, creates a reference to the coin in the Firebase database, and schedules a recursive call to placeCoin after a random timeout.
11. The attemptGrabCoin function is called when a player moves to a new coordinate. It checks if there is a coin at the given coordinates and, if so, removes the coin from the database and increments the player's coin count.
12. The handleArrowPress function is called when a player presses an arrow key to move their character. It calculates the new coordinates based on the current position and the arrow key pressed. If the new coordinates represent a valid move (not blocked by a solid space), it updates the player's position, direction, and saves the changes to the database. It also calls attemptGrabCoin to check if the player grabbed a coin at the new position.
13. The initGame function initializes the game by adding event listeners for arrow key presses, setting up database listeners for player and coin updates, and creating DOM elements for players and coins.
14. The code sets up Firebase authentication using anonymous sign-in (firebase.auth().signInAnonymously()) and handles the authentication state change using firebase.auth().onAuthStateChanged. When a user is authenticated, the game initializes by generating a random name for the player, setting up the player's initial position, and adding the player to the database. It also sets up a disconnection handler to remove the player's data from the database when they disconnect.
15. Finally, the IIFE is invoked immediately, starting the execution of the game code.

In summary, this JavaScript code sets up a multiplayer game where players can control characters on a map. The game uses Firebase for real-time data synchronization. Players can move their characters using arrow keys, collect coins, and see the positions and coin counts of other players. The code initializes the game, handles player authentication, updates player and coin data in the database, and manages the rendering of player and coin elements in the game interface.


## Security Rules

```text
{
  "rules": {
    ".read": "auth != null",
    ".write": false,
    "players": {
      "$uid": {
        ".write": "auth != null && auth.uid == $uid"
      }
    },
    "coins": {
        ".write": "auth != null"
    }
  }
}
```

## index.html

```text
<html>

<head>
  <title>Multiplayer Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css" type="text/css">
</head>

<body>

  <div class="game-container">
  </div>
  <div class="player-info">
    <div>
      <label for="player-name">Your Name</label>
      <input id="player-name" maxlength="10" type="text" />
    </div>
    <div>
      <button id="player-color">Change Color</button>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script>
    // NOTE - INCLUDE YOUR FIREBASE CONFIG HERE FOR ANYTHING TO WORK:
    const firebaseConfig = {
      apiKey: "AIzaSyBfoImSImcCkM7TD-Z3X-LxWs4OEbGOaUQ",
      authDomain: "haddley-multiplayer.firebaseapp.com",
      projectId: "haddley-multiplayer",
      storageBucket: "haddley-multiplayer.appspot.com",
      messagingSenderId: "119673300748",
      appId: "1:119673300748:web:8cb5b0ba8dbbae0834cb29"
    };
    firebase.initializeApp(firebaseConfig);
  </script>


  <script src="/KeyPressListener.js"></script>
  <script src="/app.js"></script>
</body>

</html>
```

## app.js

```text
const mapData = {
  minX: 1,
  maxX: 14,
  minY: 4,
  maxY: 12,
  blockedSpaces: {
    "7x4": true,
    "1x11": true,
    "12x10": true,
    "4x7": true,
    "5x7": true,
    "6x7": true,
    "8x6": true,
    "9x6": true,
    "10x6": true,
    "7x9": true,
    "8x9": true,
    "9x9": true,
  },
};

// Options for Player Colors... these are in the same order as our sprite sheet
const playerColors = ["blue", "red", "orange", "yellow", "green", "purple"];

//Misc Helpers
function randomFromArray(array) {
  return array[Math.floor(Math.random() * array.length)];
}
function getKeyString(x, y) {
  return `${x}x${y}`;
}

function createName() {
  const prefix = randomFromArray([
    "COOL",
    "SUPER",
    "HIP",
    "SMUG",
    "COOL",
    "SILKY",
    "GOOD",
    "SAFE",
    "DEAR",
    "DAMP",
    "WARM",
    "RICH",
    "LONG",
    "DARK",
    "SOFT",
    "BUFF",
    "DOPE",
  ]);
  const animal = randomFromArray([
    "BEAR",
    "DOG",
    "CAT",
    "FOX",
    "LAMB",
    "LION",
    "BOAR",
    "GOAT",
    "VOLE",
    "SEAL",
    "PUMA",
    "MULE",
    "BULL",
    "BIRD",
    "BUG",
  ]);
  return `${prefix} ${animal}`;
}

function isSolid(x,y) {

  const blockedNextSpace = mapData.blockedSpaces[getKeyString(x, y)];
  return (
    blockedNextSpace ||
    x >= mapData.maxX ||
    x < mapData.minX ||
    y >= mapData.maxY ||
    y < mapData.minY
  )
}

function getRandomSafeSpot() {
  //We don't look things up by key here, so just return an x/y
  return randomFromArray([
    { x: 1, y: 4 },
    { x: 2, y: 4 },
    { x: 1, y: 5 },
    { x: 2, y: 6 },
    { x: 2, y: 8 },
    { x: 2, y: 9 },
    { x: 4, y: 8 },
    { x: 5, y: 5 },
    { x: 5, y: 8 },
    { x: 5, y: 10 },
    { x: 5, y: 11 },
    { x: 11, y: 7 },
    { x: 12, y: 7 },
    { x: 13, y: 7 },
    { x: 13, y: 6 },
    { x: 13, y: 8 },
    { x: 7, y: 6 },
    { x: 7, y: 7 },
    { x: 7, y: 8 },
    { x: 8, y: 8 },
    { x: 10, y: 8 },
    { x: 8, y: 8 },
    { x: 11, y: 4 },
  ]);
}


(function () {

  let playerId;
  let playerRef;
  let players = {};
  let playerElements = {};
  let coins = {};
  let coinElements = {};

  const gameContainer = document.querySelector(".game-container");
  const playerNameInput = document.querySelector("#player-name");
  const playerColorButton = document.querySelector("#player-color");


  function placeCoin() {
    const { x, y } = getRandomSafeSpot();
    const coinRef = firebase.database().ref(`coins/${getKeyString(x, y)}`);
    coinRef.set({
      x,
      y,
    })

    const coinTimeouts = [2000, 3000, 4000, 5000];
    setTimeout(() => {
      placeCoin();
    }, randomFromArray(coinTimeouts));
  }

  function attemptGrabCoin(x, y) {
    const key = getKeyString(x, y);
    if (coins[key]) {
      // Remove this key from data, then uptick Player's coin count
      firebase.database().ref(`coins/${key}`).remove();
      playerRef.update({
        coins: players[playerId].coins + 1,
      })
    }
  }


  function handleArrowPress(xChange=0, yChange=0) {
    const newX = players[playerId].x + xChange;
    const newY = players[playerId].y + yChange;
    if (!isSolid(newX, newY)) {
      //move to the next space
      players[playerId].x = newX;
      players[playerId].y = newY;
      if (xChange === 1) {
        players[playerId].direction = "right";
      }
      if (xChange === -1) {
        players[playerId].direction = "left";
      }
      playerRef.set(players[playerId]);
      attemptGrabCoin(newX, newY);
    }
  }

  function initGame() {

    new KeyPressListener("ArrowUp", () => handleArrowPress(0, -1))
    new KeyPressListener("ArrowDown", () => handleArrowPress(0, 1))
    new KeyPressListener("ArrowLeft", () => handleArrowPress(-1, 0))
    new KeyPressListener("ArrowRight", () => handleArrowPress(1, 0))

    const allPlayersRef = firebase.database().ref(`players`);
    const allCoinsRef = firebase.database().ref(`coins`);

    allPlayersRef.on("value", (snapshot) => {
      //Fires whenever a change occurs
      players = snapshot.val() || {};
      Object.keys(players).forEach((key) => {
        const characterState = players[key];
        let el = playerElements[key];
        // Now update the DOM
        el.querySelector(".Character_name").innerText = characterState.name;
        el.querySelector(".Character_coins").innerText = characterState.coins;
        el.setAttribute("data-color", characterState.color);
        el.setAttribute("data-direction", characterState.direction);
        const left = 16 * characterState.x + "px";
        const top = 16 * characterState.y - 4 + "px";
        el.style.transform = `translate3d(${left}, ${top}, 0)`;
      })
    })
    allPlayersRef.on("child_added", (snapshot) => {
      //Fires whenever a new node is added the tree
      const addedPlayer = snapshot.val();
      const characterElement = document.createElement("div");
      characterElement.classList.add("Character", "grid-cell");
      if (addedPlayer.id === playerId) {
        characterElement.classList.add("you");
      }
      characterElement.innerHTML = (`
        <div class="Character_shadow grid-cell"></div>
        <div class="Character_sprite grid-cell"></div>
        <div class="Character_name-container">
          <span class="Character_name"></span>
          <span class="Character_coins">0</span>
        </div>
        <div class="Character_you-arrow"></div>
      `);
      playerElements[addedPlayer.id] = characterElement;

      //Fill in some initial state
      characterElement.querySelector(".Character_name").innerText = addedPlayer.name;
      characterElement.querySelector(".Character_coins").innerText = addedPlayer.coins;
      characterElement.setAttribute("data-color", addedPlayer.color);
      characterElement.setAttribute("data-direction", addedPlayer.direction);
      const left = 16 * addedPlayer.x + "px";
      const top = 16 * addedPlayer.y - 4 + "px";
      characterElement.style.transform = `translate3d(${left}, ${top}, 0)`;
      gameContainer.appendChild(characterElement);
    })


    //Remove character DOM element after they leave
    allPlayersRef.on("child_removed", (snapshot) => {
      const removedKey = snapshot.val().id;
      gameContainer.removeChild(playerElements[removedKey]);
      delete playerElements[removedKey];
    })


    //New - not in the video!
    //This block will remove coins from local state when Firebase `coins` value updates
    allCoinsRef.on("value", (snapshot) => {
      coins = snapshot.val() || {};
    });
    //

    allCoinsRef.on("child_added", (snapshot) => {
      const coin = snapshot.val();
      const key = getKeyString(coin.x, coin.y);
      coins[key] = true;

      // Create the DOM Element
      const coinElement = document.createElement("div");
      coinElement.classList.add("Coin", "grid-cell");
      coinElement.innerHTML = `
        <div class="Coin_shadow grid-cell"></div>
        <div class="Coin_sprite grid-cell"></div>
      `;

      // Position the Element
      const left = 16 * coin.x + "px";
      const top = 16 * coin.y - 4 + "px";
      coinElement.style.transform = `translate3d(${left}, ${top}, 0)`;

      // Keep a reference for removal later and add to DOM
      coinElements[key] = coinElement;
      gameContainer.appendChild(coinElement);
    })
    allCoinsRef.on("child_removed", (snapshot) => {
      const {x,y} = snapshot.val();
      const keyToRemove = getKeyString(x,y);
      gameContainer.removeChild( coinElements[keyToRemove] );
      delete coinElements[keyToRemove];
    })


    //Updates player name with text input
    playerNameInput.addEventListener("change", (e) => {
      const newName = e.target.value || createName();
      playerNameInput.value = newName;
      playerRef.update({
        name: newName
      })
    })

    //Update player color on button click
    playerColorButton.addEventListener("click", () => {
      const mySkinIndex = playerColors.indexOf(players[playerId].color);
      const nextColor = playerColors[mySkinIndex + 1] || playerColors[0];
      playerRef.update({
        color: nextColor
      })
    })

    //Place my first coin
    placeCoin();

  }

  firebase.auth().onAuthStateChanged((user) => {
    console.log(user)
    if (user) {
      //You're logged in!
      playerId = user.uid;
      playerRef = firebase.database().ref(`players/${playerId}`);

      const name = createName();
      playerNameInput.value = name;

      const {x, y} = getRandomSafeSpot();


      playerRef.set({
        id: playerId,
        name,
        direction: "right",
        color: randomFromArray(playerColors),
        x,
        y,
        coins: 0,
      })

      //Remove me from Firebase when I diconnect
      playerRef.onDisconnect().remove();

      //Begin the game now that we are signed in
      initGame();
    } else {
      //You're logged out.
    }
  })

  firebase.auth().signInAnonymously().catch((error) => {
    var errorCode = error.code;
    var errorMessage = error.message;
    // ...
    console.log(errorCode, errorMessage);
  });


})();
```
## References

- [Build a Multiplayer Game with JavaScript &amp; Firebase](https://www.youtube.com/watch?v=xhURh2RDzzg)
- [Multiplayer Game](https://github.com/Haddley/haddley.github.io/raw/main/firebase-multiplayer-demo-upload-4-18-22.zip)

---

## mysql

**Source file:** `mysql.md`

---
title: "MySQL"
description: "Connecting to MySQL from JavaScript"
date: "2021-11-14"
categories: ["SQL"]
tags: []
slug: "mysql"
image: "/assets/images/includes-mysql-5646x2872.png"
---


## Install MySQL Driver

```bash
% npm install mysql
```


![](/assets/images/mysql/screen-shot-2021-11-14-at-11.39.51-am-1836x992.png)
*SELECT COUNT(*) AS usercount FROM users*


## async await

```bash
% npm install promise-mysql
```


![](/assets/images/mysql/screen-shot-2021-11-14-at-4.31.21-pm-1836x1050.png)
*SELECT COUNT(*) AS usercount FROM users*
## References

- [Node.js MySQL](https://www.w3schools.com/nodejs/nodejs_mysql.asp)

---

## nextjs1

**Source file:** `nextjs1.md`

---
title: "Next.js (Part 1)"
description: "The React Framework for Production"
date: "2021-11-05"
categories: ["JavaScript","React"]
tags: []
slug: "nextjs1"
image: "/assets/images/2560px-nextjs-logo.svg-1536x920.png"
---


## create-next-app

npx create-next-app nextjs-blog --use-npm --example "https://github.com/vercel/next-learn/tree/master/basics/learn-starter"

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.06.36-pm-1140x742.png)
*npx create-next-app nextjs-blog --use-npm --example "https://github.com/vercel/next-learn/tree/master/basics/learn-starter"*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.07.13-pm-1138x744.png)
*npm run dev*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.07.50-pm-1746x1196.png)
*accessing nextjs-blog*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.09.08-pm-1142x740.png)
*npm run dev*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.11.11-pm-884x696.png)
*create the about page*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.11.35-pm-1108x380.png)
*React Functional Export Component (frce)*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.12.08-pm-994x532.png)
*notice that the React from 'react' import is not needed*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.12.46-pm-764x302.png)
*accessing the about page*


## Link component

The Link component is used to enable client-side navigation between pages.

Here I have used the Link component to improve performance of page navigation between the index and second-post pages in a posts folder.

In a production build Next.js automatically prefetches the code for linked pages in the background.

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.16.50-pm-644x340.png)
*creating a posts folder*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.28.23-pm-1836x887.png)
*Network traffic when <a href=...> tag is used*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-6.28.41-pm-1836x884.png)
*Network traffic when Link component is used*


## public folder

Public files are added the project's public folder

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-7.42.29-pm-1836x1133.png)
*profile.jpeg*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-7.43.26-pm-1836x884.png)
*accessing the profile.jpeg file*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-7.49.46-pm-1768x1064.png)
*a page with a next/image component*


## Metadata

The 'next/head' component can be used to set the <title> tag for a Next.js page.

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-8.00.51-pm-1126x422.png)
*Page title is 'Posts'*


## CSS Modules

Next.js supports CSS Modules using the [name].module.css file naming convention.

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-9.47.27-pm-1836x960.png)
*CSS Modules*

![](/assets/images/nextjs1/screen-shot-2021-11-05-at-9.52.59-pm-1766x1068.png)
*first-post page with CSS Modules component added*


## Styled Components

Styled Components is a CSS-in-JS tool that lets developers write CSS in JavaScript files.

I ran the following commands to install styled-components.

$ npm install styled-components
$ npm install --save-dev babel-plugin-styled-components

I added a .bablerc file with this content

{
    "presets": ["next/babel"],
    "plugins": [["styled-components", {"ssr":true}]]
}

Finally I copied the _document.js file from: [https://github.com/vercel/next.js/blob/canary/examples/with-styled-components/pages/_document.js](https://github.com/vercel/next.js/blob/canary/examples/with-styled-components/pages/_document.js) to the project's /pages folder

see also: [https://github.com/vercel/next.js/tree/canary/examples/with-styled-components](https://github.com/vercel/next.js/tree/canary/examples/with-styled-components)

![](/assets/images/nextjs1/screen-shot-2021-11-06-at-4.53.54-pm-1836x1057.png)
*Styled Components*

![](/assets/images/nextjs1/screen-shot-2021-11-06-at-11.52.18-am-1782x1076.png)
*second-post page with styled-component added*


## about.js

```text
function about() {
    return (
        <div>
            About
        </div>
    )
}

export default about
```

## index.js first-post.js and second-post.js

```text
// index.js
import Link from 'next/link'

function index() {
    return (
        <>
            <div>
                <a href='/posts/first-post'>first</a>
            </div>
            <div>
                <Link href='/posts/second-post'>
                    <a>second</a>
                </Link>
            </div>
        </>
    )
}

export default index

// first-post.js
function firstpost() {
    return (
        <div>
            First Post
            <div>
                    <a href='/posts'>home</a>
            </div>
        </div>
    )
}

export default firstpost

//second-post.js
import Link from 'next/link'

function secondpost() {
    return (
        <div>
            Second Post
            <div>
                <Link href='/posts'>
                    <a>home</a>
                </Link>
            </div>
        </div>
    )
}

export default secondpost
```

## image.js

```text
import Image from 'next/image'

function image() {
    return (
        <Image
            src="/images/profile.jpeg" // Route of the image file
            height={144} // Desired size with correct aspect ratio
            width={144} // Desired size with correct aspect ratio
            alt="Your Name"
        />
    )
}

export default image
```

## index.js

```text
import Link from 'next/link'
import Head from 'next/head'

function index() {
    return (
        <>
            <Head>
                <title>Posts</title>
            </Head>
            <div>
                <a href='/posts/first-post'>first</a>
            </div>
            <div>
                <Link href='/posts/second-post'>
                    <a>second</a>
                </Link>
            </div>
        </>
    )
}

export default index
```

## layout.module.css layout.js and first-post.js

```text
// layout.module.css
.container {
    max-width: 36rem;
    padding: 0 1rem;
    margin: 3rem auto 6rem;
  }

// layout.js
import styles from './layout.module.css'

export default function Layout({ children }) {
  return <div className={styles.container}>{children}</div>
}

// first-post.js
import Layout from '../../components/layout'

function firstpost() {
    return (
        <Layout>
            <div>
                First Post
                <div>
                    <a href='/posts'>home</a>
                </div>
            </div>
        </Layout>
    )
}

export default firstpost
```

## layout2.js and second-post.js

```yaml
// layout2.js

import styled from "styled-components";

const Layout2 = styled.div`
max-width: 36rem;
padding: 0 1rem;
margin: 3rem auto 6rem;
`;

export default Layout2 

// second-post.js

import Link from 'next/link'
import Layout2 from '../../components/layout2'

function secondpost() {
    return (
        <Layout2>
            <div>
                Second Post
                <div>
                    <Link href='/posts'>
                        <a>home</a>
                    </Link>
                </div>
            </div>
        </Layout2>
    )
}

export default secondpost
```

---

## nextjs2

**Source file:** `nextjs2.md`

---
title: "Next.js (Part 2)"
description: "getStaticProps, getServerSideProps, getStaticPaths and useSWR"
date: "2021-11-06"
categories: ["React"]
tags: []
slug: "nextjs2"
image: "/assets/images/2560px-nextjs-logo.svg-1536x920.png"
---


## Pre-rendering

Next.js has two forms of pre-rendering: Static Generation and Server-side Rendering. The difference is in when Next.js generates the HTML for a page.

Static Generation is a pre-rendering approach that generates the HTML pages at build time.

Server-side Rendering is a pre-rendering approach that generates the HTML on each request.

You can create a Next.js app that uses Static Generation for some pages and Server-side Rendering for others.


## Static Generation (with data)

In Next.js, after exporting a page function, a developer can export a getStaticProps function.

A getStaticProps runs at build time.


## getStaticProps

A getStaticProps function can be used to generate a page based on data returned by a web service call*.

* [You should not fetch an API Route from getStaticProps or getStaticPaths](https://nextjs.org/learn/basics/api-routes/api-routes-details). Instead, write your server-side code directly in getStaticProps or getStaticPaths (or call a helper function).

![](/assets/images/nextjs2/screen-shot-2021-11-06-at-6.18.26-pm-1486x906.png)
*getStaticProps*


## getServerSideProps

A getServerSideProps function is used at runtime to build a page in response to a request (with or without caching).

![](/assets/images/nextjs2/screen-shot-2021-11-06-at-6.26.46-pm-1492x908.png)
*getServerSideProps*


## getStaticPaths

getStaticProps and getStaticPaths can be used together to generate multiple pages.

![](/assets/images/nextjs2/screen-shot-2021-11-06-at-6.57.55-pm-1490x906.png)
*getStaticProps and getStaticPaths being used together*


## next export

next export can be used to generate html pages that can be uploaded to a static web server.

$ npm run export

![](/assets/images/nextjs2/screen-shot-2021-11-06-at-7.29.43-pm-1836x1051.png)
*npm run export*

![](/assets/images/nextjs2/screen-shot-2021-11-06-at-7.35.14-pm-1836x942.png)
*out folder with generated pages*

![](/assets/images/nextjs2/screen-shot-2021-11-06-at-7.31.45-pm-1486x908.png)
*/out/articles/36*


## useSWR

Once the server-side rendered parts of a page have been downloaded JavaScript running on the page can fetch data and populate the remaining parts of the page (client-side).

$ npm install swr


## Catch all routes

Dynamic routes can be extended to catch all paths by adding three dots (...) inside the brackets. For example:

pages/post/[...slug].js matches /post/a, but also /post/a/b, /post/a/b/c and so on.

pages/fullname/[...slug]/index.js matches /fullname/neil, but also /fullname/neil/haddley, /fullname/neil/leonard/haddley and so on.

You can use names other than slug, such as: [...param]

![](/assets/images/nextjs2/screen-shot-2021-11-07-at-9.14.45-am-1380x791.png)
*Client-side code*

![](/assets/images/nextjs2/screen-shot-2021-11-07-at-9.15.03-am-1380x785.png)
*Catch all routes*


## pagesarticlesindex.js

```text
function index({ articles }) {
    return (
        <div>
            <ul>
                {articles.map(article => (<li key={article.id}>{article.title}</li>))}
            </ul>
        </div>
    )
}

export default index

export const getStaticProps = async () => {
    const res = await fetch('https://jsonplaceholder.typicode.com/posts?_limit=6')
    const articles = await res.json();

    return {
        props: {
            articles: articles
        }
    }
}
```

## pagesarticlesidindex.js

```text
function article({ article }) {

    return (
        <div>
            <h1>{article.title}</h1>
            This is article {article.id}
            <p>{article.body}</p>
        </div>
    )
}

export default article

export const getServerSideProps = async (context) => {
    const res = await fetch(`https://jsonplaceholder.typicode.com/posts/${context.params.id}`)
    const article = await res.json()
    return {
        props: {
            article: article
        }
    }
}
```

## pagesarticlesidindex.js

```text
function article({ article }) {

    return (
        <div>
            <h1>{article.title}</h1>
            This is article {article.id}
            <p>{article.body}</p>
        </div>
    )
}

export default article

export const getStaticProps = async (context) => {
    const res = await fetch(`https://jsonplaceholder.typicode.com/posts/${context.params.id}`)
    const article = await res.json()

    return {
        props: {
            article: article
        }
    }
}

export const getStaticPaths = async () => {
    const res = await fetch(`https://jsonplaceholder.typicode.com/posts`)
    const articles = await res.json()
    const ids = articles.map(article => (article.id))
    const paths = ids.map(id => ({ params: { id: id.toString() } }))

    return {
        paths,
        fallback: false
    }
}
```

## pagesarticlesidindex.js

```yaml
import {useRouter} from 'next/router'
import useSWR from 'swr'

function article() {

    const router = useRouter()
    const {id} = router.query

    if (!id) return <div>waiting...</div>

    const fetcher = (...args) => fetch(...args).then(res => res.json())

    const { data, error } = useSWR(`https://jsonplaceholder.typicode.com/posts/${id}`, fetcher)

    if (error) return <div>failed to load</div>
    if (!data) return <div>loading...</div>
    
    return (
        <div>
            <h1>{data.title}</h1>
            This is article {data.id}
            <p>{data.body}</p>
        </div>
    )
}

export default article
```

## pagesfullname...slugindex.js

```text
import {useRouter} from 'next/router'

function name() {

    const router = useRouter()
    const {slug} = router.query

    if (!slug) return <div>waiting...</div>

    return (
        <div>
            <h1>{slug.join(' ')}</h1>
        </div>
    )
}

export default name
```

---

## nextjs3

**Source file:** `nextjs3.md`

---
title: "Next.js (Part 3)"
description: "API routes and next-auth"
date: "2021-11-07"
categories: ["JavaScript","React"]
tags: []
slug: "nextjs3"
image: "/assets/images/2560px-nextjs-logo.svg-1536x920.png"
---


## Get Request

API routes let you create an API endpoint inside a Next.js app.

To create an API endpoint inside a Next.js app add a file (or folder) to the /pages/api directory

![](/assets/images/nextjs3/screen-shot-2021-11-07-at-11.01.17-am-1646x784.png)
*Get Request*


## Dynamic API routes

API routes can be dynamic, just like regular Next.js pages

![](/assets/images/nextjs3/screen-shot-2021-11-07-at-11.01.28-am-1648x790.png)
*Dynamic API Route*


## Unprotected pages

User login is not required to access all of the pages.

![](/assets/images/nextjs3/screen-shot-2021-11-10-at-7.59.37-am-1830x918.png)
*Unprotected page*


## next-auth

next-auth can be used to prevent unauthorized access to protected api methods and protected pages.

$npm install next-auth


## GitHub Id and GitHub Secret

Here I used [GitHub](https://docs.github.com/en/developers/apps/building-oauth-apps/creating-an-oauth-app) as an authentication provider.

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-12.52.06-pm-1536x1078.png)
*GitHub Developer Settings*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-12.54.01-pm-1536x1080.png)
*Register a new OAuth application*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-12.55.08-pm-1536x1078.png)
*Note the Client ID and Client Secret*


## .env

Maintain the Client ID and Client Secret values in an .env file


## [...nextauth]

Add a [...nextauth] api method


## _app.js

Add a 'next-auth/client' Provider to _app.js

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-6.52.44-pm-1436x1152.png)
*Provider*


## Add code to prevent unauthorized access

Ensure that a valid session exists before returning articles or article details (using a REST API call or a web page request)

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.05.14-pm-1536x801.png)
*/api/articles is now protected*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.10.18-pm-1536x803.png)
*/api/articles/4 is now protected*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.52.40-pm-1536x808.png)
*page /protected is now protected (server-side)*

![](/assets/images/nextjs3/screen-shot-2021-11-09-at-2.35.03-pm-1830x922.png)
*page /protected is now protected (client-side)*


## Adding login and logout to home page

Adding "Sign In" and "Sign Out" to home page.

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.15.04-pm-1536x803.png)
*Sign in*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.15.15-pm-1536x801.png)
*Sign in with GitHub provider*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.15.26-pm-1536x803.png)
*Signed in*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.15.44-pm-1536x802.png)
*authorized*

![](/assets/images/nextjs3/screen-shot-2021-11-08-at-7.15.55-pm-1536x804.png)
*authorized*

![](/assets/images/nextjs3/screen-shot-2021-11-10-at-8.26.00-am-1826x922.png)
*authorized*


## next-auth database (optional)

Specifying a database is optional if you don't need to persist user data or support email sign in. If you don't specify a database then JSON Web Tokens will be enabled for session storage and used to store session data.

To specify a database update the [...nextauth].js file (and a few environment variables).

![](/assets/images/nextjs3/screen-shot-2021-11-11-at-6.59.22-am-1836x1204.png)
*accounts*

![](/assets/images/nextjs3/screen-shot-2021-11-11-at-7.02.27-am-1836x1196.png)
*users*

![](/assets/images/nextjs3/screen-shot-2021-11-11-at-10.12.00-am-1836x986.png)
*session (with user id and provider)*

![](/assets/images/nextjs3/screen-shot-2021-11-11-at-6.17.31-pm-1734x1146.png)
*pages*


## articles.js and pagesapiarticlesindex.js

```text
// articles.js

export const articles = [
  {
    "userId": 1,
    "id": 1,
    "title": "sunt aut facere repellat provident occaecati excepturi optio reprehenderit",
    "body": "quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto"
  },
  {
    "userId": 1,
    "id": 2,
    "title": "qui est esse",
    "body": "est rerum tempore vitae\nsequi sint nihil reprehenderit dolor beatae ea dolores neque\nfugiat blanditiis voluptate porro vel nihil molestiae ut reiciendis\nqui aperiam non debitis possimus qui neque nisi nulla"
  }
]

// /pages/api/articles/index.js
import { articles } from '../../../articles'

const index = async (req, res) => {

    res.status(200).json(articles)

}

export default index
```

## pagesapiarticlesid.js

```text
// /pages/api/articles/[id].js
import {articles} from '../../../articles'

const article = async (req, res) => {

    const { query: { id } } = req

    const article = articles.find(a => a.id.toString() === id)

    if (!article) {
        res.status(404).json({ message: `article ${id} not found` })
    }

    res.status(200).json(article)

}

export default article
```

## pagesunprotected

```text
import { articles } from '../articles'

function index() {

    return (
        <div>
            <ul>
                {articles.map(article => (<li key={article.id}>{article.title}</li>))}
            </ul>
        </div>
    )
}

export default index
```

## .env

```text
//.env
NEXTAUTH_GITHUB_ID=e95a2816a93e7daabc6c
NEXTAUTH_GITHUB_SECRET=<secret>
```

## apiauth...nextauth.js

```text
// /api/auth/[...nextauth].js
import NextAuth from "next-auth";
import Providers from "next-auth/providers";

const options = {
    // @link https://next-auth.js.org/configuration/providers
    providers: [
        Providers.GitHub({
            clientId: process.env.NEXTAUTH_GITHUB_ID,
            clientSecret: process.env.NEXTAUTH_GITHUB_SECRET,            
        }),
        /*Providers.Google({
            clientId: process.env.NEXTAUTH_GOOGLE_ID,
            clientSecret: process.env.NEXTAUTH_GOOGLE_SECRET,
        }),
        Providers.Facebook({
            clientId: process.env.NEXTAUTH_FACEBOOK_ID,
            clientSecret: process.env.NEXTAUTH_FACEBOOK_SECRET,
        }),*/
    ]
}

export default (req,res) => NextAuth(req,res,options)
```

## _app.js

```text
import { createGlobalStyle, ThemeProvider } from 'styled-components'
import { Provider } from "next-auth/client";

const GlobalStyle = createGlobalStyle`
  body {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
`

const theme = {
    colors: {
        primary: '#0070f3',
    },
}

export default function App({ Component, pageProps }) {
    return (
        <>
            <Provider session={pageProps.session}>
                <GlobalStyle />
                <ThemeProvider theme={theme}>
                    <Component {...pageProps} />
                </ThemeProvider>
            </Provider>
        </>
    )
}
```

## pagesapiarticlesindex.js updated

```text
import { articles } from '../../../articles'
import { getSession } from 'next-auth/client'

const index = async (req, res) => {

    const session = await getSession({ req });
    if (session) {
        res.status(200).json(articles)
    } else {
        res.status(401).json({ message: `please log in` })
    }

}

export default index
```

## pagesapiarticlesid.js updated

```text
import { articles } from '../../../articles'
import { getSession } from 'next-auth/client'

const article = async (req, res) => {

    const session = await getSession({ req });
    if (session) {
        const { query: { id } } = req
        const article = articles.find(a => a.id.toString() === id)
        if (!article) {
            res.status(404).json({ message: `article ${id} not found` })
        }
        res.status(200).json(article)
    } else {
        res.status(401).json({ message: `please log in` })
    }

}

export default article
```

## pagesprotected.js

```text
import { getSession } from "next-auth/client"
import { articles } from '../articles'

function index({ session, articles }) {

    // If no session exists, display access denied message
    if (!session) { return (<div>You need to be logged on</div>) }

    return (
        <div>
            <ul>
                {articles.map(article => (<li key={article.id}>{article.title}</li>))}
            </ul>
        </div>
    )
}

export default index

export const getServerSideProps = async (context) => {

    const session = await getSession(context);

    // If no session exists, display access denied message
    if (!session) {
        return {
            props: {
                session
            }
        }
    }

    return {
        props: {
            session,
            articles
        }
    }
}
```

## pagesprotected.js

```text
import { useSession } from "next-auth/client"
import useSWR from 'swr'

function index() {
    
    const [ session, loading ] = useSession()

  // When rendering client side don't display anything until loading is complete
  if (typeof window !== 'undefined' && loading) return null

  // If no session exists, display access denied message
  if (!session) { return  (<div>You need to be logged on</div>) }


  const fetcher = (...args) => fetch(...args).then(res => res.json())

    const { data, error } = useSWR('/api/articles', fetcher)

    if (error) return <div>failed to load</div>
    if (!data) return <div>loading...</div>
    
    return (
        <div>
            <ul>
                {data.map(article => (<li key={article.id}>{article.title}</li>))}
            </ul>
        </div>
    )

}

export default index
```

## pagesindex.js

```text
import { signIn, signOut, useSession } from 'next-auth/client'

export default function Home() {
  const [session, loading] = useSession()

  return (
    <>
      {!session && (<>
        Not signed in
        <br />
        <button onClick={signIn}>Sign In</button>
      </>)}
      {session && (<>
        Signed in as {session.user.email}
        <br />
        <button onClick={signOut}>Sign Out</button>
      </>)}
    </>
  )
}
```

## ...nextauth.js

```text
import NextAuth from "next-auth";
import { session } from "next-auth/client";
import Providers from "next-auth/providers";

const options = {
    // @link https://next-auth.js.org/configuration/providers
    providers: [
        Providers.GitHub({
            clientId: process.env.NEXTAUTH_GITHUB_ID,
            clientSecret: process.env.NEXTAUTH_GITHUB_SECRET,
        }),
        /*Providers.Google({
            clientId: process.env.NEXTAUTH_GOOGLE_ID,
            clientSecret: process.env.NEXTAUTH_GOOGLE_SECRET,
        }),
        Providers.Facebook({
            clientId: process.env.NEXTAUTH_FACEBOOK_ID,
            clientSecret: process.env.NEXTAUTH_FACEBOOK_SECRET,
        }),*/
    ],
    database: process.env.DB_URL,
    session: {
        jwt: true
    },
    jwt: {
        secret: process.env.JWT_SECRET
    },
    callbacks: {
        async jwt(token, user, account, profile, isNewUser) {
            console.log("token", token)
            console.log("user", user)
            console.log("account", account)
            console.log("profile", profile)
            console.log("isNewUser", isNewUser)
            if (user && user.id) {
                token.id = user.id
            }
            if (account && account.provider) {
                token.provider = account.provider
            }
            return token
        },
        async session(session, token) {
            session.user.id = token.id
            session.user.provider = token.provider
            return session
        }
    }
}

export default (req, res) => NextAuth(req, res, options)
```

## .env

```text
NEXTAUTH_GITHUB_ID=e95a2816a93e7daabc6c
NEXTAUTH_GITHUB_SECRET=<secret>

DB_USER=<user>
DB_PASSWORD=<password>
DB_URL=mongodb+srv://$DB_USER:$DB_PASSWORD@cluster0.gdnd5.mongodb.net/nextauthDB?retryWrites=true&w=majority
JWT_SECRET=<secret>
NEXTAUTH_URL=http://localhost:3000
```

---

## nextjs4

**Source file:** `nextjs4.md`

---
title: "Next.js (Part 4)"
description: "Deploying to Azure"
date: "2021-11-11"
categories: ["Azure","JavaScript","React",".NET"]
tags: []
slug: "nextjs4"
image: "/assets/images/2560px-nextjs-logo.svg-1536x920.png"
---


## Deploying a Next.js site to Azure

```bash
% npx create-next-app nextjs-blog --use-npm --example "https://github.com/vercel/next-learn/tree/master/basics/learn-starter"

% npm run dev
```


![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.25.59-pm-1126x734.png)
*npx create-next-app*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.27.44-pm-1836x986.png)
*localhost:3000*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.27.59-pm-1294x176.png)
*Azure App Service: Deploy to Web App*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.28.08-pm-1276x162.png)
*Select the folder to deploy*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.28.16-pm-1270x172.png)
*Create new Web App...*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.28.44-pm-1302x278.png)
*haddley-nextjs-blog*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.28.52-pm-1284x308.png)
*Node 14 LTS*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.28.58-pm-1272x248.png)
*Select a pricing tier*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.29.48-pm-1684x684.png)
*Deploying*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-2.35.07-pm-1836x993.png)
*Deployed*


## Articles

Create /articles and /articles/[id] pages


## Updated solution

Deploy update

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-3.05.58-pm-1066x688.png)
*Deploy*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-3.00.59-pm-944x204.png)
*Deployment completed*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-3.00.10-pm-1836x944.png)
*/articles*

![](/assets/images/nextjs4/screen-shot-2021-11-11-at-3.00.20-pm-1836x944.png)
*/articles/[id]*


## next-auth

```bash
% npm install next-auth
```


![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.59.47-am-1836x694.png)
*Deploy update to Azure*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-8.13.42-am-1836x1127.png)
*GitHub OAuth Application*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-5.40.25-pm-1836x937.png)
*next-auth URL, Client ID and Client Secret added to Azure App Service*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.55.17-am-1636x852.png)
*User must be signed in to access /articles*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.55.27-am-1632x846.png)
*User must be signed in to access /articles/1*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.46.54-am-1836x1037.png)
*Sign in*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.55.40-am-1626x842.png)
*Sign in with GitHub*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.47.17-am-1836x898.png)
*Authorize the Haddley Nextjs Blog app*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.47.33-am-1836x635.png)
*Authorize Haddley*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.55.52-am-1632x842.png)
*Signed in*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-10.56.07-am-1628x846.png)
*/articles page*

![](/assets/images/nextjs4/screen-shot-2021-11-12-at-11.02.13-am-1630x854.png)
*/articles/1 page*


## Azure Active Directory

The AzureADProvider from "next-auth/providers/azure-ad" can be used connect Nextjs and Azure Active Directory.

![](/assets/images/nextjs4/screen-shot-2022-01-13-at-11.11.13-am-1836x926.png)
*environment settings*

![](/assets/images/nextjs4/screen-shot-2022-01-13-at-11.14.22-am-1836x925.png)
*Application (client) ID, Directory (tenant) ID and 1 secret*

![](/assets/images/nextjs4/screen-shot-2022-01-13-at-11.14.42-am-1836x934.png)
*Client Secret*

![](/assets/images/nextjs4/screen-shot-2022-01-13-at-11.16.04-am-1836x983.png)
*Redirect URIs and Implicit flows*

![](/assets/images/nextjs4/screen-shot-2022-01-13-at-11.17.40-am-1836x1100.png)
*/api/auth/signin*


## pagesapiauth...nextauth.js pagesarticlesindex.js a...

```text
// /pages/api/auth/[...nextauth].js 
import NextAuth from "next-auth";
import Providers from "next-auth/providers";

const options = {
    providers: [
        Providers.GitHub({
            clientId: process.env.NEXTAUTH_GITHUB_ID,
            clientSecret: process.env.NEXTAUTH_GITHUB_SECRET,
        }),
    ],
}

export default (req, res) => NextAuth(req, res, options)

// /pages/articles/index.js 
import Link from 'next/link'
import { getSession } from 'next-auth/client'

function index({ session, articles }) {

    if (!session) { return (<div>You need to be logged on</div>) }
    
    return (
        <div>
            <ul>
                {articles.map(article => (<li key={article.id}>
                    <Link href={`/articles/${article.id}`}>
                        <a>{article.title}</a>
                    </Link>
                </li>))}
            </ul>
        </div>
    )
}

export default index

export const getServerSideProps = async (context) => {

    const session = await getSession(context);

    // If no session exists, display access denied message
    if (!session) {
        return {
            props: {
                session,
            }
        }
    }


    const res = await fetch('https://jsonplaceholder.typicode.com/posts')
    const articles = await res.json();

    return {
        props: {
            session,
            articles
        }
    }
}

// /pages/articles/[id]/index.js
import { getSession } from 'next-auth/client'

function article({ session, article }) {

    if (!session) { return (<div>You need to be logged on</div>) }

    return (
        <div>
            <h1>{article.title}</h1>
            This is article {article.id}
            <p>{article.body}</p>
        </div>
    )
}

export default article

export const getServerSideProps = async (context) => {

    const session = await getSession(context);

    // If no session exists, display access denied message
    if (!session) {
        return {
            props: {
                session,
            }
        }
    }
    
    const res = await fetch(`https://jsonplaceholder.typicode.com/posts/${context.params.id}`)
    const article = await res.json()
    return {
        props: {
            session,
            article
        }
    }
}
```

## ...nextauth.js updated

```text
import NextAuth from "next-auth";
import GihubProvider from "next-auth/providers/github"
import AzureADProvider from "next-auth/providers/azure-ad"

// https://haddleynexttodo.azurewebsites.net/api/auth/signin

// Authorization callback URL: https://haddleynexttodo.azurewebsites.net/api/auth/callback/github
// Authorization callback URL: https://haddleynexttodo.azurewebsites.net/api/auth/callback/azure-ad

export default NextAuth({
    providers: [
        GihubProvider({
            clientId: process.env.NEXTAUTH_GITHUB_ID, 
            clientSecret: process.env.NEXTAUTH_GITHUB_SECRET, 
        }),
        AzureADProvider({
            clientId: process.env.AZURE_AD_CLIENT_ID,
            clientSecret: process.env.AZURE_AD_CLIENT_SECRET,
            tenantId: process.env.AZURE_AD_TENANT_ID,
            authorization: { params: { scope: "openid email profile" } }, 
        })
    ],
    secret: process.env.NEXTAUTH_SECRET,
    debug: true
})
```

---

## nextjs5

**Source file:** `nextjs5.md`

---
title: "Next.js (Part 5)"
description: "next-pwa and ionic"
date: "2022-01-13"
categories: ["TypeScript","React",".NET"]
tags: []
slug: "nextjs5"
image: "/assets/images/2560px-nextjs-logo.svg-1536x920.png"
---


## next-pwa

next-pwa adds [Progressive Web Application](pwa.html) (PWA) features to Nextjs

shadowwalker provides examples apps based on [next-pwa](https://github.com/shadowwalker/next-pwa) 

A Nextjs project that includes the [ionic](ionic.html) web components can be created by running the command:

```bash
% npx create-next-app --example with-ionic-typescript --use-npm haddley-nextjs-ionic-pwa
```

The steps below demonstrate how next-pwa can be added to a with-ionic-typescript project

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.04.07-am-1836x919.png)
*example with-ionic-typescript*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.07.08-am-1836x924.png)
*npm run build copies the svg folder to public*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.13.21-am-1836x923.png)
*update next.config.js to include next-pwa (remove the svg copy)*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.14.10-am-1836x920.png)
*update gitignore so that generated files are ignored*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.14.56-am-1836x920.png)
*add an offline page*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.16.04-am-1836x923.png)
*add a manifest.json file (so that app can be installed)*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.19.45-am-1836x919.png)
*include the icons referenced in the manifest.json*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.24.12-am-1836x921.png)
*include a Nextjs _document.js file that includes a reference to the manifest.json file*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.34.43-pm-1836x1111.png)
*I needed to remove (unneeded) files from the svg folder...*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.34.17-am-1836x920.png)
*npm run build*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.34.35-am-1290x190.png)
*Create Azure Web App*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.34.45-am-1262x268.png)
*provide a name*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.34.58-am-1270x330.png)
*select a node version*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.35.08-am-1298x268.png)
*select a pricing tier*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-9.38.27-am-960x218.png)
*deploying...*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.39.13-pm-361x732.png)
*iPhone Simulator*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.39.30-pm-360x732.png)
*Accessing https://haddleynextjsionicpwa.azurewebsites.net using Safari*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.39.47-pm-357x730.png)
*Add to Home Screen*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.39.56-pm-357x733.png)
*Confirm application details*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.40.33-pm-358x734.png)
*Application on Home Screen*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.40.43-pm-360x736.png)
*Application running with an Internet connection*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.41.54-pm-359x735.png)
*Internet connection disabled*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.42.08-pm-357x735.png)
*Application running offline*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.43.18-pm-833x512.png)
*Accessing https://haddleynextjsionicpwa.azurewebsites.net using Chrome on a MacBook*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.43.28-pm-836x514.png)
*Installing application on MacBook*

![](/assets/images/nextjs5/screen-shot-2022-01-13-at-2.43.45-pm-759x605.png)
*Running application online or offline on MackBook*


## .gitignore

```text
**/public/workbox-*.js
**/public/sw.js
**/public/fallback-*.j
```

## _offline.js

```text
import Head from 'next/head'

export default () => (
  <>
    <Head>
      <title>next-pwa example</title>
    </Head>
    <h1>This is offline fallback page</h1>
    <h2>When offline, any page route will fallback to this page</h2>
  </>
)
```

## manifest.json

```text
{
    "name": "next-pwa",
    "short_name": "next-pwa",
    "display": "standalone",
    "orientation": "portrait",
    "theme_color": "#FFFFFF",
    "background_color": "#FFFFFF",
    "start_url": "/",
    "icons": [
      {
        "src": "/icons/android-chrome-192x192.png",
        "sizes": "192x192",
        "type": "image/png",
        "purpose": "any maskable"
      },
      {
        "src": "/icons/icon-512x512.png",
        "sizes": "512x512",
        "type": "image/png"
      }
    ]
  }
```

## _document.js

```text
import Document, { Html, Head, Main, NextScript } from 'next/document'

const APP_NAME = 'next-pwa example'
const APP_DESCRIPTION = 'This is an example of using next-pwa plugin'

export default class extends Document {
  static async getInitialProps(ctx) {
    return await Document.getInitialProps(ctx)
  }

  render() {
    return (
      <Html lang='en' dir='ltr'>
        <Head>
          <meta name='application-name' content={APP_NAME} />
          <meta name='apple-mobile-web-app-capable' content='yes' />
          <meta name='apple-mobile-web-app-status-bar-style' content='default' />
          <meta name='apple-mobile-web-app-title' content={APP_NAME} />
          <meta name='description' content={APP_DESCRIPTION} />
          <meta name='format-detection' content='telephone=no' />
          <meta name='mobile-web-app-capable' content='yes' />
          <meta name='theme-color' content='#FFFFFF' />
          {/* TIP: set viewport head meta tag in _app.js, otherwise it will show a warning */}
          {/* <meta name='viewport' content='minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no, viewport-fit=cover' /> */}
          
          <link rel='apple-touch-icon' sizes='180x180' href='/icons/apple-touch-icon.png' />
          <link rel='manifest' href='/manifest.json' />
          <link rel='shortcut icon' href='/favicon.ico' />
          <style>{
            `
            html, body, #__next {
              height: 100%;
            }
            #__next {
              margin: 0 auto;
            }
            h1 {
              text-align: center;
            }
            `
          }</style>
        </Head>
        <body>
          <Main />
          <NextScript />
        </body>
      </Html>
    )
  }
}
```

---

## ngrx

**Source file:** `ngrx.md`

---
title: "NGRX"
description: "haddley-ngrx"
date: "2022-11-27"
categories: ["Angular","React","TypeScript","JavaScript"]
tags: []
slug: "ngrx"
image: "/assets/images/ngrx.svg"
---


NgRx is inspired by the Redux pattern. 

NgRx stores a single state and uses actions to express state changes.

![](/assets/images/ngrx/state-management-lifecycle-1836x1033.png)
*NGRX state management lifecycle*


I installed the Angular command line interface using [npm](npm.html)

```bash
% npm i -g @angular/cli
```

I created a new Angular project using "ng new"

```bash
% ng new haddley-ngrx
```

![](/assets/images/ngrx/screen-shot-2022-11-27-at-3.16.50-pm-1150x684.png)
*ng new haddley-ngrx*


## State

The state of the haddley-ngrx application is a number between 1 and 6.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-3.48.37-pm-1836x256.png)
*The app component template displays the "value"*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-3.47.45-pm-1836x447.png)
*The app component class sets the "value"*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-3.42.02-pm-1836x589.png)
*The app component style ensures the value is big enough to see at a distance*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-3.42.08-pm-1254x596.png)
*A random number between 1 and 6.*


## (click)

Every time a user refreshes the haddley-ngrx app a random number is displayed.

I updated the code so that the number is updated in response to a mouse click.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.03.37-pm-1380x341.png)
*I added (click)="updateValue()" to app component template*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.05.03-pm-1380x343.png)
*I added code to update "this.value" to app component class*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.08.28-pm-1380x409.png)
*I refactored the code*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.09.00-pm-1380x423.png)
*I created a "valueBetween1And6" function*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.09.30-pm-1380x469.png)
*I updated the declaration of value to use the "valueBetween1And6" function*


## ng test

I ran "ng test" to check that the haddley-ngrx application was working properly.

Two tests passed and one test failed.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.31.42-pm-1836x361.png)
*ng test*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.32.24-pm-1836x969.png)
*karma page*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.36.09-pm-1836x803.png)
*'haddley-ngrx app is running'?*


## Updating the tests

In this case the haddley-ngrx app is working fine and the test is wrong.

I want the application to display a value between 1 and 6. 

I don't want the application to display 'haddley-ngrx app is running'.

So I updated the last test.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.45.52-pm-1836x584.png)
*app component should render a number between 1 and 6*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-4.43.54-pm-1836x254.png)
*ng test*


## Moving to NGRX

Using NGRX I moved "value" out of the app component and into a store.

I updated the app component to dispatch an Action in response to the (click) and to refresh the page content in response to a store Selector.


## Folders

I created a src/app/state folder and a src/app/state/dice folder.


## dice.actions

I created a dice actions typescript file and defined three actions: {roll, rollSuccess, and rollFailure}

The app component will dispatch a "roll" Action in response to a (click).

The app component will not dispatch the rollSuccess Action or the rollFailure Action.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-5.53.50-pm-1836x307.png)
*npm i @ngrx/store*


## dice.state

I created a dice state typescript file and defined a DiceState interface.

NGRX should not throw an exception in response to the app component dispatching an Action. 

Instead a Selector will return a result (to the component) indicating success or failure.

For completeness I have included a (nullable) error value in the DiceState interface.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-5.48.56-pm-1836x273.png)
*DiceState interface*


## dice.reducer

I created a dice reducer typescript file to specify how Actions will be processed.

The rollSuccess action updates the state.value to the number passed to it as a property.

The rollFailure action updates the state.error to the text passed to it as a property.

It might seem odd that the roll Action updates the state.error but does not update the state.value (see Effects below).

![](/assets/images/ngrx/screen-shot-2022-11-27-at-6.08.17-pm-1836x479.png)
*diceReducer*


## app.state

As my application grows it is likely that I will add features that are unrelated to dice.state. 

With that in mind I have created an app.state interface that can be used in the future to access dice.state and state related to other features.

I added an app.state typescript file to the state folder.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-6.54.08-pm-1836x235.png)
*app.state interface*


## dice.selectors

The app.component will access the dice state using selectors.

I added the dice.selectors typescript file and created the two selectors the app.component needs.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-6.58.27-pm-1836x501.png)
*dice.selectors*


## app.module

To get NGRX to work I needed to add two modules to the app.module file.

First I added StoreModule

![](/assets/images/ngrx/screen-shot-2022-11-27-at-7.04.48-pm-1836x579.png)
*adding StoreModule to app.module*


## Using the selectors

I updated app component template and app component class to make use of the selectDiceValue and selectDiceError selectors.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-7.31.49-pm-1836x714.png)
*app component class*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-7.33.16-pm-1836x144.png)
*app component template*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-7.36.00-pm-1260x586.png)
*ng serve -o(click) seems to do nothingrefreshing the page seems to work*


## ng test

After these updates the tests fail.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-7.39.36-pm-1836x1155.png)
*No provider for Store!*


## MockStore

To get the ng tests to pass we need to add a "mock store"

![](/assets/images/ngrx/screen-shot-2022-11-27-at-7.49.48-pm-1836x770.png)
*provideMockStore*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-7.51.03-pm-1836x653.png)
*ng test success*


## dice.effects

When the app component dispatches the "roll" Action the app component does not provide a value.

Without additional effort the roll Action is not in a position to update the state.

NGRX effects address this problem.

I created a DiceEffects class that responds to "roll" Actions.

When the DiceEffects class spots/notices/is notified of a roll Action it calculates a random value between 1 and 6 and then (some moments later) dispatches a corresponding rollSuccess or rollFailure Action.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-8.19.31-pm-1836x798.png)
*dice.effects*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-8.16.52-pm-1836x599.png)
*EffectsModule import added to AppModule*


## Final result

The final result is an Angular application that uses NGRX for state management.

![](/assets/images/ngrx/screen-shot-2022-11-27-at-8.20.53-pm-1836x1021.png)
*ng test*

![](/assets/images/ngrx/screen-shot-2022-11-27-at-8.23.22-pm-1256x592.png)
*ng serve -o*
## References

- [GitHub repository](https://github.com/Haddley/haddley-ngrx)

---

## ngrxdevtools

**Source file:** `ngrxdevtools.md`

---
title: "NGRX devtools"
description: "haddley-ngrx"
date: "2023-01-25"
categories: ["Angular"]
tags: []
slug: "ngrxdevtools"
image: "/assets/images/ngrx.svg"
---


I updated the version of @angular and @ngrx using in the haddley-ngrx project

```bash
% npm i

% ng update

% ng update @angular/cli
% ng update @ngrx/store

```

I added support for NGRX devtools using "ng add"

```bash
% ng add @ngrx/store-devtools@latest
```

I added the corresponding chrome extension from

**https://github.com/reduxjs/redux-devtools/
**

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-1.02.21-pm-1380x1013.png)
*setup instructions*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-1.50.27-pm-1822x1047.png)
*ng update @angular/cli*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-1.52.17-pm-1822x1056.png)
*ng update @angular/core ng update @ngrx/store*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-1.53.07-pm-1822x308.png)
*ng add @ngrx/store-devtools@latest*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-1.58.00-pm-1822x1078.png)
*chrome devtools extension*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-2.01.37-pm-1822x858.png)
*reviewing store state and actions*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-2.01.56-pm-1822x788.png)
*clicking the dice to roll*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-2.03.03-pm-1822x855.png)
*clicking (pin) to focus on dice/value*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-2.03.33-pm-1822x847.png)
*replaying actions and reviewing dice/value updates*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-2.03.52-pm-1822x787.png)
*Using Jump to navigate to an action*

![](/assets/images/ngrxdevtools/screen-shot-2023-01-25-at-2.04.27-pm-1822x792.png)
*Using Jump to navigate to review previous state corresponding with an older action*


## Dispatch

![](/assets/images/ngrxdevtools/screen-shot-2023-02-05-at-9.56.59-am-1836x1040.png)
*Dispatch*
## References

- [GitHub repository](https://github.com/Haddley/haddley-ngrx)

---

## ngrxentity

**Source file:** `ngrxentity.md`

---
title: "NGRX entity"
description: "json-server"
date: "2023-02-18"
categories: ["TypeScript","React","Angular","JavaScript"]
tags: []
slug: "ngrxentity"
image: "/assets/images/ngrx.svg"
---

I extended my haddley-ngrx project to include support for posts.

I used json-server to create a simple api

```bash
% npm i json-server

```

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-3.21.40-pm-1536x284.png)
*npm i json-server*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-3.22.53-pm-1536x503.png)
*Github co-pilot suggested an addition to the scripts section of package.json*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-3.26.07-pm-1536x676.png)
*I created a db.json in the project's root folder*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-3.27.45-pm-1536x717.png)
*I started the server by running npm run server*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-3.28.45-pm-1420x744.png)
*I used chrome to request details of all posts.*


## Accessing the server

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-4.11.54-pm-1536x433.png)
*ng generate service services/post*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-4.13.08-pm-1536x913.png)
*ng test*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-4.16.26-pm-1536x356.png)
*providedIn: 'root' (no need to add service to app.module.ts)*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-4.21.24-pm-1536x574.png)
*co-pilot suggests creating a post.model file (why not?)*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-4.23.22-pm-1536x351.png)
*co-pilot suggests that we include a body field (why not?)*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-5.21.38-pm-1536x615.png)
*co-pilot suggests that we include a deletePost method (why not)*

![](/assets/images/ngrxentity/screen-shot-2023-02-19-at-6.33.32-pm-1536x552.png)
*imports HttpClientModule*


## Testing a service

Initially I wrote tests that called the running json-server.

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-10.33.14-am-1536x746.png)
*Executed 6 of 6 success*

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-10.32.47-am-1536x849.png)
*Karma results in a web page*

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-10.33.29-am-1536x846.png)
*The json-server shows the POST, DELETE and GET requests*


## Mock the HTTP client

I installed jasmine-auto-spies.

```bash
% npm i --include=dev jasmine-auto-spies
```

I updated the tests to use the mock.

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-10.56.26-am-1536x141.png)
*npm i --include=dev jasmine-auto-spies*

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-11.32.27-am-1536x782.png)
*Executed 6 of 6 success*

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-11.32.46-am-1536x486.png)
*Karma results in a web page*


Entity provides an API to manipulate and query entity collections.

Reduces boilerplate for creating reducers that manage a collection of models.
Provides performant CRUD operations for managing entity collections.
Extensible type-safe adapters for selecting entity information.

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-3.08.35-pm-1536x498.png)
*Load Posts Success*

![](/assets/images/ngrxentity/screen-shot-2023-02-20-at-3.09.38-pm-1536x476.png)
*Load Posts Failure (service not running)*


## post.service.spec.ts

```text
import { HttpClient, HttpErrorResponse } from '@angular/common/http';
import { createSpyFromClass, Spy } from 'jasmine-auto-spies';
import { Post } from '../models/post.model';
import { PostService } from './post.service';
import { TestBed } from '@angular/core/testing';

describe('PostService', () => {
  let service: PostService;
  let httpSpy: Spy<HttpClient>;

  beforeEach(() => {
    TestBed.configureTestingModule({
      providers: [
        PostService,
        { provide: HttpClient, useValue: createSpyFromClass(HttpClient) }
      ]
    });

    service = TestBed.inject(PostService);
    httpSpy = TestBed.inject<any>(HttpClient);
  });

  it('should create a new post', (done: DoneFn) => {

    const newPost = { id: 100, title: "json-server100", author: "typicode", body: "some body100" } as Post;

    httpSpy.post.and.nextWith(newPost);

    service.addPost(newPost).subscribe(post => {
      expect(post).toEqual(newPost);
      done();
    });
    expect(httpSpy.post.calls.count()).toBe(1);
  });

  it('should return an existing post', (done: DoneFn) => {

    const existingPost = { id: 1, title: "json-server", author: "typicode", body: "some body" } as Post;
    const postId = existingPost.id;

    httpSpy.get.and.nextWith(existingPost);

    service.getPost(postId).subscribe(post => {
      expect(post).toEqual(existingPost);
      done();
    });

    expect(httpSpy.get.calls.count()).toBe(1);
  });

  it('should return a 404 if post does not exist', (done: DoneFn) => {

    const postId = 89776683;

    httpSpy.get.and.throwWith(new HttpErrorResponse({
      error: "404 - Not Found",
      status: 404
    }));

    service.getPost(postId).subscribe({
      next: (post) => {
        done.fail("Expected a 404");
      },
      error: (error) => {
        expect(error.status).toEqual(404);
        done();
      }
    });

    expect(httpSpy.get.calls.count()).toBe(1);
  });


});
```

## post.actions.ts

```text
import { createAction, props } from '@ngrx/store';
import { Post } from 'src/app/models/post.model';

export const loadPosts = createAction('[Posts] Load Posts');
export const loadPostsSuccess = createAction('[Posts] Load Posts Success', props<{ posts: Post[] }>());
export const loadPostsFailure = createAction('[Posts] Load Posts Failure', props<{ error: string }>());
```

## post.effect.ts

```text
import { Injectable } from "@angular/core";
import { catchError, exhaustMap, map, of } from "rxjs";
import { loadPosts, loadPostsFailure, loadPostsSuccess } from "./post.actions";
import { Actions, createEffect, ofType } from "@ngrx/effects";
import { PostService } from "src/app/services/post.service";

@Injectable()
export class PostEffects {

    constructor(private actions$: Actions, private postService: PostService) { }

    loadPosts$ = createEffect(() =>
        this.actions$.pipe(
            ofType(loadPosts),
            exhaustMap(() =>
                // call the service
                this.postService.getPosts().pipe(
                    // return a Success action when the HTTP request was successfull
                    map((posts) => loadPostsSuccess({ posts: posts })),
                    // return a Failed action when something went wrong during the HTTP request
                    catchError((error) => of(loadPostsFailure({ error: 'http error' }))),
                ),
            ),
        )
    );
}
```

## post.reducer.ts

```text
import {
    createEntityAdapter,
    EntityAdapter,
    EntityState
} from '@ngrx/entity';
import { Post } from '../../models/post.model';
import { createReducer, on } from '@ngrx/store';
import { loadPostsFailure, loadPostsSuccess } from './post.actions';

export interface PostState extends EntityState<Post> {
    // additional entities state properties
    currentPostId: number | null;
    error: any;
}

export const postAdapter: EntityAdapter<Post> = createEntityAdapter<Post>();

export const initialState: PostState = postAdapter.getInitialState({
    currentPostId: null,
    error: null
});

export const postReducer = createReducer(
    initialState,
    on(loadPostsSuccess, (state, { posts }) => {
        return postAdapter.setAll(posts, {...state,error:null});
    }),
    on(loadPostsFailure, (state, { error }) => {
        return { ...state, error};
    })

)
```

## post.selector.ts

```text
import { createSelector } from "@ngrx/store";
import { AppState } from "../app.state";
import { postAdapter, PostState } from "./post.reducer";

export const selectPosts = (state: AppState) => state.posts;

export const { selectIds, selectEntities, selectAll, selectTotal } = postAdapter.getSelectors();

export const selectAllPosts = createSelector(selectPosts, selectAll);

export const selectEntitiesPosts = createSelector(selectPosts, selectEntities);

export const selectTotalPosts = createSelector(selectPosts, selectTotal);

export const selectIdsPosts = createSelector(selectPosts, selectIds);

export const selectError = createSelector(
    selectPosts,
    (state: PostState) => state.error
);
```

## app.component.html

```text
<div class="dice" (click)="updateValue()" *ngIf="value$|async as value">{{value}}</div>

<div *ngIf="postsError$ | async as postsError; else loaded">
    <p>There was an error loading the posts</p>
    <p>{{postsError}}</p>
</div>

<ng-template #loaded>
    <table>
        <thead>
            <th>Title</th>
            <th>Author</th>
            <th>Body</th>
        </thead>
        <tbody>
            <tr *ngFor="let post of posts$ | async">
                <td>{{post.title}}</td>
                <td>{{post.author}}</td>
                <td>{{post.body}}</td>
            </tr>
        </tbody>
    </table>
</ng-template>
```

## app.component.ts

```text
import { Component, OnInit } from '@angular/core';
import { selectDiceError } from './state/dice/dice.selectors';
import { selectDiceValue } from './state/dice/dice.selectors';
import { Store } from '@ngrx/store';
import { roll} from './state/dice/dice.actions';
import { AppState } from './state/app.state';
import { selectAllPosts, selectEntitiesPosts, selectTotalPosts, selectIdsPosts, selectError } from './state/post/post.selector';
import { loadPosts } from './state/post/post.actions';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.scss']
})
export class AppComponent implements OnInit {

    // random number beteen 1 and 6
    value$ = this.appStore.select(selectDiceValue);
    error$ = this.appStore.select(selectDiceError);

    // posts
    posts$ = this.appStore.select(selectAllPosts);
    postsError$ = this.appStore.select(selectError);

  constructor(private appStore: Store<AppState>) {}

  updateValue() {
    this.appStore.dispatch(roll());
  }

  ngOnInit() {
    this.appStore.dispatch(loadPosts());
  }

  title = 'haddley-ngrx';

}
```

---

## npm

**Source file:** `npm.md`

---
title: "npm JavaScript"
description: "Create and publish an npm module using JavaScript."
date: "2021-02-25"
categories: ["JavaScript","DevOps"]
tags: []
slug: "npm"
image: "/assets/images/6078720-200x200.png"
---


## Recursion

*When a function is called, the computer must "remember" the place it was called from... so that it can return to that location with the result once the call is complete. Typically, this information is saved on the call stack... For tail calls, there is no need to remember the caller...*

[https://en.wikipedia.org/wiki/Tail_call](https://en.wikipedia.org/wiki/Tail_call)

Some interpreters (and compilers) eliminate the stack frame creation and destruction work when they recognize tail recursion.


## JavaScript

Create a folder for the *new* node module.

$ mkdir haddley-factorial-js

Navigate to the new folder

$ cd haddley-factorial-js

Create a package.json file 

$ npm init -y

![](/assets/images/npm/screen-shot-2021-02-27-at-10.44.11-am-1824x1090.png)
*Image Description*


## Mocha and Chai

Automated testing is added using mocha and chai.

$ npm i --save-dev mocha

$ npm i --save-dev chai

$ mkdir test

![](/assets/images/npm/screen-shot-2021-02-27-at-11.24.32-am-1824x1246.png)
*npm test*


## package.json

This is final package.json file


## Github actions

Github actions ensure that testing is performed using multiple versions of node.

![](/assets/images/npm/screen-shot-2021-02-27-at-11.37.09-am-1836x757.png)
*Tests are running*

![](/assets/images/npm/screen-shot-2021-02-27-at-11.37.29-am-1836x749.png)
*Code passed all of the provided tests*

![](/assets/images/npm/screen-shot-2021-02-27-at-11.38.33-am-1836x809.png)
*Test results for multiple versions of node*


## Publishing to npmjs.com

To publish the module to npmjs.com

$ node login

$ node publish

![](/assets/images/npm/screen-shot-2021-02-27-at-11.50.49-am-1818x1240.png)
*npm publish*


## index.js

```javascript
const factorial = (n) => {
    if (n < 2) return 1;
    return n * factorial(n - 1);
}

exports.factorial = factorial

const factorial_tr = (n) => {

    function fact(n, acc) {
        if (n < 2) return acc;
        return fact(n - 1, n * acc);
    }

    return fact(n, 1)
}

exports.factorial_tr = factorial_tr

const factorial_it = (n) => {

    let acc = 1

    for (i = n; i > 1; i--) {
        acc = acc * i
    }

    return acc
}

exports.factorial_it = factorial_it
```

## testtest.js

```javascript
var module = require('../index')
var expect = require('chai').expect;

describe('#factorial()', function () {

    // test recursive function
    it('should calculate factorial of 9 using recursion', function () {
        // add an assertion
        expect(module.factorial(9)).to.equal(362880);
    })

    // test tail recursion version
    it('should calculate factorial of 9 using tail recursion', function () {
        // add an assertion
        expect(module.factorial_tr(9)).to.equal(362880);
    })

    // test iteration version
    it('should calculate factorial of 9 using iteration', function () {
        // add an assertion
        expect(module.factorial_it(9)).to.equal(362880);
    })

    // test tail recursion version
    it('should calculate factorial of 170 using recursion', function () {
        // add an assertion
        expect(module.factorial(170)).to.equal(7.257415615307994e+306);
    })

    // test tail recursion version
    it('should calculate factorial of 170 using tail recursion', function () {
        // add an assertion
        expect(module.factorial_tr(170)).to.equal(7.257415615308004e+306);
    })

    // test iteration version
    it('should calculate factorial of 170 using iteration', function () {
        // add an assertion
        expect(module.factorial_it(170)).to.equal(7.257415615308004e+306);
    })

    // test tail recursion version
    it('should calculate factorial of 171 using recursion', function () {
        // add an assertion
        expect(module.factorial(171)).to.equal(Infinity);
    })

    // test tail recursion version
    it('should calculate factorial of 171 using tail recursion', function () {
        // add an assertion
        expect(module.factorial_tr(171)).to.equal(Infinity);
    })

    // test iteration version
    it('should calculate factorial of 171 using iteration', function () {
        // add an assertion
        expect(module.factorial_it(171)).to.equal(Infinity);
    })

    // test recursive function
    it('should calculate factorial of 10000 using recursion', function () {
        this.timeout(10000);
        // add an assertion
        expect(module.factorial(10000)).to.equal(Infinity);
    })

    // test recursive function
    it('should calculate factorial of 10000 using tail recursion', function () {
        this.timeout(10000);
        // add an assertion
        expect(module.factorial_tr(10000)).to.equal(Infinity);
    })

    // test recursive function
    it('should calculate factorial of 1600000 using iteration', function () {
        this.timeout(10000);
        // add an assertion
        expect(module.factorial_it(1600000)).to.equal(Infinity);
    })


})
```

## package.json

```javascript
{
  "name": "haddley-factorial-js",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "mocha"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/Haddley/haddley-factorial-js.git"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "bugs": {
    "url": "https://github.com/Haddley/haddley-factorial-js/issues"
  },
  "homepage": "https://github.com/Haddley/haddley-factorial-js#readme",
  "devDependencies": {
    "chai": "^4.3.0",
    "mocha": "^8.3.0"
  }
}
```

## node.js.yml

```javascript
# This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Node.js CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [10.x, 12.x, 14.x, 15.x]
        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/

    steps:
    - uses: actions/checkout@v2
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ matrix.node-version }}
    - run: npm ci
    - run: npm run build --if-present
    - run: npm test
```

---

## npmcc

**Source file:** `npmcc.md`

---
title: "npm C++"
description: "Create and publish an npm module using C++."
date: "2021-02-26"
categories: ["JavaScript","DevOps"]
tags: []
slug: "npmcc"
image: "/assets/images/6078720-200x200.png"
---


## Recursion

*When a function is called, the computer must "remember" the place it was called from... so that it can return to that location with the result once the call is complete. Typically, this information is saved on the call stack... For tail calls, there is no need to remember the caller...*

[https://en.wikipedia.org/wiki/Tail_call](https://en.wikipedia.org/wiki/Tail_call)

Some interpreters (and compilers) eliminate the stack frame creation and destruction work when they recognize tail recursion.


## C++

Create a folder for the *new* node module.

$ mkdir haddley-factorial-cc

Navigate to the new folder

$ cd haddley-factorial-cc

Create a package.json file 

$ npm init -y


## Mocha and Chai

Automated testing is added using mocha and chai.

$ npm i --save-dev mocha

$ npm i --save-dev chai

$ mkdir test

![](/assets/images/npmcc/screen-shot-2021-02-27-at-12.55.34-pm-1790x1188.png)
*npm test*


## package.json

This is the final package.json file


## Github actions

Github actions ensure that testing is performed using multiple versions of node.

![](/assets/images/npmcc/screen-shot-2021-02-27-at-6.04.35-pm-1836x745.png)
*Tests are running*

![](/assets/images/npmcc/screen-shot-2021-02-27-at-6.05.09-pm-1836x757.png)
*Code passed all of the provided tests*

![](/assets/images/npmcc/screen-shot-2021-02-27-at-6.05.25-pm-1836x830.png)
*Test results for multiple versions of node*


## Publishing to npmjs.com

To publish the module to npmjs.com

$ node login

$ node publish

![](/assets/images/npmcc/screen-shot-2021-02-27-at-6.08.25-pm-1836x1284.png)
*npm publish*


## addon.c

```text
#include <assert.h>
#include <node_api.h>
#include <stdio.h>

double fac(int n)
{
  if (n < 2)
    return 1;
  return n * fac(n - 1);
}

double fac_tr_aux(int n, double acc)
{
  if (n < 2)
    return acc;
  return fac_tr_aux(n - 1, n * acc);
}

double fac_tr(int n)
{
  return fac_tr_aux(n, 1);
}

double fac_it(int n)
{
  double acc = 1;

  for (int i = n; i > 1; i--)
  {
    acc = acc * i;
  }

  return acc;
}

static napi_value Factorial_aux(napi_env env, napi_callback_info info, double (*funcp)(int))
{
  napi_status status;

  size_t argc = 1;
  napi_value args[1];
  status = napi_get_cb_info(env, info, &argc, args, NULL, NULL);
  assert(status == napi_ok);

  if (argc < 1)
  {
    napi_throw_type_error(env, NULL, "Wrong number of arguments");
    return NULL;
  }

  napi_valuetype valuetype0;
  status = napi_typeof(env, args[0], &valuetype0);
  assert(status == napi_ok);

  if (valuetype0 != napi_number)
  {
    napi_throw_type_error(env, NULL, "Wrong arguments");
    return NULL;
  }

  double value0;
  status = napi_get_value_double(env, args[0], &value0);
  assert(status == napi_ok);

  napi_value result;

  double res = funcp(value0);

  status = napi_create_double(env, res, &result);
  assert(status == napi_ok);

  return result;
}

static napi_value Factorial(napi_env env, napi_callback_info info)
{
  return Factorial_aux(env, info, &fac);
}

static napi_value Factorial_tr(napi_env env, napi_callback_info info)
{
  return Factorial_aux(env, info, &fac_tr);
}

static napi_value Factorial_it(napi_env env, napi_callback_info info)
{
  return Factorial_aux(env, info, &fac_it);
}

#define DECLARE_NAPI_METHOD(name, func)     \
  {                                         \
    name, 0, func, 0, 0, 0, napi_default, 0 \
  }

napi_value Init(napi_env env, napi_value exports)
{
  napi_status status;
  napi_property_descriptor desc[] = {
      DECLARE_NAPI_METHOD("factorial", Factorial),
      DECLARE_NAPI_METHOD("factorial_tr", Factorial_tr),
      DECLARE_NAPI_METHOD("factorial_it", Factorial_it)};

  status = napi_define_properties(env, exports, 3, desc);

  assert(status == napi_ok);

  return exports;
}

NAPI_MODULE(NODE_GYP_MODULE_NAME, Init)
```

## addon.js

```javascript
const addon = require('bindings')('addon.node')

exports.factorial = addon.factorial

exports.factorial_tr = addon.factorial_tr

exports.factorial_it = addon.factorial_it
```

## binding.gyp

```javascript
{
  "targets": [
    {
      "target_name": "addon",
      "sources": [ "addon.c" ]
    }
  ]
}
```

## testtest.js

```javascript
var module = require('../addon')
var expect = require('chai').expect;

describe('#factorial()', function () {


    // test recursive function
    it('should calculate factorial of 9 using recursion', function () {
        // add an assertion
        expect(module.factorial(9)).to.equal(362880);
    })

    // test tail recursion version
    it('should calculate factorial of 9 using tail recursion', function () {
        // add an assertion
        expect(module.factorial_tr(9)).to.equal(362880);
    })

    // test iteration version
    it('should calculate factorial of 9 using iteration', function () {
        // add an assertion
        expect(module.factorial_it(9)).to.equal(362880);
    })

    // test tail recursion version
    it('should calculate factorial of 170 using recursion', function () {
        // add an assertion
        expect(module.factorial(170)).to.equal(7.257415615307994e+306);
    })

    // test tail recursion version
    it('should calculate factorial of 170 using tail recursion', function () {
        // add an assertion
        expect(module.factorial_tr(170)).to.equal(7.257415615308004e+306);
    })

    // test iteration version
    it('should calculate factorial of 170 using iteration', function () {
        // add an assertion
        expect(module.factorial_it(170)).to.equal(7.257415615308004e+306);
    })

    // test tail recursion version
    it('should calculate factorial of 171 using recursion', function () {
        // add an assertion
        expect(module.factorial(171)).to.equal(Infinity);
    })

    // test tail recursion version
    it('should calculate factorial of 171 using tail recursion', function () {
        // add an assertion
        expect(module.factorial_tr(171)).to.equal(Infinity);
    })

    // test iteration version
    it('should calculate factorial of 171 using iteration', function () {
        // add an assertion
        expect(module.factorial_it(171)).to.equal(Infinity);
    })

    // test recursive function
    it('should calculate factorial of 200000 using recursion', function () {
        this.timeout(10000);
        // add an assertion
        expect(module.factorial(200000)).to.equal(Infinity);
    })

    // test recursive function
    it('should calculate factorial of 800000 using tail recursion', function () {
        this.timeout(10000);
        // add an assertion
        expect(module.factorial_tr(800000)).to.equal(Infinity);
    })

    // test recursive function
    it('should calculate factorial of 1600000 using iteration', function () {
        this.timeout(10000);
        // add an assertion
        expect(module.factorial_it(1600000)).to.equal(Infinity);
    })


})
```

## package.json

```javascript
{
  "name": "haddley-factorial-cc",
  "version": "1.0.0",
  "description": "",
  "main": "addon.js",
  "directories": {
    "test": "test"
  },
  "scripts": {
    "test": "mocha"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/Haddley/haddley-factorial-cc.git"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "bugs": {
    "url": "https://github.com/Haddley/haddley-factorial-cc/issues"
  },
  "homepage": "https://github.com/Haddley/haddley-factorial-cc#readme",
  "dependencies": {
    "bindings": "~1.2.1"
  },
  "devDependencies": {
    "chai": "^4.3.0",
    "mocha": "^8.3.0"
  }
}
```

## node.js.yml

```javascript
# This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Node.js CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [10.x, 12.x, 14.x, 15.x]
        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/

    steps:
    - uses: actions/checkout@v2
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ matrix.node-version }}
    - run: npm ci
    - run: npm run build --if-present
    - run: npm test
```

---

## nuget

**Source file:** `nuget.md`

---
title: "NuGet C#"
description: "Create, publish and consume a NuGet package using C#."
date: "2021-02-27"
categories: [".NET","DevOps"]
tags: []
slug: "nuget"
image: "/assets/images/logo-og-600x600.png"
---



## Recursion

*When a function is called, the computer must "remember" the place it was called from... so that it can return to that location with the result once the call is complete. Typically, this information is saved on the call stack... For tail calls, there is no need to remember the caller...*

[https://en.wikipedia.org/wiki/Tail_call](https://en.wikipedia.org/wiki/Tail_call)

Some interpreters (and compilers) eliminate the stack frame creation and destruction work when they recognize tail recursion.


## C#

Adding a "**HaddleyOffice365.dotnet-factorial**" package to NuGet.org.

NuGet is the package manager for .NET.

Start by creating a **dotnet-factorial** repository in the https://github.com/**HaddleyOffice365** profile.

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.09.52-pm-788x908.png)
*New repository will be named dotnet-factorial*

![](/assets/images/nuget/screen-shot-2021-02-28-at-1.10.13-pm-1048x348.png)
*Publish to GitHub*

![](/assets/images/nuget/screen-shot-2021-02-28-at-1.11.02-pm-1026x236.png)
*Open in Visual Studio Code*


## Create a .NET solution and the .NET projects

Create a dotnet solution

**$ dotnet new sln**

Create a class library project and add the new class library project to the solution

**$ dotnet new classlib -o dotnet-factorial
$ dotnet sln add ./dotnet-factorial/dotnet-factorial.csproj**

Create a test project and add the new test project to the solution

**$ dotnet new mstest -o unittests
$ dotnet sln add ./unittests/unittests.csproj**

At a reference from the unit tests project to the factorial project.

**$ dotnet add  ./unittests/unittests.csproj reference ./dotnet-factorial/dotnet-factorial.csproj **

Add a .gitignore file to the unit tests project directory and to the factorial project directory.

**$ cd dotnet-factorial
$ dotnet new gitignore
$ cd ../unittests
$ dotnet new gitignore
$ cd ..**

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.22.23-pm-1836x1105.png)
*new solution, new classlib project and new mstest project*


## Rename UnitTest1, copy and rename Class1

Rename the generated UnitTest1 class to "UnitTests"

Copy Class1 class and rename to "recursivefunctions.cs"
Rename the generated Class1 class to "iterativefunctions"

Update the file contents:


## dotnet test

use "dotnet test" to run the unit test locally on the development machine.

**$ dotnet test**

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.51.08-pm-1836x1108.png)
*dotnet test*


## Commit to main

Commit updates to the repository.

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.53.33-pm-1836x1251.png)
*Commit to main branch*

![](/assets/images/nuget/screen-shot-2021-02-28-at-2.26.08-pm-1072x276.png)
*Push origin*


## GitHub actions

A GitHub action will ensure that testing is performed automatically.

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.56.28-pm-1140x764.png)
*Add the ".NET By GitHub Actions" workflow*

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.57.11-pm-1836x871.png)
*GitHub action running*

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.58.00-pm-1708x360.png)
*GitHub action finished*

![](/assets/images/nuget/screen-shot-2021-03-01-at-5.58.27-pm-1836x956.png)
*GitHub action details*


## PackageLicenseExpression, PackageId and Version

Add PackageLicenseExpression, PackageId and Version tags to the Functions.csproj file

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.10.42-pm-1836x709.png)
*dotnet-factorial.csproj*


## dotnet pack

use "dotnet pack" to create .nupkg file

**$ dotnet pack**

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.13.36-pm-1836x703.png)
*dotnet pack*


## Listing the NuGet package

Upload the nupkg file to nuget.org.

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.20.15-pm-1836x971.png)
*+ Add new*

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.20.27-pm-1836x973.png)
*Browse...*

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.21.03-pm-1836x1055.png)
*Choose for Upload*

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.21.19-pm-1836x1055.png)
*Verify*

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.22.19-pm-1836x1049.png)
*Submit*

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.22.51-pm-1836x944.png)
*Successful upload. Status Validating*

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.31.45-pm-1836x962.png)
*Status Listed*


## Consuming the NuGet Package

**$ dotnet new console
$ dotnet new gitignore
$ dotnet add package HaddleyOffice365.dotnet-factorial --version 1.0.0**

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.50.49-pm-1836x1229.png)
*dotnet add package HaddleyOffice365.dotnet-factorial --version 1.0.0*


## dotnet run

**$ dotnet run**

![](/assets/images/nuget/screen-shot-2021-03-01-at-6.54.50-pm-1836x1229.png)
*dotnet run*


## UnitTests.cs

```text
using Microsoft.VisualStudio.TestTools.UnitTesting;
using dotnet_factorial.recursive;
using dotnet_factorial.iterative;

namespace dotnet_factorial.unittests
{
    [TestClass]
    public class UnitTests
    {
        [TestMethod]
        public void TestMethod()
        {
            Assert.AreEqual(362880, recursivefunctions.factorial(9));
            Assert.AreEqual(362880, recursivefunctions.factorial_tr(9));
            Assert.AreEqual(362880, iterativefunctions.factorial_it(9));

            Assert.AreEqual(7.257415615307994e+306, recursivefunctions.factorial(170));
            Assert.AreEqual(7.257415615308004e+306, recursivefunctions.factorial_tr(170));
            Assert.AreEqual(7.257415615308004e+306, iterativefunctions.factorial_it(170));
        }
    }
}
```

## iterativefunctions.cs

```text
using System;

namespace dotnet_factorial.iterative
{
    public class iterativefunctions
    {
        public static double factorial_it(int n)
        {
            double acc = 1;

            for (int i = n; i > 1; i--)
            {
                acc = acc * i;
            }

            return acc;
        }
    }
}
```

## recursivefunctions.cs

```text
using System;

namespace dotnet_factorial.recursive
{
    public class recursivefunctions
    {

        public static double factorial(int n)
        {
            if (n < 2) return 1;
            return n * factorial(n - 1);
        }

        private static double fac_tr_aux(int n, double acc)
        {
            if (n < 2)
                return acc;
            return fac_tr_aux(n - 1, n * acc);
        }

        public static double factorial_tr(int n)
        {
            return fac_tr_aux(n, 1);
        }

    }
}
```

## dotnet.yml

```yaml
name: .NET

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Setup .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 5.0.x
    - name: Restore dependencies
      run: dotnet restore
    - name: Build
      run: dotnet build --no-restore
    - name: Test
      run: dotnet test --no-build --verbosity normal
```

## dotnet-factorial.csproj updates

```xml
<PackageLicenseExpression>MIT</PackageLicenseExpression>
    <PackageId>HaddleyOffice365.dotnet-factorial</PackageId>
    <Version>1.0.0</Version>
    
    <Title>DotNet Factorial Functions</Title>
    <Authors>Neil Haddley</Authors>
    <PackageProjectUrl>
    https://github.com/haddleyoffice365/dotnet-factorial
    </PackageProjectUrl>
    <Description>Recursive and Iterative functions in C#.</Description>
```

## Program.cs

```text
using System;
using dotnet_factorial.iterative;
using dotnet_factorial.recursive;

namespace dotnet_factorial_console
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("factorial of 9 is {0}",iterativefunctions.factorial_it(9));
            Console.WriteLine("factorial of 9 is {0}",recursivefunctions.factorial(9));
            Console.WriteLine("factorial of 9 is {0}",recursivefunctions.factorial_tr(9));
        }
    }
}
```

---

## ollamadeepsekr1applemacbookinstall

**Source file:** `ollamadeepsekr1applemacbookinstall.md`

---
title: "DeepSeek R1"
description: "Running locally"
date: "2025-05-24"
categories: ["AI"]
tags: []
slug: "ollamadeepsekr1applemacbookinstall"
image: "/assets/images/254932576-0d0b44e2-8f4a-4e99-9b52-a5c1c741c8f7-844x844.png"
---



**Installation & Configuration**
I successfully installed the DeepSeek-R1 model.

**Initial Performance Testing**
The 7 billion parameter variant generated output in approximately 25 seconds on my M2 MacBook Air with 16 GB of unified memory.
The 14 billion parameter variant generated output in approximately 40 seconds on my M4 MacBook Air with 32 GB of unified memory.
The 32 billion parameter variant generated output in approximately 1 minute and 50 seconds on my M4 MacBook Air with 32 GB of unified memory.
The 70 billion parameter variant generated output in approximately 1 minute 28 seconds on my M1 Max Mac Studio with 64 GB of unified memory.

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at2012.49.15e280afpm-2136x772.png)
*https://ollama.com/download*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at2012.51.16e280afpm-1108x688.png)
*I clicked Open*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at2012.51.23e280afpm-1060x604.png)
*I clicked Move to Applications*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at201.00.00e280afpm-2136x1162.png)
*search for R1 model*

**1.5B Model:**
Embedded AI (IoT devices), high-volume/low-latency tasks (e.g., spam filtering, simple Q&A), or prototyping.

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at2012.59.00e280afpm-1144x342.png)
*ollama run deepseek-r1:1.5b*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at201.01.50e280afpm-1140x746.png)
*write 100 words on DeekSeek LLM*

**7B Model:**
General-purpose chatbots, content moderation, mid-tier automation (e.g., customer support, basic data analysis).

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at201.04.25e280afpm-1138x294.png)
*ollama run deepseek-r1:7b*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at201.06.38e280afpm-1132x736.png)
*write 100 words on DeekSeek LLM*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at201.31.24e280afpm-1110x746.png)
*ollama run deepseek-r1:7b --verbose*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-05-2320at201.29.57e280afpm-1748x1544.png)
*M2 processor 16 GB of unified memory*

**14B Model:**
Enterprise-grade applications (e.g., advanced chatbots, research tools, code assistants).
Scenarios requiring deep domain expertise or high accuracy (e.g., legal document analysis, financial forecasting).

![](/assets/images/ollamadeepsekr1applemacbookinstall/501048925-1408883290959735-9110886994771392643-n-1140x746.png)
*ollama run deepseek-r1:14b --verbose*

![](/assets/images/ollamadeepsekr1applemacbookinstall/494814422-1859512331511522-7881506198410234900-n-1932x1528.png)
*M4 processor 32 GB of unified memory*

**32B Model:**
Ideal for applications prioritizing accuracy over speed, such as advanced research, data analysis, or generating long-form content.

![](/assets/images/ollamadeepsekr1applemacbookinstall/494362500-1880696412691727-7219409545231194829-n-1138x738.png)
*ollama run deepseek-r1:32b --verbose*

![](/assets/images/ollamadeepsekr1applemacbookinstall/494822610-2106330209879656-3127600083050725665-n-1938x1534.png)
*M4 processor 32 GB of unified memory*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-06-2820at2011.34.0420am-587x373.png)
*ollama run deepseek-r1:70b --verbose*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-06-2820at2012.33.1520pm-586x371.png)
*total duration 1 minute 28 seconds*

![](/assets/images/ollamadeepsekr1applemacbookinstall/screenshot202025-06-2820at2012.32.5520pm-895x767.png)
*M1 Max processor 64 GB of unified memory*

**70B Model:**
Designed for advanced reasoning, multilingual understanding, and long-context processing

---

## opencv

**Source file:** `opencv.md`

---
title: "Object Detection"
description: "Object Detection"
date: "2023-07-25"
categories: ["AI","Python"]
tags: []
slug: "opencv"
image: "/assets/images/raspberry-pi-logo.svg"
---


## Installation of OpenCV

$ sudo apt update
$ sudo apt upgrade
$ sudo apt install python3-opencv
$ python
>>> import cv2
>>> print(cv2.__version__)

![](/assets/images/opencv/screen-shot-2023-07-24-at-11.00.04-am-1134x740.png)
*sudo apt install python3-opencv*


## Installation of TensorFlow Lite

$ sudo apt-get update
$ sudo apt-get dist-upgrade

$ git clone https://github.com/EdjeElectronics/TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi.git
$ mv TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi tflite1
$ cd tflite1

$ sudo pip3 install virtualenv
$ python3 -m venv tflite1-env
**$ source tflite1-env/bin/activate**

$ bash get_pi_requirements.sh


## Using Google's sample TFLite model

$ wget https://storage.googleapis.com/download.tensorflow.org/models/tflite/coco_ssd_mobilenet_v1_1.0_quant_2018_06_29.zip

$ unzip coco_ssd_mobilenet_v1_1.0_quant_2018_06_29.zip -d Sample_TFLite_model

$ python TFLite_detection_video.py --modeldir=Sample_TFLite_model --video=test.mp4

$ python TFLite_detection_video.py --modeldir=Sample_TFLite_model --video=dog.mp4

![](/assets/images/opencv/screen-shot-2023-07-25-at-11.58.01-am-1446x928.png)
*python TFLite_detection_video.py --modeldir=Sample_TFLite_model --video=dog.mp4*


## raspi-config

The TFLite_detection_webcam.py program worked (with line self.stream = cv2.VideoCapture(**0**)) after I enabled **Interface Options | Legacy camera** using raspi-config.

$ sudo raspi-config

![](/assets/images/opencv/screen-shot-2023-07-25-at-1.42.15-pm-1434x928.png)
*TFLite_detection_webcam.py*

![](/assets/images/opencv/20230725-img-3382-1836x1377.jpg)
*Logitech QuickCam for Notebooks (from Goodwill)*

![](/assets/images/opencv/screen-shot-2023-07-27-at-12.55.11-pm-1441x924.png)
*Performance improvement from 5.17 frames per second to 28.59 frames per second*

![](/assets/images/opencv/20230727-img-3458-1836x1377.jpg)
*Coral USB Accelerator*


## TFLite_detection_video.py

```text
######## Webcam Object Detection Using Tensorflow-trained Classifier #########
#
# Author: Evan Juras
# Date: 10/2/19
# Description: 
# This program uses a TensorFlow Lite model to perform object detection on a
# video. It draws boxes and scores around the objects of interest in each frame
# from the video.
#
# This code is based off the TensorFlow Lite image classification example at:
# https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/examples/python/label_image.py
#
# I added my own method of drawing boxes and labels using OpenCV.

# Import packages
import os
import argparse
import cv2
import numpy as np
import sys
import importlib.util



# Define and parse input arguments
parser = argparse.ArgumentParser()
parser.add_argument('--modeldir', help='Folder the .tflite file is located in',
                    required=True)
parser.add_argument('--graph', help='Name of the .tflite file, if different than detect.tflite',
                    default='detect.tflite')
parser.add_argument('--labels', help='Name of the labelmap file, if different than labelmap.txt',
                    default='labelmap.txt')
parser.add_argument('--threshold', help='Minimum confidence threshold for displaying detected objects',
                    default=0.5)
parser.add_argument('--video', help='Name of the video file',
                    default='test.mp4')
parser.add_argument('--edgetpu', help='Use Coral Edge TPU Accelerator to speed up detection',
                    action='store_true')

args = parser.parse_args()

MODEL_NAME = args.modeldir
GRAPH_NAME = args.graph
LABELMAP_NAME = args.labels
VIDEO_NAME = args.video
min_conf_threshold = float(args.threshold)
use_TPU = args.edgetpu

# Import TensorFlow libraries
# If tflite_runtime is installed, import interpreter from tflite_runtime, else import from regular tensorflow
# If using Coral Edge TPU, import the load_delegate library
pkg = importlib.util.find_spec('tflite_runtime')
if pkg:
    from tflite_runtime.interpreter import Interpreter
    if use_TPU:
        from tflite_runtime.interpreter import load_delegate
else:
    from tensorflow.lite.python.interpreter import Interpreter
    if use_TPU:
        from tensorflow.lite.python.interpreter import load_delegate

# If using Edge TPU, assign filename for Edge TPU model
if use_TPU:
    # If user has specified the name of the .tflite file, use that name, otherwise use default 'edgetpu.tflite'
    if (GRAPH_NAME == 'detect.tflite'):
        GRAPH_NAME = 'edgetpu.tflite'   

# Get path to current working directory
CWD_PATH = os.getcwd()

# Path to video file
VIDEO_PATH = os.path.join(CWD_PATH,VIDEO_NAME)

# Path to .tflite file, which contains the model that is used for object detection
PATH_TO_CKPT = os.path.join(CWD_PATH,MODEL_NAME,GRAPH_NAME)

# Path to label map file
PATH_TO_LABELS = os.path.join(CWD_PATH,MODEL_NAME,LABELMAP_NAME)

# Load the label map
with open(PATH_TO_LABELS, 'r') as f:
    labels = [line.strip() for line in f.readlines()]

# Have to do a weird fix for label map if using the COCO "starter model" from
# https://www.tensorflow.org/lite/models/object_detection/overview
# First label is '???', which has to be removed.
if labels[0] == '???':
    del(labels[0])

# Load the Tensorflow Lite model.
# If using Edge TPU, use special load_delegate argument
if use_TPU:
    interpreter = Interpreter(model_path=PATH_TO_CKPT,
                              experimental_delegates=[load_delegate('libedgetpu.so.1.0')])
    print(PATH_TO_CKPT)
else:
    interpreter = Interpreter(model_path=PATH_TO_CKPT)

interpreter.allocate_tensors()

# Get model details
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()
height = input_details[0]['shape'][1]
width = input_details[0]['shape'][2]

floating_model = (input_details[0]['dtype'] == np.float32)

input_mean = 127.5
input_std = 127.5

# Check output layer name to determine if this model was created with TF2 or TF1,
# because outputs are ordered differently for TF2 and TF1 models
outname = output_details[0]['name']

if ('StatefulPartitionedCall' in outname): # This is a TF2 model
    boxes_idx, classes_idx, scores_idx = 1, 3, 0
else: # This is a TF1 model
    boxes_idx, classes_idx, scores_idx = 0, 1, 2

# Open video file
video = cv2.VideoCapture(VIDEO_PATH)
imW = video.get(cv2.CAP_PROP_FRAME_WIDTH)
imH = video.get(cv2.CAP_PROP_FRAME_HEIGHT)

while(video.isOpened()):

    # Acquire frame and resize to expected shape [1xHxWx3]
    ret, frame = video.read()
    if not ret:
      print('Reached the end of the video!')
      break
    frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
    frame_resized = cv2.resize(frame_rgb, (width, height))
    input_data = np.expand_dims(frame_resized, axis=0)

    # Normalize pixel values if using a floating model (i.e. if model is non-quantized)
    if floating_model:
        input_data = (np.float32(input_data) - input_mean) / input_std

    # Perform the actual detection by running the model with the image as input
    interpreter.set_tensor(input_details[0]['index'],input_data)
    interpreter.invoke()

    # Retrieve detection results
    boxes = interpreter.get_tensor(output_details[boxes_idx]['index'])[0] # Bounding box coordinates of detected objects
    classes = interpreter.get_tensor(output_details[classes_idx]['index'])[0] # Class index of detected objects
    scores = interpreter.get_tensor(output_details[scores_idx]['index'])[0] # Confidence of detected objects

    # Loop over all detections and draw detection box if confidence is above minimum threshold
    for i in range(len(scores)):
        if ((scores[i] > min_conf_threshold) and (scores[i] <= 1.0)):

            # Get bounding box coordinates and draw box
            # Interpreter can return coordinates that are outside of image dimensions, need to force them to be within image using max() and min()
            ymin = int(max(1,(boxes[i][0] * imH)))
            xmin = int(max(1,(boxes[i][1] * imW)))
            ymax = int(min(imH,(boxes[i][2] * imH)))
            xmax = int(min(imW,(boxes[i][3] * imW)))
            
            cv2.rectangle(frame, (xmin,ymin), (xmax,ymax), (10, 255, 0), 4)

            # Draw label
            object_name = labels[int(classes[i])] # Look up object name from "labels" array using class index
            label = '%s: %d%%' % (object_name, int(scores[i]*100)) # Example: 'person: 72%'
            labelSize, baseLine = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2) # Get font size
            label_ymin = max(ymin, labelSize[1] + 10) # Make sure not to draw label too close to top of window
            cv2.rectangle(frame, (xmin, label_ymin-labelSize[1]-10), (xmin+labelSize[0], label_ymin+baseLine-10), (255, 255, 255), cv2.FILLED) # Draw white box to put label text in
            cv2.putText(frame, label, (xmin, label_ymin-7), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 0), 2) # Draw label text

    # All the results have been drawn on the frame, so it's time to display it.
    cv2.imshow('Object detector', frame)

    # Press 'q' to quit
    if cv2.waitKey(1) == ord('q'):
        break

# Clean up
video.release()
cv2.destroyAllWindows()
```

---

## page134

**Source file:** `page134.md`

---
title: "Dynamics 365 Sales (Part 1)"
description: "Updating the Sales Insights form"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/page134/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "page134"
---

# Dynamics 365 Sales (Part 1)

## Updating the Sales Insights form

![](/assets/images/page134/dynamics365-color.svg)
*By Microsoft, Public Domain*


## Updating a Form

The Microsoft Dynamics 365 Business Central Extension described here allows users to view Customer locations in a map.

![](/assets/images/page134/screenshot-2023-10-21-at-12.48.17-pm-2136x1029.png)
*The Sales Trial environment configured to url https://haddley-sales-trial.crm.dynamics.com*

![](/assets/images/page134/screenshot-2023-10-21-at-12.46.25-pm-2136x1245.png)
*The Accounts page in the Sales app defaults to the "My Active Accounts" view*

![](/assets/images/page134/screenshot-2023-10-21-at-12.46.39-pm-2136x1244.png)
*Clicking on an Account opens the "Sales Insights" Form*

![](/assets/images/page134/screenshot-2023-10-21-at-12.49.54-pm-2136x1255.png)
*To customize the "Sales Insights" form I navigated to https://make.powerapps.com and selected the the "Sales Trial" environment*

![](/assets/images/page134/screenshot-2023-10-21-at-12.54.50-pm-2136x1103.png)
*I created a "Sales Customizations" solution*

![](/assets/images/page134/screenshot-2023-10-21-at-12.55.42-pm-2136x1111.png)
*I create a new publisher (me)*

![](/assets/images/page134/screenshot-2023-10-21-at-12.55.52-pm-2136x1111.png)
*I added the publisher's email address*

![](/assets/images/page134/screenshot-2023-10-21-at-12.57.44-pm-2136x1108.png)
*I clicked the Create button to create the new solution*

![](/assets/images/page134/screenshot-2023-10-21-at-12.58.19-pm-2136x1100.png)
*I wanted to add an existing table*

![](/assets/images/page134/screenshot-2023-10-21-at-12.58.33-pm-2136x1108.png)
*I added the existing Account table*

![](/assets/images/page134/screenshot-2023-10-21-at-12.58.47-pm-2136x435.png)
*I clicked the "select objects" link*

![](/assets/images/page134/screenshot-2023-10-21-at-1.35.10-pm-2136x1104.png)
*I selected the "Sales Insights" form*

![](/assets/images/page134/screenshot-2023-10-21-at-1.36.01-pm-2136x1108.png)
*I deleted the Fax element from the Sales Insights form*

![](/assets/images/page134/screenshot-2023-10-21-at-1.36.18-pm-2136x1109.png)
*I deleted the Ticker Symbols element from the Sales Insights form*

![](/assets/images/page134/screenshot-2023-10-21-at-1.36.45-pm-2136x1103.png)
*I deleted the Shipping section from the Details tab of the Sales Insights form*

![](/assets/images/page134/screenshot-2023-10-21-at-1.37.07-pm-2136x691.png)
*I deleted the Number of Employees element from the Sales Insights form*

![](/assets/images/page134/screenshot-2023-10-21-at-1.37.25-pm-2136x355.png)
*I saved and published the changes*

![](/assets/images/page134/screenshot-2023-10-21-at-1.38.34-pm-2136x1107.png)
*I returned to the Sales App https://haddley-sales-trial.crm.dynamics.com to review the changes*
## References

- [How to Customize Dynamics 365 Sales (CRM): Tutorial](https://www.youtube.com/watch?v=CrlxnlxVjJM)

---

## page141

**Source file:** `page141.md`

---
title: "Java Spring Boot (Spare)"
description: "Spring Data JPA"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/page141/hero.png"
tags: ["azure","docker","java","spring","postgresql"]
hidden: true
slug: "page141"
---

# Java Spring Boot (Spare)

## Spring Data JPA

![](/assets/images/page141/spring-framework-logo-2018.svg)
*Spring Framework logo by Pivotal Software is licensed under Apache License 2.0*


## Spring Data JPA

Spring Data JPA provides a set of abstractions and high-level, repository-style interfaces that make it easier to work with Java Persistence API (JPA) for data access in Spring applications. It reduces boilerplate code.

I created a Spring Boot application that used Spring Data JPA to access PostgreSQL.

![](/assets/images/page141/screenshot-2023-10-28-at-4.32.38-pm-2136x1094.png)
*I created a GitHub repository*

![](/assets/images/page141/screenshot-2023-10-28-at-4.33.17-pm-2136x1095.png)
*I opened the repository using GitHub Desktop*

![](/assets/images/page141/screenshot-2023-10-28-at-4.33.40-pm-2136x1112.png)
*I clicked the Open in Visual Studio Code button*


## ProgreSQL running locally

I used Docker to run an instance of ProgreSQL locally.

![](/assets/images/page141/screenshot-2023-10-28-at-4.35.46-pm-2044x1020.png)
*I added a docker-compose.yml file. The docker compose file will start a Docker container running PostgreSQL and a second container running Adminer (a database administration tool). Notice that in the Docker virtual network the PostgreSQL instance has hostname db.*

![](/assets/images/page141/screenshot-2023-10-28-at-4.43.20-pm-2078x204.png)
*I ran docker componse -f docker-compose.yml up*

![](/assets/images/page141/screenshot-2023-10-28-at-4.38.14-pm-2136x938.png)
*The Docker containers were started*

![](/assets/images/page141/screenshot-2023-10-28-at-7.23.40-pm-2136x550.png)
*I used Adminer to login to the local ProgreSQL instance (using hostname db)*

![](/assets/images/page141/screenshot-2023-10-28-at-7.23.52-pm-2136x660.png)
*I clicked the Create database link*

![](/assets/images/page141/screenshot-2023-10-28-at-7.24.08-pm-2136x356.png)
*I added a todo database*

![](/assets/images/page141/screenshot-2023-10-28-at-7.24.20-pm-2136x814.png)
*Initially the todo database contained no tables*

![](/assets/images/page141/screenshot-2023-10-28-at-8.06.56-pm-2136x1141.png)
*The haddley-java-jpa program running locally connected to a local instance of ProgreSQL*

![](/assets/images/page141/screenshot-2023-10-28-at-8.08.08-pm-2136x689.png)
*Contents of the local instance of ProgreSQL*


## ProgreSQL in Azure

I used Microsoft Azure to run an instance of ProgreSQL in Azure.

![](/assets/images/page141/screenshot-2023-10-28-at-12.29.56-pm-2136x875.png)
*I searched for postgreSQL in Azure*

![](/assets/images/page141/screenshot-2023-10-28-at-12.30.44-pm-2136x1129.png)
*I selected the Azure Database for ProgreSQL option*

![](/assets/images/page141/screenshot-2023-10-28-at-12.49.06-pm-2136x1238.png)
*I created a new resource group haddley-progressql-rg (sic)*

![](/assets/images/page141/screenshot-2023-10-28-at-12.49.45-pm-2136x1243.png)
*I specified the server name haddley-postgressql (sic) and the workload type Development*

![](/assets/images/page141/screenshot-2023-10-28-at-12.50.39-pm-2136x1243.png)
*I selected PostgreSQL authentication (providing admin username haddleyroot and a password)*

![](/assets/images/page141/screenshot-2023-10-28-at-12.52.48-pm-2136x1244.png)
*I specified firewall options*

![](/assets/images/page141/screenshot-2023-10-28-at-12.59.58-pm-2136x1241.png)
*The Azure hosted copy of PostgresSQL has server name haddley-postgressql.postgres.database.azure.com*

![](/assets/images/page141/screenshot-2023-10-28-at-1.01.20-pm-2136x532.png)
*I used Adminer running on http://localhost:9090 to access the Azure hosted PostgresSQL instance*

![](/assets/images/page141/screenshot-2023-10-28-at-7.29.24-pm-2136x768.png)
*I clicked on the Create database link*

![](/assets/images/page141/screenshot-2023-10-28-at-7.29.36-pm-2136x363.png)
*I created a todo database*

![](/assets/images/page141/screenshot-2023-10-28-at-7.29.49-pm-2136x762.png)
*The todo database initially contained no tables*

![](/assets/images/page141/screenshot-2023-10-28-at-7.36.47-pm-2136x1205.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.37.29-pm-2136x1209.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*


## Web App

I created an Azure Web App to host the Java application

![](/assets/images/page141/screenshot-2023-10-28-at-7.38.13-pm-2136x1212.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.38.45-pm-2136x1213.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.39.50-pm-2136x1213.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.40.16-pm-2136x1211.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.41.11-pm-2136x1208.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.42.00-pm-2136x1208.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.42.44-pm-2136x1212.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.42.56-pm-2136x1208.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/page141/screenshot-2023-10-28-at-7.59.40-pm-2136x1210.png)
*The haddley-java-jpa program being deployed to Azure using the GitHub Action*

![](/assets/images/page141/screenshot-2023-10-28-at-8.04.45-pm-2136x1144.png)
*The haddley-java-jpa program running in Azure connected to an Azure hosted instance of ProgreSQL (notice that Azure servers use universal/GMT date and time)*

![](/assets/images/page141/screenshot-2023-10-28-at-8.11.35-pm-2136x710.png)
*Contents of the Azure hosted instance of ProgreSQL*
## References

- [Spring Data JPA: What is it? And Why Should You Use It?](https://www.youtube.com/watch?v=x67yiTHxn00)
- [90 Minutes to a Complete Java Spring Boot TODO App](https://www.youtube.com/watch?v=Hvuij8SOW8Q)



---

## page152

**Source file:** `page152.md`

---
title: "Vendor Posting Group COPY"
description: "Vendor Posting Group"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/page152/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "page152"
---

# Vendor Posting Group COPY

## Vendor Posting Group

![](/assets/images/page152/dynamics365-color.svg)
*By Microsoft, Public Domain*


## Sub-ledgers

In Microsoft Dynamics 365 Business Central, sub-ledgers are used to record and manage specific types of transactions.

Each sub-ledger corresponds to a specific type of transaction or business process.

Sub-ledgers include:

[Item Ledger](https://learn.microsoft.com/en-us/dynamics365/business-central/finance-how-to-remove-and-reapply-item-entries)
[Vendor Ledger](https://learn.microsoft.com/en-us/dynamics365/business-central/purchasing-how-record-purchases)
Detailed Vendor Ledger
[Customer Ledger](https://learn.microsoft.com/en-us/dynamics365/business-central/receivables-how-apply-sales-transactions-manually); and
Detailed Customer Ledger


## Posting Groups

In Microsoft Dynamics 365 Business Central, Posting Groups are used to "build a bridge" between Business Central sub-ledgers and the general ledger accounts.


## Vendor Posting Group

A Vendor Posting Group is used to define where to post transactions for payables accounts, service charge accounts, and payment discount accounts. 

Vendor Posting Groups are maintained using the Vendor Posting Groups page.

![](/assets/images/page152/screen-shot-2023-12-11-at-7.05.09-pm-1536x860.png)
*I used search to navigate to the Vendors page. I used + New to create a new Vendor*

![](/assets/images/page152/screen-shot-2023-12-11-at-7.07.22-pm-1536x859.png)
*I entered Vendor details*

![](/assets/images/page152/screen-shot-2023-12-11-at-7.07.54-pm-1536x860.png)
*I reviewed the Invoicing tab for the new Vendor*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page152/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*
## References

- [Dynamics NAV 2017: Posting Groups](https://l.messenger.com/l.php?u=https%3A%2F%2Fwww.youtube.com%2Fplaylist%3Flist%3DPLJDdNuGpFiapss3yoWee7-fp55lRAikbK&h=AT0HmVGD-F7A3HG_rzzD4GiBU94ANq8jlnehhdkP9aflrzxNrC6dVe1uPZfEDtl_X15Q72epQNID1dBY1yaE3Phy68d4yGMxDcCecpE3trry7tjfPjLQOMYnaQO8-S1MSMavET7HSqRc0_A)
- [Set Up Posting Groups](https://learn.microsoft.com/en-us/dynamics365/business-central/finance-posting-groups)

---

## page199

**Source file:** `page199.md`

---
title: "Power Pages (Part 1) BACKUP"
description: "A Business Central Customer Portal"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/page199/hero.png"
tags: ["ai","business central","dynamics","power platform"]
hidden: true
slug: "page199"
---

# Power Pages (Part 1) BACKUP

## A Business Central Customer Portal

![](/assets/images/page199/powerpages-scalable.svg)
*Microsoft permits the use of these icons in architectural diagrams, training materials, or documentation.*


## A Business Central Customer Portal

Microsoft Power Pages is a low-code platform designed to build, host, and manage external-facing business websites.

Microsoft Dynamics Business Central provides an end-to-end solution for financials, sales, service, and operations. 

A Customer Portal is a software interface that gives customers complete visibility into their interactions with a company. It provides a platform for customers to track key metrics, support requests, or other information such as reference documents that can be easily shared.

![](/assets/images/page199/screenshot-2024-10-26-at-2.44.36pm-2136x1091.png)
*I used Microsoft Power Pages to create a Customer Portal*

![](/assets/images/page199/screenshot-2024-10-26-at-2.28.37pm-2136x764.png)
*I navigated to the Assisted Setup page in Business Central*

![](/assets/images/page199/screenshot-2024-10-26-at-2.29.00pm-2136x677.png)
*I selected the Set up a connection to Dataverse link*

![](/assets/images/page199/screenshot-2024-10-26-at-2.29.13pm-2136x1122.png)
*I enabled data synchronization and virtual tables*

![](/assets/images/page199/screenshot-2024-10-26-at-2.29.25pm-2136x1106.png)
*I accepted the terms and conditions*

![](/assets/images/page199/screenshot-2024-10-26-at-2.29.40pm-2136x1126.png)
*I selected the Developer Power Platform/Dataverse environment*

![](/assets/images/page199/screenshot-2024-10-26-at-2.30.09pm-2136x1122.png)
*I signed in as a Power Platform administrator*

![](/assets/images/page199/screenshot-2024-10-26-at-2.38.42pm-2136x1211.png)
*I clicked the Next button*

![](/assets/images/page199/screenshot-2024-10-26-at-2.48.44pm-2136x1207.png)
*I clicked the Install Business Central Virtual Table app link*

![](/assets/images/page199/screenshot-2024-10-26-at-2.49.03pm-2136x1282.png)
*I clicked the Get it now button*

![](/assets/images/page199/screenshot-2024-10-26-at-2.49.28pm-2136x1205.png)
*I clicked the Get it now button*

![](/assets/images/page199/screenshot-2024-10-26-at-2.50.41pm-2136x1281.png)
*I selected the Develop environment*

![](/assets/images/page199/screenshot-2024-10-26-at-2.50.55pm-2136x1205.png)
*I checked the I agree boxes and clicked the Install button*

![](/assets/images/page199/screenshot-2024-10-26-at-3.11.49pm-2136x1208.png)
*Business Central Virtual Table was installed*

![](/assets/images/page199/screenshot-2024-10-26-at-3.12.15pm-2136x1205.png)
*I clicked the Review and enable virtual tables link*

![](/assets/images/page199/screenshot-2024-10-26-at-3.37.02pm-2136x1212.png)
*I selected six Virtual Tables and clicked the Enable button*

![](/assets/images/page199/screenshot-2024-10-26-at-3.37.14pm-2136x328.png)
*A job queue entry was scheduled*

![](/assets/images/page199/screenshot-2024-10-26-at-3.39.28pm-2136x1208.png)
*I navigated to the Dataverse Connection Setup page*

![](/assets/images/page199/screenshot-2024-10-26-at-3.39.56pm-2136x1204.png)
*I clicked the Test Connection button*

![](/assets/images/page199/screenshot-2024-10-26-at-3.42.09pm-2136x653.png)
*I navigated to the Contacts list*

![](/assets/images/page199/screenshot-2024-10-26-at-3.42.36pm-2136x1208.png)
*Business Central sample data includes example Contacts*

![](/assets/images/page199/screenshot-2024-10-26-at-3.42.55pm-2136x550.png)
*I navigated to the Customers list*

![](/assets/images/page199/screenshot-2024-10-26-at-3.44.39pm-2136x1209.png)
*Business Central sample data includes example Customers and Vendors (Accounts).I started the Business Central to Dataverse synchronization process*

![](/assets/images/page199/screenshot-2024-10-26-at-3.45.06pm-2136x1207.png)
*The Contacts table in the Develop environment was initially empty*

![](/assets/images/page199/screenshot-2024-10-26-at-3.53.44pm-2136x1208.png)
*The Synchronization jobs copied Contact, Account and other details from Business Central to Dataverse*

![](/assets/images/page199/screenshot-2024-10-26-at-3.52.09pm-2136x1209.png)
*After the sync. the Contacts table included Contacts (connected to Accounts)*

![](/assets/images/page199/screenshot-2024-10-26-at-4.02.35pm-2136x1206.png)
*Customer and Vendor details were copied from Business Central to Dataverse*


## Sales Orders

In Dynamics 365 Business Central, a Sales Order is a document that represents a customer's intent to purchase goods or services from a company. It is a crucial component of the sales process and serves as a foundation for managing customer interactions, tracking orders, and fulfilling customer requests.

![](/assets/images/page199/screenshot-2024-10-26-at-4.13.38pm-2136x614.png)
*I navigated to the Sales Orders list*

![](/assets/images/page199/screenshot-2024-10-26-at-4.14.06pm-2136x1038.png)
*I reviewed the Sales Orders list*

![](/assets/images/page199/screenshot-2024-10-26-at-4.14.38pm-2136x1202.png)
*I navigated to the Sales Order Virtual Table*

![](/assets/images/page199/screenshot-2024-10-26-at-4.15.23pm-2136x1209.png)
*I was able to see the same records*

![](/assets/images/page199/screenshot-2024-10-26-at-4.22.42pm-2136x1165.png)
*I added columns to the display*


## Solution

I created a Power Platform Solution

![](/assets/images/page199/screenshot-2024-10-26-at-4.27.15pm-2136x1097.png)
*I created a Customer Portal Solution*

![](/assets/images/page199/screenshot-2024-10-26-at-4.56.18pm-2136x902.png)
*I could not create a new Site in the Solution page*

![](/assets/images/page199/screenshot-2024-10-26-at-4.57.17pm-2136x1017.png)
*I navigated to the Power Pages home page https://make.powerpages.microsoft.com/*

![](/assets/images/page199/screenshot-2024-10-26-at-4.58.16pm-2136x1101.png)
*I created the Customer Portal site*

![](/assets/images/page199/screenshot-2024-10-26-at-4.58.32pm-2136x1099.png)
*I waited*

![](/assets/images/page199/screenshot-2024-10-26-at-5.00.38pm-2136x1100.png)
*I clicked the Next button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.01.24pm-2136x1097.png)
*I added a Sales Orders page*

![](/assets/images/page199/screenshot-2024-10-26-at-5.03.25pm-2136x1104.png)
*I added a list to the Sales Orders page*

![](/assets/images/page199/screenshot-2024-10-26-at-5.03.47pm-2136x1100.png)
*I selected the Sales Order virtual table*

![](/assets/images/page199/screenshot-2024-10-26-at-5.04.01pm-2136x1106.png)
*I selected the All Sales Orders view*

![](/assets/images/page199/screenshot-2024-10-26-at-5.04.17pm-2136x1101.png)
*I clicked the Done button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.04.33pm-2136x1100.png)
*I clicked the + New permission link*

![](/assets/images/page199/screenshot-2024-10-26-at-5.04.50pm-2136x1107.png)
*I selected Authenticated Users*

![](/assets/images/page199/screenshot-2024-10-26-at-5.05.08pm-2136x490.png)
*I clicked the Sync button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.05.48pm-2136x385.png)
*I clicked the Preview button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.05.56pm-2136x538.png)
*I clicked the desktop button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.06.27pm-2136x719.png)
*I clicked the Sign in button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.06.45pm-2136x1088.png)
*I selected the Consent option and clicked the Accept button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.07.15pm-2136x1165.png)
*I was taken to a profile page*

![](/assets/images/page199/screenshot-2024-10-26-at-5.07.38pm-2136x1173.png)
*I navigated to the Sales Order page and reviewed the list*

![](/assets/images/page199/screenshot-2024-10-26-at-5.08.05pm-2136x772.png)
*I clicked the Edit views button and added columns*

![](/assets/images/page199/screenshot-2024-10-26-at-5.11.35pm-2136x1016.png)
*I clicked the edit column button and adjusted the number of decimal places (to 2)*

![](/assets/images/page199/screenshot-2024-10-26-at-5.13.35pm-2136x1016.png)
*I clicked the Save and publish button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.15.24pm-2136x1022.png)
*I navigated to the Sales Orders page*

![](/assets/images/page199/screenshot-2024-10-26-at-5.16.37pm-2136x953.png)
*I reviewed the other Access type options.*

![](/assets/images/page199/screenshot-2024-10-26-at-5.16.53pm-2136x955.png)
*Account access looked to be the option I wanted to select but it needed a relationship between the Sales Order list and the Account table*

![](/assets/images/page199/screenshot-2024-10-26-at-5.17.57pm-2136x690.png)
*I clicked the Synthetic Relations button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.18.15pm-2136x557.png)
*I clicked the * New button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.18.30pm-2136x1004.png)
*I selected the Dataverse/CRM Account table*

![](/assets/images/page199/screenshot-2024-10-26-at-5.19.04pm-2136x1099.png)
*I selected the Sales Order Virtual table*

![](/assets/images/page199/screenshot-2024-10-26-at-5.19.38pm-2136x1035.png)
*I selected the Account Name column in the Account table*

![](/assets/images/page199/screenshot-2024-10-26-at-5.19.56pm-2136x1096.png)
*I selected the customerName column in the Sales Order virtual table*

![](/assets/images/page199/screenshot-2024-10-26-at-5.20.06pm-2136x1039.png)
*I clicked the Next button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.20.33pm-2136x1007.png)
*A key was created*

![](/assets/images/page199/screenshot-2024-10-26-at-5.21.15pm-2136x1052.png)
*I clicked the Finish button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.24.57pm-2136x590.png)
*The relationship was displayed*

![](/assets/images/page199/screenshot-2024-10-26-at-5.26.19pm-2136x1116.png)
*I selected the relationship*

![](/assets/images/page199/screenshot-2024-10-26-at-5.27.59pm-2136x667.png)
*I navigated to the Sales Order page and found an Internal Server Error*

![](/assets/images/page199/screenshot-2024-10-26-at-5.29.07pm-2136x1080.png)
*I clicked the Edit row using form button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.30.19pm-2136x1187.png)
*I selected an Account (for my Contact)*

![](/assets/images/page199/screenshot-2024-10-26-at-5.30.28pm-2136x943.png)
*I clicked the Save & Close button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.31.28pm-2136x1182.png)
*I refreshed the Sales Order page and saw the Adatum Corporation related Sales Orders*

![](/assets/images/page199/screenshot-2024-10-26-at-5.31.54pm-2136x936.png)
*I updated the Account Name in my contact to Alpine Ski House*

![](/assets/images/page199/screenshot-2024-10-26-at-5.32.11pm-2136x352.png)
*I clicked to Sync button*

![](/assets/images/page199/screenshot-2024-10-26-at-5.32.31pm-2136x510.png)
*I navigated to the Sales Orders page*

![](/assets/images/page199/screenshot-2024-10-26-at-5.34.29pm-2136x1115.png)
*I added the Site to the Customer Portal solution*

![](/assets/images/page199/screenshot-2024-10-26-at-5.35.18pm-2136x655.png)
*I could see the Site included in the solution*


## Robert Townes

I created an invitation for Robert Townes an Adatum Corporation contact.

![](/assets/images/page199/screenshot-2024-10-27-at-3.00.46am-2136x628.png)
*I clicked on the Security menu item*

![](/assets/images/page199/screenshot-2024-10-27-at-3.01.03am-2136x836.png)
*I clicked the Site visibility menu item*

![](/assets/images/page199/screenshot-2024-10-27-at-3.01.40am-2136x814.png)
*I clicked the Public option. I clicked the Set to public button.*

![](/assets/images/page199/screenshot-2024-10-27-at-3.02.22am-2136x817.png)
*I clicked the three dots icon to the right of the Sales Orders page and selected the Page Settings menu item.*

![](/assets/images/page199/screenshot-2024-10-27-at-3.02.38am-2136x731.png)
*I selected the Permissions tab*

![](/assets/images/page199/screenshot-2024-10-27-at-3.02.53am-2136x915.png)
*I clicked the I want to choose who can see this page option and selected the Authenticated Users checkbox*

![](/assets/images/page199/screenshot-2024-10-27-at-3.03.11am-2136x856.png)
*I selected the Power Pages Management menu item*

![](/assets/images/page199/screenshot-2024-10-27-at-3.04.00am-2136x953.png)
*I selected the Contacts menu item*

![](/assets/images/page199/screenshot-2024-10-27-at-3.04.38am-2136x769.png)
*I reviewed the Robert Towns Customer Card in Business Central. Robert is an Adatum Corporation Contact.*

![](/assets/images/page199/screenshot-2024-10-27-at-3.05.09am-2136x564.png)
*I clicked the Create Invitation button*

![](/assets/images/page199/screenshot-2024-10-27-at-3.05.36am-2136x874.png)
*A new Invitation record is created. I clicked the Save button.*

![](/assets/images/page199/screenshot-2024-10-27-at-3.06.08am-2136x661.png)
*I clicked the Advanced tab and copied the Invitation Code*

![](/assets/images/page199/screenshot-2024-10-27-at-3.13.14am-2136x756.png)
*I started a new browser and navigated to https://haddleycustomerportal.powerappsportals.com/register/?returnurl=%2f&invitation=Grm2DCf3-325v32G...*

![](/assets/images/page199/screenshot-2024-10-27-at-3.13.47am-2136x859.png)
*I entered a username and password*

![](/assets/images/page199/screenshot-2024-10-27-at-3.14.17am-2136x947.png)
*I clicked the Register button*

![](/assets/images/page199/screenshot-2024-10-27-at-3.15.17am-2136x1036.png)
*I reviewed the Profile and clicked the update button*

![](/assets/images/page199/screenshot-2024-10-27-at-3.15.36am-2136x529.png)
*The Customer Portal home page was displayed*

![](/assets/images/page199/screenshot-2024-10-27-at-3.15.59am-2136x599.png)
*I navigated to the Sales Orders page*


## Power Pages Authenticated External Users

Because external users have no Business Central license or entitlements, we included built-in app/S2S users to access data stored in Business Central online on their behalf. Permission sets can be assigned to these app/S2S users to control data access by external users.

![](/assets/images/page199/screenshot-2024-10-27-at-4.47.27am-2136x840.png)
*I navigated to the Microsoft Entra Applications page*

![](/assets/images/page199/screenshot-2024-10-27-at-4.47.41am-2136x641.png)
*I selected the Power Pages Authenticated External Users page*

![](/assets/images/page199/screenshot-2024-10-27-at-4.48.19am-2136x1091.png)
*I clicked the edit menu item (the pencil icon)*

![](/assets/images/page199/screenshot-2024-10-27-at-4.58.02am-2136x1100.png)
*I added the D365 BUS PREMIUM and LOGIN User Permission Sets (I did not need to click the Grant Consent button)*

![](/assets/images/page199/screenshot-2024-10-27-at-4.58.59am-2136x1176.png)
*Robert was able to access the Adatum Corporation Sales Orders*


## Model Driven App

A Microsoft Model-Driven App is a type of application in the Power Apps suite designed to help users create complex, data-driven applications with minimal coding. Model-driven apps are structured around data models and relationships, meaning the app's layout and components are automatically generated based on the underlying data.

![](/assets/images/page199/screenshot-2024-10-27-at-8.34.45am-2136x808.png)
*I added two existing tables to the Customer Portal Solution*

![](/assets/images/page199/screenshot-2024-10-27-at-8.35.13am-2136x1092.png)
*I added the Sales Order and Sales Order Line tables*

![](/assets/images/page199/screenshot-2024-10-27-at-8.35.56am-2136x1098.png)
*I clicked the Add button*

![](/assets/images/page199/screenshot-2024-10-27-at-9.02.27am-2136x898.png)
*I added an existing Form to the Sales Order table*

![](/assets/images/page199/screenshot-2024-10-27-at-9.02.39am-2136x1093.png)
*I added the Information (Main) Form*

![](/assets/images/page199/screenshot-2024-10-27-at-9.03.15am-2136x860.png)
*I added fields to the form*

![](/assets/images/page199/screenshot-2024-10-27-at-9.04.36am-2136x1093.png)
*I updated the section adding a second column*

![](/assets/images/page199/screenshot-2024-10-27-at-9.05.30am-2136x1094.png)
*I divided the fields between the two columns. I added a new 1-column section*

![](/assets/images/page199/screenshot-2024-10-27-at-9.05.57am-2136x1094.png)
*I added a subgrid to the new section*

![](/assets/images/page199/screenshot-2024-10-27-at-9.07.08am-2136x1094.png)
*I hid the new section's label. I updated the Subgrid's label to "Lines". I clicked the Save and Publish button. I clicked the Edit view button (the pencil icon next to the Default view dropdown)*

![](/assets/images/page199/screenshot-2024-10-27-at-9.07.34am-2136x944.png)
*I updated the All Sales Order Lines view*

![](/assets/images/page199/screenshot-2024-10-27-at-9.12.58am-2136x875.png)
*I created a new Model Driven App*

![](/assets/images/page199/screenshot-2024-10-27-at-9.13.20am-2136x712.png)
*I added a Dataverse table page*

![](/assets/images/page199/screenshot-2024-10-27-at-9.13.38am-2136x917.png)
*I selected the Sales Order table (checking the Show in navigation box)*

![](/assets/images/page199/screenshot-2024-10-27-at-9.13.49am-2136x539.png)
*I clicked the Publish button*

![](/assets/images/page199/screenshot-2024-10-27-at-9.14.05am-2136x1109.png)
*I clicked the Play button*

![](/assets/images/page199/screenshot-2024-10-27-at-9.14.53am-2136x856.png)
*I updated a few of the Sales Order Table columns setting the number of decimal places*

![](/assets/images/page199/screenshot-2024-10-27-at-9.15.08am-2136x1001.png)
*The amountExcludingTax column was originally shown to 10 decimal places*

![](/assets/images/page199/screenshot-2024-10-27-at-9.15.17am-2136x1115.png)
*The amountExcludingTax column was updated show only 2 decimal places*

![](/assets/images/page199/screenshot-2024-10-27-at-9.19.01am-2136x1114.png)
*The Sales Orders page in the Customer Portal Admin app*

![](/assets/images/page199/screenshot-2024-10-27-at-9.19.35am-2136x1107.png)
*I added a page to the Power Pages site*

![](/assets/images/page199/screenshot-2024-10-27-at-9.19.59am-2136x1116.png)
*I added a Form to the page*

![](/assets/images/page199/screenshot-2024-10-27-at-9.20.30am-2136x1114.png)
*I set the source of the Form*

![](/assets/images/page199/screenshot-2024-10-27-at-9.20.43am-2136x1113.png)
*I set the Form to read-only*

![](/assets/images/page199/screenshot-2024-10-27-at-9.21.31am-2136x1113.png)
*I clicked Permissions*

![](/assets/images/page199/screenshot-2024-10-27-at-9.21.44am-2136x1113.png)
*The All Sales Order table permission was displayed*

![](/assets/images/page199/screenshot-2024-10-27-at-9.22.44am-2136x692.png)
*I opened the Sales Orders page and clicked the Edit List button*

![](/assets/images/page199/screenshot-2024-10-27-at-9.23.09am-2136x1108.png)
*I enabled the View details action*

![](/assets/images/page199/screenshot-2024-10-27-at-9.23.27am-2136x1104.png)
*I set the Target type to Web Page and selected the Sales Order page*

![](/assets/images/page199/screenshot-2024-10-27-at-9.24.02am-2136x1109.png)
*I clicked the Sync button. I clicked the Preview button.*

![](/assets/images/page199/screenshot-2024-10-27-at-9.24.20am-2136x461.png)
*I clicked the View details action*

![](/assets/images/page199/screenshot-2024-10-27-at-9.24.36am-2136x1113.png)
*I viewed the Sales Order details. The Sales Order Line view was not displayed.*

![](/assets/images/page199/screenshot-2024-10-27-at-9.25.34am-2136x1110.png)
*I updated the All Sales Orders permission*

![](/assets/images/page199/screenshot-2024-10-27-at-9.26.10am-2136x1112.png)
*I created a Child permission.*

![](/assets/images/page199/screenshot-2024-10-27-at-9.28.51am-2136x1107.png)
*I added the Authenticated Users role*

![](/assets/images/page199/screenshot-2024-10-27-at-9.31.26am-2136x1067.png)
*The user was unable to see the Sales Order Lines*

![](/assets/images/page199/screenshot-2024-10-27-at-9.39.03am-2136x1102.png)
*I added a Sales Order Line permission*

![](/assets/images/page199/screenshot-2024-10-27-at-9.39.43am-2136x1158.png)
*Robert was able to view a Sales Order and the related Sales Order Line details*
## References

- [What's new: Using Power Pages with Business Central - Licensing](https://www.youtube.com/watch?v=auoHUd24Gfw&t=227s)
- [What's new: Business Central Integration with Dataverse - Synthetic Relations](https://www.youtube.com/watch?v=-q8Gm7u7R2A&t=908s)
- [Power Pages on virtual tables (preview)](https://learn.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/power-pages-on-virtual-tables-overview)



---

## page200

**Source file:** `page200.md`

---
title: "Power Page (Part 2) Backup"
description: "Customer Orders"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/page200/hero.png"
tags: ["javascript","java","ai","ml","business central"]
hidden: true
slug: "page200"
---

# Power Page (Part 2) Backup

## Customer Orders

![](/assets/images/page200/powerpages-scalable.svg)
*Microsoft permits the use of these icons in architectural diagrams, training materials, or documentation.*


## Customer Orders

Customer Orders may be handled directly by customers using a self-service Customer Portal.

Here a Power Pages Customer Portal enables customers to view, create, and manage their orders in the context of a Business Central subscription.

![](/assets/images/page200/screenshot-2024-11-20-at-3.08.44pm-2136x751.png)
*I opened the Customer Portal Solution and added a new Table*

![](/assets/images/page200/screenshot-2024-11-20-at-3.09.18pm-2136x1101.png)
*I added a Customer Order table*

![](/assets/images/page200/screenshot-2024-11-20-at-3.11.38pm-2136x1103.png)
*I updated the Name column*

![](/assets/images/page200/screenshot-2024-11-20-at-3.12.11pm-2136x1107.png)
*I updated the Data type to Autonumber and set the prefix to Order*

![](/assets/images/page200/screenshot-2024-11-20-at-3.15.00pm-2136x1106.png)
*I added a Requested Delivery Date column*

![](/assets/images/page200/screenshot-2024-11-20-at-3.15.13pm-2136x1103.png)
*I set the type of the Requested Delivery Date column's Time zone adjustment*

![](/assets/images/page200/screenshot-2024-11-20-at-3.25.36pm-2136x1104.png)
*I added an Account column to store the Account/Customer the Order is associated with*

![](/assets/images/page200/screenshot-2024-11-20-at-3.26.43pm-2136x1109.png)
*I created a Created By Contact column to track who created the Order*

![](/assets/images/page200/screenshot-2024-11-20-at-3.27.22pm-2136x1107.png)
*I created a Modified By Contact column to track who updated the Order last*

![](/assets/images/page200/screenshot-2024-11-20-at-3.28.16pm-2136x1107.png)
*I edited the Active Customer Orders view*

![](/assets/images/page200/screenshot-2024-11-20-at-3.28.45pm-2136x1107.png)
*I saved the new view as Portal Active Customer Orders*

![](/assets/images/page200/screenshot-2024-11-20-at-3.30.49pm-2136x1100.png)
*I added columns to the view*

![](/assets/images/page200/screenshot-2024-11-20-at-3.31.44pm-2136x1106.png)
*I edited the Customer Order's Main form*

![](/assets/images/page200/screenshot-2024-11-20-at-3.32.19pm-2136x1106.png)
*I saved the form as Portal Information (I later renamed it Portal New Customer Order)*

![](/assets/images/page200/screenshot-2024-11-20-at-3.33.39pm-2136x1101.png)
*I added the Requested Delivery Date column to the form*

![](/assets/images/page200/screenshot-2024-11-20-at-3.37.00pm-2136x1171.png)
*I edited the Customer Portal web site*

![](/assets/images/page200/screenshot-2024-11-20-at-3.38.50pm-2136x1113.png)
*I created a List Customer Orders page*

![](/assets/images/page200/screenshot-2024-11-20-at-3.39.34pm-2136x1110.png)
*I added h1 text and clicked the Add a component button*

![](/assets/images/page200/screenshot-2024-11-20-at-3.39.46pm-2136x1105.png)
*I clicked the List component*

![](/assets/images/page200/screenshot-2024-11-20-at-3.40.23pm-2136x1101.png)
*I disabled AI Insights and clicked the + New List button*

![](/assets/images/page200/screenshot-2024-11-20-at-3.41.26pm-2136x1107.png)
*I selected the Customer Order table. I selected the Portal Active Customer Orders view (see above). I named the list List Portal Active Customer Orders*

![](/assets/images/page200/screenshot-2024-11-20-at-3.41.46pm-2136x1103.png)
*I clicked the + New permissions button*

![](/assets/images/page200/screenshot-2024-11-20-at-3.48.02pm-2136x1103.png)
*I created a table permission with Account access. Any Contact associated with the given Account/Customer will be able to see the Account/Customer's records. I created a table permission that provided access to the Customer Order table. I named the table permission Account Customer Order*

![](/assets/images/page200/screenshot-2024-11-20-at-3.48.19pm-2136x1103.png)
*I added the Authenticated Users role and permission to Read*

![](/assets/images/page200/screenshot-2024-11-20-at-4.09.43pm-2136x1097.png)
*I previewed the web page*

![](/assets/images/page200/screenshot-2024-11-20-at-4.10.16pm-2136x728.png)
*Anonymous users did not have access to the Customer Order table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.15.23pm-2136x593.png)
*I logged in as Robert Townes. There were no record to display*

![](/assets/images/page200/screenshot-2024-11-20-at-4.15.50pm-2136x917.png)
*I updated the page navigation permissions. Only Authenticated Users would see a menu item that would navigate to the List Customer Orders page.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.16.37pm-2136x1052.png)
*I created a New Customer Order page*

![](/assets/images/page200/screenshot-2024-11-20-at-4.17.10pm-2136x1104.png)
*I added h1 text and a Form.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.18.56pm-2136x1108.png)
*I created a Power Pages form based on the Customer Order table and the Portal Information Dataverse form (I later renamed that Dataverse form Portal New Customer Order). I named the Power Pages form Create New Customer Order.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.19.05pm-2136x1104.png)
*I selected the Data tab and selected the Creates a new record option*

![](/assets/images/page200/screenshot-2024-11-20-at-4.19.25pm-2136x915.png)
*I selected the On submit tab and selected the Redirect to a page option. The submit button will redirect back to the List Customer Orders page.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.19.33pm-2136x907.png)
*I selected the CAPTCHA tab and uncheck the boxes.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.19.44pm-2136x847.png)
*I disabled form filling assistance.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.20.09pm-2136x1103.png)
*I clicked the Update permissions button*

![](/assets/images/page200/screenshot-2024-11-20-at-4.23.25pm-2136x1101.png)
*I updated the existing Account Customer Order table permissions*

![](/assets/images/page200/screenshot-2024-11-20-at-4.23.41pm-2136x1107.png)
*I added Permission to Create.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.24.45pm-2136x1103.png)
*I navigated to Power Pages Management*

![](/assets/images/page200/screenshot-2024-11-20-at-4.25.22pm-2136x930.png)
*I navigated to Basic Forms and selected the Create New Customer Order form*

![](/assets/images/page200/screenshot-2024-11-20-at-4.26.43pm-2136x1032.png)
*I added a Basic Form Metadata*

![](/assets/images/page200/screenshot-2024-11-20-at-4.27.02pm-2136x997.png)
*I selected Attribute*

![](/assets/images/page200/screenshot-2024-11-20-at-4.27.29pm-2136x920.png)
*I selected the Order's Account field.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.27.44pm-2136x1030.png)
*I checked the Set Value On Save box and selected the Current Portal User option*

![](/assets/images/page200/screenshot-2024-11-20-at-4.28.20pm-2136x936.png)
*I selected the Current User's Company Name field (the Account/Customer the Current User is associated with).*

![](/assets/images/page200/screenshot-2024-11-20-at-4.28.32pm-2136x963.png)
*I clicked the Save & Close button*

![](/assets/images/page200/screenshot-2024-11-20-at-4.29.54pm-2136x971.png)
*I added a Basic Form Metadata to set the Order's Created By Contact field*

![](/assets/images/page200/screenshot-2024-11-20-at-4.30.12pm-2136x889.png)
*I added a Basic Form Metadata to set the Order's Modified By Contact field*

![](/assets/images/page200/screenshot-2024-11-20-at-4.30.40pm-2136x1016.png)
*The Order's Created By Contact and Modified By Contact fields would be set to the value to the Current User's Contact record*

![](/assets/images/page200/screenshot-2024-11-20-at-4.31.14pm-2136x955.png)
*I had added three Basic Form Metadata entries*

![](/assets/images/page200/screenshot-2024-11-20-at-4.31.39pm-2136x930.png)
*I scrolled to the right to double check the On Save From Attribute setting*

![](/assets/images/page200/screenshot-2024-11-20-at-4.32.32pm-2136x982.png)
*I updated the List Customer Orders' Create a new record action to use the Create New Customer Order form*

![](/assets/images/page200/screenshot-2024-11-20-at-4.33.04pm-2136x666.png)
*I navigate the List Customer Orders page and clicked the Create button*

![](/assets/images/page200/screenshot-2024-11-20-at-4.34.04pm-2136x815.png)
*I reviewed the popup form*

![](/assets/images/page200/screenshot-2024-11-20-at-4.33.41pm-2136x972.png)
*I updated the Create a new record action's Target type to Webpage and selected the New Customer Order page*

![](/assets/images/page200/screenshot-2024-11-20-at-4.34.29pm-2136x946.png)
*I clicked the Create button again and was navigate to the New Customer Order page.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.34.38pm-2136x934.png)
*I selected a Requested Delivery Date and clicked the Submit button*

![](/assets/images/page200/screenshot-2024-11-20-at-4.34.57pm-2136x708.png)
*I was redirected the to List Customer Orders page with the new Order displayed*

![](/assets/images/page200/screenshot-2024-11-20-at-4.36.52pm-2136x953.png)
*I added a new Dataverse table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.37.14pm-2136x1107.png)
*I added a Customer Order Line table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.38.12pm-2136x1107.png)
*I added a lookup column that will allow us to maintain a relationship between a given Order and a set of Order Line records*

![](/assets/images/page200/screenshot-2024-11-20-at-4.40.19pm-2136x801.png)
*I opened the Business Central Configuration app and selected the Business Central Item table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.40.33pm-2136x899.png)
*I set the Visible property to true*

![](/assets/images/page200/screenshot-2024-11-20-at-4.42.30pm-2136x828.png)
*The Item table was set to Visible*

![](/assets/images/page200/screenshot-2024-11-20-at-4.43.45pm-2136x1103.png)
*I added an Item Column to the Customer Order Line table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.44.34pm-2136x1099.png)
*I added a Quantity column to the Customer Order Line table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.47.12pm-2136x1101.png)
*I added a Unit Price column to the Customer Order Line table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.48.03pm-2136x1104.png)
*I added an Amount (formula) column to the Customer Order Line table*

![](/assets/images/page200/screenshot-2024-11-20-at-4.48.49pm-2136x881.png)
*I edited the Active Customer Order Lines view*

![](/assets/images/page200/screenshot-2024-11-20-at-4.49.18pm-2136x1103.png)
*I saved the new view as Portal Active Customer Order Lines*

![](/assets/images/page200/screenshot-2024-11-20-at-4.50.12pm-2136x897.png)
*I added columns to the view*

![](/assets/images/page200/screenshot-2024-11-20-at-4.52.25pm-2136x1107.png)
*I created a Portal Update Customer Order form*

![](/assets/images/page200/screenshot-2024-11-20-at-4.52.58pm-2136x792.png)
*I added a 1 column section*

![](/assets/images/page200/screenshot-2024-11-20-at-4.53.39pm-2136x943.png)
*I added a subgrid to the Customer Order form. The subgrid will display the Customer Order Line records related to the selected Customer Order.*

![](/assets/images/page200/screenshot-2024-11-20-at-4.54.08pm-2136x1106.png)
*I updated the subgrid label to Lines*

![](/assets/images/page200/screenshot-2024-11-20-at-4.55.17pm-2136x1020.png)
*I created an Update Customer Order page*

![](/assets/images/page200/screenshot-2024-11-20-at-4.55.54pm-2136x979.png)
*I added h1 text and a Form*

![](/assets/images/page200/screenshot-2024-11-20-at-4.56.07pm-2136x1022.png)
*I clicked the + New form button*

![](/assets/images/page200/screenshot-2024-11-20-at-4.57.08pm-2136x921.png)
*I named the form Update Existing Customer Order*

![](/assets/images/page200/screenshot-2024-11-20-at-4.57.17pm-2136x972.png)
*In the Data tab I selected the Updates an existing record option*

![](/assets/images/page200/screenshot-2024-11-20-at-4.57.31pm-2136x841.png)
*In the On submit tab I selected the List Customer Orders page*

![](/assets/images/page200/screenshot-2024-11-20-at-4.57.47pm-2136x898.png)
*I unchecked the CAPTCHA boxes*

![](/assets/images/page200/screenshot-2024-11-20-at-4.57.56pm-2136x881.png)
*I disabled form filling assistance*

![](/assets/images/page200/screenshot-2024-11-20-at-4.58.15pm-2136x1106.png)
*I clicked the Update permission button*

![](/assets/images/page200/screenshot-2024-11-20-at-4.58.55pm-2136x1101.png)
*I updated the existing Account Customer Order table permissions*

![](/assets/images/page200/screenshot-2024-11-20-at-4.59.04pm-2136x1104.png)
*I added Permission to Update*

![](/assets/images/page200/screenshot-2024-11-20-at-5.00.10pm-2136x979.png)
*I update the Edit record action to redirect to the Update Customer Order page (I would need to add additional detail see below)*

![](/assets/images/page200/screenshot-2024-11-20-at-5.00.31pm-2136x670.png)
*I opened the List Customer Order page and clicked the Edit menu item*

![](/assets/images/page200/screenshot-2024-11-20-at-5.00.46pm-2136x985.png)
*Robert did not have permission to view the Customer Order Lines*

![](/assets/images/page200/screenshot-2024-11-20-at-7.16.19pm-2136x953.png)
*I added the Order lookup to the New Customer Order Line form. I marked the lookup as Hidden.*

![](/assets/images/page200/screenshot-2024-11-20-at-5.11.48pm-2136x1101.png)
*I saved the form as Portal New Customer Order Line*

![](/assets/images/page200/screenshot-2024-11-20-at-5.13.01pm-2136x917.png)
*I created a New Customer Line page and added a form*

![](/assets/images/page200/screenshot-2024-11-20-at-5.13.40pm-2136x1100.png)
*In the Data tab I selected the Creates a new record option*

![](/assets/images/page200/screenshot-2024-11-20-at-5.13.57pm-2136x1096.png)
*I would need to return to the On submit settings*

![](/assets/images/page200/screenshot-2024-11-20-at-5.14.05pm-2136x953.png)
*I unchecked the CAPTCHA boxes*

![](/assets/images/page200/screenshot-2024-11-20-at-5.14.14pm-2136x976.png)
*I disabled form filling assistance*

![](/assets/images/page200/screenshot-2024-11-20-at-5.14.39pm-2136x1101.png)
*I could not add Account permissions (because I had not added an Account field to the Customer Order Lines table)*

![](/assets/images/page200/screenshot-2024-11-20-at-5.15.35pm-2136x1103.png)
*I added an Account field*

![](/assets/images/page200/screenshot-2024-11-20-at-5.16.29pm-2136x1101.png)
*I added a Created By Contact field*

![](/assets/images/page200/screenshot-2024-11-20-at-5.16.58pm-2136x1103.png)
*I added a Modified By Contact field*

![](/assets/images/page200/screenshot-2024-11-20-at-5.17.50pm-2136x1107.png)
*I added Account Customer Order Line table permissions*

![](/assets/images/page200/screenshot-2024-11-20-at-5.18.24pm-2136x1106.png)
*I added Permission to Read, Update, Create and Delete for Authenticated Users*

![](/assets/images/page200/screenshot-2024-11-20-at-5.18.57pm-2136x1032.png)
*I previewed the Update Customer Order form. There was no way to Create a Customer Order Line*

![](/assets/images/page200/screenshot-2024-11-20-at-5.20.03pm-2136x840.png)
*I added New Basic Form Metadata*

![](/assets/images/page200/screenshot-2024-11-20-at-5.20.29pm-2136x917.png)
*This Basic Form Metadata entry would (On Save) update the Modified By Contact value in the Customer Order*

![](/assets/images/page200/screenshot-2024-11-20-at-5.20.56pm-2136x1023.png)
*The Current User's Contact would be used to update the Modified By Contact value*

![](/assets/images/page200/screenshot-2024-11-20-at-5.21.10pm-2136x911.png)
*I clicked the + New Basic Form Meta data button again*

![](/assets/images/page200/screenshot-2024-11-20-at-5.21.37pm-2136x1106.png)
*I selected Type Subgrid*

![](/assets/images/page200/screenshot-2024-11-20-at-5.22.22pm-2136x1106.png)
*I added a Create View Action. This will ensure that a Create Line button is shown. Clicking the Create Line button will redirect the user to the New Customer Order Line page*

![](/assets/images/page200/screenshot-2024-11-20-at-5.22.44pm-2136x1058.png)
*As Robert I clicked the Create Line button*

![](/assets/images/page200/screenshot-2024-11-20-at-5.23.30pm-2136x1043.png)
*I was redirected to the New Customer Order Line page*

![](/assets/images/page200/screenshot-2024-11-20-at-5.24.33pm-2136x1053.png)
*I was unable to select an Item*

![](/assets/images/page200/screenshot-2024-11-20-at-5.25.27pm-2136x834.png)
*I confirmed that I could see the Item table as the administrator*

![](/assets/images/page200/screenshot-2024-11-20-at-5.31.41pm-2136x894.png)
*I created a Portal All Items view*

![](/assets/images/page200/screenshot-2024-11-20-at-5.33.32pm-2136x783.png)
*I added columns to this view*

![](/assets/images/page200/screenshot-2024-11-20-at-5.34.16pm-2136x1103.png)
*I added a List Items page*

![](/assets/images/page200/screenshot-2024-11-20-at-5.34.54pm-2136x958.png)
*I added h1 text and a List*

![](/assets/images/page200/screenshot-2024-11-20-at-5.35.08pm-2136x982.png)
*I clicked the + New List button*

![](/assets/images/page200/screenshot-2024-11-20-at-5.35.54pm-2136x1011.png)
*I added the List All Items list*

![](/assets/images/page200/screenshot-2024-11-20-at-5.36.53pm-2136x1107.png)
*I added Permission to Read*

![](/assets/images/page200/screenshot-2024-11-20-at-5.39.27pm-2136x1101.png)
*I returned to the New Customer Order Line page and was able to select an Item*

![](/assets/images/page200/screenshot-2024-11-20-at-5.39.56pm-2136x1014.png)
*I clicked the Submit button*

![](/assets/images/page200/screenshot-2024-11-20-at-5.40.20pm-2136x846.png)
*Submission completed successfully?*

![](/assets/images/page200/screenshot-2024-11-20-at-5.40.42pm-2136x1052.png)
*The new Customer Order Line was not displayed*

![](/assets/images/page200/screenshot-2024-11-20-at-5.41.56pm-2136x751.png)
*I added a Basic Form Metadata entry*

![](/assets/images/page200/screenshot-2024-11-20-at-5.42.20pm-2136x879.png)
*The Basic Form Metadata entry would set the Customer Order Line Account field*

![](/assets/images/page200/screenshot-2024-11-20-at-5.42.42pm-2136x1024.png)
*The Account field would be set using the Current User's Company Name.*

![](/assets/images/page200/screenshot-2024-11-20-at-5.43.12pm-2136x942.png)
*I added another Basic Form Metadata entry*

![](/assets/images/page200/screenshot-2024-11-20-at-5.43.29pm-2136x844.png)
*This Basic Form Metadata entry will set the Created By Contact field*

![](/assets/images/page200/screenshot-2024-11-20-at-5.43.58pm-2136x1084.png)
*The Created By Contact field will be set to the Current User's Contact*

![](/assets/images/page200/screenshot-2024-11-20-at-5.44.17pm-2136x907.png)
*I added another Basic Form Metadata entry*

![](/assets/images/page200/screenshot-2024-11-20-at-5.44.36pm-2136x783.png)
*This Basic Form Metadata entry will set the Modified By Contact field*

![](/assets/images/page200/screenshot-2024-11-20-at-5.45.00pm-2136x918.png)
*The Modified By Contact field will be set to the Current User's Contact*

![](/assets/images/page200/screenshot-2024-11-20-at-5.45.16pm-2136x929.png)
*I had created these three Basic Form Metadata entries*

![](/assets/images/page200/screenshot-2024-11-20-at-7.50.00pm-2136x1101.png)
*I updated the Update Existing Customer Order Line's On Success Settings. This new setting would redirect the user back to the Update Customer Order page passing the Current Order's id*

![](/assets/images/page200/screenshot-2024-11-20-at-7.50.33pm-2136x1018.png)
*I tested the subgrid's delete action*

![](/assets/images/page200/screenshot-2024-11-20-at-7.50.39pm-2136x653.png)
*I confirmed the delete action*

![](/assets/images/page200/screenshot-2024-11-20-at-7.52.29pm-2136x1100.png)
*I updated the subgrid's edit action to redirect the user to the Update Customer Order Line page*

![](/assets/images/page200/screenshot-2024-11-20-at-7.52.47pm-2136x1085.png)
*I tested the edit action*

![](/assets/images/page200/screenshot-2024-11-20-at-7.53.11pm-2136x1091.png)
*I updated the Quantity and clicked the Submit button*

![](/assets/images/page200/screenshot-2024-11-20-at-7.53.25pm-2136x1094.png)
*The updated Quantity was displayed*

![](/assets/images/page200/screenshot-2024-11-20-at-7.54.05pm-2136x1104.png)
*I needed to create code that would set the hidden Customer Order lookup field value based on the refid url value passed to the New Customer Order Line page*

![](/assets/images/page200/screenshot-2024-11-20-at-7.54.14pm-2136x1110.png)
*I clicked the Open Visual Studio Code button*

![](/assets/images/page200/screenshot-2024-11-20-at-11.16.45pm-2136x950.png)
*I added code that would set the hidden Order lookup field based on the refid url parameter*

![](/assets/images/page200/screenshot-2024-11-20-at-7.57.28pm-2136x1174.png)
*I added Liquid tags to the New Customer Order Line html to fetch Item table details and store the result in a hidden id input tag.*

![](/assets/images/page200/screenshot-2024-11-20-at-7.59.49pm-2136x1178.png)
*I updated the javascript code to lookup unit price values and calculate the amount field value*

![](/assets/images/page200/screenshot-2024-11-20-at-8.10.07pm-2136x1171.png)
*I made the same changes to the Update Customer Order Line page's html and javascript*

![](/assets/images/page200/screenshot-2024-11-20-at-11.40.32pm-2136x1104.png)
*I updated the On Success Settings of the Create New Customer Order form. On Submit the user is redirected to the Update Customer Order form (passing the new Customer Order's id as a url parameter)*

![](/assets/images/page200/screenshot-2024-11-20-at-11.27.23pm-2136x898.png)
*I created a new Customer Order*

![](/assets/images/page200/screenshot-2024-11-20-at-11.29.50pm-2136x1003.png)
*I entered a Requested Delivery Date*

![](/assets/images/page200/screenshot-2024-11-20-at-11.29.57pm-2136x798.png)
*I clicked the Submit button*

![](/assets/images/page200/screenshot-2024-11-20-at-11.30.29pm-2136x1112.png)
*I clicked on the Create Line button to add a Customer Order Line*

![](/assets/images/page200/screenshot-2024-11-20-at-11.30.53pm-2136x1103.png)
*I selected an Item*

![](/assets/images/page200/screenshot-2024-11-20-at-11.31.08pm-2136x1037.png)
*I entered a Quantity and the Amount was calculated. I clicked Submit.*

![](/assets/images/page200/screenshot-2024-11-20-at-11.31.21pm-2136x1109.png)
*I was able to see the new Customer Order Line*

![](/assets/images/page200/screenshot-2024-11-20-at-11.31.31pm-2136x1074.png)
*I clicked the edit action*

![](/assets/images/page200/screenshot-2024-11-20-at-11.31.47pm-2136x1094.png)
*I updated the Quantity to 10. The Amount was recalculated. I clicked Submit*

![](/assets/images/page200/screenshot-2024-11-20-at-11.31.57pm-2136x1097.png)
*The line details were updated. I clicked Submit*

![](/assets/images/page200/screenshot-2024-11-20-at-11.32.08pm-2136x881.png)
*I returned to the List Customer Orders page*


## New Customer Order Line.en-US.customjs.js

```text
console.log("Code loaded");
 
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$CONTENT$");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}
 
 
$(document).ready(function () {
 
    // set the orderid using url parameter
    var orderId = getParameterByName('refid');
 
    $('#hadd_order_name').attr('value', 'Customer Order');
    $('#hadd_order').attr('value', orderId);
    $('#hadd_order_entityname').attr('value', 'hadd_customerorder');
})
```

## New Customer Order Line.en-US.webpage.copy.html

```text
<div class="row sectionBlockLayout text-start" style="display: flex; flex-wrap: wrap; margin: 0px; min-height: auto; padding: 8px;">
  <div class="container" style="display: flex; flex-wrap: wrap;">
    <div class="col-lg-12 columnBlockLayout" style="flex-grow: 1; display: flex; flex-direction: column; min-width: 250px; padding: 16px; margin: 60px 0px;">
      <h1 style="text-align: left;">New Customer Order Line</h1>
      {% entityform name: 'Create New Customer Order Line' %}
    </div>
  </div>
</div>

{% fetchxml resultVariable %}
<fetch mapping="logical">
  <entity name="dyn365bc_item_v2_0">
    <attribute name="dyn365bc_item_v2_0id" />
    <attribute name="dyn365bc_displayname" />
    <attribute name="dyn365bc_unitprice" />
    <attribute name="dyn365bc_inventory" />
    <order attribute="dyn365bc_displayname" descending="false">
    </order>
  </entity>
</fetch>
{% endfetchxml %}
 
<input id="items" type="hidden" value='{
{% for entityVariable in resultVariable.results.entities %}
"{{ entityVariable.dyn365bc_item_v2_0id }}":
 {
   "id": "{{ entityVariable.dyn365bc_item_v2_0id }}",
   "displayname": "{{ entityVariable.dyn365bc_displayname }}",
   "unitprice": {{ entityVariable.dyn365bc_unitprice }},
   "inventory": {{ entityVariable.dyn365bc_inventory }}
}
{% unless forloop.last %}, {% endunless %}
{% endfor %}
}' />
```

## New Customer Order Line.en-US.customjs.js updated

```text
console.log("Code loaded");
 
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$CONTENT$");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}
 
 
$(document).ready(function () {
 
    // set the orderid using url parameter
    var orderId = getParameterByName('refid');
 
    $('#hadd_order_name').attr('value', 'Customer Order');
    $('#hadd_order').attr('value', orderId);
    $('#hadd_order_entityname').attr('value', 'hadd_customerorder');

    // set the unit cost and amount fields
    const itemsJSON = $("#items").val();
    const items = JSON.parse(itemsJSON);
 
    const currencyOptions = {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
        style: 'currency',
        currency: 'USD'
    };
 
    const numberOptions = {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
    };
 
    const updateAmountField = () => {
        const unitPrice = parseFloat($("#hadd_unitprice").val().replace(/[$,]+/g,"")) || 0;
        const quantity = parseFloat($("#hadd_quantity").val()) || 0;
        const amount = unitPrice * quantity;
        const formattedAmount = amount.toLocaleString('en', numberOptions);
        $("#hadd_amount").val(formattedAmount);
    };
 
    // set price to be readonly
    $("#hadd_unitprice").prop('readonly', true);
 
    const lookupFieldSelector = $("#hadd_item");
    if (lookupFieldSelector.length) {
        lookupFieldSelector.on("change", function () {
            console.log("Item selection changed");
 
            const selectedValue = $(this).val();
            console.log("Selected lookup value:", selectedValue);
 
            const selectedItem = items[selectedValue] || null;
            console.log(selectedItem);
 
            if (selectedItem) {
                const unitPriceFormatted = Number(selectedItem.unitprice).toLocaleString('en', numberOptions);
                $("#hadd_unitprice").val(unitPriceFormatted);
            } else {
                $("#hadd_unitprice").val("");
            }
 
            updateAmountField();
        });
    } else {
        console.warn("Item field not found");
        $("#hadd_unitprice").val("");
    }
 
    const quantityFieldSelector = $("#hadd_quantity");
    if (quantityFieldSelector.length) {
        quantityFieldSelector.on("change", function () {
            console.log("Quantity changed");
            updateAmountField();
        });
    } else {
        console.warn("Quantity field not found");
        $("#hadd_amount").val("");
    }
});
```
## References

- [Creating a Power Page Basic Forms to Insert Data](https://www.youtube.com/watch?v=DzIYDaAoguU)



---

## page50

**Source file:** `page50.md`

---
title: "Next.js (Part 4)"
description: "next-pwa"
date: "2025-09-20"
categories: ["Web Development"]
image: "/assets/images/page50/hero.png"
tags: ["aws"]
hidden: true
slug: "page50"
---



API routes let you create an API endpoint inside a Next.js app.

To create an API endpoint inside a Next.js app add a file (or folder) to the /pages/api directory

---

## page55

**Source file:** `page55.md`

---
title: "Page 55"
description: "References"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/page55/hero.png"
tags: []
hidden: true
slug: "page55"
---

# Page 55
- [Web Components Are Easier Than You Think](https://css-tricks.com/web-components-are-easier-than-you-think/)



---

## page65

**Source file:** `page65.md`

---
title: "Machine Learning (Part 4a)"
description: "WIP"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/page65/hero.png"
tags: ["python","ai","ml","machine learning","git"]
hidden: true
slug: "page65"
---

# Machine Learning (Part 4a)

## WIP

![](/assets/images/page65/tensorflow-logo.svg)
*Tensorflow logo does not meet the threshold of originality needed for copyright protection, and is therefore in the public domain*


## Colab

Colab is Google's implementation of [Jupyter Notebooks](https://jupyter.org).

 A Colab consists of [text cell comments and code cell Python code](https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/numpy_ultraquick_tutorial.ipynb?utm_source=mlcc&utm_campaign=colab-external&utm_medium=referral&utm_content=numpy_tf2-colab&hl=en#scrollTo=vO47lN3aDOAv)


## NumPy

[NumPy](https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/numpy_ultraquick_tutorial.ipynb?utm_source=mlcc&utm_campaign=colab-external&utm_medium=referral&utm_content=numpy_tf2-colab&hl=en#scrollTo=HF-flFfs9r0q) is a Python library for creating and manipulating vectors and matrices.

![](/assets/images/page65/screen-shot-2022-06-08-at-6.23.23-pm-757x144.png)
*import numpy as np*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.24.04-pm-745x209.png)
*np.array([...])*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.25.18-pm-764x221.png)
*np.array([[...],[...],...,[...]]*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.27.05-pm-755x262.png)
*a sequence from 5 to 11*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.28.11-pm-783x247.png)
*6 random values between 50 and 100*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.29.30-pm-788x165.png)
*5 random floating point values between 0 and 1*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.33.42-pm-788x475.png)
*feature and label*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.36.16-pm-788x402.png)
*adding noise*


## Pandas

[Pandas DataFrames](https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/pandas_dataframe_ultraquick_tutorial.ipynb?utm_source=mlcc&utm_campaign=colab-external&utm_medium=referral&utm_content=pandas_tf2-colab&hl=en) are similar to spreadsheets. DataFrames have columns and rows.

![](/assets/images/page65/screen-shot-2022-06-08-at-6.49.03-pm-787x164.png)
*import numpy and pandas*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.50.52-pm-789x650.png)
*pd.DataFrame(data=<data cell values>, columns=<column names>)*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.54.36-pm-779x348.png)
*<dataframe>["<new column name>"] = <dataframe>["<existing column name>"] + <constant>*

![](/assets/images/page65/screen-shot-2022-06-08-at-6.58.28-pm-787x739.png)
*<dataframe>[<start index>,<end index + 1>]*

![](/assets/images/page65/screen-shot-2022-06-08-at-7.01.31-pm-786x991.png)
*<dataframe>.copy()*


## Linear Regression with TensorFlow

We can use machine learning to predict House Prices.

![](/assets/images/page65/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page65/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page65/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page65/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/page65/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*


---

## page68

**Source file:** `page68.md`

---
title: "Machine Learning (Part 7)"
description: "Baseball Signals"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/page68/hero.png"
tags: ["ai","machine learning"]
hidden: true
slug: "page68"
---

# Machine Learning (Part 7)

## Baseball Signals

![](/assets/images/page68/tensorflow-logo.svg)
*Tensorflow logo does not meet the threshold of originality needed for copyright protection, and is therefore in the public domain*


## Stealing Baseball Signs

Can we predict when a baseball player is going to try to "steal"?


---

## page86

**Source file:** `page86.md`

---
title: "ASP.NET 5 Visual Basic"
description: "Generate Context and Entity Classes from an Existing Database"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/page86/hero.png"
tags: ["azure","docker","dotnet","sql","database"]
hidden: true
slug: "page86"
---

# ASP.NET 5 Visual Basic

## Generate Context and Entity Classes from an Existing Database

![](/assets/images/page86/net-logo.svg)
*Microsoft Dotnet Logo by Microsoft Corporation is licensed under Creative Commons CC0 1.0 Universal Public Domain Dedication*


## Active Server Pages

ASP Web Forms was released in 2003 (based on the Windows Server and the .NET Framework)
ASP.NET Model-View-Controller 5 was released in 2009 (based on Windows Server and .NET Framework and Supported in Visual Studio 2019)
ASP.NET Core Model-View-Controller was released in 2017 (based on cross platform .NET Core and Supported in Visual Studio 2022)

I used Visual Studio 2019 and ASP.NET MVC 5 to create a todo app.

![](/assets/images/page86/capture4-create-new-project-1026x677.png)
*I created a new project*

![](/assets/images/page86/capture5-configure-new-project-1022x677.png)
*I configured the new project*

![](/assets/images/page86/capture6-mvc-vb-1020x707.png)
*I created a Model-View-Controller web application*

![](/assets/images/page86/capture7-home-view-1353x729.png)
*I ran the template project (notice the "ASP.NET MVC gives" text in the index.vbhtml file and the web browser).*

![](/assets/images/page86/capture8-layout-1416x726.png)
*The _Layout.vbhtml file provides a common web page framework and navigation*

![](/assets/images/page86/capture9-controller-1382x667.png)
*Web requests are handled by Controller functions/methods. The controller function will typically return a view (the Web response). The About function sets a "Message" value and then returns a corresponding About view.*

![](/assets/images/page86/capture10-controller-passing-to-view-1405x638.png)
*Notice that the About view renders the "Message".*

![](/assets/images/page86/capture11-new-folder-842x501.png)
*I created a new HelloWorld folder in the Views folder.*

![](/assets/images/page86/capture12-new-view-2-993x492.png)
*I added a view page to the HelloWorld folder.*

![](/assets/images/page86/capture13-new-view-3-995x287.png)
*I named the new page "Index" making it the home page for the new folder.*

![](/assets/images/page86/capture14-new-view-4-1097x495.png)
*I selected the existing _Layout page*

![](/assets/images/page86/capture15-new-view-5-1387x306.png)
*I added a reference to a "Name" value.*

![](/assets/images/page86/capture16-new-controller-1-876x298.png)
*I added a new controller to the project*

![](/assets/images/page86/capture17-new-controller-2-1365x683.png)
*I created an empty controller.*

![](/assets/images/page86/capture18-new-controller-3-1114x350.png)
*I named the controller HelloWorldController (in line with the folder I had already created)*

![](/assets/images/page86/capture19-new-controller-4-1419x311.png)
*Visual Studio created an Index function that would handle requests for the HelloWorld page and return the Index view*

![](/assets/images/page86/capture20-new-controller-5-1364x615.png)
*I added the folder name HelloWorld to the url and got the result above*

![](/assets/images/page86/capture21-new-controller-6-1362x545.png)
*I updated the Controller function to set the "Name" value before returning the view. I refreshed the browser.*

![](/assets/images/page86/capture26-docker-sql-server-1157x622.png)
*docker run -e "ACCEPT_EULA=Y" -e "SA_PASSWORD=Passw0rd123" -p 1433:1433 --name sql2019 -d mcr.microsoft.com/mssql/server:2019-latest*

![](/assets/images/page86/capture27-docker-sql-server-2-1157x623.png)
*I downloaded a SQL Server docker image*

![](/assets/images/page86/capture28-docker-sql-server-3-1154x620.png)
*I created a container based in the downloaded docker image*

![](/assets/images/page86/capture29-docker-sql-server-5-1364x230.png)
*I used Visual Studio to create a new database in the docker container's SQL Server*

![](/assets/images/page86/capture30-docker-sql-server-6-1047x509.png)
*I entered the credentials*

![](/assets/images/page86/capture32-docker-sql-server-8-1025x729.png)
*To get another view of the database I opened Azure Data Studio*

![](/assets/images/page86/capture33-docker-sql-server-9-1023x729.png)
*I entered the address of the SQL Server and the credentials*

![](/assets/images/page86/capture34-docker-sql-server-10-1027x728.png)
*I selected the ToDo database*

![](/assets/images/page86/capture35-docker-sql-server-11-1026x423.png)
*I created a Tasks table (with an automatically assigned ID column, a description column and a done boolean column)*

![](/assets/images/page86/capture36-docker-sql-server-12-1359x471.png)
*I refreshed Data Connections in Visual Studio*

![](/assets/images/page86/capture37-docker-sql-server-14-808x240.png)
*I selected the Models folder and selected the Add | New Item... menu item*

![](/assets/images/page86/capture38-docker-sql-server-15-941x573.png)
*I entered the name ToDoContext and selected ADO.NET Entity Data Model*

![](/assets/images/page86/capture39-docker-sql-server-16-616x559.png)
*I selected Code First from database*

![](/assets/images/page86/capture40-docker-sql-server-17-612x560.png)
*I asked Visual Studio to save the connection details in the Web.Config file (notice that the Web.Config file is never returned to a client browser)*

![](/assets/images/page86/capture41-docker-sql-server-18-616x554.png)
*I selected the Tasks table*

![](/assets/images/page86/capture42-docker-sql-server-19-1365x331.png)
*The Task class is generated*

![](/assets/images/page86/capture43-docker-sql-server-20-880x242.png)
*I selected the Controller folder and selected the Add | New Scaffolded Item... menu item*

![](/assets/images/page86/capture44-docker-sql-server-21-952x658.png)
*I selected the MVC 5 Controller with view, using Entity Framework option*

![](/assets/images/page86/capture45-docker-sql-server-22-589x381.png)
*I entered the Model class name (Task) and the Data context class (ToDoContext).*

![](/assets/images/page86/capture46-docker-sql-server-23-1364x312.png)
*Visual Studio added CRUD controller functions and views.*

![](/assets/images/page86/capture47-docker-sql-server-24-1359x664.png)
*The controller functions includes Index. The TaskController.Index function will fetch all Tasks from the database and then display then using the corresponding Tasks/Index view*

![](/assets/images/page86/capture48-docker-sql-server-25-1363x729.png)
*The TaskController.Index function is executed when a user navigates to /Tasks (see above)*

![](/assets/images/page86/capture49-docker-sql-server-26-1040x622.png)
*Clicking on the Create New link navigates the user to the TaskController.Create function (returning the generated Create form)*

![](/assets/images/page86/capture49-docker-sql-server-26-1040x622.png)
*I entered the new task text "Feed the fish" and clicked the create Create button. This posted the contents of the form to another Controller function.*

![](/assets/images/page86/capture51-docker-sql-server-28-1038x616.png)
*The post handling function added the item to the database table and redirected the user back to the Index page.*

![](/assets/images/page86/capture52-docker-sql-server-29-1040x617.png)
*I used the generated Edit page to update the task.*

![](/assets/images/page86/capture53-docker-sql-server-30-1040x616.png)
*Once the database table row has been updated the use is (again) redirected to the Index page.*

![](/assets/images/page86/capture54-docker-sql-server-31-1039x616.png)
*I added a couple of extra task and marked the Feed the cat task as done.*

![](/assets/images/page86/capture55-docker-sql-server-32-997x722.png)
*I reviewed the database table using the Azure Data Studio application*

![](/assets/images/page86/capture56-docker-sql-server-33-1364x668.png)
*Above is an example of the Controller code*

![](/assets/images/page86/capture57-docker-sql-server-34-1365x668.png)
*Above is an example of the View code*

![](/assets/images/page86/capture58-docker-sql-server-35-1366x728.png)
*I pushed the project to GitHub*
## References

- [Getting started with ASP.NET MVC 5](https://learn.microsoft.com/en-us/aspnet/mvc/overview/getting-started/introduction/getting-started)



---

## phaser

**Source file:** `phaser.md`

---
title: "Phaser"
description: "2D game framework used for making HTML5 games"
date: "2022-01-23"
categories: ["JavaScript",".NET"]
tags: []
slug: "phaser"
image: "/assets/images/phaser-logo-1836x1530.png"
---


## Getting Started

A [getting started sample](https://haddley.github.io/phaser/index.html) includes a config object, a preload function and a create function.

The preload function is used to load the Phaser assets.

The create function is used to add assets to the scene/game.

![](/assets/images/phaser/screen-shot-2022-01-23-at-1.53.03-pm-1836x870.png)
*Getting Started - index.htm*

![](/assets/images/phaser/screen-shot-2022-01-23-at-2.22.32-pm-1836x1110.png)
*Getting Started - running*


## Aquarium

I created an animated [Aquarium](https://haddley.github.io/aquarium/index.html) based on [https://github.com/lrusso/Aquarium](https://github.com/lrusso/Aquarium).

The Aquarium code includes a config object, a preload function, a create function and an update function.

Again the preload function is used to load the Phaser assets.

Again the create function is used to add assets to the scene/game.

Here the update function is called (over and over again) as the main/game loop runs. 

The update function animates the scene (moving the fish and the bubbles).

![](/assets/images/phaser/screen-shot-2022-01-26-at-9.01.25-am-1357x1009.png)
*Aquarium with artwork*


## index.htm

```text
<!DOCTYPE html>
<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser-arcade-physics.min.js"></script>
</head>

<body>

    <script>
        var config = {

            type: Phaser.AUTO,
            
            width: 800,
            height: 600,

            scale: {

                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH,

            },

            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 200 }
                }
            },

            scene: {
                preload: preload,
                create: create
            }
        };

        var game = new Phaser.Game(config);

        function preload() {
            this.load.setBaseURL('https://labs.phaser.io');

            this.load.image('sky', 'assets/skies/space3.png');
            this.load.image('logo', 'assets/sprites/phaser3-logo.png');
            this.load.image('red', 'assets/particles/red.png');
        }

        function create() {
            this.add.image(400, 300, 'sky');

            var particles = this.add.particles('red');

            var emitter = particles.createEmitter({
                speed: 100,
                scale: { start: 1, end: 0 },
                blendMode: 'ADD'
            });

            var logo = this.physics.add.image(400, 100, 'logo');

            logo.setVelocity(100, 200);
            logo.setBounce(1, 1);
            logo.setCollideWorldBounds(true);

            emitter.startFollow(logo);
        }
    </script>

</body>

</html>
```

## Index.html

```text
<!DOCTYPE html>
<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser-arcade-physics.min.js"></script>
</head>

<body style="background-color: black;">

    <script>

        function getRandomBubbleX(columnIndex) {
            if (columnIndex == 1) {
                return this.getRandomInteger(70, 90);
            }
            else if (columnIndex == 2) {
                return this.getRandomInteger(250, 275);
            }
            else if (columnIndex == 3) {
                return this.getRandomInteger(450, 470);
            }
        }

        function getRandomBubbleY() {
            return this.getRandomInteger(450, 800);
        }

        function getRandomAngle() {
            var randomValue = this.getRandomInteger(1, 100);

            if (randomValue < 33) {
                // RETURNING A LOOKING FORWARD FISH ANGLE ORIENTATION
                return 0;
            }
            else if (randomValue < 66) {
                // RETURNING A LOOKING DOWN FISH ANGLE ORIENTATION
                return 20;
            }
            else {
                // RETURNING A LOOKING UP FISH ANGLE ORIENTATION
                return -20;
            }
        }

        function getRandomX() {
            // GETTING A RANDOM NUMBER BETWEEN 60 AND 500 (THE GAME WIDTH WITH A MARGIN)
            return this.getRandomInteger(60, 500);
        }

        function getRandomY() {
            // GETTING A RANDOM NUMBER BETWEEN 60 AND 300 (THE GAME HEIGHT WITH A MARGIN)
            return this.getRandomInteger(60, 300);
        }

        function getRandomInteger(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        var config = {

            type: Phaser.AUTO,

            width: 576, height: 432,

            scale: {

                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH,

            },

            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        bubbles = []
        fishCount = 16

        var game = new Phaser.Game(config)

        function preload() {

            // LOAD THE IMAGES
            this.load.image("imageBackground", 'imageBackground.jpeg');
            this.load.image("imageBubbles", 'imageBubbles.png');

            for (let i = 0; i < fishCount; i++) {
                this.load.image("imageFish" + (i + 1), "fish" + (i + 1) + "_64.png");
            }

            // LOAD THE AUDIO
            this.load.audio('audioBubbles', 'audioBubbles.mp3');

        }

        function create() {

            // ADD THE AUDIO
            this.bubbles = this.sound.add('audioBubbles', { volume: 0.1, loop: true });
            this.bubbles.play();

            // ADD THE BACKGROUND IMAGE
            this.add.sprite(576 / 2, 432 / 2, "imageBackground");

            fishes = []

            // ADD THE FISH
            for (let i = 0; i < fishCount; i++) {
                const fish = this.add.sprite(getRandomX(), getRandomY(), "imageFish" + (i + 1));
                fish.fishSpeed = 1;
                fish.angle = getRandomAngle();
                fish.inputEnabled = true;
                fishes.push(fish);
            }

            // ADD BUBBLES
            for (var column = 0; column < 3; column++) {
                for (var i = 0; i < 9; i++) {
                    var tempBubble = this.add.sprite(getRandomBubbleX(column + 1), getRandomBubbleY(), "imageBubbles");
                    tempBubble.columnIndex = column + 1;
                    tempBubble.alpha = 0.7;
                    tempBubble.setScale(.5);
                    bubbles.push(tempBubble);
                }
            }


        }

        function update() {

            if (game.sound.context.state === 'suspended') {
                game.sound.context.resume();
            }

            // LOOP FOR EVERY FISH
            for (var i = 0; i < fishes.length; i++) {

                // GET A FISH
                var fish = fishes[i];

                // CHECK THE FISH ORIENTATION
                if (fish.scale == 1) {
                    // MOVING THE FISH TO THE RIGHT
                    fish.x = fish.x + fish.fishSpeed;
                }
                else {
                    // MOVING THE FISH TO THE LEFT
                    fish.x = fish.x - fish.fishSpeed;
                }

                // CHECK IF THE FISH IS NOT VISIBLE (RIGHT SIDE)
                if (fish.x > 650) {
                    // RESTORING THE ORIGINAL FISH SPEED
                    fish.fishSpeed = 1;

                    // CHANGING THE FISH ORIENTATION
                    fish.scale = -1;

                    // CHANGING THE FISH Y POSITION TO A RANDOM VALUE
                    fish.y = getRandomY();

                    // CHANGING THE FISH ANGLE TO A RANDOM VALUE
                    fish.angle = getRandomAngle();
                }

                // CHECK IF THE FISH IS NOT VISIBLE (LEFT SIDE)
                else if (fish.x < -70) {
                    // RESTORING THE ORIGINAL FISH SPEED
                    fish.fishSpeed = 1;

                    // CHANGING THE FISH ORIENTATION
                    fish.scale = 1;

                    // CHANGING THE FISH Y POSITION TO A RANDOM VALUE
                    fish.y = getRandomY();

                    // CHANGING THE FISH ANGLE TO A RANDOM VALUE
                    fish.angle = getRandomAngle();
                }

                // CHECK IF THE FISH IS NOT VISIBLE (TOP SIDE)
                if (fish.y < -70) {
                    // MOVING THE FISH TO THE LEFT SIDE
                    fish.x = -70;

                    // CHANGING THE FISH Y POSITION TO A RANDOM VALUE
                    fish.y = getRandomY();

                    // RESTORING THE FISH ANGLE
                    fish.angle = 0;
                }

                // CHECK IF THE FISH IS NOT VISIBLE (BOTTOM SIDE)
                else if (fish.y > 650) {
                    // MOVING THE FISH TO THE RIGHT SIDE
                    fish.x = 650;

                    // CHANGING THE FISH Y POSITION TO A RANDOM VALUE
                    fish.y = getRandomY();

                    // RESTORING THE FISH ANGLE
                    fish.angle = 0;
                }

                // CHECK THE FISH SCALE AND ANGLE AND MOVING UP OR DOWN ACCORDINGLY
                if ((fish.scale == 1 && fish.angle == 20) || (fish.scale == -1 && fish.angle == -20)) {
                    fish.y = fish.y + fish.fishSpeed / 2;
                }
                else if ((fish.scale == 1 && fish.angle == -20) || (fish.scale == -1 && fish.angle == 20)) {
                    fish.y = fish.y - fish.fishSpeed / 2;
                }
            }

            // LOOP FOR EVERY BUBBLE
            for (var i = 0; i < bubbles.length; i++) {
                // GET A BUBBLE
                var bubble = bubbles[i];

                // MOVE THE BUBBLE
                bubble.y = bubble.y - 1;

                // CHECK IF THE BUBBLE IS NOT VISIBLE
                if (bubble.y < -150) {
                    // MOVE THE BUBBLE DOWN
                    bubble.x = getRandomBubbleX(bubble.columnIndex);
                    bubble.y = getRandomBubbleY();
                }
            }
        }

    </script>

</body>

</html>
```

## References

- [Aquarium](https://haddley.github.io/aquarium/index.html)

---

## phpsetup

**Source file:** `phpsetup.md`

---
title: "PHP Setup"
description: "Setup"
date: "2024-08-25"
categories: []
tags: []
slug: "phpsetup"
image: "/assets/images/php-logo.svg"
---


PHP is a server scripting language, and a powerful tool for making dynamic and interactive Web pages.

PHP is a widely-used, free, and efficient alternative to competitors such as Microsoft's ASP.

![](/assets/images/phpsetup/screenshot-2024-08-24-at-9.31.34pm-1146x740.png)
*brew install php*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-9.33.26pm-1144x742.png)
*php -v*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-9.34.08pm-1142x746.png)
*php -S localhost:8000*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-9.34.43pm-1736x580.png)
*https://localhost:8000*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-9.39.18pm-1831x604.png)
*PHP Intelephense*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-9.40.15pm-1831x614.png)
*Code Runner (optional)*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-9.42.37pm-1831x837.png)
*using Code Runner*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-10.30.13pm-1831x841.png)
*php -S localhost:8000*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-10.30.40pm-1831x398.png)
*https://localhost:8000/prog.php*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-10.32.05pm-1831x846.png)
*phpinfo()*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-10.32.25pm-1831x991.png)
*phpinfo() is used to check configuration settings*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-10.34.44pm-1831x489.png)
*form.html*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-10.36.11pm-1831x336.png)
*action.php*

![](/assets/images/phpsetup/screenshot-2024-08-24-at-10.36.30pm-1831x339.png)
*https://localhost:8000/action.php*

---

## pi1

**Source file:** `pi1.md`

---
title: "Raspberry Pi Imager"
description: "Raspberry Pi Imager Advanced Options"
date: "2023-07-22"
categories: []
tags: []
slug: "pi1"
image: "/assets/images/raspberry-pi-logo.svg"
---


With the Raspberry Pi Imager tool, the process of writing a standard operating system image onto a microSD card is easy. 

Taking advantage of the Imager's advanced features, I customized the connectivity settings, allowing me to remotely access the Raspberry Pi immediately after powering it on for the first time.

![](/assets/images/pi1/raspberry-pi-setup-image-2-682x452.png)
*Imager*

![](/assets/images/pi1/raspberry-pi-setup-image-3-682x452.png)
*Raspberry Pi OS (32-bit)*

![](/assets/images/pi1/raspberry-pi-setup-image-4-682x452.png)
*SD Card*

![](/assets/images/pi1/raspberry-pi-setup-image-682x452.png)
*I used 'pi' as the admin username*

![](/assets/images/pi1/raspberry-pi-setup-image-5-682x452.png)
*I provide a hostname and enabled SSH (remote terminal access)*

![](/assets/images/pi1/raspberry-pi-setup-image-7-682x452.png)
*I pressed the WRITE button*

![](/assets/images/pi1/raspberry-pi-setup-image-8-682x452.png)
*I did want to erase the SD Card*

![](/assets/images/pi1/raspberry-pi-setup-image-10-682x452.png)
*The writing process took some time...*

![](/assets/images/pi1/raspberry-pi-setup-image-11-682x452.png)
*Finished*

![](/assets/images/pi1/raspberry-pi-setup-img-3336-1836x1377.jpg)
*I put the Micro SD Card into the Raspberry Pi and plugged in the power*

![](/assets/images/pi1/screen-shot-2023-07-22-at-1.44.46-pm-1138x736.png)
*I used ping to check that the Raspberry Pi was connected to the network*

![](/assets/images/pi1/screen-shot-2023-07-22-at-1.50.37-pm-1138x738.png)
*I connected to the Raspberry Pi using SSH*

![](/assets/images/pi1/screen-shot-2023-07-22-at-1.52.03-pm-1144x520.png)
*sudo apt-get install xrdp*

![](/assets/images/pi1/screen-shot-2023-07-22-at-1.56.43-pm-1136x742.png)
*I added a new administrative account "neil"*

![](/assets/images/pi1/screen-shot-2023-07-22-at-1.58.10-pm-1526x984.png)
*Microsoft Remote Desktop Client (for MacOS)*

![](/assets/images/pi1/screen-shot-2023-07-22-at-2.03.53-pm-1836x1148.png)
*Connected to raspberrypi.local as neil*
## References

- [Installing Raspbian using the Raspberry Pi | Raspberry pi imager, Raspbian](https://projects.raspberrypi.org/en/projects/imager-install)
- [How to use Raspberry Pi Imager | Install Raspberry Pi OS to your  Raspberry Pi (Raspbian)](https://www.youtube.com/watch?v=ntaXWS8Lk34)
- [5 Ways to Remote Desktop on Raspberry Pi (Windows/Linux/Mac)](https://raspberrytips.com/remote-desktop-raspberry-pi/)

---

## pi2

**Source file:** `pi2.md`

---
title: "Raspberry Pi GPIO"
description: "Raspberry Pi GPIO"
date: "2023-07-22"
categories: ["Python"]
tags: []
slug: "pi2"
image: "/assets/images/raspberry-pi-logo.svg"
---


The Raspberry Pi input and output pins can be controlled from the terminal.

![](/assets/images/pi2/screen-shot-2023-07-22-at-3.12.04-pm-1136x744.png)
*Controlling GPIO 17 (Pin 11) using a remote SSH terminal*

![](/assets/images/pi2/raspberry-pi-gpio-image1-1836x1377.jpg)
*Hardware setup*

![](/assets/images/pi2/screen-shot-2023-07-22-at-3.26.17-pm-978x564.png)
*Wiring details*

![](/assets/images/pi2/screen-shot-2023-07-22-at-6.38.38-pm-1836x1072.png)
*sudo python blinky.py*

![](/assets/images/pi2/screen-shot-2023-07-22-at-6.51.01-pm-710x96.png)
*Notice that Pin 11 === GPIO 17*


## blinky.py

```text
import RPi.GPIO as GPIO
import time

GPIO.setmode(GPIO.BOARD)
GPIO.setwarnings(False)

ledPin = 11

GPIO.setup(ledPin, GPIO.OUT)

for i in range(5):
 print("LED turning on.")
 GPIO.output(ledPin, GPIO.HIGH)
 time.sleep(0.5)
 print("LED turning off.")
 GPIO.output(ledPin, GPIO.LOW)
 time.sleep(0.5)
```
## References

- [Coding an LED using an GPIO pin](https://projects.raspberrypi.org/en/projects/leds-buzzers-scratch-games/2)
- [UNDERSTANDING RASPBERRY PI 4 GPIO PINOUTS](https://toptechboy.com/understanding-raspberry-pi-4-gpio-pinouts/)

---

## pluginactions

**Source file:** `pluginactions.md`

---
title: "Plugin Actions"
description: "A comprehensive guide covering plugin actions"
date: "2024-02-24"
categories: ["Power Platform"]
tags: []
slug: "pluginactions"
image: "/assets/images/office-365-icon-500x500.png"
---


I created a Plugin Action to add functionality to a copilot. The large language model is being used to establish inputs that will be passed to the Plugin Action and to generate output based on the response provided by the Plugin Action.

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.14.55-pm-1836x1066.png)
*I clicked the New copilot button*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.15.08-pm-1836x957.png)
*I accepted the default name. I did not provide a web site URL*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.15.21-pm-1836x954.png)
*The copilot was set up*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.15.40-pm-1836x959.png)
*I clicked the Skip button*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.16.12-pm-1836x330.png)
*I asked the copilot "What is the weather?"*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.16.36-pm-1836x960.png)
*I clicked the Topics & Plugins tab. I clicked the Add a plugin action (preview) button*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.16.54-pm-1836x959.png)
*I selected the Get forecast for today connector action*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.17.17-pm-1836x960.png)
*I clicked the Next button*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.17.27-pm-1836x956.png)
*I did not click the Finish button*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.17.43-pm-1836x956.png)
*I selected the Inputs section*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.18.06-pm-1836x959.png)
*I set the "Units" input to the value C (for Celsius)*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.18.33-pm-1836x960.png)
*I added Conditions as an output*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.19.29-pm-1836x960.png)
*I was unable to input a Display template*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.19.45-pm-1836x960.png)
*I clicked the Finish button*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.20.12-pm-1836x954.png)
*I tested the Copilot but the Plugin Action was ignored?*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.20.30-pm-1836x955.png)
*I clicked the Generative AI tab. I enabled the Dynamic chaining with generative actions (preview) option*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.21.36-pm-1836x960.png)
*I input "What is the weather?"The copilot asked me for a locationI input the location SydneyThe copilot provided a weather forecast for Sydney*

![](/assets/images/pluginactions/screenshot-2024-02-24-at-8.22.13-pm-1836x956.png)
*I asked the copilot "What is the weather in London"The copilot provided a weather forecast for London*

---

## postinggroups

**Source file:** `postinggroups.md`

---
title: "Posting Groups"
description: "Posting Groups"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/postinggroups/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "postinggroups"
---


## Daybook sub-ledgers

In Microsoft Dynamics 365 Business Central, daybook sub-ledgers are used to record and manage specific types of transactions.

Each daybook sub-ledger corresponds to a specific type of transaction or business process.

Common daybook sub-ledgers include:

**Bank Sub-ledger**
A Bank Journal is used for recording transactions related to bank accounts. It includes entries for bank deposits, withdrawals, and other bank-related transactions.

**Sales Tax Sub-ledger**
A Sales Tax Journal is used for recording transactions related to bank accounts. It includes entries for bank deposits, withdrawals, and other bank-related transactions.

**Sales Sub-ledger**
A Sales Journal is used for recording sales transactions. This includes entries related to sales invoices, sales orders, and other sales-related activities.

**Purchase Sub-ledger**
A Purchase Journal is used for recording purchase transactions. It includes entries related to purchase invoices, purchase orders, and other procurement-related activities.

**Inventory Sub-ledger**
An Inventory Journal is used for recording inventory transactions. It includes entries related to adjustments, transfers, and other inventory-related activities.


## Posting Groups

In Microsoft Dynamics 365 Business Central, Posting Groups are a set of configuration settings that help determine how transactions are posted to the general ledger. Posting Groups are used to "build a bridge" between Business Central sub-ledgers and the general ledger accounts. 

Posting Groups are a crucial aspect of the system's configuration, allowing businesses to establish rules for how financial transactions will be recorded.

Common Posting Groups include:

**General Posting Group**
Used to link general ledger accounts to customers, vendors, items, and resources. This helps determine the accounts affected when recording transactions in sales, purchases, and general journal entries.

**Customer Posting Group**
Links customers to specific general ledger accounts. When a sales transaction occurs, the Customer Posting Group determines the accounts that will be affected in the general ledger.

**Vendor Posting Group**
Similar to the Customer Posting Group but used for vendors. It links vendors to specific general ledger accounts for purchase transactions.

**Inventory Posting Group**
Links items to specific general ledger accounts. It determines the accounts affected when dealing with inventory-related transactions, such as purchases and sales of goods.

**Resource Posting Group**
Used in resource-related transactions to link resources to specific general ledger accounts.

**Bank Account Posting Group**
Determines the default general ledger accounts associated with specific bank accounts. This is important for recording bank transactions.

**Fixed Asset Posting Group**
Links fixed assets to specific general ledger accounts. It determines how fixed asset transactions are recorded in the general ledger.

**VAT Posting Groups**
Used to determine the general ledger accounts affected by Value Added Tax (VAT) transactions. This is crucial for businesses operating in regions where VAT is applicable.

By setting up and configuring these Posting Groups, businesses can ensure that their financial transactions are consistently and accurately recorded in the general ledger.

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/postinggroups/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

---

## powerapps23

**Source file:** `powerapps23.md`

---
title: "Power Apps (Part 23)"
description: "Integrating with Business Central using Power Automate"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/powerapps23/hero.png"
tags: ["sql","business central"]
hidden: true
slug: "powerapps23"
---



The **Visual Studio shell** used to create Reporting Services reports has been released under various names, including SQL Server Data Tools (SSDT).

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerapps23/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*


---

## powerapps23configurationmigrationtool

**Source file:** `powerapps23configurationmigrationtool.md`

---
title: "Power Apps (Part 23)"
description: "The Configuration Migration tool"
date: "2025-01-01"
categories: ["Power Platform"]
tags: []
slug: "powerapps23configurationmigrationtool"
image: "/assets/images/office-365-icon-500x500.png"
---



The Configuration Migration tool is used to transport configuration and data from one environment to another.

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2024-12-28-183528-1366x724.png)
*Install the Power Platform Tools Visual Studio Code Extension*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2024-12-28-183601-1366x726.png)
*I clicked the Install button*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2024-12-28-184619-1366x730.png)
*I opened terminal, typed pac and clicked enter*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-133511-1365x360.png)
*In this example there are two Power Platform Environments.*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-134203-1366x725.png)
*I entered pac tool CMT and clicked the enter key*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-134453-1366x647.png)
*I created a Power Platform solution in the Developer Environment*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-134538-1366x522.png)
*I added a ToDo table*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-135049-1366x649.png)
*I updated the Name column of the ToDo list*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-135238-1366x649.png)
*I added a Description column*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-135347-1366x653.png)
*I added a Contact lookup column*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-135825-1366x652.png)
*I added John Doe as a Contact. I added Jane Doe as a Contact*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-135923-1365x345.png)
*Notice the unique Contact id values assigned to each Contact*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-140012-1366x567.png)
*There were no Contacts in the Sandbox solution*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-140137-1361x613.png)
*I navigated to the ToDo table in the Developer environment*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-140349-1366x646.png)
*I added a To do item for Jane.I added a To do item for John*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-164445-763x546.png)
*I returned to the Configuration Migration Tool selecting the Create schema option*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-164528-761x549.png)
*I selected the Display list of available organizations (Environments)*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-164753-766x207.png)
*I selected the Developer environment*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-192231-802x644.png)
*I selected the Content Migration Solution and the ToDo entity*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-165049-803x58.png)
*I clicked the Add Entity button*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170421-803x642.png)
*I saved the generated schema file*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170445-801x743.png)
*I clicked Yes to export the contents of the ToDo list*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170600-762x625.png)
*I named the exported data file*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170645-761x626.png)
*The data was saved*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170708-763x626.png)
*The export completed*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170749-760x549.png)
*I selected the Import data option*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170823-765x556.png)
*I clicked the Login button*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170858-764x294.png)
*I selected the Sandbox environment*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-170949-764x626.png)
*I selected the exported ToDo list data*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-171123-763x627.png)
*The import failed.*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-171914-1366x646.png)
*I exported the Content Migration solution from the Developer environment*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172115-1361x181.png)
*I downloaded the exported solution*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172240-1366x649.png)
*I imported the solution into the Sandbox environment*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172404-1366x219.png)
*The solution was imported successfully*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172521-764x627.png)
*I imported the ToDo data*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172659-1362x650.png)
*The Contact lookup column was not populated*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172758-765x550.png)
*I selected the Create schema option and clicked the Continue button*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172822-765x547.png)
*I clicked the Login button*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-172948-802x644.png)
*I selected the Contact list, clicked the Add Entity button and then clicked the Save and Export button*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173038-793x638.png)
*I saved the Contact table schema*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173103-801x642.png)
*I exported the contents of the Contacts list*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173155-763x622.png)
*The export file was created and I clicked the Exit button*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173250-763x626.png)
*I imported the Contact data into the Sandbox environment*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173325-763x625.png)
*The import was successful*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173359-1366x655.png)
*I checked that the Contact records had been imported*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173448-1366x593.png)
*Notice that the Contact lookup column was not populated*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173551-764x623.png)
*I imported the ToDo list data again*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173743-765x626.png)
*The import was successful*

![](/assets/images/powerapps23configurationmigrationtool/screenshot-2025-01-01-173905-1365x602.png)
*The ToDo content was imported successfully*

![](/assets/images/powerapps23configurationmigrationtool/476486061-1657400034846768-2157986925593245908-n-1019x412.png)
*Schema should be updated replacing createdon with overriddencreatedon*

![](/assets/images/powerapps23configurationmigrationtool/476486315-633631506115690-4193477270807083409-n-1023x411.png)
*The data.xml file should be updated to replace createdon with overriddencreatedonNotice that the created on field will only be set when the record is being imported for the first time*

---

## powerapps6

**Source file:** `powerapps6.md`

---
title: "A Custom Connector for Microsoft Graph"
description: "Calling the Microsoft Graph API from a Canvas App"
date: "2022-07-04"
categories: ["Microsoft 365","Power Platform","Azure"]
tags: []
slug: "powerapps6"
image: "/assets/images/office-365-icon-500x500.png"
---


I started by creating a "Microsoft Graph" application registration in Azure Active Directory

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.40.29-pm-1836x1351.png)
*Azure Active Directory - I created an application registration*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.41.31-pm-1836x930.png)
*I copied the Application (client) ID to be used later.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.42.08-pm-1836x1037.png)
*I created a new client secret*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.43.08-pm-1836x832.png)
*I set the client secret to expire in 2 years*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.43.41-pm-1836x830.png)
*I copied the Client Secret's Value to be used later.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.44.38-pm-1836x991.png)
*I selected the "API permissions" link*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.45.22-pm-1836x1107.png)
*I selected the "Add a permission" link*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.45.43-pm-1836x1220.png)
*I selected the "Microsoft Graph" button*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.51.26-pm-1836x1150.png)
*I selected the "Calendars.Read" and the "Calendars.Read.Shared" permissions (scopes)*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.51.44-pm-1836x1070.png)
*I clicked the "Grant admin consent for ..." link*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.52.00-pm-1836x542.png)
*I granted consent*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.53.02-pm-1836x1112.png)
*I navigated to the Custom Connectors tab and clicked the "+ New custom connector" link*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.53.24-pm-1836x1108.png)
*I provided a connector name*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.54.48-pm-1836x1110.png)
*I provided general information and navigated to the Security step*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.56.43-pm-1836x1105.png)
*I selected "OAuth 2.0"*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.58.27-pm-1836x1110.png)
*I selected Azure Active Directory. I entered the Application (client) id and Client secret values I copied earlier.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-3.59.50-pm-1836x1104.png)
*I copied the generated "Redirect URL".*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.10.03-pm-1836x736.png)
*I returned to the Application Registration and added the Redirect URL (URI)*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.10.17-pm-1836x835.png)
*I clicked the "+ Add a platform" link*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.10.26-pm-1836x625.png)
*I selected the Web button*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.11.00-pm-1836x1109.png)
*I entered the (copied) Redirect URL and clicked the configure button*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.00.15-pm-1836x829.png)
*I returned to the Power Apps page and clicked the "+ New Action" link*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.01.23-pm-1836x1040.png)
*I entered general details for the operation*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.01.42-pm-1836x500.png)
*I copied the Microsoft Graph request URL from the Graph Explorer web application.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.02.24-pm-1836x878.png)
*I copied the request URL to the new connector action*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.02.52-pm-1836x1171.png)
*I copied the sample (JSON) response from the Graph Explorer web application (notice that the array of Calendar Events is returned as the "value").*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.03.13-pm-1836x1114.png)
*I copied the sample (JSON) response to the new connector action*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.04.03-pm-1836x1105.png)
*I saw that Validation succeeded and navigated to the Code (Preview) step*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.04.17-pm-1836x1108.png)
*I reviewed the Code Details page then saved the Connector.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.05.43-pm-1836x490.png)
*I used the Created button to save the new Connector*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.14.22-pm-1836x1108.png)
*I selected the AllEventsInMyCalendar and clicked the "Test operation" button*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.14.38-pm-1836x1112.png)
*The response looked good.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.15.44-pm-1836x225.png)
*I created a new Canvas app using the "+ New app" link*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.16.04-pm-1836x1034.png)
*I provided an App name*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.16.49-pm-1836x1106.png)
*I added the new connector to the Canvas app*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.55.47-pm-1836x228.png)
*Screen1's OnVisible property is set to "Collect(Calendar, (MicrosoftGraphConnector.AllEventsInMyCalendar().value)"*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.56.15-pm-1836x930.png)
*Running the Canvas app creates a Calendar collection (of Events).*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.56.38-pm-1836x229.png)
*A Gallery is added to the Screen1. The Items property of the Gallery is set to the Calendar collection.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.57.01-pm-1836x392.png)
*The item template is updated setting Title to the Event item's "subject"*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.57.12-pm-1441x305.png)
*The item template is updated setting Subtitle to "All Day" if the Event item's isAllDay field is true.*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.57.22-pm-1444x306.png)
*The item template is updated setting Body to the Event item's "start.datetime"*

![](/assets/images/powerapps6/screen-shot-2022-07-04-at-4.57.37-pm-1836x931.png)
*The Calendar application is complete*


## Adding UserByEmail

Finally I added a UserByEmail action to the Connector

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.03.25-am-1536x755.png)
*User by email request requires User.Read.All permissions (scope)*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-6.59.41-am-1536x774.png)
*Update existing Application Registration adding a permission*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.05.14-am-1536x754.png)
*Adding the "User.Read.All" permission*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.05.33-am-1536x320.png)
*Updated permissions - Granting admin consent*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.07.19-am-1536x754.png)
*Edit the Custom Connection*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.07.32-am-1536x219.png)
*Add new action*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.08.35-am-1536x755.png)
*I entered general details*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.09.12-am-1536x751.png)
*I entered the request details (notice that a value for {user-mail} will need to be provided when the action is invoked)*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.10.02-am-1536x753.png)
*I copied a sample response from Graph Explorer to the Custom Connector*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.10.19-am-1536x749.png)
*The Custom Connector displays details of the response body provided to it*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.11.03-am-1536x751.png)
*I updated the Custom Connector and navigated to the Test step*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.11.30-am-1536x754.png)
*I provided a value for the "user-email" parameters and clicked the Test operation button*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.11.44-am-1536x754.png)
*The action returned a result*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.12.51-am-1536x795.png)
*I created a "Profiles" canvas app*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.13.30-am-1536x753.png)
*I added a reference to the updated Custom Connector*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.14.14-am-1536x752.png)
*The reference is displayed in the Data tab*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.16.18-am-1536x751.png)
*I added a Text input and a Text label*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.18.02-am-1536x750.png)
*I updated the Text input's OnSelect handler to Set the value of "UserProfile" to the result of a call to the new UserByEmail action*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.22.25-am-1536x520.png)
*I updated the Text label to display the jobTitle property of the UserProfile*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.24.26-am-1536x752.png)
*I ran the Profiles app and entered an email address*

![](/assets/images/powerapps6/screen-shot-2022-07-05-at-7.23.57-am-1536x754.png)
*The user's job title was displayed*

---

## powerappsapplication

**Source file:** `powerappsapplication.md`

---
title: "A Power Apps Application"
description: "Power Apps Application."
date: "2021-07-13"
categories: ["Power Platform","React"]
tags: []
slug: "powerappsapplication"
image: "/assets/images/office-365-icon-500x500.png"
---


## New app

Navigate to [https://make.powerapps.com/](https://make.powerapps.com/)

Select the "Apps" menu item and select the "Apps" tab.

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.14.52-pm-1292x340.png)
*+ New app | Canvas*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.18.39-pm-698x316.png)
*Blank app | Phone layout*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.19.43-pm-1836x945.png)
*Blank app App with Screen "Screen1"*


## Screens

Add three extra Blank screens and rename the four screens {BrowseScreen, DetailScreen, EditScreen and NewScreen}

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.23.34-pm-960x384.png)
*New Screen*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.24.06-pm-1448x680.png)
*Three additional screens added*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.25.13-pm-1432x646.png)
*All four screens renamed*


## Import Component Library

Select the + menu item and click the "Get more components" button

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.27.07-pm-1460x772.png)
*Get more components*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.28.21-pm-1836x1056.png)
*Import custom components from the Headers component library*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.29.17-pm-1836x1053.png)
*Add a BrowseHeader component to the BrowseScreen*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.30.27-pm-1836x1050.png)
*Add a DetailHeader component to the DetailScreen*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.31.38-pm-1836x1047.png)
*Add a EditHeader component to the EditScreen*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.32.49-pm-1836x1056.png)
*Add a EditHeader component to the NewScreen*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.33.55-pm-1836x1054.png)
*Set the "Title" property the Header component in each Screen to "Parent.Name"*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.36.07-pm-1836x1051.png)
*Every Header component is now displaying the name of the screen it is on.*


## Handle the custom OnSelect events

Update all of the custom OnSelect events so that a user can navigate between the Screens

BrowseScreen | BrowseHeader_1
OnSelectRefresh = 
OnSelectNewItem = Navigate(NewScreen)
OnSelectSortUpDown = Set(varSortDescending,!varSortDescending)

DetailScreen | DetailHeader_1
OnSelectBack = Navigate(BrowseScreen)
OnSelectDelete = Navigate(BrowseScreen)
OnSelectEdit = Navigate(EditScreen)

EditScreen | EditHeader_1
OnSelectAccept = Navigate(BrowseScreen)
OnSelectCancel = Navigate(BrowseScreen)

NewScreen| EditHeader_2
OnSelectAccept = Navigate(BrowseScreen)
OnSelectCancel = Navigate(BrowseScreen)

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.56.15-pm-1836x391.png)
*esp8266*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.56.52-pm-928x312.png)
*Preview the app*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.57.59-pm-1836x1055.png)
*Click on the + icon*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-7.58.07-pm-1836x1056.png)
*Click on the X or the tick to return to the BrowseScreen*


## Adding connection to API

Select the database menu item and click the "Add data" button

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-8.04.33-pm-1632x792.png)
*Add data*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-8.05.13-pm-1404x730.png)
*Select the Books Custom Connector*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-8.12.59-pm-838x330.png)
*Add a Vertical gallery control to the BrowseScreen*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-8.48.24-pm-1836x1051.png)
*At this point the Gallery has no Data source. The Items property is set to "CustomGallerySample"*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.00.14-pm-1836x1053.png)
*BrowseHeader_1 | OnSelectRefresh = ClearCollect(colBooks,haddley_power_app_api.BookGET())*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.03.14-pm-1836x1111.png)
*Sample data is displayed in the gallery. Click the refresh button to update the colBooks collection*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.02.39-pm-1836x1049.png)
*Select the Collections menu item to view the colBooks collection*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.04.01-pm-1836x1048.png)
*Update the gallery's datasource to colBooks*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.04.16-pm-1836x1051.png)
*colBooks items are displayed*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.04.42-pm-1836x1048.png)
*Update the layout*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.07.23-pm-1836x1048.png)
*Gallery1 | OnSelect = Navigate(DetailScreen)*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.26.12-pm-1836x1049.png)
*Add four Text labels to the DetailsScreen*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.29.19-pm-1836x1048.png)
*Gallery1.Selected.id*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.31.04-pm-1836x1051.png)
*Gallery1.Selected.title*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.33.21-pm-1836x1052.png)
*haddley_power_app_api.BookByIdDELETE(Gallery1.Selected.id);Navigate(BrowseScreen)*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.37.02-pm-1836x1052.png)
*TextInput3 | Default = Gallery1.Selected.title*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.39.20-pm-1836x1051.png)
*EditHeader_1 | OnSelectAccept = haddley_power_app_api.BookByIdPUT(Gallery1.Selected.id,{title:TextInput3.Text});Navigate(BrowseScreen)*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.45.49-pm-1836x1048.png)
*EditHeader_2 | OnSelectAccept = haddley_power_app_api.BookPOST({id:TextInput4.Text,title:TextInput3_1.Text});Navigate(BrowseScreen)*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.54.51-pm-1836x1049.png)
*NewScreen | OnVisible = UpdateContext({resetText: true});UpdateContext({resetText: false})*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-10.57.01-pm-1836x1053.png)
*BrowseScreen | OnVisible = ClearCollect(colBooks,haddley_power_app_api.BookGET())*


## Summary

Here is a summary of the application screen and control settings

BrowseScreen | OnVisible = ClearCollect(colBooks,haddley_power_app_api.BookGET())

BrowseScreen | Gallery1 | Items = Sort(colBooks,title,If(varSortDescending,Descending,Ascending))

BrowseScreen | BrowseHeader_1
OnSelectRefresh = ClearCollect(colBooks,haddley_power_app_api.BookGET())
OnSelectNewItem = Navigate(NewScreen)
OnSelectSortUpDown = Set(varSortDescending,!varSortDescending)

DetailScreen | label5 | Text = Gallery1.Selected.title
DetailScreen | label3 | Text = Gallery1.Selected.id

DetailScreen | DetailHeader_1
OnSelectBack = Navigate(BrowseScreen)
OnSelectDelete = haddley_power_app_api.BookByIdDELETE(Gallery1.Selected.id);Navigate(BrowseScreen)
OnSelectEdit = Navigate(EditScreen)

EditScreen | TextInput3 | Default = Gallery1.Selected.title

EditScreen | EditHeader_1
OnSelectAccept = haddley_power_app_api.BookByIdPUT(Gallery1.Selected.id,{title:TextInput3.Text});Navigate(BrowseScreen)
OnSelectCancel = Navigate(BrowseScreen);

NewScreen | OnVisible = Reset(TextInput4);Reset(TextInput3_1);

UpdateContext({resetText: true});UpdateContext({resetText: false})

New Screen | OnVisible = UpdateContext({resettext: !resettext});UpdateContext({resettext: !resettext})

New Screen | TextInput4 | Default = ""
New Screen | TextInput4 | Reset = resettext

New Screen | TextInput3_1 | Default = ""
New Screen | TextInput3_1 | Reset = resettext

NewScreen | EditHeader_2
OnSelectAccept = haddley_power_app_api.BookPOST({id:TextInput4.Text,title:TextInput3_1.Text});Navigate(BrowseScreen)
OnSelectCancel = Navigate(BrowseScreen);

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.12.49-pm-1836x1112.png)
*Two items returned by API*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.13.03-pm-1836x1048.png)
*Details of first item. Delete button clicked.*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.13.17-pm-1836x1051.png)
*Only second item remains*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.13.28-pm-1836x1050.png)
*Details of second item*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.13.50-pm-1836x1046.png)
*Editing second item's title*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.14.01-pm-1836x1044.png)
*Second item's title has been updated*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.16.30-pm-1836x1049.png)
*Adding a new item*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.41.31-pm-1836x1049.png)
*New item added*

![](/assets/images/powerappsapplication/screen-shot-2021-07-13-at-11.41.40-pm-1836x1119.png)
*Text values reset*

---

## powerappswithrest

**Source file:** `powerappswithrest.md`

---
title: "A Power Apps Custom Connector"
description: "Create a GitHub Repository"
date: "2021-06-27"
categories: ["Power Platform",".NET","Azure"]
tags: []
slug: "powerappswithrest"
image: "/assets/images/office-365-icon-500x500.png"
---




Create a GitHub Repository for the REST API code.

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-11.42.54-am-810x938.png)
*Create Repository*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-11.43.12-am-930x676.png)
*Publish Repository*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-11.43.36-am-1022x234.png)
*open in Visual Studio Code*


## Download example project code

Open a Visual Studio Code terminal and use the command:

```bash
% dotnet new api
```

to download example ASP.NET Core Web API code.

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-11.44.38-am-1544x460.png)
*dotnet new webapi*


## Test the example project code

Create a dotnet project gitignore file:

```bash
% dotnet new gitignore
```

Start the project:

```bash
% dotnet run
```

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-11.46.31-am-1544x564.png)
*dotnet new gitignore and dotnet run*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-12.07.27-pm-1712x472.png)
*navigate to https://localhost:5001/WeatherForecast*


## Book class

The Book class include id and title properties


## BookController class

The BookController class is able to handle GET, POST, PUT and DELETE actions


## Enable Swagger in production

Comment out the if (env.IsDevelopment()) condition to enable Swagger in production (Azure)

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-2.57.03-pm-1380x724.png)
*comment out the "if (env.IsDevelopement())" code*


## Deploy the updated project code to Azure

Create new web app.

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-1.42.47-pm-1020x214.png)
*haddley-power-app-api*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-1.43.00-pm-1020x201.png)
*.NET Core 3.1 runtime*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-1.43.10-pm-1020x277.png)
*Select pricing tier*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-2.45.46-pm-942x248.png)
*Deploy the code to the new web app*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-2.47.32-pm-550x530.png)
*confirm deployment of the code*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-2.57.45-pm-1020x654.png)
*navigate to http://haddley-power-app-api.azurewebsites.net/swagger to see a list of the GET, POST, PUT and DELETE actions*


## Use the Swagger user interface to test the API

In three steps:

**Get the books**
                        **Add a book**
                        **Get the books (list should now include the *new* book)**

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.45.31-pm-1836x1137.png)
*Expand the GET /Book action*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.45.43-pm-1836x1135.png)
*execute the GET /Book action*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.45.56-pm-1836x1137.png)
*Review the server response*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.46.27-pm-1836x1132.png)
*Expand the POST /Book action*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.46.44-pm-1836x1131.png)
*Update the request body*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.47.32-pm-1836x1134.png)
*Execute the POST /Book action using the Request body*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.47.51-pm-1836x1128.png)
*Review the Server response*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.48.05-pm-1836x1119.png)
*Execute the GET /Book action*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-5.48.20-pm-1836x1129.png)
*Review the Server response*


## API description

Click the "/swagger/v1/swagger.json" link to review a description of the API.

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.04.59-pm-1786x854.png)
*Export/Save the API description (openapi version 3 format)*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.09.40-pm-1836x1027.png)
*Upload the API description to API Transformer*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.12.05-pm-1836x1025.png)
*Download the API description (openapi version 2 format)*


## New custom connector

Navigate to make.powerapps.com and select the "Custom Connectors" menu item.

Click the "+ New custom connector" button.

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-2.44.57-pm-1836x1152.png)
*Custom Connectors*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.04.21-pm-522x530.png)
*Select the Import an OpenAPI file option*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.13.11-pm-732x600.png)
*Import the API description (openapi version 2)*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.14.57-pm-1836x1153.png)
*Books*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.15.06-pm-1836x1149.png)
*Review the General settings*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.15.23-pm-1836x1148.png)
*Select "No Authentication" (for now)*

![](/assets/images/powerappswithrest/screen-shot-2021-06-27-at-4.25.58-pm-1836x1356.png)
*Test the Book related actions*

![](/assets/images/powerappswithrest/screen-shot-2021-06-19-at-3.17.35-pm-1632x184.png)
*Books Custom Connector*


## swagger.json-Swagger20.json

```json
{
  "swagger": "2.0",
  "info": {
    "version": "v1",
    "title": "haddley_power_app_api",
    "contact": {}
  },
  "host": "www.example.com",
  "basePath": "/",
  "schemes": [
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/Book": {
      "get": {
        "description": "",
        "summary": "Book_GET",
        "tags": [
          "Book"
        ],
        "operationId": "Book_GET",
        "deprecated": false,
        "produces": [
          "text/plain",
          "application/json",
          "text/json"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Book"
              }
            },
            "headers": {}
          }
        }
      },
      "post": {
        "description": "",
        "summary": "Book_POST",
        "tags": [
          "Book"
        ],
        "operationId": "Book_POST",
        "deprecated": false,
        "produces": [
          "application/json"
        ],
        "consumes": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": false,
            "description": "",
            "schema": {
              "$ref": "#/definitions/Book"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "headers": {}
          }
        }
      }
    },
    "/Book/{id}": {
      "get": {
        "description": "",
        "summary": "BookById_GET",
        "tags": [
          "Book"
        ],
        "operationId": "BookById_GET",
        "deprecated": false,
        "produces": [
          "text/plain",
          "application/json",
          "text/json"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int64",
            "description": ""
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "schema": {
              "$ref": "#/definitions/Book"
            },
            "headers": {}
          }
        }
      },
      "put": {
        "description": "",
        "summary": "BookById_PUT",
        "tags": [
          "Book"
        ],
        "operationId": "BookById_PUT",
        "deprecated": false,
        "produces": [
          "application/json"
        ],
        "consumes": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int64",
            "description": ""
          },
          {
            "name": "body",
            "in": "body",
            "required": false,
            "description": "",
            "schema": {
              "$ref": "#/definitions/Book"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "headers": {}
          }
        }
      },
      "delete": {
        "description": "",
        "summary": "BookById_DELETE",
        "tags": [
          "Book"
        ],
        "operationId": "BookById_DELETE",
        "deprecated": false,
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int64",
            "description": ""
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "headers": {}
          }
        }
      }
    }
  },
  "definitions": {
    "Book": {
      "title": "Book",
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int64"
        },
        "title": {
          "type": "string"
        }
      }
    }
  },
  "tags": [
    {
      "name": "Book",
      "description": ""
    }
  ]
}
```

---

## powerappsxx

**Source file:** `powerappsxx.md`

---
title: "Power Apps (Part XX)"
description: "Integrating with Business Central using Power Automate"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/powerappsxx/hero.png"
tags: ["sql","business central"]
hidden: true
slug: "powerappsxx"
---



The **Visual Studio shell** used to create Reporting Services reports has been released under various names, including SQL Server Data Tools (SSDT).

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*

![](/assets/images/powerappsxx/screenshot-2024-10-30-at-5.00.32pm-1836x1475.png)
*<<NEW TEXT HERE>>*


---

## powerautomate

**Source file:** `powerautomate.md`

---
title: "Power Automate"
description: "Automating Team Creation"
date: "2022-05-04"
categories: ["Microsoft 365","Power Platform"]
tags: []
slug: "powerautomate"
image: "/assets/images/office-365-icon-500x500.png"
---


I added a Flow to create a Team every time an item is added to a "New Teams" SharePoint list.

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.41.32-pm-1487x898.png)
*New List*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.42.17-pm-1487x888.png)
*"New Teams" list*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.42.47-pm-1487x889.png)
*Create a flow*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.49.39-pm-1487x898.png)
*Execute the flow every time a list item is created*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.49.56-pm-1487x894.png)
*Choose an operation*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.50.06-pm-1487x894.png)
*Create a team*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.50.37-pm-1487x896.png)
*Team Name and Description will be based on list item Title*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.51.07-pm-1487x893.png)
*Test the flow*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.51.41-pm-1487x890.png)
*Create a new list item*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.52.24-pm-1487x892.png)
*Flow has completed*

![](/assets/images/powerautomate/screen-shot-2022-05-04-at-12.52.43-pm-1487x888.png)
*Team has been created*

---

## powerautomatereports

**Source file:** `powerautomatereports.md`

---
title: "Microsoft Power Automate Reports"
description: "A Flow that emails a Report"
date: "2024-07-19"
categories: ["Power Platform"]
tags: []
slug: "powerautomatereports"
image: "/assets/images/office-365-icon-500x500.png"
---


Creating a Flow that emails a Report as a PDF file

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-11.14.34am-2136x1112.png)
*I created a Flows solution*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-11.15.05am-2136x751.png)
*I added a new Cloud flow*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-1.56.13pm-2136x975.png)
*The user will be asked to provide a Report Name and an Email address. The Success variable is set to false.*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-1.57.43pm-2136x1114.png)
*I used the List rows action...*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-1.58.46pm-2136x674.png)
*... to fetch a row from the Reports table*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.00.23pm-2136x998.png)
*I filtered the results to the Report with the user provided name*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.00.57pm-2136x1003.png)
*I added an HTTP action*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.01.24pm-2136x1036.png)
*I selected the Invoke an HTTP request action*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-10.24.22am-2136x1096.png)
*I entered the report's base resource url twice (my unique https://XXX.crm.dynamics.com url)*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.05.34pm-2136x953.png)
*A connection was created and I entered the HTTP reuqest details/CRMReports/rsviewer/reportviewer.aspxContent-Type: application/x-www-form-urlencodedid={report id}*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.06.44pm-2136x994.png)
*The flow designer automagically added the Apply to each action*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.08.07pm-2136x888.png)
*I added three Compose actions*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.11.01pm-2136x1104.png)
*Together the three Compose actions establish the pdf download urladd(indexOf(outputs('Invoke_an_HTTP_request')?['body'],'"PdfDownloadUrl":"'), 18)sub(indexOf(outputs('Invoke_an_HTTP_request')?['body'],'","PdfPreviewUrl"'),outputs('Compose'))replace(substring(outputs('Invoke_an_HTTP_request')?['body'],outputs('Compose'),outputs('Compose_2')),'\u0026','&')*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.12.38pm-2136x1033.png)
*I added a Do until action*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.13.11pm-2136x1022.png)
*I added a Do until action to ensure that the flow would retry the HTTP GET and Email actions until the Success variable was set to true*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.14.08pm-2136x1110.png)
*I added three scope actions*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.14.30pm-2136x1112.png)
*The third scope action was configured to catch errors.*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.14.59pm-2136x1003.png)
*I added the happy path logic to the second scope*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.15.43pm-2136x1017.png)
*I attempt to fetch the report as a PDF file*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.16.16pm-2136x1104.png)
*I attempt to send the pdf file as an email attachment*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.18.44pm-2136x1059.png)
*I set the body of the email, the body of the email attachment, the email to and the email subject.*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.22.19pm-2136x1085.png)
*If no errors are generated I set the value of the Success variable*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.24.29pm-2136x1110.png)
*If no errors are generated I set the value of the Success variable to true*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.25.40pm-2070x1374.png)
*When I run the flow this email is received*

![](/assets/images/powerautomatereports/screenshot-2024-07-19-at-2.25.49pm-2060x1358.png)
*The email has this PDF file attachment*

---

## powerpages1

**Source file:** `powerpages1.md`

---
title: "Power Pages (Part 1)"
description: "Sales Orders"
date: "2024-10-26"
categories: ["Microsoft Dynamics","Business Central","Power Platform","Microsoft Dynamics"]
tags: []
slug: "powerpages1"
image: "/assets/images/powerpages-scalable.svg"
---


Microsoft Power Pages is a low-code platform designed to build, host, and manage external-facing business websites.

Microsoft Dynamics Business Central provides an end-to-end solution for financials, sales, service, and operations. 

A Customer Portal is a software interface that gives customers complete visibility into their interactions with a company. It provides a platform for customers to track key metrics, support requests, or other information such as reference documents that can be easily shared.

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.44.36pm-2136x1091.png)
*I used Microsoft Power Pages to create a Customer Portal*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.28.37pm-2136x764.png)
*I navigated to the Assisted Setup page in Business Central*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.29.00pm-2136x677.png)
*I selected the Set up a connection to Dataverse link*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.29.13pm-2136x1122.png)
*I enabled data synchronization and virtual tables*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.29.25pm-2136x1106.png)
*I accepted the terms and conditions*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.29.40pm-2136x1126.png)
*I selected the Developer Power Platform/Dataverse environment*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.30.09pm-2136x1122.png)
*I signed in as a Power Platform administrator*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.38.42pm-2136x1211.png)
*I clicked the Next button*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.48.44pm-2136x1207.png)
*I clicked the Install Business Central Virtual Table app link*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.49.03pm-2136x1282.png)
*I clicked the Get it now button*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.49.28pm-2136x1205.png)
*I clicked the Get it now button*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.50.41pm-2136x1281.png)
*I selected the Develop environment*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-2.50.55pm-2136x1205.png)
*I checked the I agree boxes and clicked the Install button*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.11.49pm-2136x1208.png)
*Business Central Virtual Table was installed*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.12.15pm-2136x1205.png)
*I clicked the Review and enable virtual tables link*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.37.02pm-2136x1212.png)
*I selected six Virtual Tables and clicked the Enable button*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.37.14pm-2136x328.png)
*A job queue entry was scheduled*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.39.28pm-2136x1208.png)
*I navigated to the Dataverse Connection Setup page*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.39.56pm-2136x1204.png)
*I clicked the Test Connection button*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.42.09pm-2136x653.png)
*I navigated to the Contacts list*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.42.36pm-2136x1208.png)
*Business Central sample data includes example Contacts*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.42.55pm-2136x550.png)
*I navigated to the Customers list*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.44.39pm-2136x1209.png)
*Business Central sample data includes example Customers and Vendors (Accounts).I started the Business Central to Dataverse synchronization process*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.45.06pm-2136x1207.png)
*The Contacts table in the Develop environment was initially empty*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.53.44pm-2136x1208.png)
*The Synchronization jobs copied Contact, Account and other details from Business Central to Dataverse*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-3.52.09pm-2136x1209.png)
*After the sync. the Contacts table included Contacts (connected to Accounts)*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-4.02.35pm-2136x1206.png)
*Customer and Vendor details were copied from Business Central to Dataverse*


## Sales Orders

In Dynamics 365 Business Central, a Sales Order is a document that represents a customer's intent to purchase goods or services from a company. It is a crucial component of the sales process and serves as a foundation for managing customer interactions, tracking orders, and fulfilling customer requests.

![](/assets/images/powerpages1/screenshot-2024-10-26-at-4.13.38pm-2136x614.png)
*I navigated to the Sales Orders list*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-4.14.06pm-2136x1038.png)
*I reviewed the Sales Orders list*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-4.14.38pm-2136x1202.png)
*I navigated to the Sales Order Virtual Table*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-4.15.23pm-2136x1209.png)
*I was able to see the same records*

![](/assets/images/powerpages1/screenshot-2024-10-26-at-4.22.42pm-2136x1165.png)
*I added columns to the display*


## Solution

I created a Power Platform Solution

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.01.41pm-2136x1097.png)
*Created a Customer Portal Solution*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.01.57pm-2136x789.png)
*I navigated into the new solution*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.02.23pm-2136x1094.png)
*I added the Sales Order and Sales Order Line tables*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.02.31pm-2136x641.png)
*Two tables will be added to the solution*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.03.14pm-2136x873.png)
*I added a Portal All Sales Orders view to the Sales Order table*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.15.37pm-2136x921.png)
*I added a Portal All Sales Orders Lines view to the Sales Order Line table*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.16.43pm-2136x1094.png)
*I added a Portal Sales Order Main Form to the Sales Order table*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.05.35pm-2136x888.png)
*I added a Sales Orders application to the solution*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.06.05pm-2136x1087.png)
*I added the Sales Order table to the Sales Orders application*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.07.14pm-2136x995.png)
*I clicked the Play button*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.07.29pm-2136x918.png)
*I selected a Sales Order*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.21.37pm-2136x1039.png)
*I reviewed the Sales Order Lines associated with the selected Sales Order*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.41.59pm-2136x889.png)
*I edited the Quantity, Unit Price, Invoiced Quantity and Amount Including Tax table columns*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.44.13pm-2136x1094.png)
*I updated the number of Decimal places*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.50.22pm-2136x1035.png)
*I reviewed the Sales Order Lines associated with the selected Sales Order*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.52.25pm-2136x1106.png)
*I navigated to https://make.powerpages.microsoft.com/*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.53.35pm-2136x1097.png)
*I selected web address https://haddleycustomerportal.powerappsportals.com/*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.54.01pm-2136x1093.png)
*The new site was setup*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-8.58.18pm-2136x1096.png)
*I added a Sales Orders page*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.00.06pm-2136x1096.png)
*The Sales Orders page will only be shown when an authenticated user is logged in*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.01.33pm-2136x1100.png)
*I added an h1 Text component. I added a List component*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.02.29pm-2136x1096.png)
*I selected the Sales Order table. I selected the Portal All Sales Orders view. I named the List All Sales Orders.*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.03.24pm-2136x1096.png)
*I added permissions*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.04.05pm-2136x1099.png)
*I added a table permission. The permission will allow users to see Sales Order rows that are associated with their company (Account).*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.05.07pm-2136x629.png)
*I added a Synthetic Relation*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.05.51pm-2136x969.png)
*The Synthetic Relation connects CRM Account records...*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.06.19pm-2136x964.png)
*... to Sales Order records*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.06.53pm-2136x989.png)
*I clicked Next*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.07.19pm-2136x981.png)
*I selected the CRM Account | Account Name field*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.07.43pm-2136x1063.png)
*I selected the Sales Order | customerName field*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.08.07pm-2136x1034.png)
*I clicked Next*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.08.35pm-2136x1026.png)
*I clicked the Finish button*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.09.34pm-2136x475.png)
*I clicked Refresh to view the new Synthetic Relation*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.10.21pm-2136x1099.png)
*I updated the configuration of the Power Pages Authentication External Users Microsoft Entra Application*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.11.45pm-2136x1100.png)
*I selected the new Synthetic Relation*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.13.17pm-2136x1103.png)
*I added the Authenticated Users Role*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.13.52pm-2136x1096.png)
*I clicked the Close button*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.18.00pm-2136x666.png)
*I used the Edit site header button to update the site title*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.18.43pm-2136x1106.png)
*I set the site title to Customer Portal*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.25.00pm-2136x565.png)
*I updated the site Style*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.30.30pm-2136x876.png)
*I set the site visibility to Public*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.21.16pm-2136x844.png)
*I navigated to the Robert Townes Contact record*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.21.47pm-2136x648.png)
*I clicked the Create Invitation button*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.22.25pm-2136x747.png)
*I clicked Save*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-9.22.56pm-2136x692.png)
*I copied the Invitation Code*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.11.10pm-2136x1107.png)
*I use the invitation code to register robert*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.11.57pm-2136x1100.png)
*I clicked the Sales Orders menu item*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.12.26pm-2136x978.png)
*I reviewed the Adatum Corporation Sales Orders*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.13.45pm-2136x1090.png)
*I created a child permission*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.14.20pm-2136x1104.png)
*I selected the Authenticated Users role*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.15.04pm-2136x1091.png)
*I created a Sales Order page*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.16.09pm-2136x1008.png)
*I added a text component and a form to the web site. I selected the Portal Sales Order Main Form*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.16.33pm-2136x833.png)
*The form will be read-only*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.16.56pm-2136x885.png)
*On submit the user will be redirected back to the Sales Orders list page*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.17.20pm-2136x841.png)
*I turned off the CAPTCHA*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.17.48pm-2136x810.png)
*I turned off AI form fill*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.19.06pm-2136x936.png)
*I updated the List. I added a View details action that will navigate the user to the Sales Order page*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.19.38pm-2136x724.png)
*I clicked on the View details link*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.20.03pm-2136x833.png)
*An Internal Server Error was generated*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.20.54pm-2136x1100.png)
*I added a New table permission*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.21.52pm-2136x1101.png)
*I added a Global permission*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.22.35pm-2136x1097.png)
*Logged in as Robert I was able to review Sales Order Lines associated with the selected Sales Order*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.25.56pm-2136x946.png)
*I reviewed the Table permissions*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.29.53pm-2136x895.png)
*I added the Customer Portal Site to the solution*

![](/assets/images/powerpages1/screenshot-2024-12-14-at-10.33.58pm-2136x825.png)
*The Customer Portal solution is ready to be exported*

---

## powerpages2

**Source file:** `powerpages2.md`

---
title: "Power Pages (Part 2)"
description: "View, create, and edit orders"
date: "2024-12-20"
categories: []
tags: []
slug: "powerpages2"
image: "/assets/images/powerpages-scalable.svg"
---



Customer Orders may be handled directly by customers using a self-service Customer Portal.

Here a Power Pages Customer Portal enables customers to view, create, and edit their orders in the context of a Business Central subscription.

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.20.16am-2136x846.png)
*I created a new table*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.20.37am-2136x1097.png)
*I set the table name to Customer Order*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.23.19am-2136x1094.png)
*I updated the Name column to be an Autonumber*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.24.44am-2136x1099.png)
*I added a Requested Delivery Date column*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.24.58am-2136x1099.png)
*I set the Time zone adjustment property of the Requested Delivery Date column*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.26.25am-2136x1104.png)
*I added an Account (Customer) column*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.28.02am-2136x1094.png)
*I created a Portal Active Customer Orders view*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.28.57am-2136x1010.png)
*I added the Account and Requested Delivery Date columns to the view*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.30.05am-2136x1101.png)
*I created a Portal Customer Order Main Form form*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.32.05am-2136x1100.png)
*I created a Customer Orders page*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.32.34am-2136x1100.png)
*Authenticated Users only*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.33.25am-2136x1101.png)
*I added h1 text and a new List*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.34.05am-2136x1100.png)
*I created the Active Customer Orders List based on the Customer Order table*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.34.52am-2136x1096.png)
*I create a table permission allowing customers to view their Customer Orders*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.37.35am-2136x1100.png)
*I selected the Read, Update, Create and Delete permissions and Authenticated Users*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.45.34am-2136x1003.png)
*I updated the Portal Customer Order Main Form*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.51.04am-2136x902.png)
*I tested the Customer Orders page*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.51.44am-2136x1100.png)
*I added a New Customer Order page*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.52.15am-2136x956.png)
*I added h1 text and a Form*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.53.58am-2136x1100.png)
*I created a New Customer Order (Power Pages/Basic) form*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.54.08am-2136x1100.png)
*The contents entered into the New Customer Order form will be used to create a new order*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.54.23am-2136x943.png)
*On Submit the user will be redirected to the Customer Orders form*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.54.31am-2136x913.png)
*I disabled CAPTCHA*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.54.43am-2136x856.png)
*I disabled form filling assistance*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-7.55.08am-2136x1096.png)
*I set the New Customer Order page's permissions*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.11.10am-2136x1103.png)
*I updated the Customer Orders Create a new record list action*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.11.36am-2136x861.png)
*I clicked the Create button*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.12.01am-2136x1094.png)
*I selected a Requested Delivery Date and clicked the Submit button*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.12.40am-2136x721.png)
*I could not see the new Customer Order*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.13.27am-2136x889.png)
*I created a Customer Orders app*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.14.09am-2136x1101.png)
*I added the Customer Order table*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.14.20am-2136x1101.png)
*Saved the changes. I clicked the Back button*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.15.19am-2136x673.png)
*I selected the Customer Orders app and clicked the Play menu item*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.15.48am-2136x430.png)
*I could see the new Customer Order*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.16.42am-2136x715.png)
*I switched to the Portal Active Customer Orders view*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.16.56am-2136x451.png)
*The Account value has not been provided*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.17.21am-2136x918.png)
*I selected the New Customer Order (Basic) form. I clicked the + New Basic Form Metadata button*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.17.47am-2136x910.png)
*I selected type Attribute and Attribute Logical Name Account*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.18.24am-2136x979.png)
*I clicked the Save Value On Save checkbox and selected the Current Portal User | Company Name value*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.18.44am-2136x883.png)
*The Basic Form Metadata details are shown in the grid*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.19.06am-2136x917.png)
*I scrolled to the right hand side of the grid*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.19.28am-2136x1099.png)
*I added a second Customer Order*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.19.51am-2136x1100.png)
*The Account Value was set*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.21.13am-2136x1099.png)
*I added an Edit Customer Order page*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.21.52am-2136x1100.png)
*I added h1 text and a Form*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.22.21am-2136x966.png)
*I created an Edit Customer Order (Power Pages/Basic) Form*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.22.33am-2136x864.png)
*This form will allow the user to update an existing Customer Order*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.22.47am-2136x888.png)
*On Submit the user will be redirected to the Customer Orders page*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.22.57am-2136x853.png)
*I disabled CAPTCHA*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.23.05am-2136x884.png)
*I disabled form filling assistance*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.23.25am-2136x1097.png)
*I set page permissions to Authenticated Users*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.23.54am-2136x1100.png)
*I updated the Customer Order's Edit record action*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.24.27am-2136x686.png)
*I clicked the edit button*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.10.53pm-2136x792.png)
*I updated the Requested Delivery Date and clicked the Submit button. Notice that when I clicked the edit button the edit page's url includes the id of the order 14b67e1a... (the value of the hadd_customerorderid field).*

![](/assets/images/powerpages2/screenshot-2024-12-15-at-8.24.56am-2136x703.png)
*The Customer Order was updated*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-4.58.12pm-2136x926.png)
*I wanted user to be redirected from the New Customer Order page directly to the Edit Customer Order page. I updated the New Customer Order's On submit value.*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.02.55pm-2136x725.png)
*I reviewed the Customer Order table*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.37.02pm-2136x1091.png)
*I reviewed the Customer Order (hadd_customerorderId) column*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.30.13pm-2136x869.png)
*I reviewed the Customer Orders*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-4.59.06pm-2136x770.png)
*I updated the New Customer Order Basic Form*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.05.00pm-2136x1096.png)
*I navigated to the On Success Settings tab. I added ...Parameter Name id and ...Attribute Logical Name hadd_customerorderid*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.06.02pm-2136x732.png)
*I created a new Customer Order and clicked Submit*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.06.13pm-2136x735.png)
*I was redirected to the Edit Customer page*

![](/assets/images/powerpages2/screenshot-2024-12-20-at-5.06.23pm-2136x777.png)
*I clicked Submit on the Edit Page and was redirected to the Customer Orders page*

---

## powerpages3

**Source file:** `powerpages3.md`

---
title: "Power Pages (Part 3)"
description: "Customer Order Lines"
date: "2024-12-20"
categories: []
tags: []
slug: "powerpages3"
image: "/assets/images/powerpages-scalable.svg"
---



Customer Order Lines refer to the individual items or services listed within a customer's order. Each order line represents a specific product or service being purchased, including details such as:

Product or Service Name: The name or description of the item.
Quantity: The number of units being ordered for that specific product or service.
Price: The cost per unit of the product or service.
Total Amount: The extended price, which is typically the product of quantity and unit price.

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.13.41pm-2136x888.png)
*I created a new Table in the Solution*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.14.25pm-2136x1100.png)
*I named the table Customer Order Lines*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.16.38pm-2136x1099.png)
*I updated the Customer Order Lines | Name field*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.18.52pm-2136x1100.png)
*I added an Order Lookup field. The Order Lookup column created a relationship between the Customer Order and the Customer Order Line tables*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.20.50pm-2136x812.png)
*I added the Business Central Item Virtual Table*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.22.17pm-2136x1099.png)
*I added an Item lookup column to the Customer Order Lines table*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.23.04pm-2136x1099.png)
*I added a Whole Number Quantity column*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.28.07pm-2136x1101.png)
*I created a view*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.29.50pm-2136x965.png)
*I added the Item and Quantity columns to the Portal view*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.33.29pm-2136x1103.png)
*I added a form to the Customer Order Line table*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.34.42pm-2136x873.png)
*I added the Item and Quantity columns to the form*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.36.16pm-2136x1103.png)
*I added a Customer Order Lines Grid to the Customer Order table's Portal form*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.36.41pm-2136x1097.png)
*I uncheck the Hide label checkbox*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.38.00pm-2136x651.png)
*I tested the add Customer Order Line form*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.38.20pm-2136x953.png)
*I was able to add a line to an order*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.47.43pm-2136x1103.png)
*I created a New Customer Order Line page*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.04.41pm-2136x1101.png)
*I added a New Customer Order Line Basic form*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.50.43pm-2136x913.png)
*I selected the Creates a new record option*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.51.29pm-2136x1100.png)
*I selected redirect to the Edit Customer Order page*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.51.38pm-2136x914.png)
*I deselected the CATCHA options*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.51.49pm-2136x949.png)
*I deselected the AI form filling experience*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.52.05pm-2136x1101.png)
*I reviewed the options*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.52.21pm-2136x1097.png)
*I reviewed the table permissions*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.53.04pm-2136x552.png)
*I clicked the Add child permission menu item*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.54.39pm-2136x1099.png)
*I named the child permissions entry Customer Order Lines by Customer Order. The Customer Order Lines by Customer Order permission entry allows the logged in user to view any Customer Order Line that is related to a Customer Order they have access to. Account Customer Orders permissions provides the given users to only the rows/records that relate to their organization.*

![](/assets/images/powerpages3/screenshot-2025-01-13-at-12.18.23pm-2136x1106.png)
*Notice that the Append permission has been added*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.31.34pm-2136x1099.png)
*I added Read, Update, Create, Delete and Append to permissions to the Account Customer Orders Table permissions entry.We would like a user to be able to create Customer Order Lines to existing Customer Orders*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.57.56pm-2136x920.png)
*The Edit Customer Order form displays a Grid of related Customer Order Line records*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.58.07pm-2136x952.png)
*I added a Basic Form Metadata entry*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-7.59.22pm-2136x1097.png)
*This Basic Form Metadata entry configures the Grid displayed on the Edit Customer Order form*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-8.01.05pm-2136x1013.png)
*A Create button has been added to the Customer Order form's grid*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-8.01.20pm-2136x1027.png)
*I was not able to lookup Items*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-8.01.58pm-2136x1096.png)
*I added a Global table permission. The Global table permission provides access to all rows/records in given table*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.08.03pm-2136x1022.png)
*I updated the On Success Settings to ensure that the Customer Order's id would be passed*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-8.02.45pm-2136x995.png)
*I selected a Customer Order Lines | Item*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-8.02.56pm-2136x1011.png)
*I entered a Quantity and clicked the Submit button*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.37.48pm-2136x982.png)
*I was redirected back to the Edit Customer Order page*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.48.02pm-2136x1101.png)
*I added an Edit Customer Order Line page*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.49.09pm-2136x1097.png)
*I added a form*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.01.15pm-2136x1096.png)
*I named the new form Edit Customer Order Line*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.50.57pm-2136x1090.png)
*The new form would allow a user to update a Customer Order Line*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.51.14pm-2136x958.png)
*The Edit Customer Order page will redirect to the Edit Customer Order page*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.51.23pm-2136x991.png)
*I cleared the CAPTCHA boxes*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.51.31pm-2136x927.png)
*I disabled AI form filling*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-10.56.10pm-2136x1100.png)
*I updated the On Success Setting of the Edit Customer Order Line form*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.11.48pm-2136x1030.png)
*I added an Edit and a Delete menu item*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.13.00pm-2136x911.png)
*I used the Edit button to update a Customer Order Line*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.13.13pm-2136x793.png)
*I updated the Quantity*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.13.23pm-2136x927.png)
*I was redirected to the Customer Order with the updated line displayed*

![](/assets/images/powerpages3/screenshot-2024-12-20-at-11.14.29pm-2136x817.png)
*Clicking Submit in the Customer Order's page redirects the user back to the Customer Orders list page*

![](/assets/images/powerpages3/screenshot-2024-12-21-at-8.35.26am-2136x1099.png)
*I added the related Item | Unit Price and Item | Based Unit of Measure columns to the Portal Active Customer Order Lines view*

![](/assets/images/powerpages3/screenshot-2024-12-21-at-8.35.38am-2136x1094.png)
*I refreshed the Edit Customer Order page*

---

## promptdialog

**Source file:** `promptdialog.md`

---
title: "Business Central (Part 27)"
description: "Prompt Dialog (Part 1)"
date: "2024-05-24"
categories: ["Microsoft Dynamics","Business Central","AI","Microsoft Dynamics"]
tags: []
slug: "promptdialog"
image: "/assets/images/posts-meta.svg"
hidden: false
---


The PromptDialog page serves as the core UI component for a Business Central Copilot, enabling users to evaluate and refine AI-generated outputs within a structured, guided workflow. This page type orchestrates an intuitive, end-to-end experience where:

User Input: Users provide initial prompts or instructions.
AI Output Generation: The system processes the input and displays results.
Review & Iteration: Users assess the output, make edits (if needed), and regenerate responses until satisfied.
Final Action: The user chooses to either save the refined output or discard the session.

![](/assets/images/promptdialog/screenshot202025-05-2320at206.45.36e280afpm-2136x1380.png)
*I navigated to Business Central https://businesscentral.dynamics.com*

![](/assets/images/promptdialog/screenshot202025-05-2320at206.47.10e280afpm-2136x1254.png)
*I created a Sandbox Environment*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.19.02e280afpm-2136x678.png)
*The Sandbox Environment state updated to Active*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.20.05e280afpm-2136x879.png)
*I switched to the CRONUS company in the Sandbox Environment*

![](/assets/images/promptdialog/screenshot202025-05-2320at206.29.07e280afpm-2136x634.png)
*In Visual Studio Code I selected the View | Command Palette menu item and entered Al:Go!*

![](/assets/images/promptdialog/screenshot202025-05-2320at206.30.06e280afpm-2136x148.png)
*I entered the Project/Extension name LLM*

![](/assets/images/promptdialog/screenshot202025-05-2320at206.30.17e280afpm-2136x147.png)
*I selected the latest Business Central version*

![](/assets/images/promptdialog/screenshot202025-05-2320at206.32.24e280afpm-2136x325.png)
*I selected the Microsoft cloud sandbox option*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.21.47e280afpm-2136x97.png)
*I used the View | Command Palette menu item and entered Al:Download symbols*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.22.04e280afpm-2136x1241.png)
*I clicked the Copy & Open button*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.23.22e280afpm-2136x1103.png)
*I clicked Continue*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.24.24e280afpm-2136x728.png)
*I clicked the Start Debugging menu item*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.25.24e280afpm-2136x744.png)
*The Debugger stopped on the Message statement. I clicked Continue*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.25.43e280afpm-2136x962.png)
*The Message was displayed on the Business Central page*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.30.21e280afpm-2136x592.png)
*I selected the New AL File Wizard right click menu item*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.30.49e280afpm-2136x360.png)
*I selected Page*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.34.20e280afpm-2136x876.png)
*I accepted the Object Id 50100 and entered the page name LLM*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.34.33e280afpm-2136x804.png)
*A page was generated*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.48.21e280afpm-2136x905.png)
*I updated the generated page with Prompt Dialog specific AL code*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.51.54e280afpm-2136x641.png)
*I updated the startupObjectId. I clicked Run | Start Debugging*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.52.43e280afpm-2136x1261.png)
*The Prompt Dialog page was displayed. I selected the Capital City item from the Prompt guide*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.53.19e280afpm-2136x1257.png)
*I updated the text to What is the Capital of France? and clicked the Generate button*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.54.07e280afpm-2136x663.png)
*The RunGeneration procedure was executed. This code updated the Output variable/field based on the Prompt*

![](/assets/images/promptdialog/screenshot202025-05-2320at207.54.40e280afpm-2136x956.png)
*The generated response was displayed*


## Pag50100.LLM.al

```text
namespace LLM.LLM;

page 50100 LLM
{
    ApplicationArea = All;
    Caption = 'LLM';
    PageType = PromptDialog;
    Extensible = false;
    DataCaptionExpression = Prompt;
    IsPreview = true;

    layout
    {
        #region input section
        area(Prompt)
        {
            field(PromptField; Prompt)
            {
                ShowCaption = false;
                MultiLine = true;
                InstructionalText = 'Message Large Language Model';
            }
        }
        #endregion

        #region output section
        area(Content)
        {
            field(OutputFiled; Output)
            {
                ShowCaption=false;
                MultiLine = true;
            }
        }
        #endregion
    }
    actions
    {
        #region prompt guide
        area(PromptGuide)
        {
            action("Capital City")
            {
                ApplicationArea = All;
                Caption = 'Capital City';
                ToolTip = 'What is the Capital of ...';

                trigger OnAction()
                begin
                    Prompt := 'What is the Capital of <Country>?';
                end;
            }
        }
        #endregion

        #region system actions
        area(SystemActions)
        {
            systemaction(Generate)
            {
                Caption = 'Generate';
                ToolTip = 'Generate a response.';

                trigger OnAction()
                begin
                    RunGeneration();
                end;
            }
            systemaction(OK)
            {
                Caption = 'OK';
                ToolTip = 'Save the result.';
            }
            systemaction(Cancel)
            {
                Caption = 'Cancel';
                ToolTip = 'Discard the result.';
            }
            systemaction(Regenerate)
            {
                Caption = 'Regenerate';
                ToolTip = 'Regenerate a response.';

                trigger OnAction()
                begin
                    RunGeneration();
                end;
            }
            #endregion
        }
    }
    var
        Prompt: Text;
        Output: Text;

    local procedure RunGeneration()
    begin
        Output := 'The prompt you entered was: ' + Prompt;
    end;

}
```

---

## promptdialog2

**Source file:** `promptdialog2.md`

---
title: "Business Central (Part 28)"
description: "Prompt Dialog (Part 2)"
date: "2024-05-24"
categories: ["Microsoft Dynamics","Business Central","AI","Azure"]
tags: []
slug: "promptdialog2"
image: "/assets/images/posts-meta.svg"
hidden: false
---




Copilot Prompt Interface: A user interface (UI) component designed to collect user inputs and queries for Microsoft Dynamics 365 Business Central's Copilot feature. This dialog page enables users to interact with the AI assistant by submitting natural language prompts or requests.

AI Integration Module: A backend system component that acts as the intermediary between Business Central and Azure OpenAI Service. This module handles API communication, data processing, and secure routing of user prompts to Azure's AI services, while managing responses back to the Business Central application.

Azure OpenAI Resource: A cloud-based service within the Microsoft Azure ecosystem that provides access to advanced OpenAI language models (e.g., GPT-4). This resource enables AI-driven capabilities such as natural language understanding, content generation, and contextual analysis, which power Copilot's intelligent features in Business Central.

![](/assets/images/promptdialog2/screenshot202025-05-2320at209.29.26e280afpm-2136x1241.png)
*I updated the LLM Prompt Dialog page*

![](/assets/images/promptdialog2/screenshot202025-05-2320at209.29.40e280afpm-2136x1253.png)
*Output is generated by a Large Language Model and returned to the user*

![](/assets/images/promptdialog2/screenshot202025-05-2320at209.42.43e280afpm-2136x1242.png)
*I updated the RunGeneration procedure*

![](/assets/images/promptdialog2/screenshot202025-05-2320at209.51.18e280afpm-2136x1114.png)

*For more detail please see* [this blog page](/posts/azureopenal/).

![](/assets/images/promptdialog2/screenshot202025-05-2320at2010.12.31e280afpm-2136x962.png)
*I updated the "publisher" property*

![](/assets/images/promptdialog2/screenshot202025-05-2320at2010.14.21e280afpm-2136x646.png)
*There is a Copilot & agent capabilities page in Business Central*

![](/assets/images/promptdialog2/screenshot202025-05-2320at2010.18.05e280afpm-2136x1171.png)
*The LLM Capability has been added to the list*


## Pag50100.LLM.al updated

```text
namespace LLM.LLM;

using System.AI;

enumextension 50100 LLM extends "Copilot Capability"
{
    value(50100; "LLM") { }
}

page 50100 LLM
{
    ApplicationArea = All;
    Caption = 'LLM';
    PageType = PromptDialog;
    Extensible = false;
    DataCaptionExpression = Prompt;
    IsPreview = true;

    layout
    {
        #region input section
        area(Prompt)
        {
            field(PromptField; Prompt)
            {
                ShowCaption = false;
                MultiLine = true;
                InstructionalText = 'Message Large Language Model';
            }
        }
        #endregion

        #region output section
        area(Content)
        {
            field(OutputFiled; Output)
            {
                ShowCaption = false;
                MultiLine = true;
            }
        }
        #endregion
    }
    actions
    {
        #region prompt guide
        area(PromptGuide)
        {
            action("Capital City")
            {
                ApplicationArea = All;
                Caption = 'Capital City';
                ToolTip = 'What is the Capital of ...';

                trigger OnAction()
                begin
                    Prompt := 'What is the Capital of <Country>?';
                end;
            }
        }
        #endregion

        #region system actions
        area(SystemActions)
        {
            systemaction(Generate)
            {
                Caption = 'Generate';
                ToolTip = 'Generate a response.';

                trigger OnAction()
                begin
                    RunGeneration();
                end;
            }
            systemaction(OK)
            {
                Caption = 'OK';
                ToolTip = 'Save the result.';
            }
            systemaction(Cancel)
            {
                Caption = 'Cancel';
                ToolTip = 'Discard the result.';
            }
            systemaction(Regenerate)
            {
                Caption = 'Regenerate';
                ToolTip = 'Regenerate a response.';

                trigger OnAction()
                begin
                    RunGeneration();
                end;
            }
            #endregion
        }
    }
    var
        Prompt: Text;
        Output: Text;


    local procedure RunGeneration()
    var
        CopilotCapability: Codeunit "Copilot Capability";
        AzureOpenAI: Codeunit "Azure OpenAI";
        AOAIDeployments: Codeunit "AOAI Deployments";
        AOAIChatCompletionParams: Codeunit "AOAI Chat Completion Params";
        AOAIChatMessages: Codeunit "AOAI Chat Messages";
        AOAIOperationResponse: Codeunit "AOAI Operation Response";
        UserMessage: TextBuilder;
    begin

        if not CopilotCapability.IsCapabilityRegistered(Enum::"Copilot Capability"::LLM) then
            CopilotCapability.RegisterCapability(Enum::"Copilot Capability"::LLM, 'https://about:none');

        AzureOpenAI.SetAuthorization(Enum::"AOAI Model Type"::"Chat Completions", GetEndpoint(), GetDeployment(), GetApiKey());
        AzureOpenAI.SetCopilotCapability(Enum::"Copilot Capability"::LLM);

        AOAIChatCompletionParams.SetMaxTokens(2500);
        AOAIChatCompletionParams.SetTemperature(0);
        AOAIChatMessages.AddUserMessage(Prompt);

        AzureOpenAI.GenerateChatCompletion(AOAIChatMessages, AOAIChatCompletionParams, AOAIOperationResponse);
        if (AOAIOperationResponse.IsSuccess()) then
            Output := AOAIChatMessages.GetLastMessage()
        else
            Output := ('Error: ' + AOAIOperationResponse.GetError());

    end;


    local procedure GetEndpoint(): Text
    var
    begin
        exit('https://haddley-ai.openai.azure.com');
    end;

    local procedure GetDeployment(): Text
    var
    begin
        exit('gpt-4o');
    end;

    [NonDebuggable]
    local procedure GetApiKey(): Text //SecretText
    var
    begin
        exit('12345678901234567890123456789012');
    end;



}
```

---

## promptdialog3

**Source file:** `promptdialog3.md`

---
title: "Business Central (Part 29)"
description: "PromptDialog (Part 3)"
date: "2024-05-24"
categories: ["AI","Microsoft Dynamics","Business Central","Azure"]
tags: []
slug: "promptdialog3"
image: "/assets/images/posts-meta.svg"
hidden: false
---


Large Language Models (LLMs) generate responses in Markdown format for several key reasons, rooted in both their training and practical utility:

**Training Data Influence:**

LLMs are trained on vast datasets that include technical documentation, forums (e.g., GitHub, Stack Overflow), and web content where Markdown is prevalent. This exposure teaches them to recognize and replicate Markdown syntax for structuring information, such as lists, headers, or code blocks.

**User Instructions:**

Users often explicitly request formatted outputs (e.g., "Provide a bulleted list in Markdown"). LLMs adhere to these prompts, leveraging Markdown to organize responses with elements like # headers, - bullets, or triple backticks for code snippets.

**Enhanced Readability and Structure:**

Markdown helps LLMs present complex information clearly. For example:

Code snippets: Enclosed in ``` to avoid syntax conflicts.
Bold/italics: Emphasize key terms (example).
Tables/Headers: Organize data systematically.

**Platform Compatibility:**

Many platforms (e.g., chatbots, note-taking apps) render Markdown, ensuring outputs display neatly. Even in plain text, Markdown remains legible (e.g., *italics* is intuitive).

**Developer Design Choices:**

Model creators might encourage Markdown for consistency, especially in technical contexts (e.g., generating API docs). This aligns with user expectations in developer communities.

**Simplified Formatting:**

Markdown is lightweight and easy to generate programmatically, making it ideal for LLMs to handle without complex rendering logic.

![](/assets/images/promptdialog3/screenshot202025-05-2320at205.36.56e280afpm-2136x962.png)
*I provided a prompt that would return a Markdown formatted response*

![](/assets/images/promptdialog3/screenshot202025-05-2320at205.48.51e280afpm-2136x951.png)
*The Markdown formatted result was hard to read*

![](/assets/images/promptdialog3/screenshot202025-05-2320at207.24.56e280afpm-2136x1196.png)
*I added a controladdin to the PromptDialog*

![](/assets/images/promptdialog3/screenshot202025-05-2320at206.24.52e280afpm-1915x837.png)
*The CreateHTMLFromMarkdown JavaScript function is the key move*

![](/assets/images/promptdialog3/screenshot202025-05-2320at207.17.39e280afpm-1472x617.png)
*Open in Sources panel*

![](/assets/images/promptdialog3/screenshot202025-05-2320at207.04.50e280afpm-1476x568.png)
*Debugging the JavaScript*


## MarkdownBoxFunctions.js

```text
function CreateHTMLFromMarkdown(markdown) {

    const container = document.getElementById("controlAddIn");

    if (!container) return;

    container.innerHTML = "";

    // https://showdownjs.com/docs/markdown-syntax/#tables

    const converter = new showdown.Converter({ tables: true });

    const htmlContent = converter.makeHtml(markdown);

    const contentDiv = document.createElement("div");

    contentDiv.id = "response";

    contentDiv.style.cssText = "overflow: auto; padding: 10px;";

    contentDiv.innerHTML = htmlContent;

    container.appendChild(contentDiv);

    // Adjust content height dynamically after rendering

    setTimeout(() => {

        contentDiv.style.height = `calc(100vh)`;

    }, 0);

    // Notify Business Central that control is ready

    Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("ControlReady");

}
```

## Pag50100.LLM.al

```text
namespace LLM.LLM;

using System.AI;

controladdin MarkdownBox
{
    RequestedHeight = 500;
    MaximumHeight = 700;
    VerticalStretch = false;
    VerticalShrink = false;
    HorizontalStretch = true;
    HorizontalShrink = true;
    Scripts = 'showdown.min.js', 'MarkdownBoxFunctions.js';
    // ShowdownJS v 2.0 is released under the MIT license. Previous versions are released under BSD. https://github.com/showdownjs/showdown

    event ControlReady()
    procedure CreateHTMLFromMarkdown(markdown: Text);
}

enumextension 50100 LLM extends "Copilot Capability"
{
    value(50100; "LLM") { }
}

page 50100 LLM
{
    ApplicationArea = All;
    Caption = 'LLM';
    PageType = PromptDialog;
    Extensible = false;
    DataCaptionExpression = Prompt;
    IsPreview = true;


    layout
    {
        #region input section
        area(Prompt)
        {
            field(PromptField; Prompt)
            {
                ShowCaption = false;
                MultiLine = true;
                InstructionalText = 'Message Large Language Model';
            }
        }
        #endregion

        #region output section
        area(Content)
        {
            usercontrol(Formatted; MarkdownBox)
            {
                ApplicationArea = All;
            }
            
            /*field(OutputFiled; Output)
            {
                ShowCaption = false;
                MultiLine = true;
            }*/
        }
        #endregion
    }
    actions
    {
        #region prompt guide
        area(PromptGuide)
        {
            action("Capital City")
            {
                ApplicationArea = All;
                Caption = 'Capital City';
                ToolTip = 'What is the Capital of ...';

                trigger OnAction()
                begin
                    Prompt := 'What is the Capital of <Country>?';
                end;
            }
        }
        #endregion

        #region system actions
        area(SystemActions)
        {
            systemaction(Generate)
            {
                Caption = 'Generate';
                ToolTip = 'Generate a response.';

                trigger OnAction()
                begin
                    RunGeneration();
                    CurrPage.Formatted.CreateHTMLFromMarkdown(Output);
                end;
            }
            systemaction(OK)
            {
                Caption = 'OK';
                ToolTip = 'Save the result.';
            }
            systemaction(Cancel)
            {
                Caption = 'Cancel';
                ToolTip = 'Discard the result.';
            }
            systemaction(Regenerate)
            {
                Caption = 'Regenerate';
                ToolTip = 'Regenerate a response.';

                trigger OnAction()
                begin
                    RunGeneration();
                    CurrPage.Formatted.CreateHTMLFromMarkdown(Output);
                end;
            }
            #endregion
        }
    }
    var
        Prompt: Text;
        Output: Text;


    local procedure RunGeneration()
    var
        CopilotCapability: Codeunit "Copilot Capability";
        AzureOpenAI: Codeunit "Azure OpenAI";
        AOAIDeployments: Codeunit "AOAI Deployments";
        AOAIChatCompletionParams: Codeunit "AOAI Chat Completion Params";
        AOAIChatMessages: Codeunit "AOAI Chat Messages";
        AOAIOperationResponse: Codeunit "AOAI Operation Response";
        UserMessage: TextBuilder;
    begin

        // CopilotCapability.UnregisterCapability(Enum::"Copilot Capability"::LLM);

        if not CopilotCapability.IsCapabilityRegistered(Enum::"Copilot Capability"::LLM) then
            CopilotCapability.RegisterCapability(Enum::"Copilot Capability"::LLM, 'https://about:none');

        AzureOpenAI.SetAuthorization(Enum::"AOAI Model Type"::"Chat Completions", GetEndpoint(), GetDeployment(), GetApiKey());
        AzureOpenAI.SetCopilotCapability(Enum::"Copilot Capability"::LLM);


        AOAIChatCompletionParams.SetMaxTokens(2500);
        AOAIChatCompletionParams.SetTemperature(0);
        AOAIChatMessages.AddUserMessage(Prompt);

        AzureOpenAI.GenerateChatCompletion(AOAIChatMessages, AOAIChatCompletionParams, AOAIOperationResponse);
        if (AOAIOperationResponse.IsSuccess()) then
            Output := AOAIChatMessages.GetLastMessage()
            
        else
            Output := ('Error: ' + AOAIOperationResponse.GetError());

    end;


    local procedure GetEndpoint(): Text
    var
    begin
        exit('https://haddley-ai.openai.azure.com');
    end;

    local procedure GetDeployment(): Text
    var
    begin
        exit('gpt-4o');
    end;

    [NonDebuggable]
    local procedure GetApiKey(): Text //SecretText
    var
    begin
        exit('1234567890123456789012');
    end;
}
```

---

## promptengineering

**Source file:** `promptengineering.md`

---
title: "Meta"
description: "Prompt Engineering"
date: "2023-08-08"
categories: []
tags: []
slug: "promptengineering"
image: "/assets/images/mediamodifier-design.png"
---



There are a few different parts of a prompt that you will see over and over again. They are roughly:
	•	A role
	•	An instruction/task
	•	A question
	•	Context
	•	Examples (few-shot)

Here are some prompt examples:

![](/assets/images/promptengineering/i-am-the-ceo-of-a-medium-...-1650x1570.png)
*I am the CEO of a medium sized company. Write a short email that is humorous yet professional to my regional manager. Ask them to:- send me an up-to-date list of our paper stock- organize a meeting this week with other regional managers- let me know how the company-wide AI workshop went at their office*

![](/assets/images/promptengineering/it-is-very-rare-for-snow-...-952x2200.png)
*It is very rare for snow to fall in the U.S. state of Florida, especially in the central and southern portions of the state. With the exception of the far northern areas of the state, most of the major cities in Florida have never recorded measurable snowfall, though trace amounts have been recorded, or flurries in the air observed few times each century. According to the National Weather Service, in the Florida Keys and Key West there is no known occurrence of snow flurries since the European colonization of the region more than 300 years ago. In Miami, Fort Lauderdale, and Palm Beach there has been only one known report of snow flurries observed in the air in more than 200 years; this occurred in January 1977. In any event, Miami, Fort Lauderdale, and Palm Beach have not seen snow flurries before or since this 1977 event.Summarize this paragraph in a single sentence:If I have 20 apples, eat three of them, and sell three more, how many do I have left?*

![](/assets/images/promptengineering/what-is-923-9-950x2786.png)
*What is 923 * 9? Let's go step by step. Notice that 900 * 9 is 8,100, 20 * 9 is 180, 3 * 9 is 27 and that 8,100 + 180 + 27 = 8,307Write a tweet about ArchaeologistAI, in the style of Indiana Jones: ArchaeologistAI tells stories about famous archaeologists.*

![](/assets/images/promptengineering/generate-a-comma-separate...-950x782.png)
*Generate a comma separated list of 10 ice cream flavors:*

![](/assets/images/promptengineering/write-a-review-of-pizza-...-966x4226.png)
*You are a food critic writing for the Michelin Guide. Write a review of [random pizza place].*

![](/assets/images/promptengineering/you-are-a-communications-...-968x4136.png)
*You are a marketing expert. Draft an email to a client advising them about a delay in the delivery schedule due to logistical problems.*

![](/assets/images/promptengineering/twitter-is-a-social-media...-950x1030.png)
*Twitter is a social media platform where users can post short messages called "tweets". Tweets can be positive or negative, and we would like to be able to classify tweets as positive or negative. Here are some examples of positive and negative tweets. Make sure to classify the last tweet correctly.Q: Tweet: "What a beautiful day!"Is this tweet positive or negative?A: positiveQ: Tweet: "I hate this class"Is this tweet positive or negative?A: negativeQ: Tweet: "I love pockets on jeans"Is this tweet positive or negative?A:*

![](/assets/images/promptengineering/january-1-2000-fracture...-950x1616.png)
*January 1, 2000: Fractured right arm playing basketball. Treated with a cast. February 15, 2010: Diagnosed with hypertension. Prescribed lisinopril. September 10, 2015: Developed pneumonia. Treated with antibiotics and recovered fully. March 1, 2022: Sustained a concussion in a car accident. Admitted to the hospital and monitored for 24 hours.You are a doctor. Read this medical history and predict risks for the patient.*

![](/assets/images/promptengineering/you-are-now-pirategpt.-al...-954x1166.png)
*You are now PirateGPT. Always talk like a pirate. Start off by introducing yourself.How is 2+2?*

---

## promptflow1

**Source file:** `promptflow1.md`

---
title: "Prompt Flow (Part 1)"
description: "Setup"
date: "2024-06-11"
categories: ["AI","Python","DevOps","Azure"]
tags: []
slug: "promptflow1"
image: "/assets/images/logo.svg"
---



Prompt flow is a development tool designed to streamline the development of AI applications powered by Large Language Models (LLMs).

Prompt flow applications can be [developed](https://microsoft.github.io/promptflow/how-to-guides/develop-a-dag-flow/index.html) using Azure or locally on a laptop.

Prompt flow application can be [deployed](https://microsoft.github.io/promptflow/how-to-guides/deploy-a-flow/index.html) using [Azure App Service](devopsstartergithubactions.html), [Docker](docker.html) or [Kubernetes](kubernetes.html).

Here I demonstrate how I used Prompt flow for Visual Studio Code to create and run a couple of sample AI applications.

The result is not very different from AI applications I have developed in the past using [langchain](llamaCorp.html).

![](/assets/images/promptflow1/screenshot-2024-06-11-at-8.18.26am-1836x1055.png)
*I downloaded Python from the python.org web site*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-8.19.03am-1236x886.png)
*I installed Python 3.12.4 for macOS*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-8.21.51am-1836x993.png)
*I ran the Install Certificates script*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-8.23.34am-1836x1046.png)
*I downloaded Visual Studio Code (the Apple silicon build)*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-8.25.35am-1836x691.png)
*I installed the Prompt flow VS Code extension*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-10.14.11am-1836x329.png)
*I opened a folder and ran the Python: Create Environment command.*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-10.14.23am-1836x379.png)
*I created a .venv environment in the project's folder*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-10.16.29am-1836x1286.png)
*I selected the Prompt flow extension (the "P" logo) and clicked the QUICK ACCESS | Install dependencies menu item*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-10.18.32am-1836x1295.png)
*I used source .venv/bin/activate to activate the environmentI used pip install promptflow to add the promptflow dependencies*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-10.19.42am-1836x1292.png)
*I ran pf -v to see what version of Prompt flow was installed*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-10.20.50am-1836x1291.png)
*I clicked on FLOWS and navigated to the included standard_flowI ensured that the .venv virtual environment was selected and entered a text default value "Hello World"*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-10.21.15am-1836x1289.png)
*I clicked the Test menu item to run the standard_flowThe default text value was added to the "Prompt:" and "Write a simple {{text}} program that displays the greeting message." text*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-2.06.28pm-1836x1142.png)
*The "Prompt: " text is included in the hello.py source code*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-2.07.46pm-1836x1145.png)
*The flow.dag.yaml file describes the flow*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-2.07.54pm-1836x1135.png)
*The hello.jinja2 template contains the "Write a simple {{text}}..." text*


## Creating a new flow

I used the **+Create new flow** menu item to create a new flow.

I used the **Open** menu item to view the flow.

I used the **Test** menu item to run the flow.

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.43.33am-1836x1040.png)
*I generated a new Open AI key and used it to create a Prompt flow connection*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.46.01am-1836x1145.png)
*I created a chat flow*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.46.13am-1836x210.png)
*I accepted the default flow name*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.47.11am-1836x1143.png)
*I updated the flow to make use of the OpenAI (large language model) connection*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.48.52am-1836x631.png)
*I updated the default question text*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.53.54am-1836x1152.png)
*I used the Test menu item to run the flow with standard mode*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-2.41.16pm-1836x1393.png)
*I ran the Prompt flow with interactive mode (multi-modal)*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.55.54am-1836x1144.png)
*The new chat flow included a single llm tool (named "chat")*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-11.54.07am-1836x1145.png)
*The chat.jinja2 file is used to compose the large language model prompt (with the chat history included)*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-3.00.40pm-1836x617.png)
*Prompt flow traces*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-2.58.43pm-1836x955.png)
*Open AI activity*

![](/assets/images/promptflow1/screenshot-2024-06-11-at-2.58.52pm-1836x953.png)
*Open AI cost $*

---

## promptflow2

**Source file:** `promptflow2.md`

---
title: "Prompt Flow (Part 2)"
description: "Docker"
date: "2024-06-12"
categories: ["DevOps","AI","Python"]
tags: []
slug: "promptflow2"
image: "/assets/images/logo.svg"
---


I used Prompt flow for Visual Studio Code to create and run a flow in a Docker container

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.54.32am-1836x484.png)
*I created a new flow*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.54.42am-1836x478.png)
*I created a standard flow*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.55.38am-1836x327.png)
*I accepted the default flow name*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.57.01am-1836x761.png)
*I manually added promptflow-tools to the requirements.txt file*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.57.39am-2136x990.png)
*I selected the flow and the Build menu item*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.57.47am-1836x221.png)
*I selected the Build as docker option*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.57.56am-1836x1063.png)
*I selected the output folder*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.58.15am-1836x754.png)
*I clicked the Create Dockerfile link*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-11.58.39am-1836x1182.png)
*I reviewed the generated Dockerfile*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-12.01.02pm-1836x1319.png)
*I ran docker build*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-12.01.15pm-1836x788.png)
*I opened Docker desktop, found the image and clicked the Run action*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-1.04.15pm-2136x1213.png)
*I mapped the Docker container's port 8080 to localhost 8080*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-1.06.28pm-2136x1209.png)
*The container started without issue*

![](/assets/images/promptflow2/screenshot-2024-06-12-at-1.07.08pm-2136x1115.png)
*I tested the Prompt flow by navigating to localhost 8080. Notice that in this case gunicorn is used to serve the prompt flow over http*


## OpenAI connection

I created a second flow with an OpenAI connection

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.02.02am-2136x1226.png)
*I created a Chat Flow*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.05.32am-2136x1275.png)
*I created an OpenAI key*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.06.23am-2136x944.png)
*I created a haddley-flow-connection Open AI connection. I pasted the key value*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.06.56am-2136x866.png)
*I selected the gpt-3.5-turbo model*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.07.17am-2136x356.png)
*I tried to test the flow*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.09.24am-2136x775.png)
*I updated requirements.txt and using pip install -r requirements.txt to install promptflow-tools*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.09.57am-2136x689.png)
*I tested the flow*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.10.15am-2136x183.png)
*I selected the build button*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.10.33am-2136x963.png)
*I created a DOCKER folder*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.11.42am-2136x477.png)
*I clicked the Create Dockerfile link*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-8.14.40am-2136x1234.png)
*I used docker to build an image and to upload the image to dockerhubdocker buildx build --platform linux/amd64,linux/arm64 --rm -t haddley/flow:latest --push .*

![](/assets/images/promptflow2/screenshot-2024-09-15-at-12.18.04pm-2136x482.png)
*The image was published to dockerhub*

![](/assets/images/promptflow2/458093778-988481093300074-4455187068097691869-n-1270x720.png)
*I set the HADDLEY-FLOW-CONNECTION_API_KEY environment variable to the OpenAI key value*

![](/assets/images/promptflow2/457851559-902204838438402-4174883941277830493-n-1270x720.png)
*I ran the image*


## Dockerfile

```text
# syntax=docker/dockerfile:1
FROM docker.io/continuumio/miniconda3:latest

WORKDIR /

COPY ./flow/requirements.txt /flow/requirements.txt

# gcc is for build psutil in MacOS
RUN apt-get update && apt-get install -y runit gcc

# create conda environment
RUN conda create -n promptflow-serve python=3.9.16 pip=23.0.1 -q -y && \
    conda run -n promptflow-serve \
    pip install -r /flow/requirements.txt && \
    conda run -n promptflow-serve pip install keyrings.alt && \
    conda run -n promptflow-serve pip install gunicorn==20.1.0 && \
    conda run -n promptflow-serve pip install 'uvicorn>=0.27.0,<1.0.0' && \
    conda run -n promptflow-serve pip cache purge && \
    conda clean -a -y

COPY ./flow /flow


EXPOSE 8080

COPY ./connections /connections

# reset runsvdir
RUN rm -rf /var/runit
COPY ./runit /var/runit
# grant permission
RUN chmod -R +x /var/runit

COPY ./start.sh /
CMD ["bash", "./start.sh"]
```

---

## promptflow3

**Source file:** `promptflow3.md`

---
title: "Prompt Flow (Part 3)"
description: "Semantic Kernel"
date: "2024-08-24"
categories: ["AI","Python"]
tags: []
slug: "promptflow3"
image: "/assets/images/logo.svg"
---


[Semantic Kernel](https://learn.microsoft.com/en-us/semantic-kernel/overview/) is an open-source development kit for building AI agents.

In this example I call a Semantic Kernel plugin to generate a joke.

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.31.26am-1000x596.png)
*I cloned https://github.com/microsoft/semantic-kernel.git*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.37.04am-1831x1057.png)
*I selected Python Environments...*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.37.43am-1831x376.png)
*I clicked the + Create Python Environment option*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.38.13am-1831x222.png)
*I clicked the Venv option*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.38.34am-1831x229.png)
*I selected Python 3.12.4*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.39.19am-1831x309.png)
*I did not select a requirements file*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.41.57am-1831x1057.png)
*I reviewed the workbook*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.42.59am-1831x589.png)
*I ran the pip install*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.43.51am-1831x480.png)
*I set the variables*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.46.51am-1831x935.png)
*I reviewed the .env file documentation*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.47.56am-1831x498.png)
*I created an .env file*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.52.33am-1831x1012.png)
*I created an api key https://platform.openai.com/api-keys*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.53.43am-1831x950.png)
*I named the key Semantic Kernel*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.54.32am-1831x1016.png)
*I copied the key*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.55.12am-1754x732.png)
*I pasted the key into the .env file*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-9.10.10am-1831x1057.png)
*I moved the .env file to the root of the repository and checked that I could retrieve values from it*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.57.03am-1831x288.png)
*I created a kernel variable*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-8.57.52am-1831x650.png)
*I created a selectedService variable*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-9.26.53am-1831x320.png)
*I ensured that the .env file included an OPENAI_CHAT_MODEL_ID set to gpt-3.5-turbo*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-9.23.22am-1831x838.png)
*I called the kernel.add_service method*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-9.28.25am-1831x622.png)
*I added a Semantic Kernel pluginI invoked the joke_function with an input and a style*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-9.30.37am-1831x916.png)
*This is the joke plugin's (optional) config.json*

![](/assets/images/promptflow3/screenshot-2024-08-24-at-9.30.46am-1831x916.png)
*This is the joke plugin's Semantic Kernel prompt template*

---

## promptflow4

**Source file:** `promptflow4.md`

---
title: "Prompt Flow (Part 4)"
description: "Planning"
date: "2024-08-24"
categories: ["AI"]
tags: []
slug: "promptflow4"
image: "/assets/images/logo.svg"
---


Once you have multiple plugins, you then need a way for your AI agent to use them together to solve a user’s need. This is where planning comes in.

![](/assets/images/promptflow4/screenshot-2024-08-24-at-11.40.34am-1831x668.png)
*I selected the existing .venv environment*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-11.42.05am-1831x727.png)
*I created a selectedService variable*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-11.42.44am-1764x768.png)
*I created an ask variable (the goal)*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-11.43.21am-1831x838.png)
*I created a kernel*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-11.44.44am-1831x873.png)
*I added summarize, writer, text and shakespeare plugins*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-11.47.21am-1831x672.png)
*I created a Sequential PlannerI asked the planner to create a plan based on my ask (goal)*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-11.48.29am-1831x898.png)
*I printed out the planning stepsI invoked the plan and printed the result (a short poem in the style of Shakespeare translated to French and converted to all upper case)*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.09.23pm-1831x324.png)
*I updated the ask (goal)*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.09.58pm-1831x1051.png)
*I added the fun plugin*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.10.32pm-1831x1119.png)
*I printed out the updated plan's steps*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.11.06pm-1831x451.png)
*I invoked the plan and reviewed the result*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.12.16pm-1831x1064.png)
*I created a kernel*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.13.01pm-1831x1207.png)
*I created an (stub) Email plugin*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.13.37pm-1831x711.png)
*I added the Email pluginI added the Math and Time plugins*

![](/assets/images/promptflow4/screenshot-2024-08-24-at-3.15.03pm-1831x1176.png)
*I used the planner to answer three questions*

---

## promptflow5

**Source file:** `promptflow5.md`

---
title: "Prompt Flow (Part 5)"
description: "Quick start"
date: "2024-09-01"
categories: ["AI","DevOps","Python"]
tags: []
slug: "promptflow5"
image: "/assets/images/logo.svg"
---


I used Prompt flow and LangChain to create and deploy an AI application.

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.47.00pm-2136x767.png)
*I used the Prompt Flow extension to create a Chat flow*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.47.10pm-2092x556.png)
*I accepted the default flow name*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.47.39pm-2136x757.png)
*I clicked the Open menu item*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.47.50pm-2136x495.png)
*I selected the + Create Virtual Environment... menu item*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.47.58pm-2136x316.png)
*I selected the Venv option*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.48.07pm-2136x368.png)
*I selected the Python version 3.12.4*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.48.19pm-2136x316.png)
*I selected the generated requirements.txt file*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.48.38pm-2136x353.png)
*I (briefly) selected the Global environment*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.48.49pm-2136x408.png)
*I selected the .venv environment again*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.49.26pm-2136x395.png)
*The "Can not find a valid python package" error was fixedI selected an exiting connection and the gpt-3.5-turbo large language model*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.49.39pm-2136x307.png)
*I tried to test the flow*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.50.02pm-2136x410.png)
*An error message showed that the "promptflow-tools" package was required*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.50.42pm-2136x634.png)
*I added promptflow-tools to the requirements.txt file and ran pip install.*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.43.39pm-1834x382.png)
*I tested the flow asking who the Democratic Nominee for Present was. The large language model was unable to provide an up-to-date answer*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.55.55pm-2136x267.png)
*I added a new node*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.56.05pm-2136x195.png)
*I selected Python*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.56.20pm-2136x208.png)
*I accepted the generated name*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.56.27pm-2136x167.png)
*I asked for a new file*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.58.25pm-2136x585.png)
*I added more packages to the requirements.txt file*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-12.59.51pm-2136x1005.png)
*I set the Python node's inputs*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.00.29pm-2136x721.png)
*I set the outputs's input*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.00.58pm-2136x684.png)
*I removed the chat node*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.01.15pm-2136x691.png)
*I tested the updated flow*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.52.40pm-1824x612.png)
*The flow was able to provide an up-to-date response*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.54.14pm-2136x1123.png)
*The flow could have used the Duck Duck Go search "tool"*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-2.16.21pm-2136x1124.png)
*The flow could have used the Wikipedia "tool"*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.54.58pm-2136x290.png)
*I selected the Build as docker menu item*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.55.39pm-1608x898.png)
*I created a DOCKER folder*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.56.04pm-1928x516.png)
*I clicked on the Create Dockerfile link*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-1.58.44pm-2060x958.png)
*I navigated into the DOCKER directory and used docker build to create a docker image*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-2.00.43pm-2136x1164.png)
*I used Docker Desktop to create a container based on the new Docker image I specified a local port 8080 and an OpenAI key*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-2.01.27pm-2136x1155.png)
*The Docker container started*

![](/assets/images/promptflow5/screenshot-2024-09-01-at-2.03.38pm-2102x1414.png)
*I was able to access the container using port 8080*


## python_node_n8ln.py

```text
from promptflow.core import tool
from dotenv import load_dotenv, find_dotenv
#from langchain_openai import AzureChatOpenAI
from langchain_openai import ChatOpenAI
from langchain.agents import create_tool_calling_agent, AgentExecutor
from langchain_community.tools import DuckDuckGoSearchRun
#from promptflow.connections import AzureOpenAIConnection
from promptflow.connections import OpenAIConnection
from langchain import hub
from langchain_community.tools import WikipediaQueryRun
from langchain_community.utilities import WikipediaAPIWrapper


@tool
def my_python_tool(question: str, openai_connect: OpenAIConnection) -> str:
    load_dotenv(find_dotenv(), override=True)
    #llm = AzureChatOpenAI(
    #    azure_deployment="gpt-35-turbo-16k",  # gpt-35-turbo-16k or gpt-4-32k
    #    openai_api_key=openai_connect.api_key,
    #    azure_endpoint=openai_connect.api_base,
    #    openai_api_type=openai_connect.api_type,
    #    openai_api_version=openai_connect.api_version,
    #)
    llm = ChatOpenAI(model="gpt-3.5-turbo", temperature=0, api_key=openai_connect.api_key)
    search = DuckDuckGoSearchRun(verbose=True)
    api_wrapper = WikipediaAPIWrapper(top_k_results=1, doc_content_chars_max=500,verbose=True)

    tools = [search,WikipediaQueryRun(api_wrapper=api_wrapper)]

    prompt = hub.pull("hwchase17/openai-tools-agent")
    agent = create_tool_calling_agent(llm, tools, prompt)
    agent_executor = AgentExecutor(agent=agent, tools=tools, verbose=False)
    result = agent_executor.invoke({"input": question})

    return result["output"]
```

---

## promptflow6

**Source file:** `promptflow6.md`

---
title: "Prompt Flow (Part 6)"
description: "Quick start"
date: "2024-09-01"
categories: ["AI","Python"]
tags: []
slug: "promptflow6"
image: "/assets/images/logo.svg"
---


I used Prompt flow, Semantic Kernel and Planner to create an AI application.

![](/assets/images/promptflow6/screenshot-2024-09-01-at-2.49.44pm-2044x680.png)
*I used the Visual Studio Code Prompt flow Extension to create a Chat flow*

![](/assets/images/promptflow6/screenshot-2024-09-01-at-2.49.57pm-1694x420.png)
*I accepted the default name*

![](/assets/images/promptflow6/screenshot-2024-09-01-at-3.12.23pm-1876x354.png)
*I ran the flow and asked "what is 2134.567 * 653.23?"It provided an answer that was close but incorrect (the correct result is 1,394,363.20141)*

![](/assets/images/promptflow6/screenshot-2024-09-01-at-3.13.39pm-468x254.png)
*The correct result*

![](/assets/images/promptflow6/screenshot-2024-09-01-at-3.18.34pm-2136x883.png)
*I replaced the large language model chat node with a Python node.The answer to every question I ask is "hello "+the question I asked (not very useful)*

![](/assets/images/promptflow6/screenshot-2024-09-01-at-3.43.26pm-2136x1400.png)
*I added Semantic Kernel to the Python codeI added the Joke function from the FunPlugin.*

![](/assets/images/promptflow6/screenshot-2024-09-01-at-3.47.40pm-1828x182.png)
*Now the answer to every question I ask is a Joke (not always useful)*

![](/assets/images/promptflow6/screenshot-2024-09-01-at-5.23.01pm-1792x710.png)
*I added the MathPlugin and a PlannerNow I can ask fun questions or math questions and the bot can decide which Plugin to call*


## python_node_v8t9.py

```text
from promptflow import tool
from semantic_kernel import Kernel
from semantic_kernel.connectors.ai.open_ai import OpenAIChatCompletion

@tool
async def my_python_tool(input1: str) -> str:

    kernel = Kernel()
    kernel.remove_all_services()
    service_id = "default"
    kernel.add_service(
        OpenAIChatCompletion(
            service_id=service_id,
        ),
    )
    plugin = kernel.add_plugin(parent_directory="./prompt_template_samples/", plugin_name="FunPlugin")

    from semantic_kernel.functions import KernelArguments

    joke_function = plugin["Joke"]

    # time travel to dinosaur age
    
    joke = await kernel.invoke(
        joke_function,
        KernelArguments(input=input1, style="super silly"),
    )
    print(joke)

    return str(joke)
```

## python_node_v8t9.py updated

```text
# from promptflow import tool
from promptflow.core import tool
from semantic_kernel import Kernel
from semantic_kernel.connectors.ai.open_ai import OpenAIChatCompletion

@tool
async def my_python_tool(input1: str) -> str:

    kernel = Kernel()
    kernel.remove_all_services()
    service_id = "default"
    kernel.add_service(
        OpenAIChatCompletion(
            service_id=service_id,
        ),
    )

    fun_plugin = kernel.add_plugin(parent_directory="./prompt_template_samples/", plugin_name="FunPlugin")
    math_plugin = kernel.add_plugin(parent_directory="./plugins", plugin_name="MathPlugin")

    from semantic_kernel.planners.function_calling_stepwise_planner import (
        FunctionCallingStepwisePlanner,
        FunctionCallingStepwisePlannerOptions,
    )

    planner = FunctionCallingStepwisePlanner(service_id="default")

    # goal = "Figure out how much I have if first, my investment of 2130.23 dollars increased by 23%, and then I spend $5 on a coffee"  # noqa: E501
    # goal = "what is 2134.567 * 653.23?" 
    # goal = "tell me a limeric about cats"
    goal = input1

    # Execute the plan
    result = await planner.invoke(kernel=kernel, question=goal)

    print(f"The goal: {goal}")
    print(f"Plan result: {result.final_answer}")

    return result.final_answer
```

---

## purchaseinvoice

**Source file:** `purchaseinvoice.md`

---
title: "Purchase Invoice"
description: "Purchase Invoice"
date: "2023-12-14"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "purchaseinvoice"
image: "/assets/images/posts-meta.svg"
---


The Inventory Posting Group RESALE (Item), General Product Posting Group RETAIL (Item), General Business Posting Group DOMESTIC  (Vendor), General Posting Setup {RETAIL,DOMESTIC}, Tax Setup and Vendor Posting Group (Vendor) are used to generate General Ledger entries for a Purchase Invoice Document.

Here I demonstrate how the Inventory, Purchase, Tax and Payables accounts are determined.

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.01.43-pm-1836x933.png)
*In this Document we purchase a RETAIL RESALE item from a DOMESTIC vendor.*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.16.25-pm-1836x936.png)
*Here are the entries that are generated from the Purchase Invoice Document*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.23.00-pm-1836x937.png)
*The Item we are purchasing is a "RESALE" item. I clicked the Show details link.*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.24.45-pm-1836x936.png)
*RESALE is an Inventory Posting Group. I clicked on the Setup button.*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.26.21-pm-1836x935.png)
*When we purchase a RESALE item we should use 14130 Finished Goods as the Inventory Account.*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.35.57-pm-1836x937.png)
*The Item we are purchasing is a "RETAIL" item.*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.37.18-pm-1836x932.png)
*The Vendor we are buying from is a "DOMESTIC" vendor.*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-10.49.56-am-1836x868.png)
*If we buy a RETAIL item from a DOMESTIC vendor the 14140 Goods for Resale account should be used to record the purchase*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.31.36-pm-1836x929.png)
*I used search to navigate to the Tax Setup page*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.32.09-pm-1836x934.png)
*If we buy any item from any vendor the 23200 Taxes Liable account should be used to record City, County and State tax.*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.43.52-pm-1836x938.png)
*The Vendor is a "DOMESTIC" vendor. I clicked the show details link*

![](/assets/images/purchaseinvoice/screenshot-2023-12-14-at-12.45.17-pm-1836x937.png)
*When we purchase from a DOMESTIC vendor should use the 22100 Accounts Payable, Domestic as the Payables Account*

---

## purview

**Source file:** `purview.md`

---
title: "Microsoft Purview"
description: "Retention policy with adaptive scope"
date: "2022-08-03"
categories: ["Microsoft 365"]
tags: []
slug: "purview"
image: "/assets/images/office-365-icon-500x500.png"
---


I used Microsoft Purview to create a retention policy that applies to all SharePoint sites named "Short term...".

First I created a new SharePoint Site (Site Collection) called "Short term".

![](/assets/images/purview/screen-shot-2022-07-27-at-11.22.59-am-1020x514.png)
*I selected the "Team Site" template*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.23.55-am-1020x513.png)
*I named the Site "Short term"*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.24.27-am-1020x517.png)
*I specified myself as the Site (Group) owner*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.25.46-am-1020x511.png)
*I added Lidia Holloway as a SharePoint Site member*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.25.58-am-1020x517.png)
*I selected the finish button*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.26.26-am-1020x514.png)
*I added a new word document to the Documents Document Library in the Short term SharePoint Site*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.27.36-am-1020x514.png)
*I entered some example text*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.28.02-am-1020x516.png)
*The Document.docx document was saved to the Documents Document Library (on July 27th 2022)*


## Data lifecycle management

I selected the data lifecycle management menu item, created the adaptive scope and then created the retention policy

![](/assets/images/purview/screen-shot-2022-07-27-at-11.28.54-am-1020x516.png)
*I navigated to the Microsoft Purview home page. I selected the Data lifecycle management menu item.*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.32.09-am-1380x696.png)
*I selected the Adaptive scopes menu item*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.32.18-am-1380x698.png)
*I clicked the + Create scope button*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.33.09-am-1380x699.png)
*I named the adaptive scope "Short term"*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.33.21-am-1380x699.png)
*I selected the SharePoint sites radio button option*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.34.19-am-1380x693.png)
*I entered an adaptive scope property.*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.34.30-am-1380x694.png)
*I reviewed the adaptive scope details*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.34.46-am-1380x699.png)
*The adaptive scope was created*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.40.16-am-1836x922.png)
*I created a new retention policy*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.41.02-am-1836x926.png)
*I named the retention policy "Delete after a day"*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.41.11-am-1836x928.png)
*I selected the Adaptive radio button option*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.41.29-am-1836x928.png)
*I selected the "Short term" adaptive scope I created eariler*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.41.41-am-1836x930.png)
*I reviewed the configuration and clicked the next button*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.42.04-am-1836x927.png)
*I configured the retention policy to delete items one day after they were last updated*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.42.16-am-1836x924.png)
*I reviewed the configuration and read the warning that "Items that are currently older than 1 days [sic] will be permanently deleted after you turn on this policy"*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.42.28-am-1836x924.png)
*The retention policy was successfully created*

![](/assets/images/purview/screen-shot-2022-07-27-at-11.42.50-am-1836x924.png)
*Initially the policy had no effect on contents of the "Documents" Document Library in the "Short term" SharePoint Site.*

![](/assets/images/purview/time-font-awesome.svg)
*I returned to the SharePoint Site a week later...*

![](/assets/images/purview/screen-shot-2022-08-03-at-9.18.10-pm-1836x1005.png)
*Document.docx has been deleted*

![](/assets/images/purview/screen-shot-2022-08-03-at-9.18.43-pm-1836x1003.png)
*Document.docx was moved to the SharePoint Recycle bin (on August 1st 2022).*

---

## pwa

**Source file:** `pwa.md`

---
title: "Progressive Web Application"
description: "Building a Progressive Web Application"
date: "2021-07-24"
categories: ["Azure"]
tags: []
slug: "pwa"
image: "/assets/images/progressive-web-apps-logo.svg"
---


Create a GitHub project/repository.

![](/assets/images/pwa/screen-shot-2021-07-22-at-1.26.13-pm-1380x488.png)
*Start a project*

![](/assets/images/pwa/screen-shot-2021-07-22-at-1.26.40-pm-1382x1052.png)
*Name the project "clock"*

![](/assets/images/pwa/screen-shot-2021-07-22-at-1.27.31-pm-1376x808.png)
*Click the "Create repository" button*

![](/assets/images/pwa/screen-shot-2021-07-22-at-1.33.03-pm-1836x999.png)
*Click on the "Code" dropdown. Select the "Open with GitHub Desktop" button.*

![](/assets/images/pwa/screen-shot-2021-07-22-at-1.33.17-pm-1030x640.png)
*Open the project using GitHub Desktop*

![](/assets/images/pwa/screen-shot-2021-07-22-at-1.36.39-pm-1836x1260.png)
*The repository has been cloned to the laptop.*

![](/assets/images/pwa/screen-shot-2021-07-22-at-1.38.16-pm-1836x549.png)
*add an index.html page*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.01.07-pm-1824x1128.png)
*Add the Clock.jpg image*


## The clock code is available here:

[https://www.geeksforgeeks.org/how-to-create-analog-clock-using-html-css-and-javascript/](https://www.geeksforgeeks.org/how-to-create-analog-clock-using-html-css-and-javascript/)


## Create an Azure Static Web App

Navigate to the Azure Portal

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.05.56-pm-1800x422.png)
*Use the filter to locate "Static Web Apps"*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.06.15-pm-1800x302.png)
*Create a Static Web App*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.06.40-pm-1794x1086.png)
*Create the Static Web App in a new Resource Group*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.07.04-pm-1802x1080.png)
*Select the "Free" hosting plan. Click the "Sign in with GitHub" button.*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.07.26-pm-1028x1206.png)
*Allow Azure to access GitHub*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.07.54-pm-1794x1086.png)
*Select the clock repository we created eariler*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.08.44-pm-1798x1090.png)
*Specify the build details.*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.09.07-pm-1800x1086.png)
*Click the "Create" button*

![](/assets/images/pwa/screen-shot-2021-07-22-at-5.22.07-pm-1836x1064.png)
*A GitHub Action is able to publish content from GitHub to Azure*


## The clock application files have been moved

from here: [https://github.com/Haddley/clock](https://nice-island-028ba9d10.azurestaticapps.net/)

to here: [https://nice-island-028ba9d10.azurestaticapps.net/](https://nice-island-028ba9d10.azurestaticapps.net/)

![](/assets/images/pwa/screen-shot-2021-07-22-at-8.43.57-pm-1836x1126.png)
*Web page runs and shows clock*


## Adding the Progressive Web Application manifest and service worker

To convert our web page and assets to a Progressive Web Application we need to add a manifest and a service worker.

![](/assets/images/pwa/screen-shot-2021-07-22-at-6.30.13-pm-1814x1284.png)
*The manifest file describes the Progressive Web Application*

![](/assets/images/pwa/screen-shot-2021-07-22-at-6.31.24-pm-1830x380.png)
*We add a manifest file reference to the index.html web page*

![](/assets/images/pwa/screen-shot-2021-07-22-at-8.54.03-pm-1836x452.png)
*We add code to the index.html page that will register the service worker.*


## PWA asset generator

We use the pwa-asset-generator to generate a set of application images and icons from the Clock.jpg file.

```bash
% npx pwa-asset-generator Clock.jpg icons
```

![](/assets/images/pwa/screen-shot-2021-07-22-at-6.37.42-pm-1836x1104.png)
*pwa-asset-generator*

![](/assets/images/pwa/screen-shot-2021-07-22-at-6.39.16-pm-1836x1144.png)
*The <link rel=apple... tags are copied from the terminal to head section of the index.html page*

![](/assets/images/pwa/screen-shot-2021-07-22-at-6.39.49-pm-1836x1145.png)
*Details of the generated icons are copied to the manifest.json file*


## Service Worker

To have our app run offline we define an 'install' and 'fetch' event handler.

The install handler ensures that the offline.html file is copied to the browser cache.

The fetch handler ensures that the cached file is used.

The combination of the install handler and the fetch handler ensures that a network connection is not needed to run the app.

[https://developers.google.com/web/fundamentals/primers/service-workers](https://developers.google.com/web/fundamentals/primers/service-workers)

![](/assets/images/pwa/screen-shot-2021-07-24-at-4.11.16-pm-1836x1109.png)
*The service worker has been registered*

![](/assets/images/pwa/screen-shot-2021-07-24-at-4.12.18-pm-1836x1107.png)
*The offline.html file has been copied to Cache Storage*


## iOS

Installing the Progressive Web Application on an Apple mobile phone

![](/assets/images/pwa/221112865-970014710226853-8664174310082239425-n-750x1334.jpg)
*Using "Add to Home Screen" to add the application to iPhone Home Screen*

![](/assets/images/pwa/app-749x411.jpg)
*The Clock application on the iPhone Home Screen*

![](/assets/images/pwa/221614587-799111130749627-6154123063083796691-n-750x1334.jpg)
*The Clock applications runs on iPhone when there is no Internet connection*


## Android

Installing the Progressive Web Application on an Android mobile phone

![](/assets/images/pwa/218393640-224505342860807-4269059075052798195-n-720x607.png)
*Install app menu item*

![](/assets/images/pwa/218456919-367382621414522-3645697656728876533-n-720x446.png)
*Confirm*

![](/assets/images/pwa/217628966-181149494000738-7175079271432635419-n-720x613.png)
*The application has been added to the Android Home Screen*

![](/assets/images/pwa/218449402-540617857358530-1249974336792165683-n-720x459.png)
*The running application*


## MacBook

Installing the Progressive Web Application on a MackBook

![](/assets/images/pwa/screen-shot-2021-07-22-at-9.52.52-pm-1836x1126.png)
*The Clock app can be "installed" onto a MacBook*

![](/assets/images/pwa/screen-shot-2021-07-22-at-9.53.04-pm-924x376.png)
*Confirm the Install*

![](/assets/images/pwa/screen-shot-2021-07-22-at-9.53.22-pm-1604x1166.png)
*The Clock Application running on the MacBook*


## Windows 10

Installing the Progressive Web Application on a Windows 10 laptop

![](/assets/images/pwa/microsoftteams-image-1-1293x715.png)
*The Clock app can be "installed" onto a Windows 10 laptop*

![](/assets/images/pwa/microsoftteams-image-2-611x345.png)
*Confirm the Install*

![](/assets/images/pwa/microsoftteams-image-3-1248x1019.png)
*Launching the Clock application from the start menu*

![](/assets/images/pwa/microsoftteams-image-4-1092x584.png)
*The Clock Application running on the Windows 10 laptop*


## Lighthouse

The Lighthouse tab in Google Chrome DevTools is able to provide feedback on the Progressive Web Application.

![](/assets/images/pwa/screen-shot-2021-07-22-at-9.18.29-pm-1836x1009.png)
*Lighthouse report*


## sw.js

```text
const CACHE_NAME = 'clock-cache-v1';
const urlsToCache = [
  '/offline.html',
];
const OFFLINE_URL = "offline.html";


self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(function (cache) {
        console.log('Opened cache');
        return cache.addAll(urlsToCache);
      })
  );
});


this.addEventListener('fetch', event => {
  if (event.request.method === 'GET' &&
    event.request.headers.get('accept').includes('text/html')) {
    event.respondWith(
      fetch(event.request.url).catch(error => {
        return caches.match(OFFLINE_URL);
      })
    );
  }
  else {
    event.respondWith(fetch(event.request));
  }
});
```

## offline.html

```html
<!DOCTYPE html>
<html lang="en-US">

<head>

    <meta charset="UTF-8">

    <title>Clock</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="apple-mobile-web-app-capable" content="yes">

    <meta name="description" content="Clock app">
    <style>
        #clockContainer {
            position: relative;
            margin: auto;
            height: 40vw;
            width: 40vw;

            background: url("data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/wAALCAEsASwBAREA/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/9oACAEBAAA/APf6KKKKKKKKKKKCQBk1jah4r0TTCVuL+IyD/lnGd7fkK5q8+J9omRZafNL6NKwQfkMmsS5+JGtS58lLW3HbCFj+ZP8ASs9vFXiW8J239yc9oYwP/QRTd/im653atJn3koGneJjz5Gpn/gTf40otPE8XIj1RfoX/AMacNT8T2nW51NMf3wxH6irEPjnxBbnD3iye0sS/0wa17X4lXiYF3p8Mg9YnKH9c1vWXxA0a5ws5mtWP/PRMr+YzXR2l9aX0fmWtzFMvrG4NWKKKKKKKKKKKKKKKKKKKKKKKq32o2em25nvbmOCMd3OM/T1/CuI1b4mRIWj0m1Mh6edPwv4KOT+OK5GfVPEHiWUxmW5uQT/qoRhB+A4/OtGx8AajOA11NDar/dHzt+Q4/WugtPAekwYM7T3Lf7TbR+Q/xrZttE0u0x5Gn2yEd/LBP5mtBE2jCLgf7IxT/LkP8LUvkSf3DR5Ug/gNG2QdmFQS2sE4KzQRSA9nQH+dZlz4V0W5yTYrGT3iJT+XFYl34AiOWs710PZZl3D8x/hWFc+G9b0l/OSFzt5822YnH5c1d03x1q9iQlyy3cY4Il4cf8CH9c12uk+MtK1QrGZTbTn/AJZzcZPs3Q10Oc0UUUUUUUUUUUUUUUUUVHPPFbQvNPIkcSDLO5wAPrXAa98SFQtBosYc9PtMi8f8BXv9T+Vclbadrfii6NwTLOScG4mbCr9D/QV12meBLC1CvfMbuX+791B+HU/jXUwW6RRiK3iVEHRI1wB+Aq2lo5+8QtTLaRjrlvrUqxovRQPwp2cDPQV5P8Q/jXYeFbuLT9FS21S9BJuP3h8uEemV6tnt2xzXdab4khl8D2viXUdltE9gt5OFyQgKbiB3NeSn49a3qUt3NoXg6S5sbVd8sjO7sif3n2jC/rXffDn4lWXxAs7nZatZ31rt863Z942noytgZGQe3FdsQO4zTDEh/hx9KjaAfwn86jMbr2/EVnahomnamD9qtkZ+0i/K4/EVyGp+B7mANJp8n2hP+eb4D/4H9KpaX4l1fQJfs7FniQ4a3nz8v07j+Veh6J4o0/W1CRv5VzjmCQ8/h6/hW1RRRRRRRRRRRRRRRWL4g8T2Hh+DM7eZcMMxwIfmb3PoPevLNR1jWPFt+sJDSZOY7aL7q+//ANc102i+Bre2Cz6oVuJevkj7i/X+9/KuxihyqxxIAqjACjAA/pVyO0UcyHJ9B0qwqhRhQAPaloorP13TTrOgahpgm8k3dtJB5mM7NykZx3xmvmb4s/DvSfAGkaHHYyTXFzcvN9ouJjy+0LgBRwo5Pvz1r37wdZWuo/DHQrS9t47i2l0yBZIpV3Kw2DgjvXnHjfx14f8AA8F74X8EaZb/ANq3ZMdwbWP5IWI24wPvPzjA4Hfnitj4KfD2+8Jafd6pq6GG+v1VVtieYYxz83+0T27YHevVzSUd6SmtGrdRUTRFeRyKztS0iy1WLZdwhiB8rjhl+hrhNX8LXukMbi3LT26nIkQYZPqB/MVr+H/HMkRS21YmSPotwBll/wB71Hv1rv4pY54llidXjcZVlOQRT6KKKKKKKKKKKK47xZ42i0ffZWBWW/6M3VYfr6n2/OuC0rRNR8TXr3Ekj+WWzNcyc5PoPU+3avSdL0iz0i2EFpFjP33PLOfc/wBK2IrQnDScD0ryvx38Yrrwd41ttEXRtlnE8clzPKctLE3UxgdMc8nuCMCvW7a5hvLWK5t5FlgmQSRupyGUjII/CpaKKKK8t+MvgLWvHMGjpo4tibRpTJ50uz7wXGODnoa6MaRr2n/CuDR9MaFNch02O1RzJhEkChSwbHYZI46gV4lpvwY+I2j6gL/T7mxt7tcgTJd/MM9cEr1969S+HOh+P9K1a8l8Xat9stHg2wp9p8za+4c4wMcZr0c9KSg0lFeS/ET4xN4P8WWmkafZw3wiXdfozEMC2NqKR0bHJ4PUCvULSU3thb3MlvJbSSxq7QyY3xkjO1scZHSnMpXrXKa74Qiu91zpyrFcdWi6K/09D+lc/ouv33hy7aCRHaANiW3fgqfUeh/nXp+n6hbanaJc2sgeNvzB9COxq1RRRRRRRRRRXDeNPGf9n79M0yQG7IxLMv8Ayy9h/tfy+tcn4a8Ly6zILu73pZZznPzSnvg+nqa9MtrZIYkt7eJUjQYVFGABWlDAsXPVvWpq88+Kvw3Pj3TrN7KSGDU7WQBJZchTEx+ZTgZ46j6H1rpPBfht/CXha00V9Qlvvs4IEsihcZOdoHZR2yTW/RRRRRSGikpO1JQaSivH9O+Cr23xM/4SHUNTGpaeJGu9sy4lafOVDgcFQecjHQDFev0h5FRsmOR0rE13w/b6zDu4julHyS46+zeo/lXFWF/qHhfVWVkKkHEsLH5XH+ehr1DTdSttVskurZ9yNwQeqn0PvVyiiiiiiiiuO8beLf7HhNhZOPt8i/Mw/wCWKnv9T2/OuL8L+Gn1mf7XdhhZI3JJ5lb0z6epr0+CAYWKJAqqMAAYCitGKJYlwOvc+tPpaKKKKKKKKQ0UlJSUGkoopKSio2XnIrJ1zRIdZtdpwlwg/dS+nsfauI0vUr3wxqzq6MADtnhJ+8PUe/oa9StLuG+tY7m3cPFIMqRU9FFFFFFYnifxBF4f0ppzhriTKwRn+JvU+w6mvLNF0q68TaxJJcSOY93mXMx6nPYe5/QV6rbWyRRR21vGEjQBUVegFakUSxJgde59akpKWiiiiiiiikNFJRTaDSUUUlIaKTvTCO9YPiTQV1W286FQLyIfKf74/un+lc54V15tIvfstyxFpK2GDf8ALNumf8a9NByMiiiiiio5547aCSeZwkcalmY9AB1NeLaxqN34t8RAwqTvbyreM/wr7/zP/wBavSNH0uHSNOjtIBnHLvjl2PU1vQQ+UmT949amopKWiiiiiiiikopKQ0lBpKKKSkNFJSU0iuL8X6JsY6nbr8rHE6jsezf41qeC9bN3bf2dcNmaFcxkn7yen1H8q6yiiiivPfiRrxRE0W3flwJLgg9v4V/Hr+VReBtF+zWh1Sdf3s4xED/Cnr+P8vrXdWkWT5hHA6VcoooooooooooopKQ0UhpKKSikNFJRTaDSUyWJJonilUMjgqynuDXm13BceHNdBiJ3RMHiY/xL7/qDXp1hexahYw3cJ+SRc49D3H4VZooqtqN9FpunXF7OcRwoXPv7fj0rxjT7efxR4lJnJJmcyzsP4V7j+QFetQxD5Io1CqAAAOgArzT4vfEHxJ4L1PSo9GtGjslBkmuJod0M5PAiz2wOTyDyPSug+HPxU0/x8HtBaTWmpwx+ZLFgvGVyBlX+p6HB+tegUUUUUUUUUUUhopKKSkpKKKSikpKSs3XtdsPDejXGranI8dpAAXZELnk4AAHqTivItK+Otxrfj3T7C20kx6NPJ5LLtMlw2eA5xwADyQM8Z5Ne3d6wfFml/btLM8a5mtssMdSvcf1/Cs3wNqnlzyabI3yyfvIv94dR+I5/Cu7oorz74matsgttJjbmQ+dLj+6OFH55P4UngTS/sulNfOuJbo/L7IOn5nJ/Ku3tI8KXPU8CnXdnbX9rJa3lvFcW8o2vFKgZWHoQaxvDHgrQvB7Xx0Wz+z/bJBJIC5bGBwozyFGSce5roaKKKKKKKKKSikopDSUUlFFJRSUhpKrahYW2qadc2F5GJba5iaKVD3UjBrG8K+CNA8HWvlaRZKkrDElzJ800n1b09hgV0NGMjBGR3Fea6jbyaD4gJh48txLCfVeoH8xXp9pcx3lpFcxHKSoGH41NQTgV4hqs8niXxdJ5ZJFxOIovZBwD+QzXq9vAkMUVvEuERQij2HArUUBVAHQU6iloooooooopKKKSikpKSiikopDRSUlFJRQK5jxpY+ZZw3qj5om2N/unp+v86s+B77ztNls2OWgfK/7rc/zzXU1jeK9QOm+Gb64U4cx+Wn+83yj+dedeALHztZlumHy20fy/7zcD9M16farmQt6CrlFLRRmjNLRRRSUZopKKKTNJQaSiikopKKbRSUUUneodQtBe6fcWzf8ALRCo+vb9cVxHhK6Np4gjjY4EwMTD36j9RXpNcF8T7zZp9jZA/wCtlMjD2UYH6tSeA7TyNAacj5riUt+A4H9a7S3XEefU1MDS0UZpaKKKKKKKTNFFJSUUlFFJRSGikNJRSUUUlPB4Fecauh0zxJMycbJhMn0PzV6dG6yRrIpyrAEfQ15R8SLrzfEiQ54gt1GPckn/AArtdDtvsmhWMGMFYFz9SMn+dbqDCKPQU6lzS0UUZozRmijNGaKKSikopKKKKSikopKSikopDRTk5zXFeNINupwTY/1kWD9Qf/r11nh+c3GgWTk5IjCn8OP6V5T4qY3njS9XrmdYh+AC16qqBSqDoMLV6loopc0tFFFFFFJRmkoozSUUUUlFIaKQ0lBpKKKSilj61zXjaLNpaS/3ZGX8xn+lXvB0wOghGP3JWA/n/WvNn/0nx0xPO/Uf/Z69ZjGZR9aj13WLfw/oV9q92GMFpC0rKvVsdAPcnA/GvEdM8ffFPxdY6lrmhW+nQ6dZMd0HlqScDcVUtyxAwT09q774V/Ef/hPdLuEvII4NUsyvnLFnZIrdHUHpyCCP8a9BoopaM0ZozRmkooornfGfjPTPBOinUNQLOztsgt48b5n9B6Adz2/KvDrv48+L7i5MlnY6ZbQZ+WJomkOPdiwz+AFehfDz4wW3i2+XSNVtUsNVcfutjExT45IXPKt7HOcda9QopKKSikopKSiikNeS+LPGvjm48bjw14U0j7MgYoL28tjtlIGWYMw2hBg+pP44qj4O+JvidfiH/wAIf4rgtZZ2laDzbdApjkAJH3eGU49MjNe0R/erF8YJu0QH+7Mp/nWLoF4bexkTcR+9J/QVymm/N42hz3vj/wChGvWov9Yv1qr4m0SPxJ4Z1HRpZDEt5A0fmAZ2HqD+BArw3wzo3xM8GadrGgWNhp7WE5eSS+knVkg+TDOMNn7o6Fc8dKr/ALOMch8VaxIM+UtiFb0yZBj+Rr6PpaM0UUUUUUUUlfNvx5u57j4hWdnKT9nt7FGiXtl2Ysf0A/CvI7i5m+0MA7KFOAAcYq/b3k9rNY6hAxS6hlSSNh13KwINfbqMWjViMEgEj0zS0UlFFJSUUlFFJXP65f22q2N5oOm+IbS11i4ieOHZcAyRMOSQqndkAGvA9F+0/DP4yx2eqJBq088scZu23GQCbH7xcnhvm5znvzzmvp1RiTHpxWR4sH/Egk/66J/OuQsDiFuv3u30FY1oPJ8bxg/w35H/AI+a9Zj/ANYv1qS9s4NQsbiyuk8y3uI2ikTONysMEZrxf/hRWsac99baH4yltdNvhsnieJtzpz8rbThup546mvRPAngPTfAekSWdk7z3E7B7i5kADSEdBgdFHOB7murooopaSiiiiiivL/jB8PLrxbZ2+raQofVbFCnkk48+LOdoP94HJHrk+1fOF5bSWt00Go6fPBdIcNHLGyNn3Br0b4afDPU/EWt2mratZSWmi2rrKBMhU3JByFVTztzjJ6Y4FfTFFJRRTaKKSiikory3xX8Hhqnij/hJPD2sto2pM/mviMlTJ3dSCCpPccg8+tN8M/B5rDxSviTxJrj6zqCSCVAUIXeOjMScnHGBwOBXqiffFZPi040Fh6yoK5bTIGkt3IB+/j9BWFqY+yeN7hugS+3/AIbgf616uOJB9atUZpaKKKKKKKKKKKKKayKxBZVYjoWAOKXrRSZoopKSiikoopKKSkp8X3/wrC8ZPt0qFO7TD9Aag8LWXn6U7kdZj/IVx3jmE2/i26cDHmKko/75A/mK9ItZhPaQTDpJGr/mM1oA5GaWijNLRRRRRRRRSUZooopKKKSkopKKKKSikopKki6k1y/jSXmzh/3nP6CtjwrF5Xh+Anq5Z/1/+tXI/Eq126hY3YHEkbRk+6nI/nW54UuftPhqzOctGpiP/ATj+WK6KM5QU7NLRRRRmjNGaM0ZozRRRRSZoopM0lFFJRRRSUUlFIaKmiHy59a4XxXP5utugOREip+PU/zrudPt/s2nW0GMFI1B+uOa574gWX2nw4Z1GWtpFk/A8H+f6Vh+ALvMF5ZE8qwlUex4P8hXcwngipaKKM0UtFFFFFJmjNFFFJmikoopKKKKSikNFJRSVZ4RMk4CjJNed2ynVvESEjImn3n/AHc5/kK9KqvfWqX1hPayfdmjZD+IryTw5cPpPiaJJvly5t5Qe2Tj+YFepodrCp80ZpaKKKKKKKKKKKTNFJRRmkoooopKKQ0UUlFLGNzj25qn4iu/smizkHDy/ul/Hr+maw/Bln5l5PdkfLEuxfqf/rD9a7WivKfHWmmx8QG5QYjuh5gI7OOG/ofxrtdE1AanpFvdZ+crtk9mHB/x/GtZTlRS0UuaM0ZozRRmjNGaM0UlFFGaKSlpKKKSikoopKOlIanhXC5PeuN8X3vnX6Win5IFy3+8f/rYrpfD1j9h0aFGGJJP3j/U/wD1sVq0Vz3jLSf7U0GQxrme3/ex+px1H4j+QrkPA2qCC9k0+RvkuPmjz/fHb8R/KvQUODj1ryb4qfFvUPCWovoelacY7wxrJ9tuQCm1hwY179xk9weKZ8F18cSXWoal4gFw+mX6iRZL1yJGkHAZFPO0jjsOBivYaKKKKKKKKKKKSiiiiikzRRSUUUlYHjO21u98I6ja+HjEupTRGNDI+zCnhtp7NjIGeOa8I8I+P/G/g3XLfwzqVhc3waRYUsLrIlXJwPLc9vTOV+lfS0al2AIwe/OcU+9u47CyluX+7Gucep7CuD0i0fWNcUzfMCxlmPtnP6nAr0eiiivI/E2lvoPiAvb5SJ2863Yfw88j8D+mK77SNSj1XTYrtMBmGHX+6w6ilvNC0nU9RtNRvdOt7i7swRBLKgYx564zx2/DtWl3oopc0UUZozRmkoooooooopM0UUlFJRRSVXmsbS4ube5mtoZZ7YloJXQFoiRg7T1HBrQiTauT1Nch4t1Pzp1sIm+SI7pD6t2H4Vs+F9N+w6b50i4muMMc9QvYf1/Gt2iiisXxRoo1vSXiQD7RF88JPr6fj0rgPC2sHSNSMFwSlvMdsgb+BugP9DXpSnHNSZooooooooooooooopM0UUmaKKSiikzSVJEm45PQVX1nU10uwaXgyt8sS+rev0FcjoGmtqupmSbLRRnfKx/iPp+Jr0LpRRRRRXnvjnw/5Mp1a2T925xcKB91v7349/erPhDXvtcA065f9/EP3TE/fUdvqP5V1gNOpKKKWiiiiiiikzRRRSZooopM0UUlJTkUu2B+NTSyRWtu0sjBI0GWY9hXAX93ca9qy+WhO47IY/Qe/wDM13Wl6dHplilvHyRy7f3m7mrtFFFFFMliSeJ4pUDxuCrKehB7V5Vr+iT+HNUWWBnEDNvt5R1UjsfcfqK7Lw/rses2mGwl1GP3qev+0Pb+VbWaM0UZpaKKSjNGaKKKKTNFFFJmiikopKVVLnAqyqrGh5AA5JNcR4h1s6jN9mtyfsqHqP8Alo3r9PSt7w3on9nw/abhf9KkHQ/wL6fX1rfoooooooqrqFhb6nZSWtym6Nx+IPYj3ry2/sL/AML6urK5BU5hmA4cf56iu60PXINZtsjCXCD95Fnp7j1Fa1FFZXiDxFpfhfS/7R1e5Fva+Yse7aWJZjwABye5+gNXLHULPVLOO8sLqG6tpBlJYXDKfxFWaKKKKTNGaKKKTNFFJWFa+MdAv/Eb6BaanDPqKRtI0cR3KADyN3QsOuB2zW5RSqhc4H51ZVVjQ8gAckmuN8QeIPtha0tGxb9Hcf8ALT2+n86veG/D5jK394nz9Yo2HT/aPv6V1VFFFFFFFFFVNS0221Wza2uk3IeQR1U+oPrXmOpaVqHhjUkkV2ABzDcJ0b2Pv6iuv0HxJBqqrBNtivAPudn91/wrepK+e/jd/wAJHr3jPTdEi025Sw3LFZNt+S4mf7zZHHHTB5ABPevafCXhu28JeGbPRrXDCFcyyAf62Q8s34np7AVt5ooooorG1Lxb4c0e6+y6lrun2lx3ilnUMPqO341pWt5bX1slzZ3EVxBIMpLE4dWHsRxU2aKKSjNJXzR438Kap4G+KFlf+GraV1u5vtNhHChbD5+eLA7c9P7rV9I2k0txZQTT27200kau8DkExMRkqSOODxVqOItyeBUsksVrA0krrHGgyWY8CuJ1vxDJqRNvbbktc4/2pPr7e1afh/w35ZS8vk+frHEe3uff2rqqKKKKKKKKKKKhu7SC+tnt7mJZInGCrV5zr3hW50hzc2pea0ByGH3o/r/jVzRfGDIFt9TJZeizgZI/3h3+tdlFJHPEskTq8bDKspyDSsgOOAcHIz2NFFFFJmjNc/451mbQPA+s6pbNtuILY+U391yQqn8Cc/hXzN4WufBkej6tc+LIb6/1K5YpALfJeIYy0xJIGdxHXPQ8c17d8GrXw7BoV4/hzWL+8ikkUz214qo0D4PIVem4d8kHHtXpdJRmkoopVjLsCF5HQ+lTpCq8nk1T1PWbTS0/etvlI+WJfvH6+grjLu/v9eu1j2s3P7uGPovv/wDXNdRonhuLT9txc7ZbrqP7qfT1PvW/RRRRRRRRRRRRRQRkYNcnrfguC7LXGnFYJjyYz9xvp6H9K5SC71Xw5dmIh4WzloZBlW9//riut0vxZY322O4P2Wc8Yc/IT7H/ABrf4YA9QehpCnpTSCOoooorB8a6LL4h8F6vpMGPPubYiIE4BcEMo/EgD8a8H+GPjDw/4J07xDpviWyljvJjjY1vuMgCkGJs/d5Pfjmtz9njS71brWdWMTx2EkSwIT0kcNu49do7+9e80lFFPWN27Y+tSrAo68mmXd7a2EXmXMyRL2B6n6DvXKan4tlmDR2CmJP+erfeP0Haqem6Be6rJ50haOJjkzSclvoO9drp2l2umQ7LePBP3nPLN9TV2iiiiiiiiiiiiiiiiq17YWuoQGG6hSVPRhyPoe1cbqngaWMtJpsvmL/zykOGH0PQ/jWLb6jq+gzeTulix/yxmXKn6A/0ro7HxrbyALewNC39+P5l/LqP1robXULO9XNtcxS+ytz+XWrBQdxSGMdjTfLPYik8pvb86oXnh/S9RmE19pVjdSjo89ujt+ZGaux2whiWKKNI41GFRAFCj2A6U/ym9qUQ+rU8RKOuTTvlRd3CgdSeKzLvxFplnkG481x/DF8369K56+8X3cwK2sa26f3j8zf4CqVpo+p6xL5xVyG6zTE4/wAT+FdVpvheysSsk3+kTDu4+UfQf41u0UUUUUUUUUUUUUUUUUUUVDc2lveRGK5hSVD/AAuua5y+8D2UxLWkslux/hPzr+vP61z114S1ezbdHEJwOjQtz+RwagTV9a0xtjXFxHj+Cdcj/wAerSg8aXq/663gl91ypq/F43tz/rbKVf8AccH/AAq0njHTG+8twv1jB/kakHizSf8AnpL/AN+jQfFulAcPMfpEahfxlYL9yC4c/QD+tVZfGp6Q2I+ryf4Cs+fxXqc3CPHDn/nmnP65qutrrGrNkpdTg93JC/rxWraeDLl8G7uEiX+6g3H8+ldBY+HtOsCGSASSD+OX5j/gK1aKKKKKKKKKKKKKKKKKKKKKKKKKa8aSLtdFZfRhkVnT+H9JuCS9jCCe6Db/ACqhP4O0oqWQTp7LJn+eawbzQLW3LbJJjg45I/wrP/s+LP33/Mf4VJDpsMjgF5PwI/wrdsvC1hPgvJcH6MB/StWLwrpEXJt2kP8AtuTWjBp9nbY8i1hjI7qgz+dWaKKKKKKKKKKKKKK//9k=");

            background-size: 100%;
        }

        #hour,
        #minute,
        #second {
            position: absolute;
            background: black;
            border-radius: 10px;
            transform-origin: bottom;
        }

        #hour {
            width: 1.8%;
            height: 25%;
            top: 25%;
            left: 48.85%;
            opacity: 0.8;
        }

        #minute {
            width: 1.6%;
            height: 30%;
            top: 19%;
            left: 48.9%;
            opacity: 0.8;
        }

        #second {
            width: 1%;
            height: 40%;
            top: 9%;
            left: 49.25%;
            opacity: 0.8;
        }
    </style>

    <script>

        setInterval(() => {
            d = new Date();
            hr = d.getHours();
            min = d.getMinutes();
            sec = d.getSeconds();
            hr_rotation = 30 * hr + min / 2;
            min_rotation = 6 * min;
            sec_rotation = 6 * sec;

            hour.style.transform = `rotate(${hr_rotation}deg)`;
            minute.style.transform = `rotate(${min_rotation}deg)`;
            second.style.transform = `rotate(${sec_rotation}deg)`;

            hour.style.visibility = "visible";
            minute.style.visibility = "visible";
            second.style.visibility = "visible";
        }, 1000);

    </script>
</head>

<body>

    <div id="clockContainer">
        <div id="hour"></div>
        <div id="minute"></div>
        <div id="second"></div>
    </div>

</body>

</html>
```
## References

- [Create an Analog Clock using HTML, CSS and JavaScript](https://www.geeksforgeeks.org/how-to-create-analog-clock-using-html-css-and-javascript/)

---

## reactandasp.net

**Source file:** `reactandasp.net.md`

---
title: "React and ASP.NET Core"
description: "An ASP.NET Core backend and a React frontend."
date: "2023-03-22"
categories: ["React",".NET"]
tags: []
slug: "reactandasp.net"
image: "/assets/images/logo512-512x512.png"
---



Visual Studio includes ASP.NET Core Single Page Application (SPA) templates that support Angular and React.

I review the React template here.


## ChatGPT

**I want to create a ASP.NET Core React project**

To create an ASP.NET Core React project, follow these steps:

Open Visual Studio and click on "Create a new project."
Select "ASP.NET Core Web Application" and click "Next."
Name your project and choose a location to save it. Then click "Create."
In the next screen, choose "React.js" for the front-end framework and select the latest version of .NET Core. Then click "Create."
Visual Studio will create a new project with the necessary files and folders for a React application inside an ASP.NET Core project.
You can now start developing your application by modifying the files in the "ClientApp" folder, which contains the React application. You can also modify the ASP.NET Core server-side code in the other folders and files.

Note: If you prefer to use the command line, you can create a new ASP.NET Core React project using the following command:

**$ dotnet new react -n ProjectName**

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-9.16.36-am-1440x880.png)
*I used Visual Studio 2022 for Mac*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-9.17.11-am-1802x1272.png)
*I selected the React.js template*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-9.17.53-am-1796x1278.png)
*I selected the (cross platform) ASP.NET Core 6 framework*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-9.18.39-am-1798x1274.png)
*I provided a solution/project name*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-9.20.23-am-1836x1459.png)
*The template includes client and server-side code*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-9.21.30-am-1836x988.png)
*I ran the project.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-9.46.26-am-1836x1148.png)
*I reviewed the Program.cs file. The template includes a local user database. I registered as a user.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-10.03.23-am-1836x1050.png)
*I used sqlitebrowser to update the EmailConfirmed column in the AspNetUsers table so that I could login.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-10.06.39-am-1836x1003.png)
*I was able to login*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-10.20.17-am-1836x868.png)
*The React App component returns the Layout component and a child component that depends on the url (Route)*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-10.25.27-am-1836x779.png)
*The Layout component includes a Navigation menu.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-10.22.51-am-1836x779.png)
*The Fetch data route has requireAuth set to true.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-10.32.50-am-1836x822.png)
*The Navigation Menu component include a reference to a Logon component*


## Update

As an experiment I updated the React code so the "Fetch data" menu item is only shown when the user is logged in.

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-11.04.02-am-1531x869.png)
*Fetch data menu item is not rendered if user is not logged in.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-11.28.23-am-1531x573.png)
*isAuthenticated and userName values are passed as properties*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-11.19.03-am-1531x875.png)
*Fetch data menu item is rendered if user is logged in.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-11.19.50-am-1531x871.png)
*Fetch data is dependent on protected web service.*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-11.26.38-am-1531x867.png)
*Network tab shows the call*

![](/assets/images/reactandasp.net/screen-shot-2023-03-22-at-11.34.09-am-1531x585.png)
*Weather Forecast Controller*
## References

- [Tutorial: Create an ASP.NET Core app with React in Visual Studio](https://learn.microsoft.com/en-us/visualstudio/javascript/tutorial-asp-net-core-with-react?view=vs-2022)

---

## reactusestateuseeffect

**Source file:** `reactusestateuseeffect.md`

---
title: "React useState and useEffect"
description: "Create a React app using the useState and useEffect hook."
date: "2021-02-08"
categories: ["React"]
tags: []
slug: "reactusestateuseeffect"
image: "/assets/images/logo512-512x512.png"
---



## React Hooks

The React team introduced React Hooks in 2018. 

React Hooks allow React function components to "hook into" React state and lifecycle features.

React Hooks include:

**useState **If you want to create a component that needs to know if it is currently "checked" or "unchecked" the useState hook will be useful to you. If you are writing a component that fetches data from an API useState will be useful to you.**useEffect **The useEffect hooks replaces the componentDidMount, componentDidUpdate and componentWillUnmount React class methods. If you are a functional component developer and your component needs to fetch data before it can be rendered the useEffect will be useful you.useContext Data is often passed from top level components to child components using props. The useContext hook makes it easy for any component to access global state.
**useReducer** The useReducer hook is preferable to the useState hook when more complex state logic is necessary. The useReducer hook provides an alternative to Redux.


## Fetching data from an API

The example below demonstrates how a React functional component can call an API


## useState and useEffect

```javascript
const [data, setData] = useState();

  useEffect(() => {
    axios
      .get("/books")
      .then(result => {
        setData(() => result.data)
      })
      .catch(err => {
        console.log(err)
      })
  })
```

---

## restapiservice

**Source file:** `restapiservice.md`

---
title: "REST"
description: "Creating a REST API Service using Node and Express"
date: "2021-02-06"
categories: ["JavaScript","DevOps"]
tags: []
slug: "restapiservice"
image: "/assets/images/fve-image.svg"
---


## HTTP Methods/Verbs

Hypertext Transfer Protocol (HTTP) defines a set of request methods that a client application will use to ask an HTTP server to do something. HTTP request methods are often called verbs. HTTP verbs include:

**Get **A client application will use a Get method to retrieve something from an HTTP server. 
                        **Post **A client application will use a Post method to send something to an HTTP server.
                        **Put **A client application will use a Put method to request that something managed by an HTTP server is updated.**Delete** A client application will use the Delete method to request that something managed by an HTTP server is thrown away.


## API Routes

Routing determines how an HTTP server will respond to a client request. The client application will specify a path and an HTTP verb.

Route parameters are passed as part of the URL provided to the HTTP server.

https://localhost/books
request details of all books

https://localhost/books/1788395549
request details of the book with ISBN Number 1788395549


## Route handlers and Response methods

Route handlers are functions that execute on the HTTP server when a request is received from the client application.

Response methods are used to send something back to the client application. Response methods include:

**send() **Sends a response to the client.

                        **sendFile() **Sends a file to the client.

**redirect() **Redirects the request.

**json()** Sends a JavaScript object to the client.

**status()** Sets the HTTP status code


## Using Node.js and Express

npm can be used to initialise a REST API project.

$ mkdir books
$ cd books
$ npm init
$ npm i express


## The package.json file

The package.json file generated by npm should be updated to:


## The index.js file

The index.js file generated by npm should be updated to:


## The Dockerfile

Visual Studio Code is able to add a Dockerfile to a Node.js project automagically.

Open the Command Palette (⇧⌘P) and use the "Docker: Add Docker Files to Workspace..." command:

FROM node:12.18-alpine

ENV NODE_ENV=production

WORKDIR /usr/src/app

COPY ["package.json", "package-lock.json*", "npm-shrinkwrap.json*", "./"]

RUN npm install --production --silent && mv node_modules ../

COPY . .

EXPOSE 5000

CMD ["npm", "start"]

![](/assets/images/restapiservice/screen-shot-2021-02-08-at-7.35.17-am-1900x1360.png)
*REST API Service*

![](/assets/images/restapiservice/screen-shot-2021-02-07-at-11.07.59-am-1626x1210.png)
*/books route*

![](/assets/images/restapiservice/screen-shot-2021-02-07-at-11.13.06-am-1628x1205.png)
*/books/id route with a valid id*

![](/assets/images/restapiservice/screen-shot-2021-02-07-at-11.09.17-am-1632x1210.png)
*/books/id with an invalid id*


## Example route handlers

```javascript
app.get('/books', (request, response) => {
    response.json(books);
});

app.get('/books/:id', (request, response) => {
    const isbnId = Number(request.params.id);
    const found = books.find((book) => book.id === isbnId);

    if (!found) {
        response.status(404).send('Book Not Found');
    } else {
        response.json(found);
    }
});
```

## package.json

```javascript
{
  "name": "books",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node index.js"
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "express": "^4.17.1"
  }
}
```

## index.js

```javascript
const express = require('express');
const app = express();
let books = [
    {
        "id": 1788395549,
        "title": "Learning Node.js Development",
    },
    {
        "id": 1788620216,
        "title": "Hands-On Microservices with Node.js",
    }
];

app.get('/books', (request, response) => {
    response.json(books);
});

app.get('/books/:id', (request, response) => {
    const isbnId = Number(request.params.id);
    const found = books.find((book) => book.id === isbnId);

    if (!found) {
        response.status(404).send('Book Not Found');
    } else {
        response.json(found);
    }
});


app.listen(5000, () => console.log('server running'));
```

---

## rewardsextension

**Source file:** `rewardsextension.md`

---
title: "Rewards Extension"
description: "Rewards Extension"
date: "2023-08-30"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "rewardsextension"
image: "/assets/images/dynamics365-color.svg"
---



The Microsoft Dynamics 365 Business Central Extension described here allows users to create a list of "Rewards" and to associate rewards with Business Central Customers.

![](/assets/images/rewardsextension/20230830image1-1021x770.png)
*I added the idRange needed for the Rewards extension*


## Rewards table

I created a Rewards.al file. In the Rewards.al file I added code to created a Business Central "Reward" table, a Business Central "Reward Card" page and a Business Central "Reward List" page.

![](/assets/images/rewardsextension/20230830image2-1443x1068.png)
*I navigated to http://bcserver/BC/?tenant=default&page=50102 to view the Reward table using the Reward List page*

![](/assets/images/rewardsextension/20230830image3-1288x520.png)
*I added a Reward item*

![](/assets/images/rewardsextension/20230830image4-1287x523.png)
*The reward item has been stored in the Reward Table*

![](/assets/images/rewardsextension/20230830image10-1415x1024.png)
*I added the Minimum Purchase field to the Reward List page*

![](/assets/images/rewardsextension/20230830image11-1416x1023.png)
*I added the Minimum Purchase field to the Reward Card page*

![](/assets/images/rewardsextension/20230830image15-1390x1038.png)
*I added a Customer Ext (table extension) and a Customer Card Ext (card extension) to associate a Reward value with an Business Central Customer*


## Documentation

I used [Meta's codellama language model](LMStudio.html) to create the AL code documentation.

![](/assets/images/rewardsextension/screenshot-2023-08-30-at-1.28.36-pm-1466x1340.png)
*LM Studio code llama instruct 7B*


## code llama instruct 7B

**Please explain this Business Central AL code**

This code creates a new table called "Reward" with four fields: "Reward ID", "Description", "Discount Percentage", and "Minimum Purchase". The "Reward ID" field is the primary key of the table. The "Description" field can contain a string with up to 250 characters, the "Discount Percentage" field is a Decimal numeric value that represents the discount that will be applied for this reward, and the "Minimum Purchase" field is also a Decimal numeric value that represents the minimum purchase amount required to qualify for this reward.

The code also creates two pages: "Reward Card" and "Reward List". The "Reward Card" page is of type "Card" and will render as a card, while the "Reward List" page is of type "List" and will render as a list. The source table for both pages is the "Reward" table.

The "Reward Card" page has a layout that includes a group called "Reward" with four fields: "Reward ID", "Description", "Discount Percentage", and "Minimum Purchase". The "Reward ID" field is a text box that displays the value of the "Reward ID" field from the "Reward" table, while the other three fields are also text boxes that display the corresponding values.

The "Reward List" page has a layout that includes a repeater called "Rewards". The repeater contains four fields: "Reward ID", "Description", "Minimum Purchase", and "Discount Percentage". Each record in the "Reward" table will be displayed as a separate row in the list.

The code also includes a table extension called "Customer Ext" that extends the "Customer" table with an additional field called "Reward ID". The "Reward ID" field is set to have a table relation to the "Reward ID" field in the "Reward" table, and it is also set to validate the table relationship.

Finally, the code includes a page extension called "Customer Card Ext" that extends the "Customer Card" page with an additional text box called "Reward ID". The "Reward ID" text box displays the value of the "Reward ID" field from the "Customer" table and allows users to select a reward from a lookup window. The "Rewards" action is also added to the Navigation group, which will run the "Reward List" page when activated.


## Rewards.al

```text
table 50100 Reward
{
    DataClassification = ToBeClassified;


    fields
    {
        // The "Reward ID" field represents the unique identifier
        // of the reward and can contain up to 30 Code characters.
        field(1; "Reward ID"; Code[30])
        {
            DataClassification = ToBeClassified;
        }


        // The "Description" field can contain a string
        // with up to 250 characters.
        field(2; Description; Text[250])
        {
            // This property specified that
            // this field cannot be left empty.
            NotBlank = true;
        }


        // The "Discount Percentage" field is a Decimal numeric value
        // that represents the discount that will
        // be applied for this reward.
        field(3; "Discount Percentage"; Decimal)
        {
            // The "MinValue" property sets the minimum value for the "Discount Percentage"
            // field.
            MinValue = 0;


            // The "MaxValue" property sets the maximum value for the "Discount Percentage"
            // field.
            MaxValue = 100;


            // The "DecimalPlaces" property is set to 2 to display discount values with  
            // exactly 2 decimals.
            DecimalPlaces = 2;
        }
    }


    keys
    {
        // The field "Reward ID" is used as the primary key of this table.
        key(PK; "Reward ID")
        {
            // Create a clustered index from this key.
            Clustered = true;
        }
    }
}


page 50101 "Reward Card"
{
    // The page will be of type "Card" and will render as a card.
    PageType = Card;


    // The page will be part of the "Tasks" group of search results.
    UsageCategory = Tasks;


    // The source table shows data from the "Reward" table.
    SourceTable = Reward;


    // The layout describes the visual parts on the page.
    layout
    {
        area(content)
        {
            group(Reward)
            {
                field("Reward Id"; Rec."Reward ID")
                {
                    // ApplicationArea sets the application area that
                    // applies to the page field and action controls.
                    // Setting the property to All means that the control
                    // will always appear in the user interface.
                    ApplicationArea = All;
                }


                field(Description; Rec.Description)
                {
                    ApplicationArea = All;
                }


                field("Discount Percentage"; Rec."Discount Percentage")
                {
                    ApplicationArea = All;
                }
            }
        }
    }
}


page 50102 "Reward List"
{
    // Specify that this page will be a list page.
    PageType = List;


    // The page will be part of the "Lists" group of search results.
    UsageCategory = Lists;


    // The data of this page is taken from the "Reward" table.
    SourceTable = Reward;


    // The "CardPageId" is set to the Reward Card previously created.
    // This will allow users to open records from the list in the "Reward Card" page.
    CardPageId = "Reward Card";


    layout
    {
        area(content)
        {
            repeater(Rewards)
            {
                field("Reward ID"; Rec."Reward ID")
                {
                    ApplicationArea = All;
                    ToolTip = 'Specifies the level of reward that the customer has at this point.';
                }


                field(Description; Rec.Description)
                {
                    ApplicationArea = All;
                }


                field("Discount Percentage"; Rec."Discount Percentage")
                {
                    ApplicationArea = All;
                }
            }
        }
    }
}
```

## Rewards.al updated

```text
table 50100 Reward
{
    DataClassification = ToBeClassified;


    fields
    {
        // The "Reward ID" field represents the unique identifier
        // of the reward and can contain up to 30 Code characters.
        field(1; "Reward ID"; Code[30])
        {
            DataClassification = ToBeClassified;
        }


        // The "Description" field can contain a string
        // with up to 250 characters.
        field(2; Description; Text[250])
        {
            // This property specified that
            // this field cannot be left empty.
            NotBlank = true;
        }


        // The "Discount Percentage" field is a Decimal numeric value
        // that represents the discount that will
        // be applied for this reward.
        field(3; "Discount Percentage"; Decimal)
        {
            // The "MinValue" property sets the minimum value for the "Discount Percentage"
            // field.
            MinValue = 0;


            // The "MaxValue" property sets the maximum value for the "Discount Percentage"
            // field.
            MaxValue = 100;


            // The "DecimalPlaces" property is set to 2 to display discount values with  
            // exactly 2 decimals.
            DecimalPlaces = 2;
        }


        field(4; "Minimum Purchase"; Decimal)
        {
            MinValue = 0;
            DecimalPlaces = 2;
        }


    }


    keys
    {
        // The field "Reward ID" is used as the primary key of this table.
        key(PK; "Reward ID")
        {
            // Create a clustered index from this key.
            Clustered = true;
        }
    }
}


page 50101 "Reward Card"
{
    // The page will be of type "Card" and will render as a card.
    PageType = Card;


    // The page will be part of the "Tasks" group of search results.
    UsageCategory = Tasks;


    // The source table shows data from the "Reward" table.
    SourceTable = Reward;


    // The layout describes the visual parts on the page.
    layout
    {
        area(content)
        {
            group(Reward)
            {
                field("Reward Id"; Rec."Reward ID")
                {
                    // ApplicationArea sets the application area that
                    // applies to the page field and action controls.
                    // Setting the property to All means that the control
                    // will always appear in the user interface.
                    ApplicationArea = All;
                }


                field(Description; Rec.Description)
                {
                    ApplicationArea = All;
                }


                field("Minimum Purchase"; Rec."Minimum Purchase")
                {
                    ApplicationArea = All;
                }


                field("Discount Percentage"; Rec."Discount Percentage")
                {
                    ApplicationArea = All;
                }
            }
        }
    }
}


page 50102 "Reward List"
{
    // Specify that this page will be a list page.
    PageType = List;


    // The page will be part of the "Lists" group of search results.
    UsageCategory = Lists;


    // The data of this page is taken from the "Reward" table.
    SourceTable = Reward;


    // The "CardPageId" is set to the Reward Card previously created.
    // This will allow users to open records from the list in the "Reward Card" page.
    CardPageId = "Reward Card";


    layout
    {
        area(content)
        {
            repeater(Rewards)
            {
                field("Reward ID"; Rec."Reward ID")
                {
                    ApplicationArea = All;
                    ToolTip = 'Specifies the level of reward that the customer has at this point.';
                }


                field(Description; Rec.Description)
                {
                    ApplicationArea = All;
                }


                field("Minimum Purchase"; Rec."Minimum Purchase")
                {
                    ApplicationArea = All;
                }


                field("Discount Percentage"; Rec."Discount Percentage")
                {
                    ApplicationArea = All;
                }
            }
        }
    }
}


tableextension 50103 "Customer Ext" extends Customer
{
    fields
    {
        field(50100; "Reward ID"; Code[30])
        {
            // Set links to the "Reward ID" from the Reward table.
            TableRelation = Reward."Reward ID";


            // Set whether to validate a table relationship.
            ValidateTableRelation = true;


            // "OnValidate" trigger executes when data is entered in a field.
            trigger OnValidate();
            begin


                // If the "Reward ID" changed and the new record is blocked, an error is thrown.
                if (Rec."Reward ID" <> xRec."Reward ID") and
                    (Rec.Blocked <> Blocked::" ") then begin
                    Error('Cannot update the rewards status of a blocked customer.')
                end;
            end;
        }
    }
}


pageextension 50104 "Customer Card Ext" extends "Customer Card"
{
    layout
    {
        // The "addlast" construct adds the field control as the last control in the General
        // group.
        addlast(General)
        {
            field("Reward ID"; Rec."Reward ID")
            {
                ApplicationArea = All;


                // Lookup property is used to provide a lookup window for
                // a text box. It is set to true, because a lookup for
                // the field is needed.
                Lookup = true;
            }
        }
    }


    actions
    {
        // The "addfirst" construct will add the action as the first action
        // in the Navigation group.
        addfirst(Navigation)
        {
            action("Rewards")
            {
                ApplicationArea = All;


                // "RunObject" sets the "Reward List" page as the object
                // that will run when the action is activated.
                RunObject = page "Reward List";
            }
        }
    }
}
```

---

## sails1

**Source file:** `sails1.md`

---
title: "Sails (Part 1)"
description: "Azure DevOps and Sails."
date: "2021-10-12"
categories: ["DevOps","JavaScript","Azure","AI"]
tags: []
slug: "sails1"
image: "/assets/images/sailsjs-logo-515x193.png"
---



Sails.js (or Sails) is a web framework that makes it easy to build custom, enterprise-grade Node.js apps. 

It is designed to resemble the MVC architecture from frameworks like Ruby on Rails.

The Azure DevOps Starter includes support for Sails.

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.31.09-am-1542x564.png)
*DevOps Starter*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.32.58-am-1536x888.png)
*Create DevOps starter*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.33.24-am-1540x930.png)
*Setting up Node.js web app with GitHub*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.34.00-am-1538x932.png)
*Select Sails.js and add a database*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.34.15-am-1540x936.png)
*Web App for Containers*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.34.32-am-1542x926.png)
*Connect to GitHub*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.35.27-am-1538x932.png)
*Web App, Container Registry and Database settings*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.35.41-am-1544x928.png)
*Review and Create*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.36.12-am-1542x930.png)
*Deployment in progress*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.36.33-am-1536x926.png)
*Deployment is complete*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.37.23-am-1536x1302.png)
*GitHub action is running*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.37.55-am-1538x1306.png)
*Authorise*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.38.26-am-1542x1308.png)
*Build and push Application to Container Repository*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.44.51-am-1532x1310.png)
*Run functional tests (Connect to web site using Selenium and check site title)*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.45.40-am-1534x1306.png)
*set up test environment and run tests*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.48.29-am-1540x1306.png)
*GitHub action/job complete*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.49.43-am-1666x1112.png)
*web site has been published*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.50.04-am-1676x956.png)
*Open GitHub repository using GitHub Desktop*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.50.55-am-1016x628.png)
*Clone*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.51.13-am-1034x232.png)
*Open in Visual Studio Code*

![](/assets/images/sails1/screen-shot-2021-10-12-at-10.53.50-am-1836x1317.png)
*Sample Functional Tests*


## local development environment

Open Visual Studio Code terminal

Navigate to the Application folder

```bash
% cd Application
```


Start the application on the laptop

```bash
% sails lift
```


![](/assets/images/sails1/screen-shot-2021-10-12-at-11.12.33-am-1836x1046.png)
*sails lift*

![](/assets/images/sails1/screen-shot-2021-10-12-at-11.13.15-am-1664x1110.png)
*http://localhost:1337*


## Testing testing

Updating the default page title (in the layout file) results in a failed test.

![](/assets/images/sails1/screen-shot-2021-10-12-at-1.11.49-pm-1836x622.png)
*Updating the web page title (without updating the web page title test)*

![](/assets/images/sails1/screen-shot-2021-10-12-at-1.18.38-pm-1836x1033.png)
*pushing update*

![](/assets/images/sails1/screen-shot-2021-10-12-at-1.32.31-pm-1836x1036.png)
*code is deployed and functional test fails (as expected)*
## References

- [Sails Hosting](https://sailsjs.com/documentation/concepts/deployment/hosting)

---

## sails2

**Source file:** `sails2.md`

---
title: "Sails (Part 2)"
description: "Sails and the Azure Cosmos DB API for MongoDB"
date: "2021-10-12"
categories: ["Azure",".NET","AI"]
tags: []
slug: "sails2"
image: "/assets/images/sailsjs-logo-515x193.png"
---


## Articles api

```bash
% sails generate api articles
```


![](/assets/images/sails2/screen-shot-2021-10-12-at-1.43.22-pm-1836x1048.png)
*generate api articles*


## Blueprint API

Once the articles api has been created I can use the Blueprint API to create article items.

On the laptop I navigate to http://localhost:1337/articles.

![](/assets/images/sails2/screen-shot-2021-10-12-at-1.57.37-pm-1564x272.png)
*/articles*

![](/assets/images/sails2/screen-shot-2021-10-12-at-2.03.46-pm-1836x347.png)
*/articles/Create?title=<title>&body=<body>*


## Push to GitHub

The new code is published to https://haddley-sails.azurewebsites.net after it is pushed to the GitHub repository.

![](/assets/images/sails2/screen-shot-2021-10-12-at-2.13.20-pm-1836x1036.png)
*Push to GitHub*

![](/assets/images/sails2/screen-shot-2021-10-12-at-2.13.32-pm-1836x1037.png)
*GitHub action in progress*

![](/assets/images/sails2/screen-shot-2021-10-12-at-6.25.29-pm-1836x1032.png)
*GitHub action completed*


## Creating and Destroying items

Once the articles model update has been published to Azure I can use the Blueprint API to create and to remove (destroy) article items.

I navigate to https://haddley-sails.azurewebsites.net/articles.

![](/assets/images/sails2/screen-shot-2021-10-12-at-6.29.01-pm-1836x627.png)
*/articles/Create?...*

![](/assets/images/sails2/screen-shot-2021-10-12-at-6.39.02-pm-1836x630.png)
*/articles/Destroy?...*

![](/assets/images/sails2/screen-shot-2021-10-12-at-6.39.24-pm-1836x633.png)
*/articles*


## Azure Cosmos DB API for MongoDB

In the screenshots above I have been using local disk storage and the sails-disk adapter.

Below I update the application to use the Azure Cosmos DB for MongoDB.

![](/assets/images/sails2/screen-shot-2021-10-12-at-7.13.43-pm-1836x1024.png)
*Overview*

![](/assets/images/sails2/screen-shot-2021-10-12-at-7.50.49-pm-1836x1161.png)
*updated connections.js*

![](/assets/images/sails2/screen-shot-2021-10-12-at-7.58.40-pm-1836x695.png)
*updated model*

![](/assets/images/sails2/screen-shot-2021-10-12-at-7.56.29-pm-1836x634.png)
*/articles*

![](/assets/images/sails2/screen-shot-2021-10-12-at-7.51.20-pm-1836x1071.png)
*Data Explorer*

![](/assets/images/sails2/screen-shot-2021-10-12-at-8.00.37-pm-1228x264.png)
*Push changes to GitHub*

![](/assets/images/sails2/screen-shot-2021-10-12-at-8.38.22-pm-1836x998.png)
*GitHub action in progress*

![](/assets/images/sails2/screen-shot-2021-10-12-at-8.39.28-pm-1836x633.png)
*https://haddley-sails.azurewebsites.net/articles connected to Azure Cosmos DB for MongoDB*
## References

- [Build a Sails.js App](https://www.youtube.com/watch?v=AmjiDC_JUt4)

---

## sails3

**Source file:** `sails3.md`

---
title: "Sails (Part 3)"
description: "Sails and the Amazon Elastic Kubernetes Service"
date: "2021-10-13"
categories: ["DevOps","AWS","Azure","JavaScript"]
tags: []
slug: "sails3"
image: "/assets/images/sailsjs-logo-515x193.png"
---


## Dockerfile

Docker Container

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-3-56-13-pm-1020x542.png)
*Dockerfile*

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-3-56-32-pm-1020x542.png)
*Command Palette...*

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-3-56-40-pm-1380x733.png)
*Docker Image: Build Image...*

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-3-56-51-pm-1380x733.png)
*haddleysails:latest*


## Docker Desktop

Running the Docker image on a laptop.

![](/assets/images/sails3/images-list-10-14-2021-12-43-16-pm-1836x975.png)
*The haddleysails image is displayed in Docker Desktop*

![](/assets/images/sails3/images-list-10-14-2021-12-43-41-pm-1836x975.png)
*Running the image*

![](/assets/images/sails3/sails-application-google-chrome-10-14-2021-12-44-05-pm-1836x975.png)
*accessing the container using http://localhost*

![](/assets/images/sails3/sails-application-google-chrome-10-14-2021-12-44-16-pm-1836x975.png)
*using the container running locally to retrieve the articles data*

![](/assets/images/sails3/container-list-10-14-2021-12-44-44-pm-1836x975.png)
*remove the container*

![](/assets/images/sails3/container-list-10-14-2021-12-44-54-pm-1836x975.png)
*no containers running*


## Docker Desktop support for Kubernettes

Running Kubernettes pods on a laptop.

![](/assets/images/sails3/haddley-sails-local.yaml-haddley-sails-visual-studio-code-10-14-2021-12-45-48-pm-1836x1033.png)
*Using kubectl to run multiple copies of the Docker image*

![](/assets/images/sails3/container-list-10-14-2021-12-46-04-pm-1836x975.png)
*The Kubernettes pods running*

![](/assets/images/sails3/localhost-articles-google-chrome-10-14-2021-12-46-15-pm-1836x975.png)
*accessing the pods using http://localhost*

![](/assets/images/sails3/sails-application-google-chrome-10-14-2021-12-44-16-pm-1836x975.png)
*using the pods running locally to retrieve the articles data*

![](/assets/images/sails3/haddley-sails-local.yaml-haddley-sails-visual-studio-code-10-14-2021-12-46-56-pm-1836x1033.png)
*removing the application/pods*

![](/assets/images/sails3/container-list-10-14-2021-12-44-54-pm-1836x975.png)
*no pods/containers running*


## Amazon Container Services

The Docker image is pushed to the Amazon Elastic Container Registry

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-06-47-pm-1380x733.png)
*Create repository*

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-07-21-pm-1380x733.png)
*haddleysails*

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-07-30-pm-1380x733.png)
*Create repository*

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-07-39-pm-1380x733.png)
*haddleysails repository*

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-07-59-pm-1380x733.png)
*View push commands*

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-08-24-pm-1380x733.png)
*macOS / Linux commands*

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-08-33-pm-1380x733.png)
*Windows commands*

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-4-24-02-pm-1380x733.png)
*docker build -t haddleysails .*

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-4-26-07-pm-1380x733.png)
*build finished*

![](/assets/images/sails3/amazon-ecr-google-chrome-10-13-2021-4-26-15-pm-1380x733.png)
*commands*

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-4-26-41-pm-1380x733.png)
*docker tag ...*

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-4-27-04-pm-1380x733.png)
*docker push ...*


## eksctl

Using eksctl to create the Amazon Elastic Kubernetes Service cluster.

![](/assets/images/sails3/dockerfile-haddley-sails-visual-studio-code-10-13-2021-4-33-23-pm-1380x733.png)
*eksctl create cluster --name haddley-sails*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-4-36-18-pm-1380x733.png)
*no clusters*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-4-40-46-pm-1380x733.png)
*creating haddley-sails*

![](/assets/images/sails3/haddley-sails.yaml-haddley-sails-visual-studio-code-10-13-2021-7-04-51-pm-1380x733.png)
*The Amazon EKS cluster is ready*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-7-05-19-pm-1380x733.png)
*The haddley-sails cluster is active*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-7-05-28-pm-1380x733.png)
*Two nodes in the cluster*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-7-05-39-pm-1380x733.png)
*Workloads*


## kubectl

Using kubectl to deploy the application to the cluster

![](/assets/images/sails3/haddley-sails.yaml-haddley-sails-visual-studio-code-10-13-2021-7-06-28-pm-1380x733.png)
*kubectl apply -f haddley-sails.yaml*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-7-07-14-pm-1380x733.png)
*2 pods desired*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-7-07-35-pm-1380x733.png)
*2 pods ready*

![](/assets/images/sails3/amazon-eks-google-chrome-10-13-2021-7-07-56-pm-1380x733.png)
*Pods*

![](/assets/images/sails3/haddley-sails.yaml-haddley-sails-visual-studio-code-10-13-2021-7-10-12-pm-1380x733.png)
*external ip address*

![](/assets/images/sails3/sails-application-google-chrome-10-13-2021-7-10-44-pm-1380x733.png)
*home page*

![](/assets/images/sails3/sails-application-google-chrome-10-13-2021-7-11-43-pm-1380x733.png)
*Articles*


## Dockfile

```yaml
FROM node:8
LABEL maintainer="Azure App Service Container Images <appsvc-images@microsoft.com>"

# Create app directory
WORKDIR /app

# Bundle app source
COPY . .
RUN npm install

EXPOSE 1337
CMD [ "npm", "start" ]
```

## haddley-sails-local.yaml

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: haddley-sails-deployment
  labels:
    app: haddley-sails
spec:
  replicas: 2
  selector:
    matchLabels:
      app: haddley-sails
  template:
    metadata:
      labels:
        app: haddley-sails
    spec:
      containers:
        - name: haddley-sails
          image: haddleysails
          imagePullPolicy: Never
          ports:
            - containerPort: 1337
---
apiVersion: v1
kind: Service
metadata:
  name: haddley-sails-service
spec:
  selector:
    app: haddley-sails
  ports:
    - protocol: TCP
      port: 80
      targetPort: 1337
  type: LoadBalancer
```

## haddley-sails.yaml

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: haddley-sails-deployment
  labels:
    app: haddley-sails
spec:
  replicas: 2
  selector:
    matchLabels:
      app: haddley-sails
  template:
    metadata:
      labels:
        app: haddley-sails
    spec:
      containers:
        - name: haddley-sails
          image: haddleysails:latest
          ports:
            - containerPort: 1337
---
apiVersion: v1
kind: Service
metadata:
  name: haddley-sails-service
spec:
  selector:
    app: haddley-sails
  ports:
    - protocol: TCP
      port: 80
      targetPort: 1337
  type: LoadBalancer
```

---

## salesinvoice

**Source file:** `salesinvoice.md`

---
title: "Sales Invoice"
description: "How the Inventory, Sale, Tax and Receivables accounts are determined"
date: "2023-12-14"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "salesinvoice"
image: "/assets/images/posts-meta.svg"
---




The Inventory Posting Group RESALE (Item), General Product Posting Group RETAIL (Item), General Business Posting Group DOMESTIC (Customer), General Posting Setup {RETAIL, DOMESTIC}, Tax Setup and Customer Posting Group (Customer) are used to generate General Ledger entries for a Sales Invoice Document.

Here I demonstrate how the Inventory, Sale, Tax and Receivables accounts are determined.

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.00.04-pm-1836x936.png)
*In this Document we sell a RETAIL RESALE item to a DOMESTIC customer.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.01.02-pm-1836x938.png)
*Here are the entries that are generated from the Sales Invoice Document*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-12.23.00-pm-1836x937.png)
*The Item we are selling is a "RESALE" item. I clicked the Show details link.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-12.24.45-pm-1836x936.png)
*RESALE is an Inventory Posting Group. I clicked on the Setup button.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-12.26.21-pm-1836x935.png)
*When we sell a RESALE item we should use 14130 Finished Goods as the Inventory Account.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-12.35.57-pm-1836x937.png)
*The Item we are purchasing is a "RETAIL" item.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.27.06-pm-1836x932.png)
*The Customer we are selling to is a "DOMESTIC" customer.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.28.51-pm-1836x938.png)
*If we sell a RETAIL item to a DOMESTIC customer the 41040 Resale of Goods account should be used to record the sale*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.36.11-pm-1836x932.png)
*If we sell a RETAIL item to a DOMESTIC customer the 50110 Cost of Materials account should be used to record the cost of goods sold.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-12.31.36-pm-1836x929.png)
*I used search to navigate to the Tax Setup page*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.31.32-pm-1836x934.png)
*If we sell any item from any customer the 23200 Taxes Liable account should be used to record City, County and State tax.*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.32.39-pm-1836x932.png)
*The Customer is a "DOMESTIC" customer. I clicked the show details link*

![](/assets/images/salesinvoice/screenshot-2023-12-14-at-1.33.17-pm-1836x937.png)
*When we sell to a DOMESTIC customer should use the 15110 Accounts Receivable, Domestic as the Recievables Account*

---

## sentenceembeddings

**Source file:** `sentenceembeddings.md`

---
title: "Sentence Embeddings"
description: "Sentence Embeddings"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/sentenceembeddings/hero.png"
tags: ["ai","machine learning"]
hidden: true
slug: "sentenceembeddings"
---



**ChatGPT: What are Sentence Embeddings?**

Sentence embeddings are numerical representations of sentences that are created using various natural language processing techniques. These embeddings capture the semantic meaning and contextual information of a sentence in a dense vector form. The goal of sentence embeddings is to convert variable-length sentences into fixed-length numerical vectors, enabling efficient and meaningful comparisons between sentences in downstream tasks.

The process of generating sentence embeddings typically involves two main steps:

Pretrained Language Models: Sentence embeddings are often derived from pretrained language models, such as BERT (Bidirectional Encoder Representations from Transformers), GPT (Generative Pretrained Transformer), or RoBERTa (A Robustly Optimized BERT Pretraining Approach). These language models are trained on large-scale corpora and can understand the contextual relationships between words in a sentence.
Encoding Sentences: Once you have a pretrained language model, you can extract sentence embeddings by inputting the sentences into the model and capturing the output at a specific layer. In some cases, this can be the output of the [CLS] token (used in BERT), or the last hidden state of the sentence token, depending on the architecture.
The resulting sentence embeddings are dense numerical vectors with a fixed size. These vectors are capable of capturing the semantic meaning of the sentences and can be used as input for various tasks, such as text classification, semantic similarity comparison, sentiment analysis, machine translation, and information retrieval.

Advantages of Sentence Embeddings:

Fixed-length representation: Sentence embeddings provide a fixed-size representation of sentences, which is convenient for many machine learning algorithms that require a fixed number of input features.
Semantic similarity: Embeddings allow for measuring semantic similarity between sentences based on vector distance metrics like cosine similarity.
Contextual information: By using pretrained language models, sentence embeddings can capture the context and meaning of sentences more effectively.
Transfer learning: Since language models are pretrained on vast amounts of text, the knowledge encoded in the embeddings can be transferred to downstream tasks, even with limited task-specific training data.
Sentence embeddings have proven to be valuable in various natural language processing tasks, and they continue to be an active area of research in the field of deep learning and NLP.

**ChatGPT: How can we calculate Sentence Similarity given Sentence Embeddings?**

Calculating sentence similarity using sentence embeddings involves measuring the semantic similarity between two sentences based on their vector representations. Sentence embeddings are dense vector representations that capture the semantic meaning of sentences. Several methods can be used to calculate sentence similarity using these embeddings. Below, I'll outline one popular approach called the cosine similarity.


## HuggingFace documentation

**Sentence Similarity**

Sentence Similarity is the task of determining how similar two texts are. Sentence similarity models convert input texts into vectors (embeddings) that capture semantic information and calculate how close (similar) they are between them. This task is particularly useful for information retrieval and clustering/grouping

https://huggingface.co/tasks/sentence-similarity

[text-classification,token-classification,question-answering,fill-mask,summarization,translation,text2text-generation,text-generation,zero-shot-classification,automatic-speech-recognition,image-to-text,image-classification,image-segmentation,zero-shot-image-classification,object-detection,feature-extraction]

![](/assets/images/sentenceembeddings/screen-shot-2023-07-19-at-7.41.32-pm-1490x894.png)
*Similar*

![](/assets/images/sentenceembeddings/screen-shot-2023-07-19-at-7.42.03-pm-1482x894.png)
*Different*

![](/assets/images/sentenceembeddings/screen-shot-2023-07-19-at-7.42.29-pm-1488x894.png)
*Different*


## sentence_similarity.html

```text
<!DOCTYPE html>
<html>

<head>
    <title>Sentence Similarity Demo</title>
</head>

<body>
    <h1>Sentence Similarity Demo</h1>
    <textarea id="input-text-1" rows="4" cols="50" placeholder="Enter text to compare"></textarea>
    <textarea id="input-text-2" rows="4" cols="50" placeholder="Enter text to compare"></textarea>

    <button id="compare">Compare</button>
    <p id="score"></p>

    <script type="module">
        import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.4.1';

        const generateEmbeddings = await pipeline(
            'feature-extraction', 'xenova/all-MiniLM-L6-v2'
        )

        async function dotProduct(vec1, vec2) {
            let result = 0;
            for (let i = 0; i < vec1.length; i++) {
                result += vec1[i] * vec2[i];
            }
            return result;
        }

        async function compare() {

            const inputText1 = document.getElementById('input-text-1').value.trim();
            const inputText2 = document.getElementById('input-text-2').value.trim();

            if (inputText1 === '' || inputText2 === '') {
                alert('Please enter text to compare.');
                return;
            }

            const options = { pooling: 'mean', normalize: true };
            const output1 = await generateEmbeddings(inputText1, options);
            const output2 = await generateEmbeddings(inputText2, options);

            const embeddings1 = output1.data;
            console.log("embeddings1", embeddings1);

            const embeddings2 = output2.data;
            console.log("embeddings2", embeddings2);

            const similarity = await dotProduct(output1.data, output2.data);

            document.getElementById('score').textContent = `Score: ${similarity}`;

        }

        document.getElementById("compare").onclick = compare;

    </script>

</body>

</html>
```



---

## sentencesimilarity

**Source file:** `sentencesimilarity.md`

---
title: "Sentence Similarity"
description: "Sentence Similarity"
date: "2023-07-19"
categories: ["AI"]
tags: []
slug: "sentencesimilarity"
image: "/assets/images/chatgpt-logo.svg"
---




**ChatGPT What is Sentence Similarity?**

Sentence similarity refers to the measure of how similar or related two sentences are in terms of their meaning or semantic content. It is a natural language processing (NLP) concept used to quantify the likeness between sentences based on their semantic, syntactic, or contextual aspects. Sentence similarity is essential in various NLP tasks, such as information retrieval, paraphrase detection, text summarization, question answering, and machine translation.

![](/assets/images/sentencesimilarity/screen-shot-2023-07-19-at-7.41.32-pm-1490x894.png)
*Similar*

![](/assets/images/sentencesimilarity/screen-shot-2023-07-19-at-7.42.03-pm-1482x894.png)
*Not similar*

![](/assets/images/sentencesimilarity/screen-shot-2023-07-19-at-7.42.29-pm-1488x894.png)
*Not similar*


## sentence_similarity.html

```text
<!DOCTYPE html>
<html>

<head>
    <title>Sentence Similarity Demo</title>
</head>

<body>
    <h1>Sentence Similarity Demo</h1>
    <textarea id="input-text-1" rows="4" cols="50" placeholder="Enter text to compare"></textarea>
    <textarea id="input-text-2" rows="4" cols="50" placeholder="Enter text to compare"></textarea>

    <button id="compare">Compare</button>
    <p id="score"></p>

    <script type="module">
        import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.4.1';

        const generateEmbeddings = await pipeline(
            'feature-extraction', 'xenova/all-MiniLM-L6-v2'
        )

        async function dotProduct(vec1, vec2) {
            let result = 0;
            for (let i = 0; i < vec1.length; i++) {
                result += vec1[i] * vec2[i];
            }
            return result;
        }

        async function compare() {

            const inputText1 = document.getElementById('input-text-1').value.trim();
            const inputText2 = document.getElementById('input-text-2').value.trim();

            if (inputText1 === '' || inputText2 === '') {
                alert('Please enter text to compare.');
                return;
            }

            const options = { pooling: 'mean', normalize: true };
            const output1 = await generateEmbeddings(inputText1, options);
            const output2 = await generateEmbeddings(inputText2, options);

            const embeddings1 = output1.data;
            console.log("embeddings1", embeddings1);

            const embeddings2 = output2.data;
            console.log("embeddings2", embeddings2);

            const similarity = await dotProduct(output1.data, output2.data);

            document.getElementById('score').textContent = `Score: ${similarity}`;

        }

        document.getElementById("compare").onclick = compare;

    </script>

</body>

</html>
```
## References

- [$0 Embeddings (OpenAI vs. free &amp; open source)](https://www.youtube.com/watch?v=QdDoFfkVkcw)

---

## sentimentanalysis

**Source file:** `sentimentanalysis.md`

---
title: "Sentiment Analysis"
description: "Sentiment Analysis"
date: "2023-07-19"
categories: ["AI","JavaScript"]
tags: []
slug: "sentimentanalysis"
image: "/assets/images/chatgpt-logo.svg"
---


**ChatGPT What is Sentiment Analysis?
**
Sentiment analysis, also known as opinion mining, is a natural language processing (NLP) technique that involves determining the sentiment or emotional tone expressed in a piece of text. The main goal of sentiment analysis is to understand and categorize the subjective opinions, feelings, and attitudes of individuals towards a particular topic, product, service, or event.

The sentiment in the text can be categorized into several polarities, such as positive, negative, neutral, or even more nuanced emotions like happy, sad, angry, etc. Sentiment analysis is widely used in various applications and industries to gain insights into public opinions, customer feedback, social media monitoring, market research, and more.

There are different approaches to perform sentiment analysis, including:

1. Rule-based methods: These methods use predefined rules and linguistic patterns to determine the sentiment expressed in the text.

2. Machine learning: Machine learning techniques involve training a model on a labeled dataset containing text samples and their corresponding sentiment labels. The model learns to predict the sentiment of new, unseen text based on the patterns learned during training.

3. Lexicon-based approaches: Lexicon-based methods use sentiment lexicons or dictionaries containing words and their associated sentiment scores to calculate the overall sentiment of a piece of text.

4. Hybrid methods: Some sentiment analysis systems combine multiple approaches to achieve more accurate results, leveraging the strengths of different techniques.

Sentiment analysis has proven to be an invaluable tool for businesses to understand customer sentiment, for social media monitoring, for brand reputation management, and for making data-driven decisions based on public opinions and emotions. It continues to evolve and improve with advancements in natural language processing and machine learning technologies.

![](/assets/images/sentimentanalysis/screen-shot-2023-07-19-at-12.56.34-pm-1182x842.png)
*Certainly positive*

![](/assets/images/sentimentanalysis/screen-shot-2023-07-19-at-12.57.00-pm-1182x844.png)
*Certainly negative*

![](/assets/images/sentimentanalysis/screen-shot-2023-07-19-at-12.58.31-pm-1178x846.png)
*Not certain.*


## sentiment_analysis.html

```text
<!DOCTYPE html>
<html>

<head>
    <title>Sentiment Analysis Demo</title>
</head>

<body>
    <h1>Sentiment Analysis Demo</h1>
    <textarea id="input-text" rows="4" cols="50" placeholder="Enter text to analyze"></textarea>
    <button id="analyzeSentiment">Analyze</button>
    <p id="result"></p>
    <p id="score"></p>

    <script type="module">
        import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.4.1';

        async function analyzeSentiment() {

            const inputText = document.getElementById('input-text').value.trim();

            if (inputText === '') {
                alert('Please enter text to analyze.');
                return;
            }

            pipeline('sentiment-analysis').then(pipe => {
                pipe(inputText).then(result => {

                    // Display the sentiment result
                    document.getElementById('result').textContent = `Sentiment: ${result[0].label}`;
                    document.getElementById('score').textContent = `Score: ${result[0].score}`;
                });
            });
        }

        document.getElementById("analyzeSentiment").onclick = analyzeSentiment;

    </script>

</body>

</html>
```
## References

- [HuggingFace Transformers.js](https://huggingface.co/docs/transformers.js/index)

---

## sh1106

**Source file:** `sh1106.md`

---
title: "Raspberry Pi SH1106"
description: "OLED display"
date: "2023-07-24"
categories: ["Python","AI"]
tags: []
slug: "sh1106"
image: "/assets/images/raspberry-pi-logo.svg"
---


The Raspberry Pi can output text (and simple graphics) to an OLED display using Python.

![](/assets/images/sh1106/screen-shot-2023-07-24-at-8.12.44-am-660x528.png)
*OLED wiring*

![](/assets/images/sh1106/screen-shot-2023-07-24-at-8.23.25-am-1140x740.png)
*i2cdetect -y 1*


## Luma-OLED Driver

I installed the Luma-OLED driver by following these instructions:

 [https://luma-oled.readthedocs.io/en/latest/install.html](https://luma-oled.readthedocs.io/en/latest/install.html)

I installed the driver with this command

$ sudo -H pip3 install --upgrade luma.oled

I enabled I2C communications using the raspi-config application

$ sudo raspi-config

Interface Options | I2C | enable ARM I2C


## i2c permissions

I followed the steps described by [Alexander Rüedlinger](https://lexruee.ch/setting-i2c-permissions-for-non-root-users.html) to allow non-root users to access i2c devices (specifically the OLED display).

1) Create new user group called i2c:
**$ sudo groupadd i2c**

2) Change the group ownership of /dev/i2c-1 to i2c:
**$ sudo chown :i2c /dev/i2c-1**

3) Change the file permissions of the device /dev/i2c-1 so users of the i2c group can read and write to the device:
**$ sudo chmod g+rw /dev/i2c-1**

4) Add your user to the group i2c:
**$ sudo usermod -aG i2c <username>**

![](/assets/images/sh1106/screen-shot-2023-07-24-at-8.40.42-am-1140x744.png)
*Python code*

![](/assets/images/sh1106/img-3353-1836x1377.jpg)
*The hello.py code running on configured hardware*


## Displaying an image on the OLED display

I downloaded a stop sign image and updated the hello.py code to display the image on the OLED display.

![](/assets/images/sh1106/20230725-stop-sign-1836x1377.jpg)
*Stop sign*


## Using OpenCV and luma.oled to display video on the OLED display

OpenCV (Open Source Computer Vision Library) is an open-source computer vision and machine learning software library. It provides a comprehensive set of tools and functions that enable developers to perform various computer vision tasks, such as image and video processing, object detection, facial recognition, and feature extraction. 

I used the cv2 library to read frames from a dog video I downloaded from:
[https://pixabay.com/videos/puppy-dog-playful-beach-sand-play-4740/](https://pixabay.com/videos/puppy-dog-playful-beach-sand-play-4740/)

Then I updated the code to send image captured by the webcam to the OLED display.

![](/assets/images/sh1106/20230725-dog-video-1836x1377.jpg)
*Dog video*

![](/assets/images/sh1106/20230725-img-3391-1536x1152.jpg)
*Webcam*


## hello.py

```text
from luma.core.interface.serial import i2c, spi, pcf8574
from luma.core.interface.parallel import bitbang_6800
from luma.core.render import canvas
from luma.oled.device import ssd1306, ssd1309, ssd1325, ssd1331, sh1106, sh1107, ws0010
from time import sleep

# rev.1 users set port=0
# substitute spi(device=0, port=0) below if using that interface
# substitute bitbang_6800(RS=7, E=8, PINS=[25,24,23,27]) below if using that interface
serial = i2c(port=1, address=0x3C)

# substitute ssd1331(...) or sh1106(...) below if using that device
device = sh1106(serial)

with canvas(device) as draw:
    draw.rectangle(device.bounding_box, outline="white", fill="black")
    draw.text((30, 40), "Hello World", fill="white")

sleep(10)
```

## stop_sign_display.py

```text
from luma.core.interface.serial import i2c, spi, pcf8574
from luma.core.interface.parallel import bitbang_6800
from luma.core.render import canvas
from luma.oled.device import ssd1306, ssd1309, ssd1325, ssd1331, sh1106, sh1107
from time import sleep

from PIL import Image

serial = i2c(port=1, address=0x3C)
device = sh1106(serial)

width =  device.width
height = device.height

image = Image.open("stop.png")

image_r = image.resize((width,height), Image.LANCZOS)
# Image.BICUBIC is another option
image_bw = image_r.convert("1")

device.display(image_bw)

sleep(10)
```

## dog_display_window_and_oled.py

```text
from luma.core.interface.serial import i2c, spi, pcf8574
from luma.core.interface.parallel import bitbang_6800
from luma.core.render import canvas
from luma.oled.device import ssd1306, ssd1309, ssd1325, ssd1331, sh1106, sh1107

from time import sleep

import cv2

# OpenCV follows BGR color convention and PIL follows RGB color convention

# Python Imaging Library
from PIL import Image

serial = i2c(port=1, address=0x3C)
device = sh1106(serial)

width =  device.width
height = device.height

cap = cv2.VideoCapture("dog.mp4")
while True:
    ret, frame = cap.read()
    if not ret:
        break
    cv2.imshow("Img", frame)
    
    color_coverted = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
    pil_image = Image.fromarray(color_coverted)
    image_r = pil_image.resize((width,height), Image.LANCZOS) 
    # Image.BICUBIC is another option
    image_bw = image_r.convert("1")

    device.display(image_bw)

    key = cv2.waitKey(1)
    if key == 27:
        break
        
cap.release()
cv2.destroyAllWindows()
```

## webcam_display_window_and_oled.py

```text
...
cap = cv2.VideoCapture(0)
...
```
## References

- [SH1106 OLED Display on a Raspberry Pi 4](https://www.youtube.com/watch?v=LdOKXUDw2NY)
- [luma-oled documentation python usage](https://luma-oled.readthedocs.io/en/latest/python-usage.html)

---

## sharepoint2019

**Source file:** `sharepoint2019.md`

---
title: "SharePoint 2019"
description: "Azure Portal"
date: "2022-12-31"
categories: ["Microsoft 365","SQL","Azure"]
tags: []
slug: "sharepoint2019"
image: "/assets/images/1200px-microsoft-office-sharepoint-2018present.svg-1200x1172.png"
---


I logged into Azure Portal

I selected 'SharePoint Server 2019 Trial' in Marketplace

I added Active Directory role

I added SQL Server

I ran the SharePoint Configuration Wizard

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.29.53-pm-1836x1074.png)
*Azure Portal*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.30.34-pm-1836x435.png)
*I entered 'SharePoint' into search*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.31.05-pm-1836x721.png)
*I used 'see all' link to view the SharePoint related Marketplace items*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.31.23-pm-1836x627.png)
*I selected the 'SharePoint Server Trial' card*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.31.36-pm-1836x597.png)
*I selected the 'SharePoint Server 2019 Trial' item*


## Active Directory and SQL Server

The SharePoint Server 2019 Trial overview explains that: 

"You can set-up Active Directory and SQL Server required for your SharePoint farm by provisioning additional virtual machines".

In this case I wanted to install Active Directory, SQL Server and SharePoint on a single server.

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.32.31-pm-1836x972.png)
*I created a new Azure Resource Group 'sharepoint-rg'*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.33.08-pm-1836x967.png)
*I named the new virtual machine 'sharepoint-vm'*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.34.02-pm-1836x965.png)
*I specified an administrator user name 'sharepoint_admin'*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.34.55-pm-1836x965.png)
*I selected 'Review + Create'*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.35.12-pm-1836x972.png)
*I clicked Create*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.41.48-pm-1836x969.png)
*I navigated to the virtual machine and selected Connect*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.42.43-pm-1836x972.png)
*I selected 'Download RDP File' (Remote Desktop Protocol)*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.42.59-pm-1836x976.png)
*I opened the downloaded file with the Microsoft Remote Desktop application*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.43.38-pm-868x460.png)
*I provided the Administrator credentials*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.45.00-pm-1836x1149.png)
*SharePoint has been installed*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.47.38-pm-1836x1150.png)
*I clicked the 'Add roles and features' link*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.47.57-pm-1570x1120.png)
*I clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.48.12-pm-1566x1112.png)
*I left 'Role-based...' selected and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.48.25-pm-1570x1116.png)
*I selected the local server*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.48.51-pm-1576x1114.png)
*I selected the 'Active Directory Domain Services' option and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.49.11-pm-1566x1112.png)
*I reviewed the dependencies and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.49.52-pm-1564x1112.png)
*I reviewed the features that would be installed and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.50.03-pm-1572x1120.png)
*I reviewed the AD DS summary and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.50.14-pm-1570x1114.png)
*I clicked install*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.50.29-pm-1564x1110.png)
*I clicked close*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-2.50.54-pm-1836x327.png)
*I reviewed the install progress*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.09.11-pm-1836x325.png)
*A saw that a restart was required*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.09.26-pm-1284x444.png)
*I restarted the server*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.14.44-pm-1836x331.png)
*I needed to promote the server to a domain controlled*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.15.01-pm-1514x1110.png)
*I started the Active Directory Domain Services Configuration Wizard*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.15.34-pm-1512x1116.png)
*I selected new forest and entered a root domain name 'sharepoint.haddley.com'*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.16.31-pm-1512x1114.png)
*I provided a DSRM password*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.16.52-pm-1512x1110.png)
*I ignored the DNS warning*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.17.17-pm-1512x1116.png)
*I reviewed the suggested NetBIOS domain name 'SHAREPOINT' and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.17.37-pm-1518x1118.png)
*I reviewed the suggested folders and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.17.51-pm-1514x1114.png)
*I reviewed the summary and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.18.17-pm-1512x1112.png)
*I reviewed the warnings and clicked install*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.19.16-pm-1616x1112.png)
*The server restarted*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.20.45-pm-868x466.png)
*I logged into the virtual machine*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.42.51-pm-1386x996.png)
*I deselected the 'Google Update' services*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.44.35-pm-1836x1075.png)
*The were no errors in the Server Manager Dashboard*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.45.51-pm-1836x1341.png)
*I downloaded SQL Server Developer Edition from https://www.microsoft.com/en-us/sql-server/sql-server-downloads*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.46.10-pm-1684x1340.png)
*I installed SQL Server*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-3.58.19-pm-1684x1338.png)
*I installed the SSMS management application from https://aka.ms/ssmsfullsetup*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.07.11-pm-1372x1122.png)
*SSMS installed*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.07.25-pm-1836x956.png)
*I confirmed that the SQL Server command line application sqlcmd was working*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.08.12-pm-982x514.png)
*I started the SharePoint 2019 Products Configuration Wizard*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.08.38-pm-1230x1062.png)
*I clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.08.52-pm-1232x1060.png)
*I clicked Yes*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.09.05-pm-1226x1060.png)
*I selected 'Create a new farm' and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.10.47-pm-1230x1058.png)
*I entered the local server's name as the database server and provided the administrator's credentials*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.11.11-pm-1228x1068.png)
*I provided a passphrase*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.11.23-pm-1228x1062.png)
*I selected the Single-Server Farm option and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.11.37-pm-1236x1062.png)
*I accepted the suggested (random) administration site port number 9728*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.11.49-pm-1230x1058.png)
*I reviewed the settings and clicked next*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.11.59-pm-1234x1060.png)
*I waited for the wizard to run*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.25.34-pm-1226x1058.png)
*The configuration wizard finished*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.29.04-pm-1806x1188.png)
*I navigated to the Central Administration site*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.29.18-pm-1806x1178.png)
*I specified that all of the SharePoint Services should runas the same administrator account*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.29.52-pm-1802x1182.png)
*I waited*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.39.59-pm-1836x1349.png)
*I was able to access the Central Administration site*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.52.04-pm-1518x776.png)
*I created a 'Home' Site Collection*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.52.55-pm-1836x1325.png)
*I selected the 'Team Site' template*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-4.53.53-pm-1836x1321.png)
*I provided the administrator account name*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.35.17-pm-1836x1066.png)
*I was able to navigate to the Team Site*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.38.42-pm-872x758.png)
*I added Test 1 and Test 2 user accounts*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.39.17-pm-864x756.png)
*I provided a password*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.40.06-pm-1836x1062.png)
*I reviewed Team Site permissions*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.40.38-pm-1836x1071.png)
*I clicked the Share site button*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.40.53-pm-1836x1067.png)
*I shared the Team Site with the Test 1 and Test 2 users*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.41.16-pm-1836x1064.png)
*The Test 1 and Test 2 users are able to View and Edit items in the Team Site*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.41.44-pm-1836x919.png)
*The Site permission update was saved*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.44.16-pm-1836x771.png)
*I updated the virtual machine's public dns details*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.44.27-pm-1836x180.png)
*I saved the update*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.45.44-pm-1836x436.png)
*I navigated to the Team Site from my laptop using the dns address*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.46.08-pm-1836x452.png)
*I entered the administrator credentials*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.46.22-pm-1836x583.png)
*I was able to access the Team Site as the administrator*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.47.15-pm-1836x435.png)
*I switched to incognito mode and logged in as user Test 1*

![](/assets/images/sharepoint2019/screen-shot-2022-12-31-at-5.47.34-pm-1836x1073.png)
*I was able to access the Team Site as user Test 1*

![](/assets/images/sharepoint2019/screen-shot-2023-01-02-at-10.22.43-am-1836x1089.png)
*Cost analysis*
## References

- [SharePoint Server in Microsoft Azure](https://learn.microsoft.com/en-us/sharepoint/administration/sharepoint-server-in-microsoft-azure)

---

## sharepointsitedesignsandsitescripts

**Source file:** `sharepointsitedesignsandsitescripts.md`

---
title: "SharePoint site designs and site scripts"
description: "SharePoint users and administrators have long appreciated the opportunity to reuse SharePoint Site Templates."
date: "2021-02-15"
categories: ["Microsoft 365"]
tags: []
slug: "sharepointsitedesignsandsitescripts"
image: "/assets/images/1200px-microsoft-office-sharepoint-2018present.svg-1200x1172.png"
---


## Site scripts

Microsoft site scripts allow users and administrators to automate the provisioning of "similar" SharePoint sites.

Site scripts are JSON formatted files. 

Site scripts include "actions" that will modify a SharePoint site. 

Site script actions include:

Add Nav Link
**Apply Theme****Create Content Type****Create Site Column****Create SharePoint List****Install Solution****Join Hub Site****Remove Nav Link****Set Regional Settings****Set Site Branding****Set Site Logo****Set Site External Sharing Capability****Trigger Flow**


## The full schema can be downloaded from here

[https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json](https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json).


## Add-SPOSiteScript

Site scripts are added to a SharePoint tenant using the Add-SPOSiteScript command

![](/assets/images/sharepointsitedesignsandsitescripts/image-6-979x512.png)
*Connect to the SharePoint administration site*

![](/assets/images/sharepointsitedesignsandsitescripts/image-17-979x512.png)
*Load the JSON text into a variable*


## Add-SPOSiteDesign

Site designs can extend the SharePoint modern team site template(64) or the SharePoint modern communication site template (68).

Site designs are added to a SharePoint tenant using the ADD-SPOSiteDesign command (specifying one or more Site Script ids)

![](/assets/images/sharepointsitedesignsandsitescripts/image-10-979x512.png)
*Add the Site Script and add the Site Design*


## SharePoint Create a Site

Once the Site design has been created the out of the box "Create a Site" user experience will be updated

![](/assets/images/sharepointsitedesignsandsitescripts/image-11-1366x728.png)
*Select "Team Site" because the new Site Design is based on the team site template(64)*

![](/assets/images/sharepointsitedesignsandsitescripts/image-12-1366x728.png)
*The "Contoso customer tracking" Site Design is available in the "Choose a design" drop down list.*

![](/assets/images/sharepointsitedesignsandsitescripts/image-14-1366x728.png)
*Click the Finish button to create the new Site and to run the Site Scripts*

![](/assets/images/sharepointsitedesignsandsitescripts/image-16-1366x728.png)
*The newly created site includes the "Customer Tracking" list*


## Applying a site design to an existing site

The Get-SPOSiteDesign command can be used to list the installed Site designs (and the ids assigned).

Site designs can be applied to an existing SharePoint site using the Invoke-SPOSiteDesign command.

![](/assets/images/sharepointsitedesignsandsitescripts/image-20-1057x674.png)
*Site contents before invoking site design*

![](/assets/images/sharepointsitedesignsandsitescripts/image-19-979x512.png)
*Invoke-SPOSiteDesign*

![](/assets/images/sharepointsitedesignsandsitescripts/image-21-1057x674.png)
*Site contents after invoking site design*


## Get-SPOSiteScriptFromWeb

The Get-SPOSiteScriptFromWeb command extracts Site Script from an existing SharePoint site.

![](/assets/images/sharepointsitedesignsandsitescripts/image-22-979x512.png)
*Running the Get-SPOSiteScriptFromWeb command*


## Example site script

```javascript
{
     "$schema": "schema.json",
         "actions": [
             {
                 "verb": "createSPList",
                 "listName": "Customer Tracking",
                 "templateType": 100,
                 "subactions": [
                     {
                         "verb": "setDescription",
                         "description": "List of Customers and Orders"
                     },
                     {
                         "verb": "addSPField",
                         "fieldType": "Text",
                         "displayName": "Customer Name",
                         "isRequired": false,
                         "addToDefaultView": true
                     },
                     {
                         "verb": "addSPField",
                         "fieldType": "Number",
                         "displayName": "Requisition Total",
                         "addToDefaultView": true,
                         "isRequired": true
                     },
                     {
                         "verb": "addSPField",
                         "fieldType": "User",
                         "displayName": "Contact",
                         "addToDefaultView": true,
                         "isRequired": true
                     },
                     {
                         "verb": "addSPField",
                         "fieldType": "Note",
                         "displayName": "Meeting Notes",
                         "isRequired": false
                     }
                 ]
             }
         ],
             "bindata": { },
     "version": 1
}
```

## Get-SPOSiteScriptFromWeb results

```javascript
{
  "$schema": "https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json",
  "actions": [
    {
      "verb": "createSiteColumnXml",
      "schemaXml": "<Field ID=\"{c15b34c3-ce7d-490a-b133-3f4de8801b76}\" Name=\"TaskStatus\" Group=\"Core Task and Issue Columns\" Type=\"Choice\" DisplayName=\"Task Status\" SourceID=\"http://schemas.microsoft.com/sharepoint/v3/fields\" StaticName=\"TaskStatus\" DelayActivateTemplateBinding=\"GROUP,SPSPERS,SITEPAGEPUBLISHING\" Customization=\"\" AllowDeletion=\"TRUE\"><CHOICES><CHOICE>Not Started</CHOICE><CHOICE>In Progress</CHOICE><CHOICE>Completed</CHOICE><CHOICE>Deferred</CHOICE><CHOICE>Waiting on someone else</CHOICE></CHOICES><MAPPINGS><MAPPING Value=\"1\">Not Started</MAPPING><MAPPING Value=\"2\">In Progress</MAPPING><MAPPING Value=\"3\">Completed</MAPPING><MAPPING Value=\"4\">Deferred</MAPPING><MAPPING Value=\"5\">Waiting on someone else</MAPPING></MAPPINGS><Default>Not Started</Default></Field>",
      "pushChanges": true
    },
    {
      "verb": "createContentType",
      "name": "To Do Item",
      "id": "0x0100AC72E73DED8B1947B3AD265DD7CFCB4A",
      "description": "",
      "parentId": "0x01",
      "hidden": false,
      "group": "Custom Content Types",
      "subactions": [
        {
          "verb": "addSiteColumn",
          "internalName": "TaskStatus"
        }
      ]
    },
    {
      "verb": "createSPList",
      "listName": "To Do",
      "templateType": 100,
      "color": "2",
      "icon": "11",
      "subactions": [
        {
          "verb": "setDescription",
          "description": "To Do List"
        },
        {
          "verb": "addContentType",
          "name": "To Do Item"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field ID=\"{fa564e0f-0c70-4ab9-b863-0177e6ddd247}\" Type=\"Text\" Name=\"Title\" DisplayName=\"Title\" Required=\"TRUE\" SourceID=\"http://schemas.microsoft.com/sharepoint/v3\" StaticName=\"Title\" FromBaseType=\"TRUE\" MaxLength=\"255\" />"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field ID=\"{82642ec8-ef9b-478f-acf9-31f7d45fbc31}\" DisplayName=\"Title\" Description=\"\" Name=\"LinkTitle\" SourceID=\"http://schemas.microsoft.com/sharepoint/v3\" StaticName=\"LinkTitle\" Type=\"Computed\" ReadOnly=\"TRUE\" FromBaseType=\"TRUE\" Width=\"150\" DisplayNameSrcField=\"Title\" Sealed=\"FALSE\"><FieldRefs><FieldRef Name=\"Title\" /><FieldRef Name=\"LinkTitleNoMenu\" /><FieldRef Name=\"_EditMenuTableStart2\" /><FieldRef Name=\"_EditMenuTableEnd\" /></FieldRefs><DisplayPattern><FieldSwitch><Expr><GetVar Name=\"FreeForm\" /></Expr><Case Value=\"TRUE\"><Field Name=\"LinkTitleNoMenu\" /></Case><Default><HTML><![CDATA[<div class=\"ms-vb itx\" onmouseover=\"OnItem(this)\" CTXName=\"ctx]]></HTML><Field Name=\"_EditMenuTableStart2\" /><HTML><![CDATA[\">]]></HTML><Field Name=\"LinkTitleNoMenu\" /><HTML><![CDATA[</div>]]></HTML><HTML><![CDATA[<div class=\"s4-ctx\" onmouseover=\"OnChildItem(this.parentNode); return false;\">]]></HTML><HTML><![CDATA[<span>&nbsp;</span>]]></HTML><HTML><![CDATA[<a onfocus=\"OnChildItem(this.parentNode.parentNode); return false;\" onclick=\"PopMenuFromChevron(event); return false;\" href=\"javascript:;\" title=\"Open Menu\"></a>]]></HTML><HTML><![CDATA[<span>&nbsp;</span>]]></HTML><HTML><![CDATA[</div>]]></HTML></Default></FieldSwitch></DisplayPattern></Field>"
        },
        {
          "verb": "addSPView",
          "name": "All Items",
          "viewFields": [
            "LinkTitle",
            "TaskStatus"
          ],
          "query": "",
          "rowLimit": 30,
          "isPaged": true,
          "makeDefault": true,
          "replaceViewFields": true
        }
      ]
    }
  ]
}
```
## References

- [SharePoint site design and site script overview](https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/site-design-overview)

---

## sharepointwebpart1

**Source file:** `sharepointwebpart1.md`

---
title: "SharePoint Web Part (Part 1)"
description: "How to create and publish a SharePoint Web Part"
date: "2021-02-11"
categories: ["React","Microsoft 365","TypeScript"]
tags: []
slug: "sharepointwebpart1"
image: "/assets/images/1200px-microsoft-office-sharepoint-2018present.svg-1200x1172.png"
---



## SharePoint Web Parts Extend the Office 365 User Experience

Microsoft SharePoint, Microsoft Teams and Microsoft Outlook can be extended using the SharePoint Framework (SPFx). 

The SharePoint Framework is a page and web part model for client-side development.

The SharePoint Framework depends on TypeScript and front end libraries such as React.

Once a SharePoint Framework solution has been deployed users are able to add the new Web Parts to SharePoint Pages.

The Yeoman "yo" command can be used to create Web Part solutions.

![yo @microsof/sharepoint](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-10.38.21-am-1836x1378.png)
*yo @microsoft/sharepoint*


## Sample React Code

The React component code below is provided as a starting point.

![Web Part React Component](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-11.35.33-am-1836x1299.png)
*Web Part React Component*


## Local Workbench

A developer can test their Web Part by running "gulp serve".

When the gulp serve command is run their Web Parts are available in the local workbench.

![SharePoint Workbench](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-10.40.53-am-1764x1264.png)
*SharePoint Workbench*


## pageContext

A SharePoint Web Part can do interesting things if it has "context".

In this example the ICalendarProps interface is used to pass values from the CalendarWebPart instance to the Calendar React component. 

So we add a context property of type WebPartContext to the ICalendarProps interface and update the CalendarWebPart's render method to pass "this.context" from the CalendarWebPart instance to the Calendar component.

Running "gulp serve" again allows us to test the result in the "Local Workbench" or to test the result in a SharePoint site using the /_layouts/15/workbench.aspx page.

![](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-1.43.01-pm-1900x1342.png)
*Adding context:WebPartContext to ICalendarProps interface*

![](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-1.43.32-pm-1900x1343.png)
*Updating CalendarWebPart to pass context to Calendar React Component*

![](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-1.43.55-pm-1900x1346.png)
*Updating Calendar React Component to use context*

![](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-1.40.17-pm-1754x1266.png)
*Testing the Web Part using the Local Workbench*

![](/assets/images/sharepointwebpart1/screen-shot-2021-02-12-at-1.47.37-pm-1750x1260.png)
*Testing the Web Part using the /_layouts/15/workbench.aspx SharePoint page*


## TypeScript and React

The generated CalendarWebPart class extends the Microsoft BaseClientSideWebPart class.

The generated Calendar class extends the React.Component class.

The CalendarWebPart class manages state and the Calendar class has state passed to it via props.

Before doing additional work on the Calendar component we can reimplement the Calendar React component as a function component. 

Reimplementing the Calendar component as a function component makes the Calendar component code easier to read.

If the Calendar component needs to maintain state we can take advantage of [React useState and useEffect hooks](reactusestateuseeffect.html).

![React FunctionComponent](/assets/images/sharepointwebpart1/screen-shot-2021-02-13-at-10.10.01-am-1836x1299.png)
*Calendar component as a function component*

---

## sharepointwebpart2

**Source file:** `sharepointwebpart2.md`

---
title: "SharePoint Web Part (Part 2)"
description: "How to create and publish a SharePoint Web Part"
date: "2021-02-14"
categories: ["React","Microsoft 365","TypeScript"]
tags: []
slug: "sharepointwebpart2"
image: "/assets/images/1200px-microsoft-office-sharepoint-2018present.svg-1200x1172.png"
---



## Adding the big calendar

npm is the package manager for the Node JavaScript platform. 

The npmjs web site is a repository of reusable software components.

react-big-calendar is an events calendar  component built for React.

[https://www.npmjs.com/package/react-big-calendar](https://www.npmjs.com/package/react-big-calendar)

To add the react-big-calendar component to our SharePoint Web Part solution we run this command:

$ npm i react-big-calendar


## Update the Calendar Function Component

This is how to update the Web Part's Calendar Component to include react-big-calendar.

Notice that we are again using React's [useEffect and useState hooks](reactusestateuseeffect.html).


## Pnp react-calendar sample

SharePoint provides a [REST API](restapiservice.html).

The [pnp react-calendar sample project](https://github.com/pnp/sp-dev-fx-webparts/tree/master/samples/react-calendar) uses an "sp-services" class to hold all of the code needed to fetch Calendar list items from the SharePoint site via SharePoint's REST API.

We can use the same approach:


## workbench.aspx

The code above assumes that your SharePoint site has a Calendar list named "Calendar".

The Local Workbench used for Web Part testing does not have a Calendar list, so to test the Web Part we need to navigate to the workbench page in a SharePoint site that does have a Calendar list (eg. https://haddleyoffice365.sharepoint.com/sites/AllStaff/_layouts/15/workbench.aspx).

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-2.53.35-pm-1900x1357.png)
*Example Team Site Calendar with sample events*

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-2.56.27-pm-1900x1357.png)
*Calendar Web Part icon in /layouts/15/workbench.aspx page*

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-2.56.52-pm-1900x1213.png)
*Calendar Web Part running in /layouts/15/workbench.aspx page displaying sample events*


## Packaging and deploying

These commands can be used to create a .sppkg package

gulp clean
gulp bundle --ship
gulp package-solution --ship

The Web Part can then be deployed by copying the .sppkg package to the SharePoint tenant's app catalog site.

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-3.12.16-pm-1900x1209.png)
*Copying the .sppkg package to the SharePoint app catalog*

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-3.13.38-pm-1900x1213.png)
*Adding the Calendar Web Part to a Sharepoint page*

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-3.13.52-pm-1900x1215.png)
*An opportunity to set the Calendar Web Part properties*

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-3.14.12-pm-1900x1208.png)
*The Calendar Web Part running in the SharePoint page (in Month mode)*

![](/assets/images/sharepointwebpart2/screen-shot-2021-02-14-at-3.14.29-pm-1900x1213.png)
*The Calendar Web Part running in the SharePoint page (in Agenda mode)*

![](/assets/images/sharepointwebpart2/image0-1242x2208.png)
*The Calendar Web Part running in the iOS SharePoint app (in Month mode)*

![](/assets/images/sharepointwebpart2/image0-2-1242x2208.png)
*The Calendar Web Part running in the iOS SharePoint app (in Agenda mode)*


## Calendar.tsx

```typescript
import * as React from 'react';
import { ICalendarProps } from './ICalendarProps';
import { escape } from '@microsoft/sp-lodash-subset';
import { WebPartContext } from '@microsoft/sp-webpart-base';
import { FunctionComponent } from 'react';
import { Spinner, SpinnerSize } from 'office-ui-fabric-react';
import { useEffect, useState } from 'react';
import spservices from '../../../services/spservices';
import { Calendar as BigCalendar, momentLocalizer } from 'react-big-calendar';
import * as moment from 'moment';
import 'react-big-calendar/lib/css/react-big-calendar.css';

const Calendar: FunctionComponent<ICalendarProps> =
  ({ description, context }: { description: string, context: WebPartContext }) => {

    const [busy, setBusy] = useState(true)
    const [events, setEvents] = useState([])

    useEffect(() => {
      (async () => {
        await refreshEvents()
      })();
    }, [])

    const refreshEvents = async () => {
      try {
        setBusy(() => true);
        const spService = new spservices(context);
        const calendarEvents = await spService.getEvents();
        setEvents(() => calendarEvents);
        setBusy(() => false);
      }
      catch (error) {
        setBusy(() => false);
      }
    }

    const deleteEvent = async (id: number) => {
      try {
        const spService = new spservices(context);
        await spService.deleteEvent(id);
        const calendarEvents = await spService.getEvents();
        setEvents(() => calendarEvents);
      }
      catch (error) {
        setBusy(() => false);
      }
    }

    const localizer = momentLocalizer(moment)

    return (
      (busy)
        ? (
          <Spinner size={SpinnerSize.large} label="Loading..." />
        )
        : (
          <>
            <h1>{escape(description)}</h1>
            <BigCalendar
              defaultDate={moment().startOf('day').toDate()}
              localizer={localizer}
              events={events}
              views={{ day: true, week: true, month: true, agenda: true }}
              style={{ height: 500 }}
              components={{
                eventWrapper: ({ event, children }) => (
                  <div
                    onContextMenu={
                      e => {
                        alert(`Will delete ${event.title} (${event.id})!`);
                        deleteEvent(event.id);
                        e.preventDefault();
                      }
                    }
                  >
                    {children}
                  </div>
                )
              }}
            />
          </>
        )
    )
  }

export default Calendar
```

## sp-services.ts

```typescript
import { WebPartContext } from "@microsoft/sp-webpart-base";
import { sp } from '@pnp/sp';
import "@pnp/sp/webs";
import "@pnp/sp/lists";
import "@pnp/sp/items";
import "@pnp/sp/regional-settings";
import * as moment from 'moment';

export default class spservices {

    constructor(private context: WebPartContext) {
        sp.setup({
            spfxContext: this.context
        });
    }

    public async getLocalTime(date: string | Date): Promise<string> {
        try {
            const localTime = await sp.web.regionalSettings.timeZone.utcToLocalTime(date);
            return localTime;
        } catch (error) {
            return Promise.reject(error);
        }
    }

    public async getEvents(): Promise<any[]> {
        try {

            const items: any[] = await sp.web.lists.getByTitle("Calendar").items.get();

            const promises = items.map(event =>
                (async (item) => {

                    let start: Date
                    let end: Date

                    if (item.fAllDayEvent) {

                        // ignore timezone for all day events
                        start = new Date(item.EventDate.slice(0, -1))
                        end = new Date(item.EndDate.slice(0, -1))
                        

                    } else {

                        const start1 = await this.getLocalTime(item.EventDate)
                        start = new Date(start1)

                        const end1 = await this.getLocalTime(item.EndDate)
                        end = new Date(end1)

                    }

                    return ({
                        id: item.Id,
                        title:item.Title,
                        allDay: item.fAllDayEvent,
                        start: start,
                        end: end,
                    })

                })(event))

            return await (Promise.all(promises))

        } catch (error) {
            return Promise.reject(error)
        }
    }

    public async deleteEvent(id: number) {
        try {
            if (sp) {
                const list = sp.web.lists.getByTitle("Calendar");
                await list.items.getById(id).delete();
            }
        } catch (error) {
            return Promise.reject(error)
        }
    }

}
```
## References

- [SharePoint Framework web part, Teams tab, personal app, app page samples](https://github.com/pnp/sp-dev-fx-webparts)

---

## spring-boot-2

**Source file:** `spring-boot-2.md`

---
title: "Java Spring Boot (Part 2)"
description: "References"
date: "2023-10-26"
categories: ["Azure","Java","DevOps"]
tags: []
slug: "spring-boot-2"
image: "/assets/images/spring-framework-logo-70-no.svg"
---


I used [https://start.spring.io](https://start.spring.io), Visual Studio Code, GitHub and Microsoft Azure to generate an Spring application, to run the Spring application on my laptop and to deploy the Spring application to Microsoft Azure

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-9.55.59-am-1895x1185.png)
*I created a new GitHub repository (haddley-java)*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-9.56.35-am-1898x717.png)
*I clicked the Open with GitHub Desktop menu item*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-9.57.18-am-1604x710.png)
*I used the Open in Visual Studio Code (Insiders) button to open the repository in Visual Studio Code*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-9.57.51-am-1605x790.png)
*I needed some sample code*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-9.59.05-am-1899x896.png)
*https://spring.io/quickstart explains how to create a sample project*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.02.47-am-1898x693.png)
*I logged into the Azure Portal to see what versions of Java were supported*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.03.01-am-1897x508.png)
*I clicked the Web App Create link*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.03.26-am-1898x504.png)
*The latest version of Java supported was 17*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.37.23-am-1897x762.png)
*I navigated to https://start.spring.io/ and updated Group to "com.haddley" and added the Spring Web dependency*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.38.08-am-1895x891.png)
*I clicked the GENERATE button*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.42.36-am-1198x430.png)
*I copied the generated file to my local copy of the haddley-java repository*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.44.21-am-1609x793.png)
*I updated the code to include support for the /hello path and ran using ./mvnw spring-boot:run*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.44.49-am-1605x790.png)
*Tomcat initialized with port 8080*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.45.31-am-1895x154.png)
*I navigated to http://localhost:8080/hello*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.46.15-am-1604x709.png)
*I checked my changes*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.46.28-am-1605x710.png)
*I clicked Push origin to upload my changes to GitHub*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.46.43-am-1603x711.png)
*The changes were uploaded*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.48.44-am-1895x892.png)
*I added an Azure Resource Group (haddley-java-rg)*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.49.32-am-1897x894.png)
*I selected the Java 17 runtime*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.49.59-am-1895x894.png)
*I changed the Pricing plan to "Free" and clicked the Next: Deployment button*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.51.14-am-1897x462.png)
*The Continuous deployment option was disabled so I clicked the Previous button*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.51.33-am-1896x894.png)
*I selected the Basic B1 pricing plan*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.51.47-am-1894x891.png)
*I enabled Continuous deployment and clicked the Authorize button*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.52.06-am-1278x719.png)
*I clicked the Authorize AzureAppService button*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.52.20-am-1281x722.png)
*I entered an Authorization code*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.53.10-am-1898x894.png)
*I selected organization Haddley. I selected the haddley-java repository*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.53.31-am-1896x892.png)
*I selected the main branch*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.53.56-am-1895x894.png)
*I reviewed the GitHub Actions configuration*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.55.13-am-1896x891.png)
*I clicked the Create button*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.55.45-am-1896x891.png)
*I waited*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-10.59.45-am-1896x894.png)
*When deployment was complete I clicked the Go to resource button*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.00.03-am-1896x892.png)
*I reviewed the Web App overview and clicked on the https://haddley-java.azurewebsites.net link*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.00.34-am-1896x291.png)
*I reviewed the Azure deployed application*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.01.10-am-1894x500.png)
*I returned to the GitHub repository and reviewed the GitHub Actions workflow history*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.01.36-am-1896x892.png)
*I reviewed the workflow summary*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.03.13-am-1897x1208.png)
*I reviewed the workflow file*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.04.41-am-1602x791.png)
*I updated the source code adding a home page*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.05.06-am-1604x789.png)
*I ran the updated code locally*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.05.25-am-1895x173.png)
*I accessed the home page at http://localhost:8080*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.06.06-am-1604x708.png)
*I commited the update (to the main branch)*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.06.29-am-1609x709.png)
*I pulled changes from the GitHub repository*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.06.42-am-1607x709.png)
*I pushed my change to GitHub*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.06.53-am-1602x708.png)
*There were no conflicts/issues*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.07.15-am-1899x595.png)
*I returned to GitHub and saw that the Merge branch workflow had started*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.08.40-am-1898x1208.png)
*The Merge branch workflow completed with no errors*

![](/assets/images/spring-boot-2/screenshot-2023-10-26-at-11.09.30-am-1896x165.png)
*I navigated to https://haddley-java.azurewebsites.net to view the new home page*
- [How to deploy your Spring Boot app to Azure App Service with GitHub Actions](https://www.youtube.com/watch?v=CPsI1KnVSOM)

---

## spring-boot-3

**Source file:** `spring-boot-3.md`

---
title: "Java Spring Boot (Part 3)"
description: "SpringdatajpaApplication.java"
date: "2023-10-28"
categories: ["Java","Azure"]
tags: []
slug: "spring-boot-3"
image: "/assets/images/spring-framework-logo-70-no.svg"
---



Spring Data JPA provides a set of abstractions and high-level, repository-style interfaces that make it easier to work with Java Persistence API (JPA) for data access in Spring applications. It reduces boilerplate code.

I created a Spring Boot application using Spring Data JPA

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.03.24-am-1836x981.png)
*I created a new GitHub repository haddley-spring-data-jpa*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.04.03-am-1836x911.png)
*I opened the repository using GitHub Desktop*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.04.25-am-1836x956.png)
*I cloned the GitHib repository*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.04.49-am-1830x872.png)
*GitHub repository folder*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.40.07-am-1836x1176.png)
*I created a new spring boot application springdatajpa*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.16.13-am-1834x864.png)
*I copied the generated files to the GitHub repository folder*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.46.13-am-1836x1018.png)
*I updated SpringdatajpaApplication.java so that it would respond to http://localhost/hello requests*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.26.33-am-1836x213.png)
*I accessed http://localhost/hello using my web browser*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-10.52.00-am-1836x1031.png)
*I created a TodoItem Java class*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-11.10.46-am-1836x407.png)
*I created a Spring Data JPA repository interface (based on the TodoItem class)*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-11.17.11-am-1836x1010.png)
*I created a TodoItemDataLoader to ensure that if the repository was empty two new TodoItems would be added as the application started*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-12.21.33-pm-1836x1013.png)
*I updated SpringdatajpaApplication.java to return all of the TodoItems in response to http://localhost/hello requests*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-12.25.12-pm-1836x158.png)
*I accessed http://localhost/todos using my web browser*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-12.35.11-pm-1836x537.png)
*I added text to applications.properties*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-12.38.23-pm-1836x614.png)
*I accessed the h2 console (using values jdbc:h2:mem:testdb, sa and password)*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-12.38.56-pm-1836x1063.png)
*I clicked on the TODO_ITEM table*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-12.39.17-pm-1836x575.png)
*I clicked Run to execute the select query*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-1.16.08-pm-2136x1238.png)
*The haddley-spring-data-jpa application hosted in Azure*

![](/assets/images/spring-boot-3/screenshot-2023-10-29-at-1.16.29-pm-2136x418.png)
*Accessing the haddley-spring-data-jpa application hosted in Azure*


```text
package com.haddley.springdatajpa;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
@RestController
public class SpringdatajpaApplication {
    public static void main(String[] args) {
        SpringApplication.run(SpringdatajpaApplication.class, args);
    }

    @GetMapping("/hello")
    public String hello(@RequestParam(value = "name", defaultValue = "World") String name) {
        return String.format("Hello %s!", name);
    }
}
```

## TodoItem.java

```text
package com.haddley.springdatajpa.models;

import java.time.Instant;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import jakarta.validation.constraints.NotBlank;

import lombok.Getter;
import lombok.Setter;

@Entity
@Table(name = "todo_item")
public class TodoItem {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Getter
    @Setter
    private Long id;

    @Getter
    @Setter
    @NotBlank(message = "Description is required")
    private String description;

    @Getter
    @Setter
    private boolean complete;

    @Getter
    @Setter
    private Instant createdDate;

    @Getter
    @Setter
    private Instant modifiedDate;

    public TodoItem() {}

    public TodoItem(String description) {
        this.description = description;
        this.complete = false;
        this.createdDate = Instant.now();
        this.modifiedDate = Instant.now();
    }

    @Override
    public String toString() {
        return String.format("TodoItem{id=%d, description='%s', complete='%s', createdDate='%s', modifiedDate='%s'}", id, description, complete, createdDate, modifiedDate);
    }


}
```

## TodoItemRepository.java

```text
package com.haddley.springdatajpa.models;

import com.haddley.springdatajpa.models.TodoItem;
import org.springframework.data.repository.CrudRepository;

public interface TodoItemRepository extends CrudRepository {
}
```

## TodoItemDataLoader.java

```text
package com.haddley.springdatajpa.config;

import com.haddley.springdatajpa.models.TodoItem;
import com.haddley.springdatajpa.repositories.TodoItemRepository;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

@Component
public class TodoItemDataLoader implements CommandLineRunner {

    private final Logger logger = LoggerFactory.getLogger(TodoItemDataLoader.class);

    @Autowired
    TodoItemRepository todoItemRepository;

    @Override
    public void run(String... args) throws Exception {
        loadSeedData();
    }

    private void loadSeedData() {
        if (todoItemRepository.count() == 0) {
            TodoItem todoItem1 = new TodoItem("get the milk");
            TodoItem todoItem2 = new TodoItem("rake the leaves");

            todoItemRepository.save(todoItem1);
            todoItemRepository.save(todoItem2); 
        }

        logger.info("Number of TodoItems: {}", todoItemRepository.count());
    }

}
```

## SpringdatajpaApplication.java updated

```text
package com.haddley.springdatajpa;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import com.haddley.springdatajpa.models.TodoItem;
import com.haddley.springdatajpa.repositories.TodoItemRepository;
import org.springframework.beans.factory.annotation.Autowired;

import java.util.stream.StreamSupport;
import java.util.stream.Collectors;

@SpringBootApplication
@RestController
public class SpringdatajpaApplication {
    public static void main(String[] args) {
        SpringApplication.run(SpringdatajpaApplication.class, args);
    }

    @GetMapping("/hello")
    public String hello(@RequestParam(value = "name", defaultValue = "World") String name) {
        return String.format("Hello %s!", name);
    }

    @Autowired
    private TodoItemRepository todoItemRepository;

    @GetMapping("/todos")
    public String index() {

        Iterable todos = todoItemRepository.findAll();

        return StreamSupport.stream(todos.spliterator(), false)
            .map(TodoItem::toString) 
            .collect(Collectors.joining(", ")); 

    }

}
```

## application.properties

```text
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
```
## References

- [Spring Data JPA: What is it? And Why Should You Use It?](https://www.youtube.com/watch?v=x67yiTHxn00)
- [90 Minutes to a Complete Java Spring Boot TODO App](https://www.youtube.com/watch?v=Hvuij8SOW8Q)

---

## spring-boot-4

**Source file:** `spring-boot-4.md`

---
title: "Java Spring Boot (Part 4)"
description: "ModelAndView"
date: "2023-10-29"
categories: ["Java","AI"]
tags: []
slug: "spring-boot-4"
image: "/assets/images/spring-framework-logo-70-no.svg"
---


In Java Spring, ModelAndView is a class that represents both a model and a view for a web application. It is typically used in the context of Spring MVC (Model-View-Controller) to handle web requests and provide a way to pass data to a view template for rendering.

Using ModelAndView allows you to separate the model data and the view template, making your code more modular and following the MVC pattern, which is a common architectural pattern in web development. Note that in more recent versions of Spring, you can often return a Map or a POJO directly from a controller method, simplifying the code and eliminating the need for ModelAndView.

![](/assets/images/spring-boot-4/screenshot-2023-10-29-at-2.18.03-pm-2136x1056.png)
*I added thymeleaf, bootstrap and jquery as dependencies*

![](/assets/images/spring-boot-4/screenshot-2023-10-29-at-2.19.57-pm-2136x1053.png)
*I added a thymeleaf page (as an alternative to JSP)*

![](/assets/images/spring-boot-4/screenshot-2023-10-29-at-2.21.23-pm-2136x1055.png)
*I updated the controller to populate the fetch the todo items and to pass them and the current day of the week to the thymeleaf view.*

![](/assets/images/spring-boot-4/screenshot-2023-10-29-at-2.22.07-pm-2136x963.png)
*The new home page displays the todo items*

![](/assets/images/spring-boot-4/screenshot-2023-10-29-at-2.30.48-pm-2136x832.png)
*I updated the controller to handle a delete request*

![](/assets/images/spring-boot-4/screenshot-2023-10-29-at-2.31.38-pm-2136x874.png)
*I clicked the Delete button on the second todo item*

![](/assets/images/spring-boot-4/screenshot-2023-10-29-at-2.31.47-pm-2136x876.png)
*The second todo item has been deleted*


## pom.xml

```text
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>3.1.5</version>
		<relativePath/> <!-- lookup parent from repository -->
	</parent>
	<groupId>com.haddley</groupId>
	<artifactId>springdatajpa</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>springdatajpa</name>
	<description>Demo project for Spring Boot</description>
	<properties>
		<java.version>17</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-validation</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.projectlombok</groupId>
			<artifactId>lombok</artifactId>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-thymeleaf</artifactId>
		</dependency>

		<!-- https://mvnrepository.com/artifact/org.webjars/bootstrap -->
		<dependency>
			<groupId>org.webjars</groupId>
			<artifactId>bootstrap</artifactId>
			<version>3.4.1</version>
		</dependency>
		<!-- https://mvnrepository.com/artifact/org.webjars/jquery -->
		<dependency>
			<groupId>org.webjars</groupId>
			<artifactId>jquery</artifactId>
			<version>3.6.0</version>
		</dependency>

	</dependencies>

	<build>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<configuration>
					<excludes>
						<exclude>
							<groupId>org.projectlombok</groupId>
							<artifactId>lombok</artifactId>
						</exclude>
					</excludes>
				</configuration>
			</plugin>
		</plugins>
	</build>

</project>
```

## SpringdatajpaApplication.java

```text
package com.haddley.springdatajpa;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.stereotype.Controller;

import com.haddley.springdatajpa.models.TodoItem;
import com.haddley.springdatajpa.repositories.TodoItemRepository;
import org.springframework.beans.factory.annotation.Autowired;

import java.util.stream.StreamSupport;
import java.util.stream.Collectors;

import org.springframework.web.servlet.ModelAndView;
import org.springframework.ui.Model;
import java.time.ZoneId;
import java.time.Instant;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import org.springframework.web.bind.annotation.PathVariable;

@SpringBootApplication
@Controller
public class SpringdatajpaApplication {

    private final Logger logger = LoggerFactory.getLogger(SpringdatajpaApplication.class);

    public static void main(String[] args) {
      SpringApplication.run(SpringdatajpaApplication.class, args);
    }

    @Autowired
    private TodoItemRepository todoItemRepository;
    
    @GetMapping("/")
    public ModelAndView index() {
        logger.info("request to GET index");
        ModelAndView modelAndView = new ModelAndView("index");
        modelAndView.addObject("todoItems", todoItemRepository.findAll());
        modelAndView.addObject("today", Instant.now().atZone(ZoneId.systemDefault()).toLocalDate().getDayOfWeek());
        return modelAndView;
    }

    @GetMapping("/delete/{id}")
    public String deleteTodoItem(@PathVariable("id") long id, Model model) {
        TodoItem todoItem = todoItemRepository
        .findById(id)
        .orElseThrow(() -> new IllegalArgumentException("TodoItem id: " + id + " not found"));
    
        todoItemRepository.delete(todoItem);
        return "redirect:/";
    }


}
```
## References

- [Spring Web MVC | 05 | The Model object](https://www.youtube.com/watch?v=lHucuG4jyU0&list=PLdW9lrB9HDw23SG-j-iOlQFGvdM7xU1fR&index=5)

---

## spring-boot-5

**Source file:** `spring-boot-5.md`

---
title: "Java Spring Boot (Part 5)"
description: "Spring for GraphQL"
date: "2023-10-30"
categories: ["Java","React","SQL","AWS"]
tags: []
slug: "spring-boot-5"
image: "/assets/images/spring-framework-logo-70-no.svg"
---


Build GraphQL applications with Spring for [GraphQL](GraphQL.html) and GraphQL Java.

![](/assets/images/spring-boot-5/screenshot-2023-10-30-at-12.13.17-pm-1253x813.png)
*I created a new GitHub repository*

![](/assets/images/spring-boot-5/screenshot-2023-10-30-at-12.46.56-pm-1251x1056.png)
*I used spring initializr to create a new project*


## The finished project

I used http://localhost:8080/graphiql to demonstrate the finished code (in line with my [node GraphQL](GraphQL.html) implementation)

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.07.53-am-1432x1011.png)
*books*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.10.30-am-1433x515.png)
*author(id: 6)*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.17.34-am-1430x386.png)
*addAuthor*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.20.06-am-1433x540.png)
*addBook*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.22.12-am-1429x591.png)
*SELECT * FROM AUTHOR*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.22.36-am-1434x515.png)
*SELECT * FROM BOOK*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.23.00-am-1433x553.png)
*SELECT * FROM BOOK_AUTHORS*


## Implementation

Here are the Java implementation details

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.24.59-am-2136x1230.png)
*application.properties*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.29.07-am-2136x1231.png)
*SeedDataConfig.java*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.34.19-am-2136x1227.png)
*Author.js*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.43.31-am-2136x1231.png)
*Book.java*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.44.20-am-2136x883.png)
*AuthorRepository.java*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.45.39-am-2136x713.png)
*BookRepository.java*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.47.25-am-2136x923.png)
*schema.graphqls*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.49.44-am-2136x1182.png)
*AuthorController.java*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.52.27-am-2136x1175.png)
*BookController.java*

![](/assets/images/spring-boot-5/screenshot-2023-10-31-at-10.53.42-am-2136x1017.png)
*pom.xml*


## application.properties

```text
server.port=8080

logging.level.web=DEBUG
logging.level.sql=DEBUG
logging.level.com.example=DEBUG

# generate the hibernate entities
spring.jpa.generate-ddl=true

spring.graphql.graphiql.enabled=true

spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
```

## SeedDataConfig.java

```text
package com.haddley.haddleyspringgraphql.config;

import com.haddley.haddleyspringgraphql.models.Book;
import com.haddley.haddleyspringgraphql.models.Author;
import com.haddley.haddleyspringgraphql.repositories.BookRepository;
import com.haddley.haddleyspringgraphql.repositories.AuthorRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

import java.util.ArrayList;
import java.util.Arrays;

@Component
@RequiredArgsConstructor
public class SeedDataConfig implements CommandLineRunner {

    private final AuthorRepository authorRepository;
    private final BookRepository BookRepository;

    @Override
    public void run(String... args) throws Exception {


        if (authorRepository.count() == 0) {


                /* 
                const authors = [
                { id: 1, name: 'Samer Buna' },
                { id: 2, name: 'Robin Wieruch' },
                { id: 3, name: 'Nader Dabit' },
                { id: 4, name: 'Sebastian Grebe' },
                { id: 5, name: 'Eve Porcello' },
                { id: 6, name: 'Alex Banks' }
                ]
                */


            Author author1 = Author.builder()
                    .name("Samer Buna")
                    .build();

            author1 = authorRepository.save(author1);

            Author author2 = Author.builder()
                    .name("Robin Wieruch")
                    .build();

            author2 = authorRepository.save(author2);

            Author author3 = Author.builder()
                    .name("Nader Dabit")
                    .build();

            author3 = authorRepository.save(author3);

            Author author4 = Author.builder()
                    .name("Sebastian Grebe")
                    .build();

            author4 = authorRepository.save(author4);
            
            Author author5 = Author.builder()
                    .name("Eve Porcello")
                    .build();

            author5 = authorRepository.save(author5);

            Author author6 = Author.builder()
                    .name("Alex Banks")
                    .build();

            author6 = authorRepository.save(author6);

                /* 
                const books = [
                { id: 1, isbn10: '161729568X', name: 'GraphQL in Action', authorIds: [1] },
                { id: 2, isbn10: '1730853935', name: 'The Road to GraphQL: Your journey to master pragmatic GraphQL in JavaScript with React.js and Node.js', authorIds: [2] },
                { id: 3, isbn10: '1492059897', name: 'Full Stack Serverless: Modern Application Development with React, AWS, and GraphQL', authorIds: [3] },
                { id: 4, isbn10: '1789134528', name: 'Hands-On Full-Stack Web Development with GraphQL and React', authorIds: [4] },
                { id: 5, isbn10: '1492030716', name: 'Learning GraphQL: Declarative Data Fetching for Modern Web Apps', authorIds: [5, 6] },
                { id: 6, isbn10: '1492051721', name: 'Learning React: Modern Patterns for Developing React Apps', authorIds: [5, 6] },
                ]
                */

                Book book1 = Book.builder()
                    .isbn10("161729568X")
                    .name("GraphQL in Action")
                    .authors(new ArrayList<>(Arrays.asList(author1)))
                    .build();

                Book book2 = Book.builder()
                    .isbn10("1730853935")
                    .name("The Road to GraphQL: Your journey to master pragmatic GraphQL in JavaScript with React.js and Node.js")
                    .authors(new ArrayList<>(Arrays.asList(author2)))
                    .build();

                Book book3 = Book.builder()
                    .isbn10("1492059897")
                    .name("Full Stack Serverless: Modern Application Development with React, AWS, and GraphQL")
                    .authors(new ArrayList<>(Arrays.asList(author3)))
                    .build();

                Book book4 = Book.builder()
                    .isbn10("1789134528")
                    .name("Hands-On Full-Stack Web Development with GraphQL and React")
                    .authors(new ArrayList<>(Arrays.asList(author4)))
                    .build();

                Book book5 = Book.builder()
                    .isbn10("1492030716")
                    .name("Learning GraphQL: Declarative Data Fetching for Modern Web Apps")
                    .authors(new ArrayList<>(Arrays.asList(author5,author6)))
                    .build();

                Book book6 = Book.builder()
                    .isbn10("1492051721")
                    .name("Learning React: Modern Patterns for Developing React Apps")
                    .authors(new ArrayList<>(Arrays.asList(author5,author6)))
                    .build();

            BookRepository.save(book1);
            BookRepository.save(book2);
            BookRepository.save(book3);
            BookRepository.save(book4);
            BookRepository.save(book5);
            BookRepository.save(book6);

        }
    }

}
```

## Author.js

```text
package com.haddley.haddleyspringgraphql.models;

import jakarta.persistence.*;
import lombok.*;

import java.util.ArrayList;
import java.util.List;

@Entity
@Data
@ToString
@Builder
@AllArgsConstructor
@EqualsAndHashCode(exclude = "books")
public class Author {

    @Id
    @GeneratedValue
    Long id;

    String name;

    @ManyToMany(mappedBy = "authors", cascade = CascadeType.ALL)
    List<Book> books;

    public Author() {
        books = new ArrayList<>();
    }
}
```

## Book.java

```text
package com.haddley.haddleyspringgraphql.models;

import jakarta.persistence.*;
import lombok.*;

import java.util.ArrayList;
import java.util.List;

@Entity
@Data
@ToString
@Builder
@AllArgsConstructor
@EqualsAndHashCode(exclude = "authors")
public class Book {

    @Id
    @GeneratedValue
    Long id;

    String name;

    String isbn10;

    @ManyToMany(fetch = FetchType.LAZY)
    List<Author> authors;

    public Book() {
        authors = new ArrayList<>();
    }
}
```

## AuthorRepository.java

```text
package com.haddley.haddleyspringgraphql.repositories;

import com.haddley.haddleyspringgraphql.models.Author;
import org.springframework.data.jpa.repository.JpaRepository;

public interface AuthorRepository extends JpaRepository<Author, Long> {
}
```

## BookRepository.java

```text
package com.haddley.haddleyspringgraphql.repositories;

import com.haddley.haddleyspringgraphql.models.Book;
import org.springframework.data.jpa.repository.JpaRepository;

public interface BookRepository extends JpaRepository<Book, Long> {
}
```

## schema.graphqls

```text
type Query {
    books: [Book]
    book(id: ID!): Book
    authors: [Author]
    author(id: ID!): Author
}

type Mutation {
    deleteBook(id: ID!): Book
    addBook( isbn10: String!, name: String!, authorIds: [ID]!): Book
    addAuthor( name: String!): Author
}

type Author {
    id: ID!
    name: String!
    books: [Book]
}

type Book {
    id: ID!
    isbn10: String!
    name: String!
    authors: [Author]
}
```

## AuthorController.java

```text
package com.haddley.haddleyspringgraphql.controllers;

import com.haddley.haddleyspringgraphql.models.Author;
import com.haddley.haddleyspringgraphql.repositories.AuthorRepository;
import lombok.NonNull;
import lombok.RequiredArgsConstructor;
import org.springframework.graphql.data.method.annotation.Argument;
import org.springframework.graphql.data.method.annotation.MutationMapping;
import org.springframework.graphql.data.method.annotation.QueryMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.Optional;

@RestController
@RequestMapping("/api/authors")
@RequiredArgsConstructor
public class AuthorController {

    private final AuthorRepository authorRepository;

    @QueryMapping
    public Iterable<Author> authors() {
        return authorRepository.findAll();
    }

    @QueryMapping
    public Optional<Author> author(@Argument Long id) {
        return authorRepository.findById(id);
    }

    @MutationMapping
    public Author addAuthor(@NonNull @Argument String name) {
        Author author = Author.builder()
                        .name(name)
                        .build();

        authorRepository.save(author);

        return author;
    }
}
```

## BookController.java

```text
package com.haddley.haddleyspringgraphql.controllers;

import com.haddley.haddleyspringgraphql.models.Book;
import com.haddley.haddleyspringgraphql.models.Author;
import com.haddley.haddleyspringgraphql.repositories.BookRepository;
import com.haddley.haddleyspringgraphql.repositories.AuthorRepository;
import lombok.NonNull;
import lombok.RequiredArgsConstructor;
import org.springframework.graphql.data.method.annotation.Argument;
import org.springframework.graphql.data.method.annotation.MutationMapping;
import org.springframework.graphql.data.method.annotation.QueryMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;
import java.util.stream.Collectors;
import java.util.Optional;

@RestController
@RequestMapping("/api/books")
@RequiredArgsConstructor
public class BookController {

    private final AuthorRepository authorRepository;
    private final BookRepository bookRepository;

    @QueryMapping
    public Iterable<Book> books() {
        return bookRepository.findAll();
    }

    @QueryMapping
    public Optional<Book> book(@Argument Long id) {
        return bookRepository.findById(id);
    }

    @MutationMapping
    public Optional<Book> deleteBook(@Argument Long id) {
        Optional<Book> book = bookRepository.findById(id);
        book.ifPresent(b -> bookRepository.deleteById(id));
        return book;
    }

    @MutationMapping
    public Book addBook(@NonNull @Argument String isbn10, @NonNull @Argument String name, @NonNull @Argument List<Long> authorIds) {
        List<Author> authors = authorIds.stream()
                                        .map(authorRepository::findById)
                                        .flatMap(Optional::stream)
                                        .collect(Collectors.toList());

        Book book = Book.builder()
                        .isbn10(isbn10)
                        .name(name)
                        .authors(authors)
                        .build();

        bookRepository.save(book);

        return book;
    }
}
```

## pom.xml

```text
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>3.1.5</version>
		<relativePath/> <!-- lookup parent from repository -->
	</parent>
	<groupId>com.haddley</groupId>
	<artifactId>haddley-spring-graphql</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>haddley-spring-graphql</name>
	<description>Demo project for Spring Boot</description>
	<properties>
		<java.version>17</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-graphql</artifactId>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.projectlombok</groupId>
			<artifactId>lombok</artifactId>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-webflux</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.graphql</groupId>
			<artifactId>spring-graphql-test</artifactId>
			<scope>test</scope>
		</dependency>
	</dependencies>

	<build>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<configuration>
					<excludes>
						<exclude>
							<groupId>org.projectlombok</groupId>
							<artifactId>lombok</artifactId>
						</exclude>
					</excludes>
				</configuration>
			</plugin>
		</plugins>
	</build>

</project>
```
## References

- [Unleash the Power of GraphQL in Spring Boot](https://www.youtube.com/watch?v=8Hp-DMeqHAk&t=1717s)

---

## spring-boot-6

**Source file:** `spring-boot-6.md`

---
title: "Java Spring Boot (Part 6)"
description: "GitHub"
date: "2023-10-31"
categories: ["Java"]
tags: []
slug: "spring-boot-6"
image: "/assets/images/spring-framework-logo-70-no.svg"
---



OAuth2 authentication using Spring Security and GitHub.

![](/assets/images/spring-boot-6/screenshot-2023-11-01-at-1.43.58-pm-1433x943.png)
*I used spring initializr to create a new project with a dependency on Spring Web and OAuth2 Client*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-9.10.29-am-1229x1116.png)
*I made a small change to the SpringOauth2Application.java file (see above) and ran the project.The project generated a temporary password*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-9.10.55-am-1308x404.png)
*I accessed the running code on http://localhost:8080 and I was redirected to a login page*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-9.11.47-am-1307x185.png)
*I entered the username "user" and the generated a temporary password and the home page was displayed*


To switch to using GitHub as an OAuth2 authentication service I would need a github.client-id and a github.client-secret.

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-8.47.31-am-1307x726.png)
*I logged into my GitHub account and clicked on the Settings menu item*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-8.47.51-am-1309x1284.png)
*I clicked on the Developer settings menu item*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-8.48.11-am-1307x543.png)
*I selected the existing localhost OAuth application (if it had not already existed I would have created it)*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-8.48.23-am-1306x1285.png)
*I updated the Authorization callback URL and took a note of the Client ID and a newly generated Client Secret*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-8.51.22-am-1229x289.png)
*I added the github.client-id and a github.client-secret values to my application.properties file*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-9.15.52-am-1306x820.png)
*Now when I tried to access http://localhost:8080 I was redirected to a GitHub page*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-9.16.04-am-1308x767.png)
*I provided the Authentication code from my two-factor authentication app*

![](/assets/images/spring-boot-6/screenshot-2023-11-02-at-9.21.11-am-1306x153.png)
*I was redirected back to the http://localhost:8080 home page*


## Adding Views and Roles

I added an admin, user and index view.
I added a USER role and an ADMIN role

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-3.02.01-pm-1474x383.png)
*I added a Thymeleaf dependency*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.29.08-pm-1661x862.png)
*I created a SecurityFilterChain Bean to control access*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.29.37-pm-1663x868.png)
*I created a service that assigns security Roles to users (user with GitHub ID=15018162 is the only ADMIN)*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.32.46-pm-1665x589.png)
*REST Controller (not used here because we are generating pages server-side only)*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.33.54-pm-1661x867.png)
*ModelAndView Controller*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.30.20-pm-1665x656.png)
*index view*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.30.43-pm-1666x696.png)
*navbar fragment*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.34.49-pm-1413x869.png)
*Home view*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.35.41-pm-1413x866.png)
*I clicked on the Login button*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.36.13-pm-1412x870.png)
*I entered an Authentication code*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.37.30-pm-1413x870.png)
*Home view with User Menu Item, Admin Menu Item and User Avatar.*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.38.09-pm-1411x867.png)
*User view*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.38.32-pm-1414x868.png)
*Admin view*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.39.20-pm-1414x272.png)
*user api result*

![](/assets/images/spring-boot-6/screenshot-2023-11-04-at-10.39.41-pm-1416x235.png)
*admin api result*


## SecurityConfig.java

```text
package com.haddley.springoauth2.controller.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    SecurityFilterChain configure(HttpSecurity http) throws Exception {
        http.authorizeRequests(auth -> auth.requestMatchers("/").permitAll());
        http.authorizeRequests(auth -> auth.requestMatchers("/webjars/bootstrap/**", "/webjars/jquery/**", "/webjars/popper.js/**").permitAll());
        http.authorizeRequests(auth -> auth.requestMatchers("/user").hasRole("USER"));
        http.authorizeRequests(auth -> auth.requestMatchers("/admin").hasRole("ADMIN"));
        http.authorizeRequests(auth -> auth.requestMatchers("/api/v1/user").hasRole("USER"));
        http.authorizeRequests(auth -> auth.requestMatchers("/api/v1/admin").hasRole("ADMIN"));

        return http.oauth2Login().and().build();
    }
}
```

## WebConfig.java

```text
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
@EnableWebMvc
public class WebConfig implements WebMvcConfigurer {

    private static final String WEBJARS_PATH_PATTERN = "/webjars/**";
    private static final String WEBJARS_LOCATION = "/webjars/";

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler(WEBJARS_PATH_PATTERN)
                .addResourceLocations(WEBJARS_LOCATION);
    }
}
```

## CustomOAuthUserService.java

```text
package com.haddley.springoauth2.service;

import com.haddley.springoauth2.model.CustomOAuth2User;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.oauth2.client.userinfo.DefaultOAuth2UserService;
import org.springframework.security.oauth2.client.userinfo.OAuth2UserRequest;
import org.springframework.security.oauth2.core.OAuth2AuthenticationException;
import org.springframework.security.oauth2.core.user.OAuth2User;
import org.springframework.stereotype.Service;

import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@Service
public class CustomOAuth2UserService extends DefaultOAuth2UserService {

    private static final Logger logger = LoggerFactory.getLogger(CustomOAuth2UserService.class);
    private static final String ADMIN_USER_NAME = "15018162";
    private static final String ROLE_USER = "ROLE_USER";
    private static final String ROLE_ADMIN = "ROLE_ADMIN";
    private static final String GITHUB_REGISTRATION_ID = "github";

    @Override
    public CustomOAuth2User loadUser(OAuth2UserRequest userRequest) throws OAuth2AuthenticationException {
        OAuth2User user = super.loadUser(userRequest);

        logger.info("User Details: {}", user);
        logger.info("User Name Details: {}", user.getName());

        if (!GITHUB_REGISTRATION_ID.equals(userRequest.getClientRegistration().getRegistrationId())) {
            throw new OAuth2AuthenticationException("ID is not from GitHub");
        }

        return new CustomOAuth2User(user, getAuthorities(user));
    }

    private List<SimpleGrantedAuthority> getAuthorities(OAuth2User user) {
        if (ADMIN_USER_NAME.equals(user.getName())) {
            return Arrays.asList(new SimpleGrantedAuthority(ROLE_USER), new SimpleGrantedAuthority(ROLE_ADMIN));
        }

        return Collections.singletonList(new SimpleGrantedAuthority(ROLE_USER));
    }
}
```

## CustomOAuth2User.java

```text
package com.haddley.springoauth2.model;

import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.oauth2.core.user.OAuth2User;

import java.util.Collection;
import java.util.Collections;
import java.util.Map;

public class CustomOAuth2User implements OAuth2User {

    private final OAuth2User oAuth2User;
    private final Collection<? extends GrantedAuthority> authorities;

    public CustomOAuth2User(OAuth2User oAuth2User, Collection<? extends GrantedAuthority> authorities) {
        this.oAuth2User = oAuth2User;
        this.authorities = Collections.unmodifiableCollection(authorities);
    }

    @Override
    public Map<String, Object> getAttributes() {
        return oAuth2User.getAttributes();
    }

    @Override
    public Collection<? extends GrantedAuthority> getAuthorities() {
        return authorities;
    }

    @Override
    public String getName() {
        return oAuth2User.getName();
    }
}
```

## MyRestController.java

```text
package com.haddley.springoauth2.controller;

import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.security.core.Authentication;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@RestController
public class MyRestController {

    private static final Logger logger = LoggerFactory.getLogger(MyRestController.class);
    private static final String DEFAULT_NAME = "World";
    private static final String SECURED_MESSAGE_FORMAT = "Secured %s!";

    @GetMapping("api/v1/user")
    public String userHello(@RequestParam(value = "name", defaultValue = DEFAULT_NAME) String name, Authentication authentication) {
        logger.info("Authentication Details: {}", authentication);
        return String.format(SECURED_MESSAGE_FORMAT, name);
    }

    @GetMapping("api/v1/admin")
    public String adminHello(@RequestParam(value = "name", defaultValue = DEFAULT_NAME) String name, Authentication authentication) {
        logger.info("Authentication Details: {}", authentication);
        return String.format(SECURED_MESSAGE_FORMAT, name);
    }
}
```

## MyPageController.java

```text
package com.haddley.springoauth2.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.security.core.Authentication;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.security.oauth2.core.user.OAuth2User;

import java.util.Map;

@Controller
public class MyPageController {

    private static final Logger logger = LoggerFactory.getLogger(MyPageController.class);
    private static final String AVATAR_URL_KEY = "avatar_url";
    private static final String INDEX_VIEW_NAME = "index";
    private static final String USER_VIEW_NAME = "user";
    private static final String ADMIN_VIEW_NAME = "admin";

    @GetMapping("/")
    public ModelAndView index(Authentication authentication) {
        return prepareModelAndView(authentication, INDEX_VIEW_NAME);
    }

    @GetMapping("/user")
    public ModelAndView user(Authentication authentication) {
        return prepareModelAndView(authentication, USER_VIEW_NAME);
    }

    @GetMapping("/admin")
    public ModelAndView admin(Authentication authentication) {
        return prepareModelAndView(authentication, ADMIN_VIEW_NAME);
    }

    private ModelAndView prepareModelAndView(Authentication authentication, String viewName) {
        logger.info("Authentication Details: {}", authentication);

        ModelAndView modelAndView = new ModelAndView(viewName);
        boolean isAuthenticated = false;
        boolean isUser = false;
        boolean isAdmin = false;

        if (authentication != null && authentication.isAuthenticated()) {
            OAuth2User oAuth2User = (OAuth2User) authentication.getPrincipal();
            String avatarUrl = getAvatarUrl(oAuth2User);

            isAuthenticated = true;
            isUser = authentication.getAuthorities().stream().anyMatch(grantedAuthority -> grantedAuthority.getAuthority().equals("ROLE_USER"));
            isAdmin = authentication.getAuthorities().stream().anyMatch(grantedAuthority -> grantedAuthority.getAuthority().equals("ROLE_ADMIN"));

            logger.info("User Avatar URL: {}", avatarUrl);

            modelAndView.addObject("avatarUrl", avatarUrl);

        }

        logger.info("isAuthenticated: {}", isAuthenticated);
        logger.info("isUser: {}", isUser);
        logger.info("isAdmin: {}", isAdmin);

        modelAndView.addObject("isAuthenticated", isAuthenticated);
        modelAndView.addObject("isUser", isUser);
        modelAndView.addObject("isAdmin", isAdmin);

        return modelAndView;
    }

    private String getAvatarUrl(OAuth2User oAuth2User) {
        Map<String, Object> attributes = oAuth2User.getAttributes();
        return (String) attributes.get(AVATAR_URL_KEY);
    }
}
```

## pom.xml

```text
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>3.1.5</version>
		<relativePath/> <!-- lookup parent from repository -->
	</parent>
	<groupId>com.haddley</groupId>
	<artifactId>spring-oauth2</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>spring-oauth2</name>
	<description>Demo project for Spring Boot</description>
	<properties>
		<java.version>17</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-oauth2-client</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-thymeleaf</artifactId>
		</dependency>


		<dependency>
    		<groupId>org.webjars</groupId>
    		<artifactId>bootstrap</artifactId>
    		<version>5.3.2</version>
		</dependency>
		<dependency>
    		<groupId>org.webjars</groupId>
    		<artifactId>jquery</artifactId>
    		<version>3.1.1</version>
		</dependency>


	</dependencies>

	<build>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
			</plugin>
		</plugins>
	</build>

</project>
```
## References

- [OAuth2Advanced Spring Security Login Made Easy in Java](https://www.youtube.com/watch?v=us0VjFiHogo)
- [Advanced Spring Security](https://www.youtube.com/watch?v=PczgM2L3w60)

---

## spring-boot

**Source file:** `spring-boot.md`

---
title: "Java Spring Boot (Part 1)"
description: "Spring based Java Applications that you can just run."
date: "2021-04-06"
categories: ["Java","React"]
tags: []
slug: "spring-boot"
image: "/assets/images/spring-framework-logo-70-no.svg"
---

## Spring Tool Suite

Spring Tool Suite is an Integrated Development Environment based on Eclipse.


## Maven

Maven is a build and dependency management tool for Java.

The pom.xml file is used to maintain a list of modules that the Spring application depends on.

Module jar files are downloaded from a managed repository.


## Creating a REST project using Spring Boot

Open Spring Tool Suite
Create new Spring Starter Project
Add Book class
Add BooksRestController
Run as Spring Boot App
Test using Browser

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.01.43-am-1718x1074.png)
*Create new Spring Starter Project*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.03.13-am-1180x1440.png)
*Enter the project name and package details*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.03.38-am-1174x1440.png)
*The REST API project depends on "Spring Web"*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.04.47-am-1430x436.png)
*Add a new class*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.05.11-am-1180x1254.png)
*Add class "Book"*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.06.30-am-1174x1254.png)
*Add class "BooksRestController"*


## Annotations

The **@RestController** annotation is used to mark the BooksRestController class as a Spring Framework RestController.

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.07.37-am-1836x552.png)
*Add @RestController annotation to BooksRestController classUse CTRL+Space to import org.springframework.web.bind.annotation.RestController*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.10.26-am-1722x1076.png)
*Add "books" ArrayList to the BooksRestController*


## Books REST Controller

The **@GetMapping** annotation is used to mark the book and books methods as HTTP Get method handlers.

The completed BooksRestController code is shown below.

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.17.47-am-560x844.png)
*Run as Spring Boot App*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.19.11-am-1836x874.png)
*http://localhost:8080/books*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.19.46-am-1836x873.png)
*http://localhost:8080/books/1788395549*

![](/assets/images/spring-boot/screen-shot-2021-04-06-at-11.20.30-am-1836x875.png)
*http://localhost:8080/books/1234567890*


## React client

Static files can be added to the /src/main/resources/static folder of the Spring Boot project.

The static files can be image files, html files and javascript files.

The static files can be a [React](reactusestateuseeffect.html) app that calls the REST API exposed by the (same) Spring Boot project.

![](/assets/images/spring-boot/screen-shot-2021-04-08-at-3.28.25-pm-1836x981.png)
*Static files*

![](/assets/images/spring-boot/screen-shot-2021-04-08-at-3.27.02-pm-1286x750.png)
*Running the React/Spring Boot app*


## Book.java

```text
package com.haddley.Books;

public class Book {

	public Book(long id, String title) {
		_id = id;
		_title = title;
	}

	private long _id;

	public long getId() {
		return _id;
	}

	public void setId(long id) {
		this._id = id;
	}

	public String getTitle() {
		return _title;
	}

	public void setTitle(String title) {
		this._title = title;
	}

	private String _title;
	
}
```

## BooksRestController.java

```text
package com.haddley.Books;

import java.util.ArrayList;

import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.server.ResponseStatusException;


@RestController
public class BooksRestController {

	private static ArrayList<Book> books = new ArrayList<Book>();

	static {
		books.add(new Book(1788395549, "Learning Node.js Development"));
		books.add(new Book(1788620216, "Hands-On Microservices with Node.js"));
	}

	@GetMapping("/books/{id}")
	public Book book(@PathVariable Long id) {
		@SuppressWarnings("unchecked")
		ArrayList<Book> result = (ArrayList<Book>) BooksRestController.books.clone();
		result.removeIf(n -> (n.getId() != id));
		if (result.isEmpty()){
			throw new ResponseStatusException(HttpStatus.NOT_FOUND, "Book Not Found");
		}
		return result.get(0);
	}

	@GetMapping("/books")
	public ArrayList<Book> books() {
		return BooksRestController.books;
	}
	
}
```

## App.js

```text
import React, { useEffect, useState } from 'react';

function App() {

  const [books, setBooks] = useState([]);

  useEffect(() => {

    console.log("use effect");
    fetch('/books')
      .then(
        (d) => {
          d.json().then((b) => {
            setBooks(() => b)
          });
        }
      )

  }
    , [])

  return (

    <>
        {books.map(book =>
            <h4>{book.title}</h4>)}
    </>

  );
}

export default App;
```

## index.html

```html
<!DOCTYPE html>
<html lang="en">

<head>
	<title>React App</title>
</head>

<body>

	<noscript>You need to enable JavaScript to run this app.</noscript>
	<div id="root"></div>

	<script>!function (e) {function r(r) {for (var n, i, l = r[0], p = r[1], f = r[2], c = 0, s = []; c < l.length; c++)i = l[c], Object.prototype.hasOwnProperty.call(o, i) && o[i] && s.push(o[i][0]), o[i] = 0; for (n in p) Object.prototype.hasOwnProperty.call(p, n) && (e[n] = p[n]); for (a && a(r); s.length;)s.shift()(); return u.push.apply(u, f || []), t()} function t() {for (var e, r = 0; r < u.length; r++) {for (var t = u[r], n = !0, l = 1; l < t.length; l++) {var p = t[l]; 0 !== o[p] && (n = !1)} n && (u.splice(r--, 1), e = i(i.s = t[0]))} return e} var n = {}, o = {1: 0}, u = []; function i(r) {if (n[r]) return n[r].exports; var t = n[r] = {i: r, l: !1, exports: {}}; return e[r].call(t.exports, t, t.exports, i), t.l = !0, t.exports} i.m = e, i.c = n, i.d = function (e, r, t) {i.o(e, r) || Object.defineProperty(e, r, {enumerable: !0, get: t})}, i.r = function (e) {"undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {value: "Module"}), Object.defineProperty(e, "__esModule", {value: !0})}, i.t = function (e, r) {if (1 & r && (e = i(e)), 8 & r) return e; if (4 & r && "object" == typeof e && e && e.__esModule) return e; var t = Object.create(null); if (i.r(t), Object.defineProperty(t, "default", {enumerable: !0, value: e}), 2 & r && "string" != typeof e) for (var n in e) i.d(t, n, function (r) {return e[r]}.bind(null, n)); return t}, i.n = function (e) {var r = e && e.__esModule ? function () {return e.default} : function () {return e}; return i.d(r, "a", r), r}, i.o = function (e, r) {return Object.prototype.hasOwnProperty.call(e, r)}, i.p = "/"; var l = this["webpackJsonpnode-spring-client"] = this["webpackJsonpnode-spring-client"] || [], p = l.push.bind(l); l.push = r, l = l.slice(); for (var f = 0; f < l.length; f++)r(l[f]); var a = p; t()}([])</script>
	<script src="/js/2.bd91be3c.chunk.js"></script>
	<script src="/js/main.d36b6e09.chunk.js"></script>

</body>

</html>
```
## References

- [QuickStart](https://spring.io/quickstart)

---

## sprint-apps1

**Source file:** `sprint-apps1.md`

---
title: "Azure Spring Apps (Part 1)"
description: "hello-world-app"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/sprint-apps1/hero.png"
tags: ["azure","java","spring","ai"]
hidden: true
slug: "sprint-apps1"
---


## Hello World

I used **Azure Spring Apps** to host a Java Web Application in Microsoft Azure

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-11.56.47-am-2136x1150.png)
*I clicked the Azure Spring Apps Create button*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-11.57.01-am-2136x1157.png)
*I reviewed the overview and clicked the Create button*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-11.57.46-am-2136x1151.png)
*I specified a resource group name (haddley-spring-rg)*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-11.58.33-am-2136x1151.png)
*I specified a service details name (haddley-spring)*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-11.58.47-am-2136x1157.png)
*I selected the entry level and clicked the Deploy sample project option*


## GreetingController.java

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-11.59.18-am-2136x1151.png)
*I clicked the Create button*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-11.59.39-am-2136x1154.png)
*Deployment in progress*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.51.39-pm-2136x1156.png)
*Deployment is complete*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.52.00-pm-2136x1153.png)
*Overview*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.52.19-pm-2136x1154.png)
*Apps*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.52.34-pm-2136x1157.png)
*hello-world-app*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.52.48-pm-2136x1229.png)
*Running application*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.54.11-pm-2136x1113.png)
*Scale up*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.54.34-pm-2136x1113.png)
*Scale out*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.55.39-pm-2136x1113.png)
*Stop service*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-12.56.25-pm-2136x1116.png)
*Quickstarts*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-2.50.38-pm-2136x968.png)
*./mvnw spring-boot:run*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-2.49.29-pm-2136x1245.png)
*Tomcat initialized with port 8080 (http)*

![](/assets/images/sprint-apps1/screenshot-2023-10-24-at-2.49.57-pm-2136x268.png)
*Running locally*
## References

- [Azure Spring Apps: The easy way to run your apps | ODFP207](https://www.youtube.com/watch?v=64AWFTbDwHg)



---

## stablediffusion

**Source file:** `stablediffusion.md`

---
title: "Stable Diffusion"
description: "Stable Diffusion"
date: "2023-08-01"
categories: ["Python","AI"]
tags: []
slug: "stablediffusion"
image: "/assets/images/jupyter.svg"
---



Stable Diffusion is a deep learning, text-to-image model released in 2022 based on diffusion techniques. It is primarily used to generate detailed images conditioned on text descriptions.

https://huggingface.co/CompVis/stable-diffusion

https://github.com/huggingface/diffusers


## "stableenv" environment

I created an isolated Anaconda environment "stableenv" for my [Stable Diffusion](https://en.wikipedia.org/wiki/Stable_Diffusion) development.

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.19.43-pm-1176x166.png)
*I created the stableenv environment (adding jupyterlab, ipykernel and ipywidgets)conda create --name stableenv jupyterlab ipykernel ipywidgets*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.22.20-pm-1172x96.png)
*I activated the stableenv environmentconda activate stableenv*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.22.29-pm-1164x360.png)
*I added jupyter labs support to the environmentipython kernel install --user --name=stableenv*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.23.05-pm-1172x738.png)
*I started the jupyter lab servicejupyter lab*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.25.53-pm-1320x780.png)
*I switched to the stableenv environment (kernel)*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.26.15-pm-991x307.png)
*I installed the stable diffusion pipeline dependencies (I could have used pip)!conda install -c conda-forge -y accelerate diffusers transformers*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.27.42-pm-1321x562.png)
*I created a pipe instance using the DiffusionPipeline.from_pretrained(id) method call.*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.30.16-pm-1317x829.png)
*The DiffusionPipeline.from_pretrained(id) method call returned a warning*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.31.07-pm-912x708.png)
*I generated an image using the pipeline*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.35.07-pm-890x669.png)
*In this configuration Stable Diffusion did not take advantage of the laptop's GPU.*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.35.39-pm-888x669.png)
*In this configuration Stable Diffusion took 4 minutes and 19 seconds to generate an image.*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.36.12-pm-872x665.png)
*I updated the pipeline instance to use the laptop's GPU*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.37.27-pm-889x666.png)
*In this configuration Stable Diffusion used the laptop's GPU.*

![](/assets/images/stablediffusion/screenshot-2023-08-01-at-6.37.50-pm-852x662.png)
*In this configuration Stable Diffusion took 1 minute and 7 seconds to generate an image.*

---

## staticwebapp.config.json

**Source file:** `staticwebapp.config.json.md`

---
title: "staticwebapp.config.json"
description: "staticwebapp.config.json"
date: "2024-03-10"
categories: ["Azure"]
tags: []
slug: "staticwebapp.config.json"
image: "/assets/images/azurex70x75.svg"
---



The "auth" section of the staticwebapp.config.json can be used to configure access to a static web app.

Static web app environment variables can be used to manage authentication properties

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-1.57.36-pm-1836x961.png)
*I created an index.html file. I created a staticwebapp.config.json file.*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.00.55-pm-1836x958.png)
*I right clicked the Static Web App icon and selected the "Create Static Web App... (Advanced)" option*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.01.06-pm-1836x958.png)
*I clicked the Create button*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.01.17-pm-1836x108.png)
*I provided a git initial commit message*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.02.17-pm-1836x151.png)
*I provided a name for a new Azure Resource Group*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.02.28-pm-1836x152.png)
*I accepted the detail Azure Static Web app name*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.02.40-pm-1836x177.png)
*I selected the Free pricing option*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.02.53-pm-1836x145.png)
*I selected the GitHub organization name*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.03.05-pm-1836x165.png)
*I accepted the default repository name*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.03.15-pm-1836x180.png)
*I selected the private option*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.03.24-pm-1836x201.png)
*I selected the default shortname*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.03.32-pm-1836x135.png)
*I selected the default region*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.03.56-pm-1836x328.png)
*I selected the HTML project structure*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.04.03-pm-1836x215.png)
*I selected location /*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.04.10-pm-1836x198.png)
*I left the Azure Function name empty*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.04.17-pm-1836x230.png)
*I selected location /*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.05.34-pm-1836x386.png)
*I created a new Azure Active Directory/Entra ID App Registration*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.06.24-pm-1836x1021.png)
*I selected the "any organization... option*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.33.24-pm-1836x592.png)
*I added a platform*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.33.32-pm-1836x482.png)
*I selected Web*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.33.43-pm-1836x1020.png)
*I specified the Redirect URI*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.58.39-pm-1836x995.png)
*I added https://jolly-bush.../.auth/login/add/callback*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.53.48-pm-1836x1019.png)
*I selected the ID tokens checkbox*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.06.55-pm-1836x508.png)
*I copied the client ID*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.08.06-pm-1836x669.png)
*I created an application Environment Variable called AZURE_CLIENT_ID and pasted in the value*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.08.25-pm-1836x1019.png)
*I created a Client Secret*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.08.38-pm-1836x821.png)
*I copied the Client Secret value*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.09.15-pm-1836x1020.png)
*I created an application Environment Variable called AZURE_CLIENT_SECRET and pasted in the value*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.47.56-pm-1836x1019.png)
*I upgraded the Static web app's hosting plan*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.09.39-pm-1836x421.png)
*I copied the Static Web Application's URL*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.54.53-pm-1836x1080.png)
*I clicked the Accept button*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.10.55-pm-1836x1046.png)
*I entered a username and password*

![](/assets/images/staticwebapp.config.json/screenshot-2024-03-16-at-2.11.24-pm-1836x1046.png)
*I logged onto the app*


```text
{
  "routes": [
    {
      "route": "/*",
      "allowedRoles": [
        "authenticated"
      ]
    }
  ],
  "responseOverrides": {
    "401": {
      "statusCode": 302,
      "redirect": "/.auth/login/aad"
    }
  },
  "auth": {
    "identityProviders": {
      "azureActiveDirectory": {
        "registration": {
          "openIdIssuer": "https://login.microsoftonline.com/1661e837-0a95-4bc6-a655-865365c2419b/v2.0",
          "clientIdSettingName": "AZURE_CLIENT_ID",
          "clientSecretSettingName": "AZURE_CLIENT_SECRET"
        }
      }
    }
  }
}
```
## References

- [Build a website using Azure Static Web Apps and Authenticate with AAD](https://www.youtube.com/watch?v=jnwRpEM6GR8)

---

## streamlit

**Source file:** `streamlit.md`

---
title: "Streamlit"
description: "Streamlit"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/streamlit/hero.png"
tags: ["python","ai","ml","machine learning"]
hidden: true
slug: "streamlit"
---



**ChatGPT: What is Streamlit?**

Streamlit is an open-source Python library that allows developers to create web applications for data science and machine learning projects with minimal effort. It was designed to simplify the process of turning data scripts into interactive web applications without the need for extensive web development knowledge.

With Streamlit, you can create interactive web applications directly from Python scripts using familiar Python programming paradigms. The library is particularly popular in the data science and machine learning communities due to its ease of use and fast prototyping capabilities.

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/streamlit/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*


## sentence_similarity.html

```text
<!DOCTYPE html>
<html>

<head>
    <title>Sentence Similarity Demo</title>
</head>

<body>
    <h1>Sentence Similarity Demo</h1>
    <textarea id="input-text-1" rows="4" cols="50" placeholder="Enter text to compare"></textarea>
    <textarea id="input-text-2" rows="4" cols="50" placeholder="Enter text to compare"></textarea>

    <button id="compare">Compare</button>
    <p id="score"></p>

    <script type="module">
        import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.4.1';

        const generateEmbeddings = await pipeline(
            'feature-extraction', 'xenova/all-MiniLM-L6-v2'
        )

        async function dotProduct(vec1, vec2) {
            let result = 0;
            for (let i = 0; i < vec1.length; i++) {
                result += vec1[i] * vec2[i];
            }
            return result;
        }

        async function compare() {

            const inputText1 = document.getElementById('input-text-1').value.trim();
            const inputText2 = document.getElementById('input-text-2').value.trim();

            if (inputText1 === '' || inputText2 === '') {
                alert('Please enter text to compare.');
                return;
            }

            const options = { pooling: 'mean', normalize: true };
            const output1 = await generateEmbeddings(inputText1, options);
            const output2 = await generateEmbeddings(inputText2, options);

            const embeddings1 = output1.data;
            console.log("embeddings1", embeddings1);

            const embeddings2 = output2.data;
            console.log("embeddings2", embeddings2);

            const similarity = await dotProduct(output1.data, output2.data);

            document.getElementById('score').textContent = `Score: ${similarity}`;

        }

        document.getElementById("compare").onclick = compare;

    </script>

</body>

</html>
```
## References

- [Sentence Similarity](https://huggingface.co/tasks/sentence-similarity)
- [$0 Embeddings (OpenAI vs. free &amp; open source)](https://www.youtube.com/watch?v=QdDoFfkVkcw)



---

## syntexautofill

**Source file:** `syntexautofill.md`

---
title: "SharePoint Syntex "
description: "Autofill columns"
date: "2025-07-30"
categories: ["Microsoft 365"]
tags: []
slug: "syntexautofill"
image: "/assets/images/1200px-microsoft-office-sharepoint-2018present.svg-1200x1172.png"
---



Syntex Autofill is an AI feature in SharePoint that automatically extracts or generates metadata from documents using natural language prompts, populating SharePoint columns without manual entry. Syntex Autofill transforms unstructured content into structured data.

I added a **Smoke?** Autofill column to a Document Library. The objective was to automatically label [patient medical reports](langchain.html).

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.26.13e280afpm-2136x1125.png)
*I uploaded a patient medical report to a SharePoint Document Library. I clicked the + Add column button. I added a Smoke? column. I enabled the Autofill feature for this column. I added the Does the patient smoke? prompt.*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.26.51e280afpm-2136x1125.png)
*I clicked the Save button*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.27.14e280afpm-2136x1125.png)
*I started the Autofill processing*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.27.29e280afpm-2136x1123.png)
*I was told that my files were being processed*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.27.57e280afpm-2136x1112.png)
*I clicked the View autofill activity button*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.31.02e280afpm-2136x491.png)
*I uploaded 5 more medical report documents*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.31.30e280afpm-2136x1130.png)
*By default the Smoke? column was set to true*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.33.01e280afpm-2136x1122.png)
*After a few minutes the autofill process completed. The Smoke? column value had been updated.*

![](/assets/images/syntexautofill/screenshot202025-07-3020at203.34.09e280afpm-2136x952.png)
*Reviewing the hp2 document confirmed that the Smoke? column value had been set correctly.*

---

## taxsetup

**Source file:** `taxsetup.md`

---
title: "Tax Setup"
description: "Tax Setup"
date: "2025-09-20"
categories: ["Business Central"]
image: "/assets/images/taxsetup/hero.png"
tags: ["ai","business central","dynamics"]
hidden: true
slug: "taxsetup"
---


## Sub-ledgers

In Microsoft Dynamics 365 Business Central, sub-ledgers are used to record and manage specific types of transactions.

Each sub-ledger corresponds to a specific type of transaction or business process.

Sub-ledgers include:

Item Ledger
Vendor Ledger
Detailed Vendor Ledger
Customer Ledger; and
Detailed Customer Ledger


## Posting Groups

In Microsoft Dynamics 365 Business Central, Posting Groups are used to "build a bridge" between Business Central sub-ledgers and the general ledger accounts.


## Vendor Posting Group

A Vendor Posting Group is used to define which accounts payable general ledger account to use when purchasing goods from a Vendor.

A Vendor Posting Group can also be used to define service charge accounts, and payment discount accounts.

Vendor Posting Groups are maintained using the Vendor Posting Groups page.

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.22.52-pm-1536x777.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.23.02-pm-1536x572.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.24.37-pm-1536x428.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.25.20-pm-1536x225.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.28.49-pm-1536x540.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.29.36-pm-1536x676.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.30.05-pm-1536x871.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.31.20-pm-1536x856.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.31.56-pm-1536x725.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.32.23-pm-1536x875.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.34.50-pm-1536x982.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.36.42-pm-1536x977.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.40.50-pm-1536x361.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.41.21-pm-1536x298.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.41.45-pm-1536x572.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.42.09-pm-1536x519.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.42.54-pm-1536x345.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.43.21-pm-1536x521.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.44.34-pm-1536x336.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.46.08-pm-1536x538.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.49.02-pm-1536x586.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.50.19-pm-1536x848.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2023-12-12-at-3.51.54-pm-1536x400.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/taxsetup/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

---

## teamstoolkit

**Source file:** `teamstoolkit.md`

---
title: "Teams Toolkit with Azure"
description: "Get started with Microsoft Teams app development using Azure."
date: "2021-05-29"
categories: ["Microsoft 365","Azure","React","SQL"]
tags: []
slug: "teamstoolkit"
image: "/assets/images/teams-hi-res-icon-2019.svg"
---


## Visual Studio Extension

Teams Toolkit makes creating Teams Tabs/Azure applications easier.

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-5.12.18-pm-1836x824.png)
*Add Teams Toolkit Extension to Visual Studio Code*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.47.21-pm-294x84.png)
*Click the Teams Toolkit to open Wizard*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.48.08-pm-1468x1114.png)
*Configure Quick Start items*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.49.16-pm-748x282.png)
*Sign-in to M365 account*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.49.23-pm-734x276.png)
*Sign-in to Azure*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.49.33-pm-726x330.png)
*Click Create New Project link*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.49.49-pm-1264x352.png)
*Start from a sample*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.50.08-pm-1226x514.png)
*Select the Todo List with backend on Azure sample*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.52.34-pm-534x552.png)
*Download the sample code from Github*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.53.04-pm-1334x464.png)
*Notice that the sample code is a work in progress*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.54.00-pm-574x124.png)
*Open Command Palette*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.54.51-pm-1240x160.png)
*Use Team: Provision in the Cloud command to configure Azure*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.55.24-pm-1252x210.png)
*Enter a hard to guess database administrator account name*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.56.06-pm-530x780.png)
*Configures Azure Services*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-3.56.20-pm-970x336.png)
*Provisioning progress*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.09.03-pm-1836x1083.png)
*Newly created resource group*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.09.28-pm-1718x670.png)
*Open SQL Database to copy "Server name"*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.10.16-pm-992x834.png)
*Open Azure Data Studio and enter SQL Server connection details*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.10.32-pm-998x838.png)
*Ensure that Azure firewall rule is added*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.12.32-pm-1102x714.png)
*Use a Query tab in Azure Data Studio to create the Todo list*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.19.44-pm-1234x158.png)
*Use Teams: Deploy to the Cloud command*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.19.52-pm-1248x264.png)
*Deploy the React code and the Azure Function (API)*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.23.48-pm-1258x166.png)
*Use Teams: Build Teams Package command*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.25.03-pm-1242x164.png)
*Use Teams: Publish to Teams command*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.25.13-pm-1230x334.png)
*Install to organization*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.26.40-pm-1836x903.png)
*Open Microsoft Teams admin center. Locate app "pending approval"*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.26.58-pm-1484x896.png)
*Publish app*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.27.08-pm-1210x510.png)
*Click the Publish button*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.28.34-pm-682x388.png)
*App has been added to Microsoft Teams*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.29.15-pm-1188x616.png)
*Use Add to a team button*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.29.28-pm-1262x714.png)
*Select a Team (click Set up a tab)*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.29.55-pm-1224x1230.png)
*View tab configuration page*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.30.25-pm-920x510.png)
*Welcome page click Start to progress*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.30.56-pm-912x590.png)
*Login is required*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.31.12-pm-876x972.png)
*Provide consent*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.31.30-pm-1836x1357.png)
*If no tasks to display*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.32.02-pm-1740x328.png)
*Add task (press enter)*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.32.16-pm-1758x462.png)
*using map to render all of the tasks*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.35.11-pm-1836x977.png)
*A row has been added to the database*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.42.13-pm-1836x1181.png)
*The function app is used to implement a REST api*

![](/assets/images/teamstoolkit/screen-shot-2021-05-29-at-4.45.25-pm-1836x1182.png)
*Tab.js*


## An extract from Tab.js

```text
{this.state.showLoginPage === true && <div className="auth">
          <Profile userInfo={this.state.userInfo} />
          <h2>Welcome to To Do List App!</h2>
          <Button primary onClick={() => this.loginBtnClick()}>Start</Button>
        </div>}
```

## Profile.js

```text
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.

import React from 'react';
import './Profile.css';
import defaultPhoto from '../images/default-photo.png'

class Profile extends React.Component {
  render() {
    return (
      <div className="profile">
        <div className="photo">
          <img src={defaultPhoto} alt="avatar"/>
        </div>
        <div className="info">
          <div className="name">{this.props.userInfo.displayName}</div>
          <div className="email">{this.props.userInfo.preferredUserName}</div>
        </div>
      </div>
    );
  }
}

export default Profile;
```

## An extract from Tab.js

```text
async componentDidMount() {
    await this.initTeamsFx();
    await this.initData();
  }

  async initTeamsFx() {
    // Initialize configuration from environment variables and set the global instance
    loadConfiguration({
      authentication: {
        initiateLoginEndpoint: process.env.REACT_APP_START_LOGIN_PAGE_URL,
        simpleAuthEndpoint: process.env.REACT_APP_TEAMSFX_ENDPOINT,
        clientId: process.env.REACT_APP_CLIENT_ID
      },
      resources: [
        {
          type: ResourceType.API,
          name: "default",
          properties: {
            endpoint: process.env.REACT_APP_FUNC_ENDPOINT
          }
        }
      ]
    });
    const credential = new TeamsUserCredential();
    // Get the user info from access token
    const userInfo = await credential.getUserInfo();

    this.setState({
      userInfo: userInfo
    });

    this.credential = credential;
    this.scope = ["User.Read", "User.ReadBasic.All"];
    this.channelOrChatId = await this.getChannelOrChatId();
  }

  async initData() {
    if (!await this.checkIsConsentNeeded()) {
      await this.getItems();
    }
  }

  async loginBtnClick() {
    try {
      // Popup login page to get user's access token
      await this.credential.login(this.scope);
    } catch (err) {
      alert("Login failed: " + err);
      return;
    }
    await this.initData();
  }

  async checkIsConsentNeeded() {
    try {
      await this.credential.getToken(this.scope);
    } catch (error) {
      this.setState({
        showLoginPage: true
      });
      return true;
    }
    this.setState({
      showLoginPage: false
    });
    return false;
  }
```

## An extract from Tab.js

```text
{this.state.initialized && !this.state.items.length && !this.state.isAddingItem && <div className="no-item">
                <div>
                  <img src={noItemimage} alt="no item" />
                </div>
                <div>
                  <h2>No tasks</h2>
                  <p>Add more tasks to make you day productive.</p>
                </div>
              </div>}
```

## An extract from Tab.js

```text
{this.state.isAddingItem && <div className="item add">
                <div className="complete">
                  <Checkbox
                    disabled
                    className="is-completed-input"
                  />
                </div>
                <div className="description">
                  <Input
                    autoFocus
                    type="text"
                    value={this.state.newItemDescription}
                    onChange={(e) => this.setState({ newItemDescription: e.target.value })}
                    onKeyDown={(e) => {
                      if (e.key === 'Enter') {
                        this.onAddItem();
                      }
                    }}
                    onBlur={() => {
                      if (this.state.newItemDescription) {
                        this.onAddItem();
                      }
                      this.setState({
                        isAddingItem: false,
                      });
                    }}
                    className="text"
                  />
                </div>
              </div>}
```

## An extract from Tab.js

```text
const items = this.state.items?.map((item, index) =>
      <div key={index} className="item">
        <div className="complete">
          <Checkbox
            checked={this.state.items[index].isCompleted}
            onChange={(e, { checked }) => this.onCompletionStatusChange(item.id, index, checked)}
            className="is-completed-input"
          />
        </div>
        <div className="description">
          <Input
            value={this.state.items[index].description}
            onChange={(e) => this.handleInputChange(index, "description", e.target.value)}
            onKeyDown={(e) => {
              if (e.key === 'Enter') {
                this.onUpdateItem(item.id, this.state.items[index].description);
                e.target.blur();
              }
            }}
            onBlur={() => this.onUpdateItem(item.id, this.state.items[index].description)}
            className={"text" + (this.state.items[index].isCompleted ? " is-completed" : "")}
          />
        </div>
        <Creator objectId={item.objectId} credential={this.credential} scope={this.scope} />
        <div className="action">
          <MenuButton
            trigger={<Button content="..." />}
            menu={[
              {
                content: 'Delete',
                onClick: () => this.onDeleteItem(item.id)
              }
            ]}
            on="click"
          />
        </div>
      </div>
    );
```

## index.js

```text
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.

const {
    loadConfiguration,
    OnBehalfOfUserCredential,
    DefaultTediousConnectionConfiguration,
} = require("@microsoft/teamsfx");
const { Connection, Request } = require('tedious');

/**
 * This function handles requests sent from teamsfx client SDK.
 * The HTTP request should contain an SSO token in the header and any content in the body.
 * The SSO token should be queried from Teams client by teamsfx client SDK.
 * Before trigger this function, teamsfx binding would process the SSO token and generate teamsfx configuration.
 *
 * This function initializes the teamsfx Server SDK with the configuration and calls these APIs:
 * - getUserInfo() - Get the user's information from the received SSO token.
 * - getMicrosoftGraphClientWithUserIdentity() - Get a graph client to access user's Microsoft 365 data.
 *
 * The response contains multiple message blocks constructed into a JSON object, including:
 * - An echo of the request body.
 * - The display name encoded in the SSO token.
 * - Current user's Microsoft 365 profile if the user has consented.
 *
 * @param {Context} context - The Azure Functions context object.
 * @param {HttpRequest} req - The HTTP request.
 * @param {teamsfxConfig} config - The teamsfx configuration generated by teamsfx binding.
 */
module.exports = async function (context, req, config) {
    let connection;
    // Initialize configuration from environment variables and set the global instance
    loadConfiguration()
    try {
        connection = await getSQLConnection();
        const method = req.method.toLowerCase();
        const accessToken = config.AccessToken;
        const credential = new OnBehalfOfUserCredential(accessToken);
        // Get the user info from access token
        const currentUser = await credential.getUserInfo();
        const objectId = currentUser.objectId;
        var query;

        switch (method) {
            case "get":
                query = `select id, description, isCompleted, objectId from dbo.Todo where channelOrChatId = '${req.query.channelOrChatId}'`;
                break;
            case "put":
                if (req.body.description) {
                    query = `update dbo.Todo set description = N'${req.body.description}' where id = ${req.body.id}`;
                } else {
                    query = `update dbo.Todo set isCompleted = ${req.body.isCompleted ? 1 : 0} where id = ${req.body.id}`;
                }
                break;
            case "post":
                query = `insert into dbo.Todo (description, objectId, isCompleted, channelOrChatId) values (N'${req.body.description}','${objectId}',${req.body.isCompleted ? 1 : 0},'${req.body.channelOrChatId}')`;
                break;
            case "delete":
                query = "delete from dbo.Todo where " + (req.body ? `id = ${req.body.id}` : `objectId = '${objectId}'`);
                break;
        }
        // Execute SQL through TeamsFx server SDK generated connection and return result
        const result = await execQuery(query, connection);
        return {
            status: 200,
            body: result
        }
    }
    catch (err) {
        return {
            status: 500,
            body: {
                error: err.message
            }
        }
    }
    finally {
        if (connection) {
            connection.close();
        }
    }
}

async function getSQLConnection() {
    const sqlConnectConfig = new DefaultTediousConnectionConfiguration();
    const config = await sqlConnectConfig.getConfig();
    const connection = new Connection(config);
    return new Promise((resolve, reject) => {
        connection.on('connect', err => {
            if (err) {
                reject(err);
            }
            resolve(connection);
        })
        connection.on('debug', function (err) {
            console.log('debug:', err);
        });
    })
}

async function execQuery(query, connection) {
    return new Promise((resolve, reject) => {
        const res = [];
        const request = new Request(query, (err) => {
            if (err) {
                reject(err);
            }
        });

        request.on('row', columns => {
            const row = {};
            columns.forEach(column => {
                row[column.metadata.colName] = column.value;
            });
            res.push(row)
        });

        request.on('requestCompleted', () => {
            resolve(res)
        });

        request.on("error", err => {
            reject(err);
        });

        connection.execSql(request);
    })
}
```
## References

- [Teams Toolkit](https://docs.microsoft.com/en-us/microsoftteams/platform/get-started/prerequisites?tabs=vscode)

---

## teamstoolkitspfx

**Source file:** `teamstoolkitspfx.md`

---
title: "Teams Toolkit with SPFx"
description: "Get started with Microsoft Teams app development using SPFx."
date: "2021-05-30"
categories: ["Microsoft 365","Azure"]
tags: []
slug: "teamstoolkitspfx"
image: "/assets/images/teams-hi-res-icon-2019.svg"
---



## Visual Studio Extension

Teams Toolkit makes creating Teams Tabs/Azure applications easier.

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-29-at-5.12.18-pm-1836x824.png)
*Add Teams Toolkit Extension to Visual Studio Code*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-29-at-3.47.21-pm-294x84.png)
*Click the Teams Toolkit to open Wizard*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-29-at-3.48.08-pm-1468x1114.png)
*Configure Quick Start items*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-29-at-3.49.16-pm-748x282.png)
*Sign-in to M365 account*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-29-at-3.49.23-pm-734x276.png)
*Sign-in to Azure*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-29-at-3.49.33-pm-726x330.png)
*Click Create New Project link*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-29-at-3.49.49-pm-1264x352.png)
*Start from a sample*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.41.34-am-1256x516.png)
*Select the Todo List with SPFx sample*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.41.56-am-536x476.png)
*Download the sample code from Github*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.42.39-am-1380x416.png)
*Notice that the sample code is a work in progress*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.47.47-am-1836x1138.png)
*Navigate to {tenant).sharepoint.com*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.48.19-am-320x402.png)
*Create a blank list*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.49.22-am-1194x810.png)
*Name list "To Do List"*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.50.02-am-1628x584.png)
*esp8266*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.50.55-am-838x648.png)
*Add description column*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.51.09-am-1836x704.png)
*esp8266*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.51.56-am-822x638.png)
*Add isCompleted column*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.52.17-am-1766x1156.png)
*To Do List*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.52.53-am-768x436.png)
*esp8266*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.53.21-am-422x126.png)
*Update list settings*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.53.38-am-730x216.png)
*Users can only see list items created by them*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.55.11-am-556x106.png)
*Open Visual Studio Code command palette*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.55.57-am-1232x154.png)
*esp8266*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.56.08-am-536x706.png)
*Run "Teams: Deploy to the Cloud" command*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.57.31-am-934x140.png)
*Building SharePoint package*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.58.56-am-938x372.png)
*todo-list-sp-fx.sppkg file created*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-8.59.30-am-1836x770.png)
*Upload todo-list-sp-fx.sppkg file to SharePoint App Catalog*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.00.31-am-1836x1046.png)
*Upload*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.00.50-am-1836x1012.png)
*Add a document*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.01.35-am-1306x864.png)
*Ensure that "Make this solution available to all sites" is checked and Deploy*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.05.30-am-1836x975.png)
*Select the app and click the "Sync to Teams" button in the SharePoint ribbon*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.05.43-am-516x128.png)
*App will be added to Teams*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.06.48-am-1050x660.png)
*Navigate to Teams Admin pages*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.08.49-am-562x220.png)
*Select "Manage apps" (using a supported browser)*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.09.21-am-1836x408.png)
*The TodoList SPFX app has been published.*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.10.24-am-1836x836.png)
*Open Teams and select the Apps item from left hand menu*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.10.37-am-1456x688.png)
*esp8266*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.12.20-am-1226x648.png)
*App is a "Personal app" (and not a Tabs app)*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.12.39-am-1836x1088.png)
*Use Open button to open Personal App*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.12.53-am-1200x272.png)
*Add a To Do List item*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.13.48-am-1638x710.png)
*Item is added to SharePoint list*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.13.59-am-1268x352.png)
*Update "isCompleted" status*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.14.08-am-1610x722.png)
*The isCompleted status updated in SharePoint List item*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.17.09-am-1300x768.png)
*Review TodoListWebPart.manifest.jsson*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.17.42-am-1118x214.png)
*Add "TeamsTab" option*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.18.27-am-1242x168.png)
*Use Teams: Deploy to the Cloud (to rebuild the sppkg file)*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.18.34-am-550x710.png)
*Build the SharePoint Package*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.23.33-am-966x412.png)
*Delete the SPFx App from Teams*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.23.43-am-1274x522.png)
*Delete "TodoList" SPFx app*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.24.28-am-1690x488.png)
*Notice that the SPFx app is gone*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.24.52-am-1338x746.png)
*Delete the app from SharePoint App Catalog*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.25.15-am-1644x990.png)
*After deleting the App from Teams and the SharePoint App Catalog... upload the new version*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.25.24-am-1764x986.png)
*Again "Add a document"*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.25.39-am-1486x876.png)
*Again select the "Make this solution available to all sites" checkbox*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.25.53-am-1302x880.png)
*Again click the "Sync to Teams" button*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.26.31-am-1778x788.png)
*New version of SPFx app is now published to Teams.*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.27.16-am-1836x765.png)
*New version of SPFx app is available in the Teams client app*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.27.26-am-1498x752.png)
*New version of SPFx app can be used as a "Personal app" or "Used in a tab"*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.28.18-am-1298x760.png)
*Add as a tab in a Teams Channel*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.28.34-am-1276x1244.png)
*Looks good*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.28.57-am-564x566.png)
*Error. The app assumes that a "To Do List" has been added to the Teams SharePoint Site.*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.30.00-am-1254x640.png)
*Navigate to the Team SharePoint Site and create a new list.*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.30.08-am-324x406.png)
*Create a blank list*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.31.31-am-1214x820.png)
*Name the list "To Do List"*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.31.59-am-1582x546.png)
*Add a "Single line of text" column*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.32.10-am-782x658.png)
*Name the column "description"*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.32.32-am-1558x592.png)
*Add a "Yes/No" column*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.32.40-am-786x630.png)
*Name the column "isComplete"*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.34.11-am-1216x694.png)
*Try adding the app as a tab again*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.34.24-am-1308x780.png)
*Select the Team and Channel*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.34.37-am-1234x1230.png)
*Looks good*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.34.51-am-1836x1073.png)
*The new tab has been added*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.35.11-am-822x376.png)
*Add a To Do List item*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.35.21-am-820x422.png)
*To Do List item added*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.35.33-am-1836x962.png)
*New SharePoint List Item has been created*

![](/assets/images/teamstoolkitspfx/screen-shot-2021-05-30-at-9.37.04-am-1836x1056.png)
*Code in SharePointListManager.ts communicates with SharePoint using well known REST methods*
## References

- [Teams Toolkit](https://docs.microsoft.com/en-us/microsoftteams/platform/get-started/prerequisites?tabs=vscode)

---

## threejs

**Source file:** `threejs.md`

---
title: "Three.js"
description: "A JavaScript-based WebGL engine"
date: "2023-03-05"
categories: ["JavaScript"]
tags: []
slug: "threejs"
image: "/assets/images/three.js-icon.svg"
---



Three. js is a JavaScript-based WebGL engine that can run GPU-powered games and other graphics-powered apps straight from the browser.


## Overview

In the code below I create a three.js scene. The scene contains

![](/assets/images/threejs/screen-shot-2023-03-05-at-7.42.09-pm-1536x414.png)
*import library modules and sets up scene*

![](/assets/images/threejs/screen-shot-2023-03-05-at-7.42.29-pm-1536x126.png)
*sets up camera*

![](/assets/images/threejs/screen-shot-2023-03-05-at-7.42.49-pm-1536x611.png)
*sets up floating cubes and spheres*

![](/assets/images/threejs/screen-shot-2023-03-05-at-7.43.18-pm-1536x422.png)
*sets up renderer*

![](/assets/images/threejs/screen-shot-2023-03-05-at-7.43.30-pm-1536x597.png)
*sets up animation*


## index-three-analyph

```text
// imports

        import * as THREE from 'three';
        import { AnaglyphEffect } from 'three/addons/effects/AnaglyphEffect.js';

        // scene background (skybox)

        const path = 'https://threejs.org/examples/textures/cube/Park2/';
        const format = '.jpg';
        const urls = [
            path + 'posx' + format, path + 'negx' + format,
            path + 'posy' + format, path + 'negy' + format,
            path + 'posz' + format, path + 'negz' + format
        ];

        const textureCube = new THREE.CubeTextureLoader().load(urls);

        // scene

        const scene = new THREE.Scene();
        scene.background = textureCube;

        // camera

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.01, 100);
        camera.position.z = 3;
        camera.focalLength = 3;

        // floating things

        const floaters = [];

        const geometryBox = new THREE.BoxGeometry(0.1, 0.1, 0.1);
        const geometrySphere = new THREE.SphereGeometry(0.1, 32, 16);
        const materialFloaters = new THREE.MeshBasicMaterial({ color: 0xffffff, envMap: textureCube });

        for (let i = 0; i < 250; i++) {

            const cube = new THREE.Mesh(geometryBox, materialFloaters);

            cube.position.x = Math.random() * 10 - 5;
            cube.position.y = Math.random() * 10 - 5;
            cube.position.z = Math.random() * 10 - 5;

            cube.scale.x = cube.scale.y = cube.scale.z = Math.random() * 3 + 1;

            scene.add(cube);

            floaters.push(cube);

        }

        for (let i = 0; i < 250; i++) {

            const sphere = new THREE.Mesh(geometrySphere, materialFloaters);

            sphere.position.x = Math.random() * 10 - 5;
            sphere.position.y = Math.random() * 10 - 5;
            sphere.position.z = Math.random() * 10 - 5;

            sphere.scale.x = sphere.scale.y = sphere.scale.z = Math.random() * 3 + 1;

            scene.add(sphere);

            floaters.push(sphere);

        }

        // renderer

        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.xr.enabled = true;

        const effect = new AnaglyphEffect(renderer);
        effect.setSize(window.innerWidth, window.innerHeight);

        document.body.appendChild(renderer.domElement);

        window.addEventListener('resize', onWindowResize);

        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            effect.setSize(window.innerWidth, window.innerHeight);

        }

        function animate() {

            requestAnimationFrame(animate);

            render();

        }

        // render scene

        function render() {

            const timer = 0.0001 * Date.now();

            camera.lookAt(scene.position);

            for (let i = 0, il = floaters.length; i < il; i++) {

                const floater = floaters[i];

                floater.position.x = 5 * Math.cos(timer + i);
                floater.position.y = 5 * Math.sin(timer + i * 1.1);

            }

            effect.render(scene, camera);

        }

        animate()
```
## References

- [three.js examples](https://threejs.org/examples/?q=effects#webgl_effects_anaglyph)

- [haddley-three-stereo](https://haddley.github.io/three/haddley-three-stereo.html)

- [haddley-three-vr.html](https://haddley.github.io/three/haddley-three-vr.html)

---

## threetier

**Source file:** `threetier.md`

---
title: "Blazor WASM API SQL Server Stored Procedure"
description: "Three Tiers"
date: "2023-03-25"
categories: [".NET","SQL"]
tags: []
slug: "threetier"
image: "/assets/images/net-logo.svg"
---



Visual Studio includes an ASP.NET Core Single Page Application (SPA) template that supports Blazor WASM.

Here I demonstrate how Blazer Web Assembly, ASP.NET Core and Microsoft SQL Server can be configured to work together.


## ChatGPT

**How do I create an ASP.NET application that connects to SQL Server and has a Blazor Web Assembly UI using Individual authentication?**

To create an ASP.NET application that connects to SQL Server and has a Blazor Web Assembly UI using Individual authentication, you can follow these steps:

Create a new ASP.NET Core Web Application project in Visual Studio.
Choose Blazor WebAssembly as the project template.
Choose Individual Accounts as the authentication type.
Choose the ASP.NET Core hosted option, which will create a separate server project and a client-side Blazor WebAssembly project.
Click Create to create the project.
In the server project, open the appsettings.json file and add a connection string to your SQL Server database.
Install the Microsoft.EntityFrameworkCore.SqlServer NuGet package in the server project.
Create a DbContext class that inherits from Microsoft.EntityFrameworkCore.DbContext and represents your database schema.
In the DbContext class, add a DbSet property for each entity you want to work with.
In the ConfigureServices method of the server's Startup.cs file, add a call to AddDbContext to register your DbContext with the application's dependency injection system.
In the client-side Blazor project, create a service class that uses HttpClient to call the server-side API methods you want to use.
Use dependency injection to inject the service class into your Blazor components, and call its methods as needed.

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.33.18-pm-1430x872.png)
*Visual Studio 2022 for Mac (ASP.NET Core is cross platform)*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.33.48-pm-1536x1086.png)
*Blazor WebAssembly App template*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.34.12-pm-1536x1090.png)
*Individual Authentication (local app.db database)*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.34.35-pm-1536x1085.png)
*I named the project/solution haddley_blazor_api (notice that in names the ASP.NET Core code generators seem to prefer underscores over dashes)*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.35.13-pm-1536x841.png)
*I reviewed the generated projects*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.35.48-pm-1536x926.png)
*I ran the ASP.NET Core web site*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.35.58-pm-1536x926.png)
*I created an account and logged in*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.37.36-pm-1536x328.png)
*dotnet add package Microsoft.EntityFrameworkCore.SqlServer --version 6.0.15*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.48.59-pm-1536x230.png)
*dotnet ef dbcontext scaffold "server=192.168.0.3;initial catalog=ToDo;user id=sa;password=Passw0rd123" Microsoft.EntityFrameworkCore.SqlServer -o Models --data-annotations --force*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.49.13-pm-1536x492.png)
*I reviewed the entity framework classes generated from the database schema*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.55.33-pm-1536x956.png)
*I selected the API Controller with actions using Entity Framework*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.55.58-pm-1484x706.png)
*I created a ToControl to handle requests to /api/ToDo*

![](/assets/images/threetier/screen-shot-2023-03-25-at-3.59.20-pm-1536x790.png)
*I reviewed the generated controller code*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.00.31-pm-1536x287.png)
*I tested the ToDo controller by navigating to /api/ToDo.*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.03.07-pm-630x238.png)
*I moved the Item.cs file to the Shared project (so that it could be used by the Server and the Client projects.*

![](/assets/images/threetier/screen-shot-2023-03-25-at-5.33.26-pm-1536x649.png)
*builder.Services.AddDbContext(options => options.UseSqlServer("server=192.168.0.3;initial catalog=ToDo;user id=sa;password=Passw0rd123"));*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.17.07-pm-1536x593.png)
*I was able to login*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.17.27-pm-1536x384.png)
*I was able to view the todo items using the new Razor page.*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.18.52-pm-1536x268.png)
*I updated the application's navigation menu*

![](/assets/images/threetier/screen-shot-2023-03-25-at-5.36.49-pm-1536x482.png)
*I created a stored procedure to return the to do items*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.45.22-pm-1536x278.png)
*I updated the API implementation to use the stored procedure*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.45.49-pm-1536x348.png)
*I reviewed the To Do page (populated using the stored procedure)*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.53.15-pm-1536x670.png)
*I updated the stored procedure to prefix each description with "Urgent "*

![](/assets/images/threetier/screen-shot-2023-03-25-at-4.53.26-pm-1536x503.png)
*I refreshed the To Do page*

---

## ticktacktoe

**Source file:** `ticktacktoe.md`

---
title: "Multiplayer Tick-Tack-Toe"
description: "Creating a new firebase project"
date: "2023-05-10"
categories: ["AI","React"]
tags: []
slug: "ticktacktoe"
image: "/assets/images/logo-lockup-firebase-vertical.svg"
---


I asked ChatGPT for some help creating a multiplayer version of Tick-Tack-Toe.


## ChatGPT

**How would I write a multiplayer tick-tack-toe game with Firebase Realtime Database, HTML, CSS and JavaScript?**

To write a multiplayer tic-tac-toe game with Firebase Realtime Database, HTML, CSS, and JavaScript, you can follow these general steps:

1. Set up a Firebase account and create a new project.
2. Create a new Firebase Realtime Database in your project.
3. Create an HTML file with the tic-tac-toe game board and UI elements. You can use CSS to style the board and UI elements.
4. Write JavaScript code to connect to your Firebase Realtime Database and set up the game logic.
5. When a player makes a move, update the game state in the database.
6. Listen for changes to the game state in the database and update the UI accordingly.
7. Implement game logic to detect a win or a tie and update the database and UI accordingly.

Here's an example implementation of the above steps:

...

![](/assets/images/ticktacktoe/screen-shot-2023-05-09-at-2.56.33-pm-1802x844.png)
*project name*

![](/assets/images/ticktacktoe/screen-shot-2023-05-09-at-2.57.24-pm-1804x874.png)
*google analytics?*

![](/assets/images/ticktacktoe/screen-shot-2023-05-09-at-2.58.10-pm-1690x910.png)
*project is ready*

![](/assets/images/ticktacktoe/screen-shot-2023-05-09-at-3.03.30-pm-1836x913.png)
*add web app*

![](/assets/images/ticktacktoe/screen-shot-2023-05-09-at-3.04.16-pm-1836x977.png)
*sdk setup*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.17.39-am-1836x567.png)
*Add Realtime Database*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.18.28-am-1836x530.png)
*create databse*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.19.05-am-1836x634.png)
*database location*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.19.16-am-1836x783.png)
*security rules (authentication is not enabled yet)*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.19.37-am-1836x571.png)
*Realtime Database is empty*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-8.57.48-am-1366x828.png)
*example implementation*

![](/assets/images/ticktacktoe/screen-shot-2023-05-09-at-5.41.12-pm-1142x274.png)
*create a folder*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-12.00.13-pm-1836x643.png)
*Open with Live Server*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.38.28-am-1836x1189.png)
*code running locally*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.41.28-am-1836x1156.png)
*firebase init*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.42.33-am-1836x465.png)
*firebase deploy*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.44.06-am-1598x1100.png)
*public folder has been uploaded to firebase*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.45.53-am-1460x542.png)
*copy the html, css and javascript files to the public folder*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-9.46.35-am-1836x1189.png)
*code has been deployed to Firebase (access using https://haddley-tick-tack-toe.web.app/)*


## Adding authentication

**How do we know which player is which?**

To differentiate between players and determine which player made a move, you can incorporate user authentication into your tic-tac-toe game. Firebase Authentication can be utilized to handle user sign-up, sign-in, and tracking the current user.

Here's an updated version of the makeMove function that incorporates user authentication:

...

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-12.00.57-pm-1836x625.png)
*dashboard*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-12.01.09-pm-1836x450.png)
*authentication*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-12.01.20-pm-1836x764.png)
*Anonymous*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-12.01.30-pm-1836x729.png)
*Anonymous Enabled*


## ChatGPT's commentary

This code initializes and sets up a tic-tac-toe game using Firebase as the backend database. Here's an explanation of the code:

1. Firebase Configuration: The code defines the configuration object firebaseConfig that contains the necessary credentials and configuration options for connecting to the Firebase project.
2. Firebase Initialization: The code initializes Firebase using the provided configuration object by calling firebase.initializeApp(firebaseConfig).
3. Anonymous Authentication: The code signs in the user anonymously by calling firebase.auth().signInAnonymously(). This allows the user to play the game without requiring any authentication.
4. Database Reference: The code obtains a reference to the Firebase Realtime Database service by calling firebase.database(). This reference will be used to interact with the game state data in the database.
5. Game State: The code defines the initial game state and related constants. The gameState object stores information such as the current player, the game board, and the game status.
6. UI Elements: The code retrieves references to various elements in the HTML document that represent the game board and the status message.
7. Update UI: The updateUI() function is responsible for updating the user interface based on the current game state. It updates the game board cells and the status message.
8. Make Move: The makeMove(row, col) function is called when a user clicks on a game board cell. It checks if the game is still in progress, verifies the user's turn, and updates the game board if the move is valid. It also checks for a win or draw condition and updates the game state accordingly.
9. Win Condition: The hasPlayerWon(player) function checks if a player has won the game by examining the game board.
10. Board Full Condition: The isBoardFull() function checks if the game board is full and there is no winner, resulting in a draw.
11. Reset Game: The resetGame() function resets the game state to the default values and updates the database with the new state.
12. Initialize Game: The initGame() function sets up event listeners for the game board cells and the reset button. It also listens for changes in the game state data in the database and updates the local game state and UI accordingly.
13 DOMContentLoaded Event: The initGame() function is called when the DOM (Document Object Model) is fully loaded, ensuring that the game setup is performed when the page is ready.

Overall, this code provides the functionality for playing a tic-tac-toe game in a web browser using Firebase for real-time updates and synchronization of the game state between multiple players.

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-3.06.41-pm-1836x1175.png)
*updated code*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-3.10.52-pm-1452x540.png)
*firebase deploy*

![](/assets/images/ticktacktoe/screen-shot-2023-05-10-at-3.14.17-pm-1836x1248.png)
*deployed*


## SDK setup

```text
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAw86TBoGMBkdTHnhs28zKCiVvvkNEcPqM",
    authDomain: "haddley-tick-tack-toe.firebaseapp.com",
    projectId: "haddley-tick-tack-toe",
    storageBucket: "haddley-tick-tack-toe.appspot.com",
    messagingSenderId: "762869781957",
    appId: "1:762869781957:web:02d5bd65bd1d1661dc27ac"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
</script>
```

## index.html

```text
<!DOCTYPE html>
<html>
  <head>
    <title>Tic Tac Toe</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1>Tic Tac Toe</h1>
    <div id="board">
      <div class="row">
        <div class="cell" id="cell00"></div>
        <div class="cell" id="cell01"></div>
        <div class="cell" id="cell02"></div>
      </div>
      <div class="row">
        <div class="cell" id="cell10"></div>
        <div class="cell" id="cell11"></div>
        <div class="cell" id="cell12"></div>
      </div>
      <div class="row">
        <div class="cell" id="cell20"></div>
        <div class="cell" id="cell21"></div>
        <div class="cell" id="cell22"></div>
      </div>
    </div>
    <div id="status"></div>
    <button id="reset">Reset</button>

    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-database.js"></script>
    <script src="app.js"></script>
  </body>
</html>
```

## style.css

```text
#board {
    display: flex;
    flex-direction: column;
  }
  
  .row {
    display: flex;
    flex-direction: row;
  }
  
  .cell {
    width: 100px;
    height: 100px;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 48px;
    cursor: pointer;
  }
  
  .cell:hover {
    background-color: #f1f1f1;
  }
  
  #status {
    margin-top: 20px;
    font-size: 24px;
  }
  
  #reset {
    margin-top: 20px;
  }
```

## app.js

```text
// Initialize Firebase
const firebaseConfig = {
    apiKey: "AIzaSyAw86TBoGMBkdTHnhs28zKCiVvvkNEcPqM",
    authDomain: "haddley-tick-tack-toe.firebaseapp.com",
    projectId: "haddley-tick-tack-toe",
    storageBucket: "haddley-tick-tack-toe.appspot.com",
    messagingSenderId: "762869781957",
    appId: "1:762869781957:web:02d5bd65bd1d1661dc27ac"
};

firebase.initializeApp(firebaseConfig);

// Get a reference to the database service
const database = firebase.database();

// Game state
let gameState = {
    currentPlayer: 'X',
    board: [
        ['', '', ''],
        ['', '', ''],
        ['', '', ''],
    ],
};

// Game board elements
const boardCells = [
    document.getElementById('cell00'),
    document.getElementById('cell01'),
    document.getElementById('cell02'),
    document.getElementById('cell10'),
    document.getElementById('cell11'),
    document.getElementById('cell12'),
    document.getElementById('cell20'),
    document.getElementById('cell21'),
    document.getElementById('cell22'),
];


// Update the UI with the current game state
function updateUI() {
    const { board, currentPlayer } = gameState;

    // Update each cell on the board
    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            const cell = document.getElementById(`cell${i}${j}`);
            cell.textContent = board[i][j];
        }
    }

    // Update the status message
    const statusElement = document.getElementById('status');
    statusElement.textContent = `Current Player: ${currentPlayer}`;
}

// Make a move
function makeMove(row, col) {
    const { board, currentPlayer } = gameState;

    // Check if the selected cell is empty
    if (board[row][col] === '') {
        // Update the board with the current player's symbol
        board[row][col] = currentPlayer;

        // Check if the current player has won
        if (hasPlayerWon(currentPlayer)) {
            alert(`Player ${currentPlayer} has won!`);
            resetGame();
        } else {
            // Check if the board is full
            if (isBoardFull()) {
                alert('The game is a draw!');
                resetGame();
            } else {
                // Switch to the other player
                gameState.currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
            }
        }

        // Update the game state in the database
        database.ref('gameState').set(gameState);
    }
}

// Check if a player has won
function hasPlayerWon(player) {
    const { board } = gameState;
  
    // Check rows
    for (let i = 0; i < 3; i++) {
      if (board[i][0] === player && board[i][1] === player && board[i][2] === player) {
        return true;
      }
    }
  
    // Check columns
    for (let j = 0; j < 3; j++) {
      if (board[0][j] === player && board[1][j] === player && board[2][j] === player) {
        return true;
      }
    }
  
    // Check diagonals
    if (board[0][0] === player && board[1][1] === player && board[2][2] === player) {
      return true;
    }
    if (board[0][2] === player && board[1][1] === player && board[2][0] === player) {
      return true;
    }
  
    return false;
  }

  

// Check if the game board is full
function isBoardFull() {
    const { board } = gameState;
  
    // Check each cell on the board
    for (let i = 0; i < 3; i++) {
      for (let j = 0; j < 3; j++) {
        if (board[i][j] === '') {
          return false;
        }
      }
    }
  
    return true;
  }
  

// Reset the game
function resetGame() {
    // Reset the game state
    gameState = {
        currentPlayer: 'X',
        board: [
            ['', '', ''],
            ['', '', ''],
            ['', '', ''],
        ],
    };

    // Clear the board in the database
    database.ref('gameState').set(gameState);
}

// Initialize the game
function initGame() {
    // Attach click event listeners to each cell
    const cells = document.getElementsByClassName('cell');
    for (let i = 0; i < cells.length; i++) {
        const cell = cells[i];
        const row = Math.floor(i / 3);
        const col = i % 3;
        cell.addEventListener('click', () => makeMove(row, col));
    }

    // Attach click event listener to the reset button
    const resetButton = document.getElementById('reset');
    resetButton.addEventListener('click', resetGame);

    // Listen for changes in the game state
    database.ref('gameState').on('value', (snapshot) => {
        const gameStateFromLiveDatabase = snapshot.val();
        if (gameStateFromLiveDatabase) {
            gameState = gameStateFromLiveDatabase;
        }
        updateUI();
    });
}

// Call the initGame function when the DOM is ready
document.addEventListener('DOMContentLoaded', initGame);
```

## Security Rules updated

```text
{
  "rules": {
    "gameState": {
      ".read": "auth != null",
      ".write": "auth != null"
    }
  }
}
```

## index.html updated

```text
<!DOCTYPE html>
<html>

<head>
    <title>Tic Tac Toe</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <h1>Tic Tac Toe</h1>
    <div id="board">
        <div class="row">
            <div class="cell" id="cell00"></div>
            <div class="cell" id="cell01"></div>
            <div class="cell" id="cell02"></div>
        </div>
        <div class="row">
            <div class="cell" id="cell10"></div>
            <div class="cell" id="cell11"></div>
            <div class="cell" id="cell12"></div>
        </div>
        <div class="row">
            <div class="cell" id="cell20"></div>
            <div class="cell" id="cell21"></div>
            <div class="cell" id="cell22"></div>
        </div>
    </div>
    <div id="whoami"></div>
    <div id="status"></div>
    <button id="reset">Reset</button>

    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-database.js"></script>
    <script src="app.js"></script>
</body>

</html>
```

## style.css updated

```text
#board {
    display: flex;
    flex-direction: column;
}

.row {
    display: flex;
    flex-direction: row;
}

.cell {
    width: 100px;
    height: 100px;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 48px;
    cursor: pointer;
}

.cell:hover {
    background-color: #f1f1f1;
}

#status {
    margin-top: 20px;
    font-size: 24px;
}

#whoami {
    margin-top: 20px;
    font-size: 24px;
}

#reset {
    margin-top: 20px;
}
```

## app.js updated

```text
// Initialize Firebase
const firebaseConfig = {
    apiKey: "AIzaSyAw86TBoGMBkdTHnhs28zKCiVvvkNEcPqM",
    authDomain: "haddley-tick-tack-toe.firebaseapp.com",
    projectId: "haddley-tick-tack-toe",
    storageBucket: "haddley-tick-tack-toe.appspot.com",
    messagingSenderId: "762869781957",
    appId: "1:762869781957:web:02d5bd65bd1d1661dc27ac"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

// Sign in anonymously
firebase.auth().signInAnonymously().catch((error) => {
    var errorCode = error.code;
    var errorMessage = error.message;
    console.log(errorCode, errorMessage);
});

// Get a reference to the database service
const database = firebase.database();

// Game state
let gameState;
const states = {
    Playing: "playing",
    XWon: "xwon",
    OWon: "owon",
    Draw: "draw"
};

const defaultGameState = {
    hostUID: null, // Replace with actual host user's UID
    currentPlayer: 'X',
    board: [
        ['', '', ''],
        ['', '', ''],
        ['', '', ''],
    ],
    status: states.Playing
};

// Game board elements
const boardCells = [
    document.getElementById('cell00'),
    document.getElementById('cell01'),
    document.getElementById('cell02'),
    document.getElementById('cell10'),
    document.getElementById('cell11'),
    document.getElementById('cell12'),
    document.getElementById('cell20'),
    document.getElementById('cell21'),
    document.getElementById('cell22'),
];

// Update the UI with the current game state
function updateUI() {
    const { board, currentPlayer, status, hostUID } = gameState;

    // Update each cell on the board
    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            const cell = document.getElementById(`cell${i}${j}`);
            cell.textContent = board[i][j];
        }
    }

    // Update the status message
    const statusElement = document.getElementById('status');
    switch (status) {
        case states.XWon:
            statusElement.textContent = `Player X has won!`;
            break;
        case states.OWon:
            statusElement.textContent = `Player O has won!`;
            break;
        case states.Draw:
            statusElement.textContent = `The game is a draw!`;
            break;
        case states.Playing:
        default:
            statusElement.textContent = `Current Player: ${currentPlayer}`;
    }

    const user = firebase.auth().currentUser;
    const whoAmIElement = document.getElementById('whoami');
    if (user.uid === hostUID) {
        whoAmIElement.textContent = `You are X`;
    } else {
        whoAmIElement.textContent = `You are O`;
    }
}

// Make a move
function makeMove(row, col) {
    const { board, currentPlayer, hostUID, status } = gameState;

    if (status !== states.Playing) {
        // The game is over, ignore the move
        return;
    }

    const user = firebase.auth().currentUser;
    if (!user) {
        // User is not authenticated, handle the authentication requirement
        console.log("Please sign in or create an account to play.");
        return;
    }

    if ((user.uid === hostUID && currentPlayer === 'X') || (user.uid !== hostUID && currentPlayer === 'O')) {
        if (board[row][col] === '') {
            board[row][col] = currentPlayer;

            if (hasPlayerWon(currentPlayer)) {
                console.log(`Player ${currentPlayer} has won the game!`);
                gameState.status = currentPlayer === 'X' ? states.XWon : states.OWon;
            } else if (isBoardFull()) {
                console.log("It's a tie!");
                gameState.status = states.Draw;
            } else {
                gameState.currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
            }

            database.ref('gameState').set(gameState);
        }
    } else {
        console.log("It's not your turn.");
    }
}

// Check if a player has won
function hasPlayerWon(player) {
    const { board } = gameState;

    for (let i = 0; i < 3; i++) {
        if (board[i][0] === player && board[i][1] === player && board[i][2] === player) {
            return true;
        }
    }

    for (let j = 0; j < 3; j++) {
        if (board[0][j] === player && board[1][j] === player && board[2][j] === player) {
            return true;
        }
    }

    if (board[0][0] === player && board[1][1] === player && board[2][2] === player) {
        return true;
    }

    if (board[0][2] === player && board[1][1] === player && board[2][0] === player) {
        return true;
    }

    return false;
}

// Check if the game board is full
function isBoardFull() {
    const { board } = gameState;

    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            if (board[i][j] === '') {
                return false;
            }
        }
    }

    return true;
}

// Reset the game
function resetGame() {
    gameState = defaultGameState;
    gameState.hostUID = firebase.auth().currentUser.uid;
    database.ref('gameState').set(gameState);
}

// Initialize the game
function initGame() {
    const cells = document.getElementsByClassName('cell');

    for (let i = 0; i < cells.length; i++) {
        const cell = cells[i];
        const row = Math.floor(i / 3);
        const col = i % 3;
        cell.addEventListener('click', () => makeMove(row, col));
    }

    const resetButton = document.getElementById('reset');
    resetButton.addEventListener('click', resetGame);

    database.ref('gameState').on('value', (snapshot) => {
        const gameStateFromLiveDatabase = snapshot.val();

        if (!gameStateFromLiveDatabase) {
            gameState = defaultGameState;
            gameState.hostUID = firebase.auth().currentUser.uid;
            database.ref('gameState').set(gameState);
            return;
        }

        gameState = gameStateFromLiveDatabase;
        updateUI();
    });
}

// Call the initGame function when the DOM is ready
document.addEventListener('DOMContentLoaded', initGame);
```

---

## topics

**Source file:** `topics.md`

---
title: "Copilot"
description: "Topics"
date: "2024-02-25"
categories: ["Power Platform","Microsoft Dynamics","Business Central"]
tags: []
slug: "topics"
image: "/assets/images/office-365-icon-500x500.png"
---



I created a Topic that used the Business Central Connector to retrieve the list of Companies created on my Production Business Server environment.

![](/assets/images/topics/screenshot-2024-02-25-at-3.54.16-pm-1836x788.png)
*There were three Companies in my PRODUCTION environment*

![](/assets/images/topics/screenshot-2024-02-25-at-3.54.57-pm-1836x1152.png)
*I created a new Copilot and asked it to provide a "list of companies"It replied "I'm sorry..."*

![](/assets/images/topics/screenshot-2024-02-25-at-3.55.11-pm-1836x493.png)
*I created a new Topic|From blank*

![](/assets/images/topics/screenshot-2024-02-25-at-3.55.51-pm-1836x827.png)
*I added the Phrases "list of companies" and "company list"*

![](/assets/images/topics/screenshot-2024-02-25-at-3.57.20-pm-1836x1038.png)
*I selected Call an action|Connector (preview) and selected the "List companies (V3)" action*

![](/assets/images/topics/screenshot-2024-02-25-at-3.57.32-pm-1836x1043.png)
*I clicked the Submit button*

![](/assets/images/topics/screenshot-2024-02-25-at-3.57.55-pm-1836x1037.png)
*The Connector action was added to the Topic*

![](/assets/images/topics/screenshot-2024-02-25-at-3.58.07-pm-1836x352.png)
*I provided the Environment (String) PRODUCTION*

![](/assets/images/topics/screenshot-2024-02-25-at-3.58.24-pm-1836x1039.png)
*I Variable management|Set a variable value*

![](/assets/images/topics/screenshot-2024-02-25-at-3.58.55-pm-1836x607.png)
*I set the variable name to Var1 and the value to GetCompaniesV3.value*

![](/assets/images/topics/screenshot-2024-02-25-at-3.59.36-pm-1836x1040.png)
*<<<<<< REPLACE WITH TEXT >>>>>>>*

![](/assets/images/topics/screenshot-2024-02-25-at-4.00.06-pm-1836x1039.png)
*I added Message to return the Var1 table to the user*

![](/assets/images/topics/screenshot-2024-02-25-at-4.01.17-pm-1836x1039.png)
*I created a second variable Var2.I set the value of Var2 to the list of Company DisplayNames separated by ", "*

![](/assets/images/topics/screenshot-2024-02-25-at-4.02.52-pm-1836x1040.png)
*I added Topic management|End current topic*

![](/assets/images/topics/screenshot-2024-02-25-at-4.03.47-pm-1836x1040.png)
*I entered "list of companies" into the Copilot.The Copilot returned the three company names.*

---

## vbnetconsolesqlserverunittests

**Source file:** `vbnetconsolesqlserverunittests.md`

---
title: "VB.NET Console SQL Server Unit Tests"
description: "Test driven development"
date: "2023-05-27"
categories: ["SQL","AI",".NET"]
tags: []
slug: "vbnetconsolesqlserverunittests"
image: "/assets/images/net-logo.svg"
---



Unit tests are automated tests written and run by software developers to ensure that a section of an application (known as the "unit") meets its design and behaves as intended.

I wanted to add unit tests to a Visual Basic Console App that fetched data from a database using SqlConnection, SqlCommand, SqlDataAdapter and DataTable classes.

In any case it is best practice is for Unit Tests to run independent of a running database server.

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000001-890x625.png)
*I created a new project (in a new solution)*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000002-889x626.png)
*I selected the .NET Framework (old school)*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000003-890x624.png)
*I selected .NET Framework 4.7.2*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000004-1325x674.png)
*Main*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000005-1363x382.png)
*I added Hello World code*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000006-1359x567.png)
*I updated the Console Application to connect to a database and display the contents of a Tasks table*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000017-1361x656.png)
*I added a second project to the solution. I selected the Unit Test Project (.NET Framework) template*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000018-1362x683.png)
*I accepted the defaults*

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000019-1360x250.png)
*I added a reference to the Test project*


## ChatGPT

I asked ChatGPT to generate unit tests for the code.

**Write Unit Tests for this code

Imports System.Data.SqlClient

Module Module1
...**

To write unit tests for the given code, you can use a testing framework such as NUnit or xUnit. However, since the code primarily consists of database interactions and console output, it may not be feasible to write traditional unit tests for it.

Instead, you can consider refactoring the code to improve testability by separating concerns. One approach could be to move the database-related code into a separate class or method that returns the result DataTable. Then, you can write unit tests specifically for that database-related code.

Here's an example of how you can refactor the code and write unit tests for the database interaction part using NUnit:

...

![](/assets/images/vbnetconsolesqlserverunittests/database-unit-test-1366x728.png)
*Database Tests*


## Refactoring the code with testing in mind

As ChatGPT explained it is hard to create Unit Tests for the database and Console code contained in the Module1.vb. 

It does not help that the database access and Console.WriteLine code is mixed together in a single block.

I extracted the WriteDataTable code to create a function that was easier to create Unit Tests for.

I wrote the UnitTestProject2 tests with the help of ChatGPT.

![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000020-1098x244.png)
*The WriteDataTable function expects to be passed a DataTable.*

![](/assets/images/vbnetconsolesqlserverunittests/mixed-unit-tests-1366x728.png)
*Running the Unit Tests*


## UnitTest1.vb

```text
Imports System.Data.SqlClient
Imports System.Text
Imports Microsoft.VisualStudio.TestTools.UnitTesting


<TestClass()> Public Class DatabaseTests
    Private ReadOnly connectionString As String = "Data Source=(local);Initial Catalog=ToDo;user id=sa;password=Passw0rd123"

    <TestMethod()>
    Public Sub GetData_ShouldReturnValidDataTable()
        ' Arrange
        Dim database As New DatabaseInteraction(connectionString)

        ' Act
        Dim result As DataTable = database.GetData()

        ' Assert
        Assert.IsNotNull(result)
        Assert.IsTrue(result.Rows.Count > 0)
    End Sub
End Class

Public Class DatabaseInteraction
    Private ReadOnly connectionString As String

    Public Sub New(connectionString As String)
        Me.connectionString = connectionString
    End Sub

    Public Function GetData() As DataTable
        Dim query As String = "SELECT * FROM Items"
        Dim result As DataTable = Nothing

        Using connection As New SqlConnection(connectionString)
            connection.Open()
            Using command As New SqlCommand(query, connection)
                Using adapter As New SqlDataAdapter(command)
                    result = New DataTable()
                    adapter.Fill(result)
                End Using
            End Using
        End Using

        Return result
    End Function
End Class
```

## Module1.vb

```text
Imports System.Data.SqlClient

Public Module Module1

    Private ReadOnly connectionString As String = "Data Source=(local);Initial Catalog=ToDo;user id=sa;password=Passw0rd123"

    Sub Main()
        Console.WriteLine("Tasks")

        Dim query As String = "SELECT * FROM Items"
        Dim result As DataTable = Nothing
        Using connection As New SqlConnection(connectionString)
            connection.Open()
            Using command As New SqlCommand(query, connection)
                Using adapter As New SqlDataAdapter(command)
                    result = New DataTable()
                    adapter.Fill(result)

                    WriteDataTable(result)

                End Using
            End Using
        End Using

        Console.ReadLine()
    End Sub

    Public Function WriteDataTable(result As DataTable)
        Console.WriteLine("{0,10}{1,20}{2,7}", "ID", "Description", "Done")

        Dim count As Integer = 0
        For Each row As DataRow In result.Rows
            Console.WriteLine("{0,10}{1,20}{2,7}", row("ID"), row("Description"), row("Done"))
            count = count + 1
        Next

        Return count
    End Function
End Module
```

## UnitTestProject1 - UnitTest1.vb

```text
mports System.Data.SqlClient
Imports System.Text
Imports Microsoft.VisualStudio.TestTools.UnitTesting

<TestClass()> Public Class UnitTest1

    Private ReadOnly connectionString As String = "Data Source=(local);Initial Catalog=ToDo;user id=sa;password=Passw0rd123"

    Private _dataTable As New DataTable()

    <TestInitialize>
    Public Sub intialize()

        'reset the test data before each test method is executed
        _dataTable = New DataTable()

        ' Create the example result DataTable
        _dataTable.Columns.Add("ID", GetType(Integer))
        _dataTable.Columns.Add("Description", GetType(String))
        _dataTable.Columns.Add("Done", GetType(Boolean))

        _dataTable.Rows.Add(1000, "Feed Dog", False)

    End Sub

    <TestMethod>
    Public Sub TestDataFromDataTable()

        ' Act
        Dim count = ConsoleApp1.WriteDataTable(_dataTable)

        ' Assert
        Assert.IsNotNull(_dataTable)
        Assert.IsTrue(_dataTable.Rows.Count = 1)
        Assert.IsTrue(count = _dataTable.Rows.Count)
    End Sub

    <TestMethod>
    Public Sub TestDataFromDataTableAddItem()

        'Arrange 
        _dataTable.Rows.Add(1001, "Feed Cat", False)

        ' Act
        Dim count = ConsoleApp1.WriteDataTable(_dataTable)

        ' Assert
        Assert.IsNotNull(_dataTable)
        Assert.IsTrue(_dataTable.Rows.Count = 2)
        Assert.IsTrue(count = _dataTable.Rows.Count)
    End Sub


    <TestMethod>
    Public Sub TestDataFromDataTableAddTwoItems()

        'Arrange 
        _dataTable.Rows.Add(1001, "Feed Snake", False)
        _dataTable.Rows.Add(1001, "Feed Mouse", False)

        ' Act
        Dim count = ConsoleApp1.WriteDataTable(_dataTable)

        ' Assert
        Assert.IsNotNull(_dataTable)
        Assert.IsTrue(_dataTable.Rows.Count = 3)
        Assert.IsTrue(count = _dataTable.Rows.Count)
    End Sub


    <TestMethod>
    Public Sub SelectDataFromDatabaseTest()
        ' Arrange
        Dim query As String = "SELECT * FROM Items"
        Dim result As DataTable = Nothing
        Dim count As Integer = 0

        ' Act
        Using connection As New SqlConnection(connectionString)
            connection.Open()
            Using command As New SqlCommand(query, connection)
                Using adapter As New SqlDataAdapter(command)
                    result = New DataTable()
                    adapter.Fill(result)

                    count = ConsoleApp1.WriteDataTable(result)

                End Using
            End Using
        End Using

        ' Assert
        Assert.IsNotNull(result)
        Assert.IsTrue(result.Rows.Count > 0)
        Assert.IsTrue(count = result.Rows.Count)
    End Sub


End Class
```

## UnitTestProject2 - UnitTest1.vb

```text
Imports System.Data.SqlClient
Imports System.IO
Imports ConsoleApp1

<TestClass()> Public Class DatabaseTests
    Private ReadOnly connectionString As String = "Data Source=(local);Initial Catalog=ToDo;user id=sa;password=Passw0rd123"

    <TestMethod()>
    Public Sub GetData_ShouldReturnValidDataTable()
        ' Arrange
        Dim database As New DatabaseInteraction(connectionString)

        ' Act
        Dim result As DataTable = database.GetData()

        ' Assert
        Assert.IsNotNull(result)
        Assert.IsTrue(result.Rows.Count > 0)
    End Sub
End Class

Public Class DatabaseInteraction
    Private ReadOnly connectionString As String

    Public Sub New(connectionString As String)
        Me.connectionString = connectionString
    End Sub

    Public Function GetData() As DataTable
        Dim query As String = "SELECT * FROM Items"
        Dim result As DataTable = Nothing

        Using connection As New SqlConnection(connectionString)
            connection.Open()
            Using command As New SqlCommand(query, connection)
                Using adapter As New SqlDataAdapter(command)
                    result = New DataTable()
                    adapter.Fill(result)
                End Using
            End Using
        End Using

        Return result
    End Function
End Class




<TestClass()> Public Class Module1Tests
    Private ReadOnly connectionString As String = "Data Source=(local);Initial Catalog=ToDo;user id=sa;password=Passw0rd123"

    <TestMethod>
    Public Sub WriteDataTable_ShouldWriteCorrectData()
        ' Arrange
        Dim result As New DataTable()
        result.Columns.Add("ID", GetType(Integer))
        result.Columns.Add("Description", GetType(String))
        result.Columns.Add("Done", GetType(Boolean))
        result.Rows.Add(1, "Task 1", True)
        result.Rows.Add(2, "Task 2", False)

        Dim expectedOutput As String =
            "        ID         Description   Done" + vbCrLf +
            "         1              Task 1   True" + vbCrLf +
            "         2              Task 2  False" + vbCrLf

        ' Act
        Dim consoleOutput As String = CaptureConsoleOutput(Sub() Module1.WriteDataTable(result))

        Console.WriteLine("Expected")
        Console.WriteLine("<" + expectedOutput + ">")
        Console.WriteLine("Test Result")
        Console.WriteLine("<" + consoleOutput + ">")

        ' Assert
        Assert.AreEqual(expectedOutput, consoleOutput)
    End Sub

    ' Helper method to capture console output during testing
    Private Function CaptureConsoleOutput(action As Action) As String
        Dim originalOut As TextWriter = Console.Out
        Dim writer As New StringWriter()
        Console.SetOut(writer)
        action.Invoke()
        Console.SetOut(originalOut)
        Return writer.ToString()
    End Function
End Class
```

---

## vbnetwinforms

**Source file:** `vbnetwinforms.md`

---
title: "VB.NET WinForms and ASP.NET Core API"
description: "VB.NET WinForms Development"
date: "2023-03-27"
categories: [".NET"]
tags: []
slug: "vbnetwinforms"
image: "/assets/images/net-logo.svg"
---



**How do I create a VB.NET Forms app connected to an ASP.NET Core API?**

To create a VB.NET Forms app connected to an ASP.NET Core API, you can follow these general steps:

Create an ASP.NET Core API project:
You can create an ASP.NET Core Web API project using Visual Studio 2019 or newer. Choose the ASP.NET Core Web Application template and select the API project type.
Define your API endpoints:
Define your endpoints in the API project, and make sure they return the data your VB.NET Forms app will use. You can use various methods to create endpoints, such as MVC controllers or routing.
Build and run the API project:
Build and run your API project to ensure it's working correctly. You can use tools like Postman or curl to test the endpoints and verify that they return the expected data.
Create a VB.NET Forms app:
Create a new VB.NET Forms app project in Visual Studio. Add any necessary controls to the form, such as text boxes or buttons, that will interact with the API.
Add a reference to the API project:
Add a reference to the API project in your VB.NET Forms app project. You can do this by right-clicking on the project in the Solution Explorer and selecting "Add Reference."
Make API calls from your VB.NET Forms app:
Use the HttpClient class in your VB.NET Forms app to make requests to the API. You can use methods such as GetAsync or PostAsync to retrieve or send data to the API.
Process the API responses in your VB.NET Forms app:
Handle the responses from the API in your VB.NET Forms app. You can deserialize JSON responses into objects using libraries such as Newtonsoft.Json. You can then use these objects to populate the controls on your form.
These are just general steps, and the specific implementation may vary depending on your requirements.

![](/assets/images/vbnetwinforms/capture20230127-001-1011x676.png)
*I created a new project/solution*

![](/assets/images/vbnetwinforms/capture20230127-002-1011x676.png)
*I selected the ASP.NET Core Web API template (with swagger)*

![](/assets/images/vbnetwinforms/capture20230127-003-1013x671.png)
*I named the Web Application*

![](/assets/images/vbnetwinforms/capture20230127-004-1012x674.png)
*I selected the .NET Core Framework version*

![](/assets/images/vbnetwinforms/capture20230127-005-1368x730.png)
*I tested the API*

![](/assets/images/vbnetwinforms/capture20230127-006-1045x572.png)
*Using Swagger User Interface*

![](/assets/images/vbnetwinforms/capture20230127-007-741x590.png)
*I added a second project*

![](/assets/images/vbnetwinforms/captureaa-05-1011x676.png)
*I selected the VB.NET Windows Forms App template*

![](/assets/images/vbnetwinforms/captureaa-06-1011x672.png)
*I gave the WinForms app a name*

![](/assets/images/vbnetwinforms/captureaa-07-1012x674.png)
*I selected a .NET Core version*

![](/assets/images/vbnetwinforms/captureaa-08-828x653.png)
*I added a reference from the VB.NET WinForms app to the ASP.NET app (providing the VB.NET application with a understanding of the WeatherForecast type)*

![](/assets/images/vbnetwinforms/20230128-783x541.png)
*I selected the API project*

![](/assets/images/vbnetwinforms/capture20230127-008-1036x703.png)
*I started the API project (dotnet run)*

![](/assets/images/vbnetwinforms/capture20230127-009-1369x729.png)
*I added a button and two labels to the VB.NET WinForm screen and VB.NET code to call the API.*


## Form1.vb

```text
Imports System.Net.Http
Imports WebApplicationAPI
Imports Newtonsoft.Json

Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        ' Create an instance of the HttpClient class
        Dim client As New HttpClient()

        ' Set the base address of the API
        client.BaseAddress = New Uri("https://localhost:7018/")

        ' Send an HTTP GET request to the API and receive the response
        Dim response As HttpResponseMessage = client.GetAsync("WeatherForecast").Result

        ' Check if the response was successful
        If response.IsSuccessStatusCode Then
            ' Read the response content as a string
            Dim result As String = response.Content.ReadAsStringAsync().Result

            ' Deserialize the JSON response into a .NET object
            Dim forecast As List(Of WeatherForecast) = JsonConvert.DeserializeObject(Of List(Of WeatherForecast))(result)

            ' Do something with the forecast data

            Label1.Text = forecast.First.Date

            Label2.Text = forecast.First.Summary

        Else
            ' Handle the error
        End If
    End Sub
End Class
```

---

## vendorpostinggroup

**Source file:** `vendorpostinggroup.md`

---
title: "Vendor Posting Group"
description: "Sub-ledgers"
date: "2023-12-12"
categories: ["Microsoft Dynamics","Business Central","Microsoft Dynamics"]
tags: []
slug: "vendorpostinggroup"
image: "/assets/images/posts-meta.svg"
---



In Microsoft Dynamics 365 Business Central, sub-ledgers are used to manage business operations.

Sub-ledgers include:

Item Ledger
Vendor Ledger
Detailed Vendor Ledger
Customer Ledger; and
Detailed Customer Ledger


## Posting Groups

In Microsoft Dynamics 365 Business Central, Posting Groups are used to "build a bridge" between Business Central sub-ledgers and the general ledger accounts.


A Vendor Posting Group is used to define which accounts payable general ledger account to use when purchasing goods from a Vendor.

Vendor Posting Groups are maintained using the Vendor Posting Groups page.

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-11-at-7.05.09-pm-1536x860.png)
*I used search to navigate to the Vendors page. I used + New to create a new Vendor*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-11-at-7.07.22-pm-1536x859.png)
*I entered Vendor details*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-11-at-7.07.54-pm-1536x860.png)
*I reviewed the Invoicing tab for the new Vendor*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-11.39.06-am-1536x996.png)
*I clicked the + New link*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-11.41.36-am-1536x996.png)
*I added code DOMESTIC and set Payables Account to 22100 (Account Payable, Domestic)*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-11.42.04-am-1536x998.png)
*Vendor Posting Group is set to DOMESTIC*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-11.51.39-am-1536x371.png)
*I used search to navigate to the General Journal page*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-11.54.14-am-1536x610.png)
*I created a Journal entry debiting the Finished Goods account*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-12.03.08-pm-1536x558.png)
*I set the Amount to $2,503 and the balancing Account Type to Vendor*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-12.03.53-pm-1536x554.png)
*I selected Vendor Fabrikam, Inc.*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-12.05.28-pm-1536x426.png)
*I clicked the Preview Posting button*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-12.05.55-pm-1536x393.png)
*The preview showed 2 General Ledger entries, 1 Vendor Ledger entry and 1 Detailed Vendor Ledger entry*

![](/assets/images/vendorpostinggroup/screen-shot-2023-12-12-at-12.06.33-pm-1536x311.png)
*The first general ledger entry relates to General Ledger account 14130 Finished Goods. The second general ledger entry relates to General Ledger account 22100 Accounts Payable, Domestic (per the DOMESTIC Vendor Posting Group).*

---

## voicekit

**Source file:** `voicekit.md`

---
title: "Voice Kit"
description: "Raspberry Pi Voice Kit"
date: "2025-10-11"
categories: ["Python","AI"]
tags: []
slug: "voicekit"
image: "/assets/images/raspberry-pi-logo.svg"
---


The Google AIY Voice Kit is a do-it-yourself version of a Google Home assistant. This kit includes a Raspberry Pi Zero computer, a speaker, a microphone, a button, and a cardboard casing for a hands-on build experience.

![](/assets/images/voicekit/C059C37E-B731-4377-8891-9C68A72568CB.png)
*Raspberry Pi Hat*

![](/assets/images/voicekit/FF078E6D-EA98-4E1E-976B-B036E33DA9F2.png)
*Cardboard assembled*

![](/assets/images/voicekit/Screenshot%202025-10-11%20at%204.12.07 PM.png)
*[Download image](https://github.com/google/aiyprojects-raspbian/releases)*

![](/assets/images/voicekit/Screenshot%202025-10-11%20at%204.10.12 PM.png)
*Image flashed to MicroSD Card*

![](/assets/images/voicekit/Screenshot%202025-10-11%20at%205.09.53 PM.png)
*I enabled xrdp and connected to pi remotely*



Notice that I had to run "apt-get --allow-releaseinfo-change update" to update the Buster image.

![](/assets/images/voicekit/Screenshot%202025-10-11%20at%205.21.15 PM.png)
*I ran the Check audio script*

![](/assets/images/voicekit/Screenshot%202025-10-11%20at%207.49.52 PM.png)
*I ran the voice_recorder script*

## voice_recorder.py

```python
#!/usr/bin/env python3
# Copyright 2017 Google Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

import argparse
import time
import threading

from aiy.board import Board
from aiy.voice.audio import AudioFormat, play_wav, record_file, Recorder

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('--filename', '-f', default='recording.wav')
    args = parser.parse_args()

    with Board() as board:
        print('Press button to start recording.')
        board.button.wait_for_press()

        done = threading.Event()
        board.button.when_pressed = done.set

        def wait():
            start = time.monotonic()
            while not done.is_set():
                duration = time.monotonic() - start
                print('Recording: %.02f seconds [Press button to stop]' % duration)
                time.sleep(0.5)

        record_file(AudioFormat.CD, filename=args.filename, wait=wait, filetype='wav')
        print('Press button to play recorded sound.')
        board.button.wait_for_press()

        print('Playing...')
        play_wav(args.filename)
        print('Done.')

if __name__ == '__main__':
    main()


```


## References

- [AIY](https://aiyprojects.withgoogle.com/voice-v1/)
- [xrdp](https://haddley.github.io/posts/pi1/)

---

## voicekit2

**Source file:** `voicekit2.md`

---
title: "Voice Kit 2"
description: "Google Assistant API"
date: "2025-10-16"
categories: ["Python","AI"]
tags: []
slug: "voicekit"
image: "/assets/images/raspberry-pi-logo.svg"
---

## Setup Context

### Note on Browser Compatibility

During setup, I encountered issues with the unsupported Chromium version in the Raspberry Pi image. This was resolved by installing Firefox, which properly handled the OAuth authentication flow required by the Google Assistant API.

```bash
pi@raspberrypi:~ $ sudo apt install firefox-esr
```

![](/assets/images/voicekit2/Screenshot%202025-10-16%20at%2012.14.19 PM.png)
*Google Cloud Console*

![](/assets/images/voicekit2/Screenshot%202025-10-16%20at%2012.27.12 PM.png)
*Credentials*

![](/assets/images/voicekit2/Screenshot%202025-10-16%20at%2012.34.06 PM.png)
*APIs & Services*

![](/assets/images/voicekit2/Screenshot%202025-10-16%20at%204.03.01 PM.png)
*assistant.json*

```json
{
    "installed": {
        "client_id": "<SPECIFIC TO YOU>.apps.googleusercontent.com",
        "project_id": "voice-assistant-haddley",
        "auth_uri": "https://accounts.google.com/o/oauth2/auth",
        "token_uri": "https://oauth2.googleapis.com/token",
        "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
        "client_secret": "<SPECIFIC TO YOU>",
        "redirect_uris": [
            "http://localhost"
        ]
    }
}
```

![](/assets/images/voicekit2/Screenshot%202025-10-16%20at%2012.34.37 PM.png)
*Assistant Library Demo*


[Voice Kit Demo Video](/assets/images/voicekit2/2FAE2E52-F355-4157-8F3E-6DC1A2EFC690.mp4)


# Google Assistant with AIY Voice Kit

## Project Overview
Python implementation of a voice-activated Google Assistant using hotword detection ("OK Google") with the AIY Voice Kit hardware.

## Setup Notes
**Authentication Challenge**: The initial setup encountered browser compatibility issues with the unsupported Chromium version in the Raspberry Pi image. Successfully resolved by installing Firefox to handle the OAuth authentication flow for Google Assistant API integration.

## Code Implementation

### Core Dependencies
```python
import logging
import platform
import sys
from google.assistant.library.event import EventType
from aiy.assistant import auth_helpers
from aiy.assistant.library import Assistant
from aiy.board import Board, Led
```

### Event Processing Logic
The `process_event()` function manages the Assistant's state machine with visual LED feedback:

#### State Transitions
- **Ready State** (`ON_START_FINISHED`)
  - LED: `BEACON_DARK`
  - Status: Assistant initialized and awaiting hotword

- **Active Listening** (`ON_CONVERSATION_TURN_STARTED`)
  - LED: `ON` (solid)
  - Status: Processing user voice input

- **Processing Query** (`ON_END_OF_UTTERANCE`)
  - LED: `PULSE_QUICK`
  - Status: Assistant analyzing and responding to query

- **Completion States**
  - `ON_CONVERSATION_TURN_FINISHED`
  - `ON_CONVERSATION_TURN_TIMEOUT`
  - `ON_NO_RESPONSE`
  - LED: Returns to `BEACON_DARK`

- **Error Handling** (`ON_ASSISTANT_ERROR`)
  - Condition: Fatal errors trigger application exit


```python
def main():
    # Initialize logging system
    logging.basicConfig(level=logging.INFO)
    
    # Authenticate with Google Assistant API
    credentials = auth_helpers.get_assistant_credentials()
    
    # Initialize hardware and Assistant
    with Board() as board, Assistant(credentials) as assistant:
        # Event processing loop
        for event in assistant.start():
            process_event(board.led, event)
```

### Hardware Requirements

Supported Devices: Raspberry Pi 2/3
Excluded Devices: Raspberry Pi Zero (requires alternative trigger methods)
Required Components: AIY Voice Kit with microphone and speaker array

### Operational Characteristics

Activation Method: Hotword detection ("OK Google")
Audio Handling: Direct access via Google Assistant Library
Visual Feedback: Multi-state LED indicators
Network Dependency: Requires persistent internet connection

### Authentication Notes

The successful implementation relies on proper OAuth configuration with Google Assistant API, achieved through Firefox installation to bypass Chromium compatibility limitations in the standard Raspberry Pi image.

## assistant_library_demo.py



```python
#!/usr/bin/env python3
# Copyright 2017 Google Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""Activates the Google Assistant with hotword detection, using the Google Assistant Library.

The Google Assistant Library has direct access to the audio API, so this Python
code doesn't need to record audio.

.. note:

    This example depends on hotword detection (such as "Okay Google") to activate the Google
    Assistant, which is supported only with Raspberry Pi 2/3. If you're using a Pi Zero, this
    code won't work. Instead, you must use the button or another type of trigger, as shown
    in assistant_library_with_button_demo.py.
"""

import logging
import platform
import sys

from google.assistant.library.event import EventType

from aiy.assistant import auth_helpers
from aiy.assistant.library import Assistant
from aiy.board import Board, Led

def process_event(led, event):
    logging.info(event)

    if event.type == EventType.ON_START_FINISHED:
        led.state = Led.BEACON_DARK  # Ready.
        logging.info('Say "OK, Google" then speak, or press Ctrl+C to quit...')

    elif event.type == EventType.ON_CONVERSATION_TURN_STARTED:
        led.state = Led.ON  # Listening.

    elif event.type == EventType.ON_END_OF_UTTERANCE:
        led.state = Led.PULSE_QUICK  # Thinking.

    elif (event.type == EventType.ON_CONVERSATION_TURN_FINISHED
          or event.type == EventType.ON_CONVERSATION_TURN_TIMEOUT
          or event.type == EventType.ON_NO_RESPONSE):
        led.state = Led.BEACON_DARK

    elif event.type == EventType.ON_ASSISTANT_ERROR and event.args and event.args['is_fatal']:
        sys.exit(1)


def main():
    logging.basicConfig(level=logging.INFO)

    credentials = auth_helpers.get_assistant_credentials()
    with Board() as board, Assistant(credentials) as assistant:
        for event in assistant.start():
            process_event(board.led, event)


if __name__ == '__main__':
    main()


```


## References

- [Hacking the Google AIY Voice Kit - Part 1](https://www.youtube.com/watch?v=jQK0VDWIzus)
- [Hacking the Google AIY Voice Kit Part 2 - Voice Control](https://www.youtube.com/watch?v=GI8zU_HO8CA)

---

## warehousemanagementputaway

**Source file:** `warehousemanagementputaway.md`

---
title: "Warehouse Management Put away"
description: "Warehouse Management - Put-away"
date: "2023-08-19"
categories: ["Microsoft Dynamics","Business Central"]
tags: []
slug: "warehousemanagementputaway"
image: "/assets/images/dynamics365-color.svg"
---



Businesses that physically move goods in and out of their warehouse need to be able to receive, pick, and ship items.

I created a walkthrough.

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.33.47-am-1437x713.png)
*I updated my role to Inventory Manager*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.33.58-am-1437x712.png)
*I clicked the Bin Content link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.34.20-am-1441x554.png)
*At this point there seems to be nothing in the Warehouse.*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.35.18-am-1439x713.png)
*I clicked Locations link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.35.35-am-890x602.png)
*I clicked on the White Warehouse link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.37.12-am-1435x711.png)
*I clicked on the Zones link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.38.34-am-1439x714.png)
*The White Warehouse has been divided into 8 zones.Each zone has a Bin Type*


## Bin Type

The bin type determines how a bin is used when processing the flow of items through the warehouse.

Incoming goods will be unloaded to a "Receive" bin, moved to a "Put Away" bin, removed from a "Pick" bin and sent from a "Ship" bin.

In this example these "Bin Types" are defined: PICK (Pick), PUTAWAY (Put Away), PUTPICK (Put Away and Pick), RECEIVE (Receive) and SHIP (Ship).

[QC (None) bins are used for items that are excluded from normal item flows.]

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-3.37.18-pm-1443x429.png)
*Bin Types*


## Zones

[Zones](https://learn.microsoft.com/en-us/training/modules/set-up-zones-bins/2-set-up-zone) are used to subdivide the warehouse into logical parts. Zones are divided into bins.

Notice that bin "W-08-0001" is a RECEIVE bin and "W-04-0001" is a PUTPICK bin.

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.38.51-am-1438x713.png)
*I clicked the Bins link to open a list of Bins in the White Warehouse*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.39.03-am-1437x711.png)
*This is a list of the Bins in the White Warehouse.*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.40.53-am-1431x714.png)
*I clicked Settings|Personalize to open the Personalizing toolbar.*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.41.15-am-1438x708.png)
*I was able to drag fields from the right onto the Bins page*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.43.18-am-1436x715.png)
*I added the Zone Code and the Bin Type Code Fields*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.46.03-am-1436x714.png)
*Notice that bin W-08-0001 is a RECEIVE bin in the RECEIVE Zone*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.46.54-am-1438x714.png)
*Notice that bin W-04-0001 is a PUTPICK bin in the PICK Zone (with a bin ranking of 100)*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.48.31-am-1438x714.png)
*Business Central will allocate incoming items to "Put Away" bins based on a Put-away Template*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.48.43-am-1438x711.png)
*Here two put away templates have been defined*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.49.08-am-1439x713.png)
*In the STD template items will be directed to a Fixed Bin already used for this item type with the same unit measure and less than minimum quantity, a Fixed Bin already used for this item type with the same unit measure, a Floating Bin that already has an item of this type in it with the same unit measure, a Floating Bin that already has an item of this type in it, to an empty bin with the next highest "bin ranking", or to a random floating bin.*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.49.32-am-1435x712.png)
*In the VAR template items will be directed to a Floating Bin that already has an item of this type in it with the same unit measure, to an empty bin with the next highest "bin ranking", or to a random floating bin.*


## Purchase Order

Purchase Orders are usually created by a planning process.

To demonstrate how items flow through a warehouse I created a Purchase Order manually.

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.49.57-am-1438x712.png)
*I navigated to the Purchase Orders page*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.50.32-am-1439x296.png)
*I clicked the + New link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.50.51-am-1437x711.png)
*In this case I wanted to purchase items from "First Up Consultants". I selected the Vendor Name box.*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.51.06-am-1438x711.png)
*I selected First Up Consultants*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.51.21-am-1437x714.png)
*The Vendor name and contact details were added to the new Purchase Order page.*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.51.42-am-1437x712.png)
*I wanted to purchase 10 yellow BERLIN Guest Chairs.*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.52.04-am-1439x713.png)
*I entered quantity 10*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.52.26-am-1438x713.png)
*I wanted to have the chairs shipped to the White Warehouse*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.27.35-pm-1836x930.png)
*I clicked the Release link (notice that I did not enter a vendor invoice number - the invoice will not be received for some days or weeks)*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.27.50-pm-1836x927.png)
*The Purchase Order document is released.*


## Push or pull the warehouse receipt?

After the Purchase Order details have been entered I could have clicked on the "Create Whse. Receipt" link to create a Warehouse Receipt (based on the details in the current Purchase Order). This would be to follow a Push strategy.

The alternative is to release the Purchase Order and to let the Warehouse staff create the Warehouse Receipt. In this example I followed a [Pull strategy](https://usedynamics.com/business-central/warehouse/strategies-when-creating-receipts/).

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-10.56.34-am-1435x710.png)
*I switched to the Warehouse Worker role*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-7.55.18-pm-1444x716.png)
*I navigated to the Warehouse Employees page*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-7.56.20-pm-1440x512.png)
*I added myself as a warehouse employee*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-4.52.29-pm-1439x318.png)
*I clicked the Warehouse Receipts link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.25.51-pm-1836x454.png)
*I created a new Warehouse Receipt*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.28.21-pm-1836x926.png)
*I clicked the Get Source Documents... link to import details from the Purchase Order into this Warehouse Receipt(Notice that a single Warehouse Receipt can import lines from multiple source documents)*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.28.45-pm-1836x928.png)
*Notice that the Bin Code was automatically set to bin W-08-0001 (the RECEIVE bin in the RECEIVE Zone - see above)*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.29.16-pm-1836x926.png)
*I clicked the Post Receipt link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.29.26-pm-1836x922.png)
*I posted the Warehouse Receipt*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.29.40-pm-1836x927.png)
*As I posted the Warehouse Receipt a Put-away was created*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.29.57-pm-1836x342.png)
*I clicked the Put-aways link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.30.10-pm-1836x508.png)
*I clicked on the newly created Put-away*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.30.30-pm-1836x926.png)
*I clicked the "i" to collapse the FactBox*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.30.45-pm-1836x927.png)
*Notice that the Put-away describes how the items should be moved from bin W-08-0001 (the RECEIVE bin in the RECEIVE Zone) and moved to bin W-04-0001 (the PUTPICK bin in the PICK Zone)*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.31.05-pm-1836x925.png)
*I wanted to review the Bin Contents before clicking Register Put-away*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.31.39-pm-1836x929.png)
*The items are shown in the W-08-0001 bin (the RECEIVE bin in the RECEIVE Zone)*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.31.50-pm-1836x931.png)
*I clicked the Register Put-away link*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.31.59-pm-1836x927.png)
*I clicked Yes*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.32.10-pm-1836x929.png)
*The put away is completed*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.32.26-pm-1836x924.png)
*I wanted to review the Bin Contents after clicking Register Put-away*

![](/assets/images/warehousemanagementputaway/screen-shot-2023-08-19-at-8.32.37-pm-1836x929.png)
*The items are shown in the W-04-0001 bin (the PUTPICK bin in the PICK Zone)*

---

## webcomponents

**Source file:** `webcomponents.md`

---
title: "Web Components"
description: "A set of web technologies that allow users to create HTML elements."
date: "2022-02-10"
categories: ["React"]
tags: []
slug: "webcomponents"
image: "/assets/images/web-components-logo.svg"
---


## History

In 1998 Microsoft Internet Explorer 5.5 added support for HTML Components. 

In 2001 Mozilla introduced XBL.

In 2007 Mozilla released XBL 2.

In 2016 Chrome and Opera added support for Web Components.


## howto-tooltip

The [aria-describedby](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-describedby) attribute lists the ids of the elements that describe the object. It is used to establish a relationship between widgets or groups and the text that describes them.

In the google chrome labs github repository there is a Web Component that creates a [howto-tooltip element](https://googlechromelabs.github.io/howto-components/howto-tooltip/#demo).

The howto-tooltip element only displays the "described by" content when a user is focused on the described element.


## demo

Move to and away from the text box below. 

If Web Components are supported by your browser the tooltip should appear and disappear.
                    

============

                    
Favourite type of cheese: 
                    

                    

    Help I am trapped inside a tooltip message

                    

============

The howto-tooltip Web Component is created using a JavaScript class and defined with a window.customElements.define() call.

The JavaScript class has a constructor, a _show method, a _hide method and an implementation for the connectedCallback and disconnectedCallback lifecycle methods.

The constructor uses bind to ensure that the _show and _hide methods can show or hide "this" howto-tooltip element.

The lifecycle methods add or remove event listeners to the described elements.

Notice that if the HTML is accessed by a Web Browser that does not support Web Components (and no "polyfill" has been included) the user is still able to read the tooltip text.


## template

An HTML template is a section of HTML that can be stamped out multiple times on multiple HTML pages.

Slots are used to identify places in the HTML template where other content can be grafted.

Consider this template from the [Web Components Are Easier Than You Think](https://css-tricks.com/web-components-are-easier-than-you-think/) article

<body>
    <template id="my-paragraph">
        <p>My paragraph</p>
    </template>
</body>

![](/assets/images/webcomponents/screen-shot-2022-02-10-at-1.16.05-pm-890x428.png)
*my-paragraph template*


## Using a template with JavaScript

Adding a template element to a web page does not result in anything being displayed (see above).

We can use JavaScript to apply the template.

<script>
        let template = document.getElementById('my-paragraph');
        let templateContent = template.content;
        document.body.appendChild(templateContent.cloneNode(true))
document.body.appendChild(templateContent.cloneNode(true))
document.body.appendChild(templateContent.cloneNode(true))
    </script>

![](/assets/images/webcomponents/screen-shot-2022-02-10-at-1.21.13-pm-890x429.png)
*Using an HTML template*


## Using a template in a Web Component

An easier way to apply a template is to create a Web Component.

<script>

        customElements.define("my-element",
            class extends HTMLElement {
                constructor() {
                    super();
                    let template = document.getElementById("my-paragraph");
                    let templatecontent = template.content;
                    const shadowRoot = this.attachShadow({ mode: "open" }).appendChild(templatecontent.cloneNode(true));
                }
            });

    </script>


## JavaScript only

...and this can be re-written without using the <template> tag.


## Slots

Slots are a way to customize a template.

If a developer wants to add more than one slot to a single template they need to provide ids.

Consider these examples:

  Hello World!
<template>
  <p>Hello <slot>World</slot>!</p>
</template>

and

<template>
  <p><slot name="greeting">Hello</slot> <slot name="name">World</slot>!</p>
</template>


## Web Components with slots

The example below shows how a Web Component can be created with support for slots.

![](/assets/images/webcomponents/screen-shot-2022-02-10-at-4.49.43-pm-828x372.png)
*Web Component with slots*


## Properties

Values can also be passed to Web Components using HTML element properties


## Events

Web Component events can be bubbled up to parent elements.

Web Components can dispatch custom events.

![](/assets/images/webcomponents/screen-shot-2022-02-10-at-6.23.41-pm-1260x648.png)
*The click event is bubbled up. The custom tick events are dispatched.*


## Are Web Components the future?

In her [article](https://blog.logrocket.com/what-happened-to-web-components/) Anna Monus explains:

*These days, web components are a divisive topic. They were once expected to revolutionize frontend development, but they’re still struggling to achieve industrywide adoption. Some developers say web components have already died, while others think they’re the future of web development.*

...

*UI libraries, such as React, Vue, and Angular, serve the same purpose as web components: they make component-based frontend development possible. Even though they’re not native to web browsers (you have to add the libraries separately while web components use web APIs built into the browser, such as DOM and CustomElementRegistry), they have a huge ecosystem, good documentation, and many developer-friendly features.*

[https://blog.logrocket.com/what-happened-to-web-components/](https://blog.logrocket.com/what-happened-to-web-components/)


## React integration

In his [article](https://css-tricks.com/3-approaches-to-integrate-react-with-custom-elements/) Caleb Williams explains:

*As of the time of this writing, React recently released version 17. The React team had initially planned to release improvements for compatibility with custom elements; unfortunately, those plans seem to have been pushed back to version 18.

Until then it will take a little extra work to use all the features custom elements offer with React. Hopefully, the React team will continue to improve support to bridge the gap between React and the web platform.*

[https://css-tricks.com/3-approaches-to-integrate-react-with-custom-elements/](https://css-tricks.com/3-approaches-to-integrate-react-with-custom-elements/)


## html embedded above

```text
<label for="cheese">Favourite type of cheese: </label>
<input id="cheese" aria-describedby="tp2"/>
<howto-tooltip id="tp2">Help I am trapped inside a tooltip message</howto-tooltip>
```

## howtoTooltip.js

```text
class HowtoTooltip extends HTMLElement {

    constructor() {
        super();

        this._show = this._show.bind(this);
        this._hide = this._hide.bind(this);
    }

    connectedCallback() {
        this._hide();

        this._target = document.querySelector('[aria-describedby=' + this.id + ']');
        if (!this._target)
            return;

        this._target.addEventListener('focus', this._show);
        this._target.addEventListener('blur', this._hide);
        this._target.addEventListener('mouseenter', this._show);
        this._target.addEventListener('mouseleave', this._hide);
    }

    disconnectedCallback() {
        if (!this._target)
            return;

        this._target.removeEventListener('focus', this._show);
        this._target.removeEventListener('blur', this._hide);
        this._target.removeEventListener('mouseenter', this._show);
        this._target.removeEventListener('mouseleave', this._hide);
        this._target = null;
    }

    _show() {
        this.hidden = false;
    }

    _hide() {
        this.hidden = true;
    }
}


window.customElements.define('howto-tooltip', HowtoTooltip)

customElements.whenDefined('howto-tooltip').then(() => {
    console.log('howto-tooltip ready!');
});
```

## template.html

```text
<body>

    <template id="my-paragraph">
        <p>My paragraph</p>
    </template>


    <script>

        customElements.define("my-element",
            class extends HTMLElement {
                constructor() {
                    super();
                    let template = document.getElementById("my-paragraph");
                    let templatecontent = template.content;
                    const shadowRoot = this.attachShadow({ mode: "open" }).appendChild(templatecontent.cloneNode(true));
                }
            });

    </script>

    <my-element></my-element>
    <my-element></my-element>
    <my-element></my-element>

</body>
```

## template.html

```text
<body>

    <script>

        const template = document.createElement('template');
        template.innerHTML = `
            <p>My paragraph</p>
        `

        customElements.define("my-element",
            class extends HTMLElement {
                constructor() {
                    super();
                    let templatecontent = template.content;
                    const shadowRoot = this.attachShadow({ mode: "open" }).appendChild(templatecontent.cloneNode(true));
                }
            });

    </script>

    <my-element></my-element>
    <my-element></my-element>
    <my-element></my-element>

</body>
```

## template.html

```text
<body>

    <script>

        const template = document.createElement('template');
        template.innerHTML = `
            <p><slot name="greeting">Hello</slot> <slot name="name">World</slot>!</p>
        `

        customElements.define("my-element",
            class extends HTMLElement {
                constructor() {
                    super();
                    let templatecontent = template.content;
                    const shadowRoot = this.attachShadow({ mode: "open" }).appendChild(templatecontent.cloneNode(true));
                }
            });

    </script>

    <my-element></my-element>
    <my-element><span slot="name">Neil</span></my-element>
    <my-element><span slot="name">Neil</span><span slot="greeting">Welcome</span></my-element>

</body>
```

## template.html

```text
<body>

    <script>

        const template = document.createElement('template');
        template.innerHTML = `
            <p><slot>Hello</slot> <span id="name">World</span>!</p>
        `

        customElements.define("my-element",
            class extends HTMLElement {
                constructor() {
                    super();
                    let templatecontent = template.content;
                    const shadowRoot = this.attachShadow({ mode: "open" }).appendChild(templatecontent.cloneNode(true));
                }
                static get observedAttributes() {
                    return ['name'];
                }

                attributeChangedCallback(name, oldValue, newValue) {
                    if (name == 'name') {
                        const span = this.shadowRoot.querySelector('#name')
                        if (newValue) {
                            span.innerText = newValue
                            return
                        } 
                        span.innerText = "World"
                    }
                }
            });


    </script>

    <my-element></my-element>
    <my-element name="Neil"></my-element>
    <my-element name="Neil"><span slot>Welcome</span></my-element>
```

## template.html

```text
<body>

    <script>

        const template = document.createElement('template');
        template.innerHTML = `
            <p><slot>Hello</slot> <span id="name">World</span>!</p>
        `

        customElements.define("my-element",
            class extends HTMLElement {
                constructor() {
                    super();
                    let templatecontent = template.content;
                    const shadowRoot = this.attachShadow({ mode: "open" }).appendChild(templatecontent.cloneNode(true));
                }

                static get observedAttributes() {
                    return ['name'];
                }

                attributeChangedCallback(name, oldValue, newValue) {
                    if (name == 'name') {
                        const span = this.shadowRoot.querySelector('#name')
                        if (newValue) {
                            span.innerText = newValue
                            return
                        }
                        span.innerText = "World"
                    }
                }

                connectedCallback() {
                    this._interval = setInterval( () => {
                        console.log('.')
                        this._tick()
                    }, 50000);
                }

                disconnectedCallback() {
                    clearInterval(this._interval);
                }

                _tick() {
                    const tickEvent = new CustomEvent("tick", {
                        bubbles: true,
                        cancelable: false,
                        composed: true
                    })
                    this.dispatchEvent(tickEvent);
                }

            })

    </script>

    <my-element id='first'></my-element>
    <my-element id='second' name="Neil"></my-element>
    <my-element name="Neil"><span slot>Welcome</span></my-element>

    <script>

        document.querySelector('#first').addEventListener("tick", (e) => {
            console.log('tick');
            console.log(e);
        });

        document.querySelector('#first').addEventListener("click", (e) => {
            console.log('click');
            console.log(e);
        });

        document.querySelector('#second').addEventListener("tick", function (e) {
            console.log('tock');
            console.log(e);
        });

    </script>

</body>
```
## References

- [Web Components Are Easier Than You Think](https://css-tricks.com/web-components-are-easier-than-you-think/)

---

## webvr

**Source file:** `webvr.md`

---
title: "WebVR"
description: "Create Virtual Reality Experiences."
date: "2021-03-02"
categories: []
tags: []
slug: "webvr"
image: "/assets/images/webvr-logo-square-512x512.png"
---


## Moon Rider

[WebVR](https://webvr.info) has been replaced by the [WebXR](https://github.com/immersive-web) Device API, that supports both Virtual Reality (VR) and Augmented Reality (AR).

So why write a post about WebVR?

[Moon Rider](https://moonrider.xyz). That's why.

Moon Rider is a free VR rhythm game built on WebVR that runs in a web browser.

Moon Rider is an impressive example of what can be done with WebVR.

[https://moonrider.xyz](https://moonrider.xyz)

The Moon Rider code is available for download from GitHub

[https://github.com/supermedium/moonrider](https://github.com/supermedium/moonrider)

![](/assets/images/webvr/image0-4-1334x750.png)
*Moon Rider in Oculus Quest 2 Browser*


## A static WebVR scene

WebVR developers use **entities** to create **scenes**. Entities are created using **assets**.

A static scene can be created using a few web page tags.


## A scene

```javascript
<body>

    <a-scene>

        <a-assets>
            <a-asset-item id="engine" src="./assets/files/engine.glb">
            </a-asset-item>
        </a-assets>

        <a-entity position="0 0 -3">
            <a-gltf-model src="#engine" rotation="90 0 0" scale="18 18 18"></a-gltf-model>
        </a-entity>

        <a-entity light="type: point; intensity: 60; distance: 50; decay: 2" position="0 0 10"></a-entity>

    </a-scene>

</body>

</html>
```

---

## webxr

**Source file:** `webxr.md`

---
title: "WebXR"
description: "Create Augmented Reality Experiences."
date: "2022-04-22"
categories: ["JavaScript"]
tags: []
slug: "webxr"
image: "/assets/images/34385910-400x400.png"
---



[WebXR](https://github.com/immersive-web) supports both Virtual Reality (VR) and Augmented Reality (AR).

WebXR has replaced the [WebVR](WebVR.html) standard.


## Scene with markers

This scene includes two Augmented Reality markers.

A sphere is added to the camera output when the Hiro marker is recognised.

A dinosaur is added to the camera output when the '6' barcode marker is recognised.

For convenience the barcode marker can be added to a web page QR Code.

![](/assets/images/webxr/278535875-3143515849195152-3177239650686303329-n-750x1334.jpg)
*QR Code*

![](/assets/images/webxr/278604232-1195762084291932-2000984922213087796-n-750x1334.jpg)
*Barcode marker*

![](/assets/images/webxr/hiro-marker-arjs-472x475.png)
*Augmented Reality Marker*

![](/assets/images/webxr/marker6-226x226.png)
*Barcode Marker*

![](/assets/images/webxr/qr-code-3-1148x1148.png)
*Barcode Marker embedded in a QR Code*


## Scene

```html
<!DOCTYPE html>
<html>
<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

<body style="margin : 0px; overflow: hidden;">
    <a-scene embedded arjs="detectionMode: mono_and_matrix; matrixCodeType: 3x3;">

        <a-marker preset="hiro">
            <a-sphere position='0 0.5 0' material="opacity: 0.5" radius="1"></a-sphere>
        </a-marker>

        <a-marker type="barcode" value="6">
            <a-entity position="0 0 0" scale="0.05 0.05 0.05"
                gltf-model="https://arjs-cors-proxy.herokuapp.com/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/scene.gltf">
            </a-entity>
        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>
</body>

</html>
```

---

## xcode1

**Source file:** `xcode1.md`

---
title: "XCode C++ (Part 1)"
description: "Hello, World!"
date: "2023-03-08"
categories: []
tags: []
slug: "xcode1"
image: "/assets/images/xcode-14-icon-300x314.png"
---



How I built hello world on my M1 MacBook Air

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.40.19-am-1536x891.png)
*new Command Line Tool project*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.40.45-am-1456x1034.png)
*Product Name is helloWorldLanguage is C++*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.41.39-am-1536x855.png)
*Select Source Code location*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.42.12-am-1536x889.png)
*General project settings*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.42.35-am-1536x663.png)
*Build and Run*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.43.19-am-1536x887.png)
*Program ended*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.43.37-am-1536x641.png)
*Show Build Folder in Finder*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.43.51-am-1536x723.png)
*Build Folder*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.43.59-am-1536x295.png)
*Debug Build*

![](/assets/images/xcode1/screen-shot-2023-03-08-at-10.44.18-am-1536x729.png)
*Unix Executable File*


## main.cpp

```text
//
//  main.cpp
//  helloWorld
//
//  Created by Neil Haddley on 3/8/23.
//

#include <iostream>

int main(int argc, const char * argv[]) {
    // insert code here...
    std::cout << "Hello, World!\n";
    return 0;
}
```

---

## xcode2

**Source file:** `xcode2.md`

---
title: "XCode C++ (Part 2)"
description: "OpenGL GLFW"
date: "2023-03-08"
categories: []
tags: []
slug: "xcode2"
image: "/assets/images/xcode-14-icon-300x314.png"
---


## Building an OpenGL application using C++ and XCode

I compiled a minimal OpenGL on my M1 MacBook Air.

I used GLFW (a cross platform library for OpenGL).


## Overview

Here GLFW is used to create an application window with a given width and height and the title "Hello World".

In a loop the SwapBuffers function is called until the window is closed.

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.01.51-pm-1478x1044.png)
*New Command Line Tool project*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.02.10-pm-1466x1040.png)
*Named Hello OpenGL*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.02.41-pm-1536x541.png)
*General Settings*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.02.53-pm-1536x639.png)
*Default hello world code*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.03.16-pm-1536x542.png)
*GLFW web site*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.03.31-pm-1536x795.png)
*Hello OpenGL example*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.04.04-pm-1536x895.png)
*Missing library/header files*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.04.44-pm-1144x180.png)
*brew install glfw*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.10.58-pm-1140x746.png)
*installed to folder /opt/homebrew/Cellar/glfw/3.3.8*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.11.40-pm-1536x533.png)
*Add reference to /opt/homebrew/Cellar/glfw/3.3.8/ header files*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.12.06-pm-1536x619.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.12.19-pm-1536x528.png)
*/opt/homebrew/Cellar/glfw/3.3.8/include reference added*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.12.32-pm-1536x606.png)
*Add reference to libraries*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.12.53-pm-1536x774.png)
*OpenGL.framework*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.13.04-pm-1536x541.png)
*Add items*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.13.14-pm-1536x783.png)
*Add files*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.15.50-pm-1536x767.png)
*add a reference to dynamically loaded library /opt/homebrew/Cellar/glfw/3.3.8/lib/libglfw.3.3.dylib*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.15.59-pm-1536x562.png)
*Library references updated*

![](/assets/images/xcode2/screen-shot-2023-03-08-at-12.16.22-pm-1536x892.png)
*Hello OpenGL application running*


## main.cpp

```text
#include <GLFW/glfw3.h>

int main(void)
{
    GLFWwindow* window;

    /* Initialize the library */
    if (!glfwInit())
        return -1;

    /* Create a windowed mode window and its OpenGL context */
    window = glfwCreateWindow(640, 480, "Hello World", NULL, NULL);
    if (!window)
    {
        glfwTerminate();
        return -1;
    }

    /* Make the window's context current */
    glfwMakeContextCurrent(window);

    /* Loop until the user closes the window */
    while (!glfwWindowShouldClose(window))
    {
        /* Render here */
        glClear(GL_COLOR_BUFFER_BIT);

        /* Swap front and back buffers */
        glfwSwapBuffers(window);

        /* Poll for and process events */
        glfwPollEvents();
    }

    glfwTerminate();
    return 0;
}
```
## References

- [OpenGL GLFW Hello World: M1 Macbook Pro + Xcode](https://www.youtube.com/watch?v=MHlbNbWlrIM)
- [OpenGL GLFW Windows Visual Studio](https://www.youtube.com/watch?v=OR4fNpBjmq8)

---

## xcode3

**Source file:** `xcode3.md`

---
title: "XCode C++ (Part 3)"
description: "Building an OpenGL application using C++ and XCode"
date: "2023-03-08"
categories: []
tags: []
slug: "xcode3"
image: "/assets/images/xcode-14-icon-300x314.png"
---



I compiled an OpenGL Triangle app on my M1 MacBook Air.

The OpenGL Extension Wrangler Library (GLEW) is a cross-platform loading library. 

GLEW provides a way to determine (at runtime) which OpenGL implementations are available.

The "4.1 Metal - 76.3" OpenGL implementation is available on my M1 MacBook Air.

![](/assets/images/xcode3/screen-shot-2023-03-08-at-1.53.36-pm-1536x1206.png)
*Running application*


## Overview

The GLFW library is used to create an application window with a given width and height and the title "LearnOpenGL".

The GLEW library state is initialized.

A GLEW library call is used to define a viewport.

In this example vertex shader and fragment shader code (written in the C-like language GLSL) is copied, compiled and executed on the computer's graphics processing unit (GPU). 

In a loop the shaders are used to draw and redraw a triangle defined by a set of positions/vertices. Each position includes an x value between -1 (far left) and 1 (far right), a y value between -1 (bottom) and 1 (top) and a z value (always 0 in this example).

![](/assets/images/xcode3/screen-shot-2023-03-08-at-1.35.42-pm-1134x730.png)
*brew install glew*

![](/assets/images/xcode3/screen-shot-2023-03-08-at-1.39.47-pm-1536x456.png)
*Add include folder to header search*

![](/assets/images/xcode3/screen-shot-2023-03-08-at-1.42.29-pm-1536x459.png)
*Add library*

![](/assets/images/xcode3/screen-shot-2023-03-08-at-1.42.40-pm-1536x595.png)
*updated library references*

![](/assets/images/xcode3/screen-shot-2023-03-08-at-2.03.06-pm-1536x850.png)
*build and run application*


## main.cpp

```text
#include <iostream>

// GLEW
#define GLEW_STATIC
#include <GL/glew.h>

// GLFW
#include <GLFW/glfw3.h>

// Window dimensions
const GLuint WIDTH = 800, HEIGHT = 600;

// Shaders
const GLchar* vertexShaderSource = "#version 330 core\n"
"layout (location = 0) in vec3 position;\n"
"void main()\n"
"{\n"
"gl_Position = vec4(position.x, position.y, position.z, 1.0);\n"
"}\0";
const GLchar* fragmentShaderSource = "#version 330 core\n"
"out vec4 color;\n"
"void main()\n"
"{\n"
"color = vec4(1.0f, 0.5f, 0.2f, 1.0f);\n"
"}\n\0";

// The MAIN function, from here we start the application and run the game loop
int main()
{
    // Init GLFW
    glfwInit( );
    
    // Set all the required options for GLFW
    glfwWindowHint( GLFW_CONTEXT_VERSION_MAJOR, 3 );
    glfwWindowHint( GLFW_CONTEXT_VERSION_MINOR, 3 );
    glfwWindowHint( GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE );
    glfwWindowHint( GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE );

    glfwWindowHint( GLFW_RESIZABLE, GL_FALSE );
    
    // Create a GLFWwindow object that we can use for GLFW's functions
    GLFWwindow *window = glfwCreateWindow( WIDTH, HEIGHT, "LearnOpenGL", nullptr, nullptr );
    
    int screenWidth, screenHeight;
    glfwGetFramebufferSize( window, &screenWidth, &screenHeight );
    
    if ( nullptr == window )
    {
        std::cout << "Failed to create GLFW window" << std::endl;
        glfwTerminate( );
        
        return EXIT_FAILURE;
    }
    
    glfwMakeContextCurrent( window );
    
    // Set this to true so GLEW knows to use a modern approach to retrieving function pointers and extensions
    glewExperimental = GL_TRUE;
    // Initialize GLEW to setup the OpenGL Function pointers
    if ( GLEW_OK != glewInit( ) )
    {
        std::cout << "Failed to initialize GLEW" << std::endl;
        return EXIT_FAILURE;
    }
    
    std::cout << glGetString(GL_VERSION);
    
    // Define the viewport dimensions
    glViewport( 0, 0, screenWidth, screenHeight );
    
    
    // Build and compile our shader program
    // Vertex shader
    GLuint vertexShader = glCreateShader( GL_VERTEX_SHADER );
    glShaderSource( vertexShader, 1, &vertexShaderSource, NULL );
    glCompileShader( vertexShader );
    
    // Check for compile time errors
    GLint success;
    GLchar infoLog[512];
    
    glGetShaderiv( vertexShader, GL_COMPILE_STATUS, &success );
    if ( !success )
    {
        glGetShaderInfoLog( vertexShader, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::VERTEX::COMPILATION_FAILED\n" << infoLog << std::endl;
    }
    
    // Fragment shader
    GLuint fragmentShader = glCreateShader( GL_FRAGMENT_SHADER );
    glShaderSource( fragmentShader, 1, &fragmentShaderSource, NULL );
    glCompileShader( fragmentShader );
    
    // Check for compile time errors
    glGetShaderiv( fragmentShader, GL_COMPILE_STATUS, &success );
    
    if ( !success )
    {
        glGetShaderInfoLog( fragmentShader, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::FRAGMENT::COMPILATION_FAILED\n" << infoLog << std::endl;
    }
    
    // Link shaders
    GLuint shaderProgram = glCreateProgram( );
    glAttachShader( shaderProgram, vertexShader );
    glAttachShader( shaderProgram, fragmentShader );
    glLinkProgram( shaderProgram );
    
    // Check for linking errors
    glGetProgramiv( shaderProgram, GL_LINK_STATUS, &success );
    
    if ( !success )
    {
        glGetProgramInfoLog( shaderProgram, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::PROGRAM::LINKING_FAILED\n" << infoLog << std::endl;
    }
    
    glDeleteShader( vertexShader );
    glDeleteShader( fragmentShader );
    
    
    // Set up vertex data (and buffer(s)) and attribute pointers
    GLfloat vertices[] =
    {
        -0.5f, -0.5f, 0.0f, // Left
        0.5f, -0.5f, 0.0f, // Right
        0.0f,  0.5f, 0.0f  // Top
    };
    
    GLuint VBO, VAO;
    glGenVertexArrays( 1, &VAO );
    glGenBuffers( 1, &VBO );
    // Bind the Vertex Array Object first, then bind and set vertex buffer(s) and attribute pointer(s).
    glBindVertexArray( VAO );
    
    glBindBuffer( GL_ARRAY_BUFFER, VBO );
    glBufferData( GL_ARRAY_BUFFER, sizeof( vertices ), vertices, GL_STATIC_DRAW );
    
    glVertexAttribPointer( 0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof( GLfloat ), ( GLvoid * ) 0 );
    glEnableVertexAttribArray( 0 );
    
    glBindBuffer( GL_ARRAY_BUFFER, 0 ); // Note that this is allowed, the call to glVertexAttribPointer registered VBO as the currently bound vertex buffer object so afterwards we can safely unbind
    
    glBindVertexArray( 0 ); // Unbind VAO (it's always a good thing to unbind any buffer/array to prevent strange bugs)
    
    // Game loop
    while ( !glfwWindowShouldClose( window ) )
    {
        // Check if any events have been activiated (key pressed, mouse moved etc.) and call corresponding response functions
        glfwPollEvents( );
        
        // Render
        // Clear the colorbuffer
        glClearColor( 0.2f, 0.3f, 0.3f, 1.0f );
        glClear( GL_COLOR_BUFFER_BIT );
        
        // Draw our first triangle
        glUseProgram( shaderProgram );
        glBindVertexArray( VAO );
        glDrawArrays( GL_TRIANGLES, 0, 3 );
        glBindVertexArray( 0 );
        
        // Swap the screen buffers
        glfwSwapBuffers( window );
    }
    
    // Properly de-allocate all resources once they've outlived their purpose
    glDeleteVertexArrays( 1, &VAO );
    glDeleteBuffers( 1, &VBO );
    
    // Terminate GLFW, clearing any resources allocated by GLFW.
    glfwTerminate( );
    
    return EXIT_SUCCESS;
}
```
## References

- [Modern OpenGL Tutorials](https://github.com/SonarSystems/Modern-OpenGL-Tutorials)
- [The OpenGL Extension Wrangler Library - GLEW](https://www.youtube.com/watch?v=H2E3yO0J7TM)

---

## xcode4

**Source file:** `xcode4.md`

---
title: "XCode C++ (Part 4)"
description: "Rotating the triangle"
date: "2023-03-27"
categories: []
tags: []
slug: "xcode4"
image: "/assets/images/xcode-14-icon-300x314.png"
---


OpenGL Mathematics (GLM) is a header only C++ mathematics library for graphics software based on the OpenGL Shading Language (GLSL) specifications.

I installed GLM using this command

$ brew install glm

![](/assets/images/xcode4/screen-shot-2023-03-27-at-10.03.48-pm-1596x1258.png)
*Running application*


## Overview

To rotate the triangle by 10 degrees I had to make changes to the vertex shader.

 I had to update the code to apply a rotation matrix to the vertex positions.

*const GLchar* vertexShaderSource = "#version 330 core\n"
"layout (location = 0) in vec3 position;\n"
**"uniform mat4 transform;\n"**
"void main()\n"
"{\n"
"gl_Position = **transform *** vec4(position, 1.0);\n"
"}\0";*

In the updated code the uniform variable "transform" represents the rotation matrix that will be applied to the vertex positions.

To set the value of the transform uniform, I needed to add some code to the main function. 

To rotate the triangle by 10 degrees around the z-axis I added this code

*// Define the rotation angle in degrees
GLfloat angle = 10.0f;

// Convert the angle to radians
GLfloat radians = glm::radians(angle);

// Calculate the rotation matrix
glm::mat4 **rotation** = glm::rotate(glm::mat4(1.0f), radians, glm::vec3(0.0f, 0.0f, **1.0f**));

// Get the location of the "transform" uniform
GLint **transformLoc** = glGetUniformLocation(shaderProgram, "**transform**");

// Set the value of the "transform" uniform
glUniformMatrix4fv(**transformLoc**, 1, GL_FALSE, glm::value_ptr(**rotation**));*

A rotation matrix "rotation" is calculated using the glm::rotate() function. 

The glm::rotate() function takes a matrix, an angle (in radians), and an axis of rotation (In this case, we are rotating around the z-axis, so we pass in a vector with x and y values of 0 and a z value of 1).

The location of the transform uniform in the vertex shader is retrieved using the glGetUniformLocation() function. 

The value of the transform uniform is set using the glUniformMatrix4fv() function, which takes the location of the uniform, the number of matrices being passed (1), whether or not to transpose the matrix (in this case, we don't want to transpose it), and a pointer to the matrix data (which is obtained using the glm::value_ptr() function).

With these changes, the triangle is rotated by 10 degrees around the z-axis.

![](/assets/images/xcode4/screen-shot-2023-03-27-at-8.08.59-pm-1596x642.png)
*I added the glm include folder to header search*


## Animation

For fun I changed the code above to update the rotation applied to the triangle in the "game loop".


## main.cpp

```text
#include <iostream>

// GLEW
#define GLEW_STATIC
#include <GL/glew.h>

// GLFW
#include <GLFW/glfw3.h>

// GLM (OpenGL Mathematics) library
#include <glm/glm.hpp>
#include <glm/gtc/matrix_transform.hpp>
#include <glm/gtc/type_ptr.hpp>

// Window dimensions
const GLuint WIDTH = 800, HEIGHT = 600;

// Shaders
/*const GLchar* vertexShaderSource = "#version 330 core\n"
"layout (location = 0) in vec3 position;\n"
"void main()\n"
"{\n"
"gl_Position = vec4(position.x, position.y, position.z, 1.0);\n"
"}\0";*/

const GLchar* vertexShaderSource = "#version 330 core\n"
"layout (location = 0) in vec3 position;\n"
"uniform mat4 transform;\n"
"void main()\n"
"{\n"
"gl_Position = transform * vec4(position, 1.0);\n"
"}\0";

const GLchar* fragmentShaderSource = "#version 330 core\n"
"out vec4 color;\n"
"void main()\n"
"{\n"
"color = vec4(1.0f, 0.5f, 0.2f, 1.0f);\n"
"}\n\0";




// The MAIN function, from here we start the application and run the game loop
int main()
{
    // Init GLFW
    glfwInit( );
    
    // Set all the required options for GLFW
    glfwWindowHint( GLFW_CONTEXT_VERSION_MAJOR, 3 );
    glfwWindowHint( GLFW_CONTEXT_VERSION_MINOR, 3 );
    glfwWindowHint( GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE );
    glfwWindowHint( GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE );

    glfwWindowHint( GLFW_RESIZABLE, GL_FALSE );
    
    // Create a GLFWwindow object that we can use for GLFW's functions
    GLFWwindow *window = glfwCreateWindow( WIDTH, HEIGHT, "LearnOpenGL", nullptr, nullptr );
    
    int screenWidth, screenHeight;
    glfwGetFramebufferSize( window, &screenWidth, &screenHeight );
    
    if ( nullptr == window )
    {
        std::cout << "Failed to create GLFW window" << std::endl;
        glfwTerminate( );
        
        return EXIT_FAILURE;
    }
    
    glfwMakeContextCurrent( window );
    
    // Set this to true so GLEW knows to use a modern approach to retrieving function pointers and extensions
    glewExperimental = GL_TRUE;
    // Initialize GLEW to setup the OpenGL Function pointers
    if ( GLEW_OK != glewInit( ) )
    {
        std::cout << "Failed to initialize GLEW" << std::endl;
        return EXIT_FAILURE;
    }
    
    std::cout << '\n';
    std::cout << '\n';
    
    std::cout << glGetString(GL_VERSION);
    std::cout << '\n';
    std::cout << '\n';
    
    // Define the viewport dimensions
    glViewport( 0, 0, screenWidth, screenHeight );
    
    
    // Build and compile our shader program
    // Vertex shader
    GLuint vertexShader = glCreateShader( GL_VERTEX_SHADER );
    glShaderSource( vertexShader, 1, &vertexShaderSource, NULL );
    glCompileShader( vertexShader );
    
    // Check for compile time errors
    GLint success;
    GLchar infoLog[512];
    
    glGetShaderiv( vertexShader, GL_COMPILE_STATUS, &success );
    if ( !success )
    {
        glGetShaderInfoLog( vertexShader, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::VERTEX::COMPILATION_FAILED\n" << infoLog << std::endl;
    }
    
    // Fragment shader
    GLuint fragmentShader = glCreateShader( GL_FRAGMENT_SHADER );
    glShaderSource( fragmentShader, 1, &fragmentShaderSource, NULL );
    glCompileShader( fragmentShader );
    
    // Check for compile time errors
    glGetShaderiv( fragmentShader, GL_COMPILE_STATUS, &success );
    
    if ( !success )
    {
        glGetShaderInfoLog( fragmentShader, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::FRAGMENT::COMPILATION_FAILED\n" << infoLog << std::endl;
    }
    
    // Link shaders
    GLuint shaderProgram = glCreateProgram( );
    glAttachShader( shaderProgram, vertexShader );
    glAttachShader( shaderProgram, fragmentShader );
    glLinkProgram( shaderProgram );
    
    // Check for linking errors
    glGetProgramiv( shaderProgram, GL_LINK_STATUS, &success );
    
    if ( !success )
    {
        glGetProgramInfoLog( shaderProgram, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::PROGRAM::LINKING_FAILED\n" << infoLog << std::endl;
    }
    
    glDeleteShader( vertexShader );
    glDeleteShader( fragmentShader );
    
    
    // Set up vertex data (and buffer(s)) and attribute pointers
    GLfloat vertices[] =
    {
        -0.5f, -0.5f, 0.0f, // Left
        0.5f, -0.5f, 0.0f, // Right
        0.0f,  0.5f, 0.0f  // Top
    };
    
    
    GLuint VBO, VAO;
    glGenVertexArrays( 1, &VAO );
    glGenBuffers( 1, &VBO );
    // Bind the Vertex Array Object first, then bind and set vertex buffer(s) and attribute pointer(s).
    glBindVertexArray( VAO );
    
    glBindBuffer( GL_ARRAY_BUFFER, VBO );
    glBufferData( GL_ARRAY_BUFFER, sizeof( vertices ), vertices, GL_STATIC_DRAW );
    
    glVertexAttribPointer( 0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof( GLfloat ), ( GLvoid * ) 0 );
    glEnableVertexAttribArray( 0 );
    
    glBindBuffer( GL_ARRAY_BUFFER, 0 ); // Note that this is allowed, the call to glVertexAttribPointer registered VBO as the currently bound vertex buffer object so afterwards we can safely unbind
    
    glBindVertexArray( 0 ); // Unbind VAO (it's always a good thing to unbind any buffer/array to prevent strange bugs)
    
    
    
    // Game loop
    while ( !glfwWindowShouldClose( window ) )
    {
        // Check if any events have been activiated (key pressed, mouse moved etc.) and call corresponding response functions
        glfwPollEvents( );
        
        // Render
        // Clear the colorbuffer
        glClearColor( 0.2f, 0.3f, 0.3f, 1.0f );
        glClear( GL_COLOR_BUFFER_BIT );
        

        
        // Draw our first triangle
        glUseProgram( shaderProgram );
        glBindVertexArray( VAO );
        

        
        // Define the rotation angle in degrees
        GLfloat angle = 10.0f;
        // Convert the angle to radians
        GLfloat radians = glm::radians(angle);
        // Calculate the rotation matrix
        glm::mat4 rotation = glm::rotate(glm::mat4(1.0f), radians, glm::vec3(0.0f, 0.0f, 1.0f));
        // Get the location of the "transform" uniform
        GLint transformLoc = glGetUniformLocation(shaderProgram, "transform");
        // Set the value of the "transform" uniform
        glUniformMatrix4fv(transformLoc, 1, GL_FALSE, glm::value_ptr(rotation));
        
        
        
        glDrawArrays( GL_TRIANGLES, 0, 3 );
        glBindVertexArray( 0 );
        
        // Swap the screen buffers
        glfwSwapBuffers( window );
    }
    
    // Properly de-allocate all resources once they've outlived their purpose
    glDeleteVertexArrays( 1, &VAO );
    glDeleteBuffers( 1, &VBO );
    
    // Terminate GLFW, clearing any resources allocated by GLFW.
    glfwTerminate( );
    
    return EXIT_SUCCESS;
}
```

## Program.cs

```text
#include <iostream>

// GLEW
#define GLEW_STATIC
#include <GL/glew.h>

// GLFW
#include <GLFW/glfw3.h>

// GLM (OpenGL Mathematics) library
#include <glm/glm.hpp>
#include <glm/gtc/matrix_transform.hpp>
#include <glm/gtc/type_ptr.hpp>

// Window dimensions
const GLuint WIDTH = 800, HEIGHT = 600;

// Shaders
const GLchar* vertexShaderSource = "#version 330 core\n"
"layout (location = 0) in vec3 position;\n"
"uniform mat4 transform;\n"
"void main()\n"
"{\n"
"gl_Position = transform * vec4(position, 1.0);\n"
"}\0";

const GLchar* fragmentShaderSource = "#version 330 core\n"
"out vec4 color;\n"
"void main()\n"
"{\n"
"color = vec4(1.0f, 0.5f, 0.2f, 1.0f);\n"
"}\n\0";



// The MAIN function, from here we start the application and run the game loop
int main()
{
    // Init GLFW
    glfwInit( );
    
    // Set all the required options for GLFW
    glfwWindowHint( GLFW_CONTEXT_VERSION_MAJOR, 3 );
    glfwWindowHint( GLFW_CONTEXT_VERSION_MINOR, 3 );
    glfwWindowHint( GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE );
    glfwWindowHint( GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE );

    glfwWindowHint( GLFW_RESIZABLE, GL_FALSE );
    
    // Create a GLFWwindow object that we can use for GLFW's functions
    GLFWwindow *window = glfwCreateWindow( WIDTH, HEIGHT, "LearnOpenGL", nullptr, nullptr );
    
    int screenWidth, screenHeight;
    glfwGetFramebufferSize( window, &screenWidth, &screenHeight );
    
    if ( nullptr == window )
    {
        std::cout << "Failed to create GLFW window" << std::endl;
        glfwTerminate( );
        
        return EXIT_FAILURE;
    }
    
    glfwMakeContextCurrent( window );
    
    // Set this to true so GLEW knows to use a modern approach to retrieving function pointers and extensions
    glewExperimental = GL_TRUE;
    // Initialize GLEW to setup the OpenGL Function pointers
    if ( GLEW_OK != glewInit( ) )
    {
        std::cout << "Failed to initialize GLEW" << std::endl;
        return EXIT_FAILURE;
    }
    
    std::cout << '\n';
    std::cout << '\n';
    
    std::cout << glGetString(GL_VERSION);
    std::cout << '\n';
    std::cout << '\n';
    
    // Define the viewport dimensions
    glViewport( 0, 0, screenWidth, screenHeight );
    
    
    // Build and compile our shader program
    // Vertex shader
    GLuint vertexShader = glCreateShader( GL_VERTEX_SHADER );
    glShaderSource( vertexShader, 1, &vertexShaderSource, NULL );
    glCompileShader( vertexShader );
    
    // Check for compile time errors
    GLint success;
    GLchar infoLog[512];
    
    glGetShaderiv( vertexShader, GL_COMPILE_STATUS, &success );
    if ( !success )
    {
        glGetShaderInfoLog( vertexShader, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::VERTEX::COMPILATION_FAILED\n" << infoLog << std::endl;
    }
    
    // Fragment shader
    GLuint fragmentShader = glCreateShader( GL_FRAGMENT_SHADER );
    glShaderSource( fragmentShader, 1, &fragmentShaderSource, NULL );
    glCompileShader( fragmentShader );
    
    // Check for compile time errors
    glGetShaderiv( fragmentShader, GL_COMPILE_STATUS, &success );
    
    if ( !success )
    {
        glGetShaderInfoLog( fragmentShader, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::FRAGMENT::COMPILATION_FAILED\n" << infoLog << std::endl;
    }
    
    // Link shaders
    GLuint shaderProgram = glCreateProgram( );
    glAttachShader( shaderProgram, vertexShader );
    glAttachShader( shaderProgram, fragmentShader );
    glLinkProgram( shaderProgram );
    
    // Check for linking errors
    glGetProgramiv( shaderProgram, GL_LINK_STATUS, &success );
    
    if ( !success )
    {
        glGetProgramInfoLog( shaderProgram, 512, NULL, infoLog );
        std::cout << "ERROR::SHADER::PROGRAM::LINKING_FAILED\n" << infoLog << std::endl;
    }
    
    glDeleteShader( vertexShader );
    glDeleteShader( fragmentShader );
    
    
    // Set up vertex data (and buffer(s)) and attribute pointers
    GLfloat vertices[] =
    {
        -0.5f, -0.5f, 0.0f, // Left
        0.5f, -0.5f, 0.0f, // Right
        0.0f,  0.5f, 0.0f  // Top
    };
    
    
    GLuint VBO, VAO;
    glGenVertexArrays( 1, &VAO );
    glGenBuffers( 1, &VBO );
    // Bind the Vertex Array Object first, then bind and set vertex buffer(s) and attribute pointer(s).
    glBindVertexArray( VAO );
    
    glBindBuffer( GL_ARRAY_BUFFER, VBO );
    glBufferData( GL_ARRAY_BUFFER, sizeof( vertices ), vertices, GL_STATIC_DRAW );
    
    glVertexAttribPointer( 0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof( GLfloat ), ( GLvoid * ) 0 );
    glEnableVertexAttribArray( 0 );
    
    glBindBuffer( GL_ARRAY_BUFFER, 0 ); // Note that this is allowed, the call to glVertexAttribPointer registered VBO as the currently bound vertex buffer object so afterwards we can safely unbind
    
    glBindVertexArray( 0 ); // Unbind VAO (it's always a good thing to unbind any buffer/array to prevent strange bugs)
    
    
    // Define the rotation angle in degrees
    GLfloat angle = 0.0f;
    // Get the location of the "transform" uniform
    GLint transformLoc = glGetUniformLocation(shaderProgram, "transform");
    
    // Game loop
    while ( !glfwWindowShouldClose( window ) )
    {
        // Check if any events have been activiated (key pressed, mouse moved etc.) and call corresponding response functions
        glfwPollEvents( );
        
        // Animate
        angle++;
        if (angle>359.0f){
            angle=0.0f;
        }
        // Convert the angle to radians
        GLfloat radians = glm::radians(angle);
        // Calculate the rotation matrix
        glm::mat4 rotation = glm::rotate(glm::mat4(1.0f), radians, glm::vec3(1.0f, 1.0f, 1.0f));
        // Set the value of the "transform" uniform
        glUniformMatrix4fv(transformLoc, 1, GL_FALSE, glm::value_ptr(rotation));
        
        // Render
        // Clear the colorbuffer
        glClearColor( 0.2f, 0.3f, 0.3f, 1.0f );
        glClear( GL_COLOR_BUFFER_BIT );
        
        // Draw our first triangle
        glUseProgram( shaderProgram );
        
        glBindVertexArray( VAO );
        
        glDrawArrays( GL_TRIANGLES, 0, 3 );
        glBindVertexArray( 0 );
        
        // Swap the screen buffers
        glfwSwapBuffers( window );
    }
    
    // Properly de-allocate all resources once they've outlived their purpose
    glDeleteVertexArrays( 1, &VAO );
    glDeleteBuffers( 1, &VBO );
    
    // Terminate GLFW, clearing any resources allocated by GLFW.
    glfwTerminate( );
    
    return EXIT_SUCCESS;
}
```
## References

- [Modern OpenGL Tutorials](https://github.com/SonarSystems/Modern-OpenGL-Tutorials)

---

## yolo

**Source file:** `yolo.md`

---
title: "Yolo"
description: "You only look once, real time object detection"
date: "2025-09-20"
categories: ["Development"]
image: "/assets/images/yolo/hero.png"
tags: ["ai"]
hidden: true
slug: "yolo"
---



YOLO is a single-shot detector that uses a fully convolutional neural network (CNN) to process an image.

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*

![](/assets/images/yolo/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png)
*esp8266*
## References

- [LangChain Quickstart](https://python.langchain.com/docs/get_started/quickstart)



---

