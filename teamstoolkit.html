<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v5.6.13, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v5.6.13, mobirise.com">
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image:src" content="">
  <meta property="og:image" content="">
  <meta name="twitter:title" content="Teams Toolkit with Azure">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/15018162-128x128.png" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>Teams Toolkit with Azure</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  
  
  <link href="prism.css" rel="stylesheet" />
<!-- include A-Frame obviously -->
<script src="aframe.min.js"></script>
<!-- include ar.js for A-Frame -->
<script src="aframe-ar.js"></script>



  
</head>
<body>
  
  <section class="menu menu3 cid-syLWMTcu0Q" once="menu" id="menu3-12g">
    
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-black text-primary display-7" href="index.html">Neil Haddley</a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="posts.html">
                            Blog Posts</a></li></ul>
                <div class="icons-menu">
                    <a class="iconfont-wrapper" href="https://www.linkedin.com/in/neil-haddley/" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-linkedin socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://github.com/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mbrib-github"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://www.npmjs.com/~haddley" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-npm socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://hub.docker.com/u/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mobi-mbri-delivery mobi-mbri"></span>
                    </a>
                </div>
                
            </div>
        </div>
    </nav>
</section>

<section class="content4 cid-syLWMTBOCb" id="content4-12h">
    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-2"><strong>Teams Toolkit with Azure</strong></h3>
                <h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5">Get started with Microsoft Teams app development using Azure.</h4>
                
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLWMTLyGp" id="image3-12i">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/teams-hi-res-icon-2019.svg" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4"><a rel="nofollow" href="https://commons.wikimedia.org/wiki/File:Teams_hi-res_icon_(2019).svg" class="text-primary">Teams hi-res icon (2019)</a>&nbsp;by <a href="https://en.wikipedia.org/wiki/en:Microsoft">Microsoft Corporation</a> is <a href="â€œhttps://commons.wikimedia.org/w/index.php?curid=43353450">Public Domain</a></p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-syLWMTTfep" id="content5-12j">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>Visual Studio Extension</strong></h4>
                <p class="mbr-text mbr-fonts-style display-7">Teams Toolkit makes creating Teams Tabs/Azure applications easier.<br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM31EXj46" id="image3-14e">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-5.12.18-pm-1836x824.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Add Teams Toolkit Extension to Visual Studio Code</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZBr320W" id="image3-136">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.47.21-pm-294x84.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Click the Teams Toolkit to open Wizard&nbsp;</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZC3HQKm" id="image3-137">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.48.08-pm-1468x1114.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Configure Quick Start items</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZCNyKKz" id="image3-139">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.49.16-pm-748x282.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Sign-in to M365 account</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZDafZ5b" id="image3-13a">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.49.23-pm-734x276.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Sign-in to Azure</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZDvJUJx" id="image3-13b">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.49.33-pm-726x330.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Click Create New Project link</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZDUSgt1" id="image3-13c">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.49.49-pm-1264x352.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Start from a sample</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZEjpAJJ" id="image3-13d">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.50.08-pm-1226x514.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Select the Todo List with backend on Azure sample</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZEIa7Ly" id="image3-13e">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.52.34-pm-534x552.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Download the sample code from Github</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZF9Q0QR" id="image3-13f">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.53.04-pm-1334x464.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Notice that the sample code is a work in progress</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZFzdnpO" id="image3-13g">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.54.00-pm-574x124.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Open Command Palette</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZGoaNRK" id="image3-13h">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.54.51-pm-1240x160.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Use Team: Provision in the Cloud command to configure Azure</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZGQAmez" id="image3-13i">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.55.24-pm-1252x210.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Enter a hard to guess database administrator account name</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZHcn2Hl" id="image3-13j">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.56.06-pm-530x780.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Configures Azure Services</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZHyHPjm" id="image3-13k">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-3.56.20-pm-970x336.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Provisioning progress</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZHVwZAF" id="image3-13l">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.09.03-pm-1836x1083.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Newly created resource group</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZIh3RG6" id="image3-13m">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.09.28-pm-1718x670.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Open SQL Database to copy "Server name"</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZIByXnn" id="image3-13n">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.10.16-pm-992x834.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Open Azure Data Studio and enter SQL Server connection details&nbsp;</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZIVCrfu" id="image3-13o">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.10.32-pm-998x838.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Ensure that Azure firewall rule is added</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZJWEFpU" id="image3-13q">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.12.32-pm-1102x714.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Use a Query tab in Azure Data Studio to create the Todo list</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZCokF4Q" id="image3-138">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.19.44-pm-1234x158.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Use Teams: Deploy to the Cloud command</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syLZAJDnlW" id="image3-135">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.19.52-pm-1248x264.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Deploy the React code and the Azure Function (API)</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM174diaA" id="image3-13s">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.23.48-pm-1258x166.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Use Teams: Build Teams Package command</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM17BoU0O" id="image3-13t">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.25.03-pm-1242x164.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Use Teams: Publish to Teams command</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM186tx1O" id="image3-13u">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.25.13-pm-1230x334.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Install to organization</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM191oHQg" id="image3-13w">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.26.40-pm-1836x903.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Open Microsoft Teams admin center. Locate app "pending approval"</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM18wFPh9" id="image3-13v">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.26.58-pm-1484x896.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Publish app</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM19nJKNI" id="image3-13x">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.27.08-pm-1210x510.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Click the Publish button</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1akkQU8" id="image3-13z">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.28.34-pm-682x388.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">App has been added to Microsoft Teams</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1aY2ADf" id="image3-140">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.29.15-pm-1188x616.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Use Add to a team button</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM16hqNyi" id="image3-13r">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.29.28-pm-1262x714.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Select a Team (click Set up a tab)</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1Qo92kR" id="image3-143">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.29.55-pm-1224x1230.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">View tab configuration page</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1QUc2kV" id="image3-144">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.30.25-pm-920x510.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Welcome page click Start to progress</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-syM6YBc97K" id="content7-14g">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>An extract from Tab.js</strong></h5>

<pre class="language-clike"><code><!--        
{this.state.showLoginPage === true && <div className="auth">
          <Profile userInfo={this.state.userInfo} />
          <h2>Welcome to To Do List App!</h2>
          <Button primary onClick={() => this.loginBtnClick()}>Start</Button>
        </div>}
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-syMdYVY1bU" id="content7-14n">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>Profile.js</strong></h5>

<pre class="language-clike"><code><!--         
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.

import React from 'react';
import './Profile.css';
import defaultPhoto from '../images/default-photo.png'

class Profile extends React.Component {
  render() {
    return (
      <div className="profile">
        <div className="photo">
          <img src={defaultPhoto} alt="avatar"/>
        </div>
        <div className="info">
          <div className="name">{this.props.userInfo.displayName}</div>
          <div className="email">{this.props.userInfo.preferredUserName}</div>
        </div>
      </div>
    );
  }
}

export default Profile;
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1RhnZo1" id="image3-145">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.30.56-pm-912x590.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Login is required</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-syM7j3paoU" id="content7-14h">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>An extract from Tab.js</strong></h5>

<pre class="language-clike"><code><!--         
  async componentDidMount() {
    await this.initTeamsFx();
    await this.initData();
  }

  async initTeamsFx() {
    // Initialize configuration from environment variables and set the global instance
    loadConfiguration({
      authentication: {
        initiateLoginEndpoint: process.env.REACT_APP_START_LOGIN_PAGE_URL,
        simpleAuthEndpoint: process.env.REACT_APP_TEAMSFX_ENDPOINT,
        clientId: process.env.REACT_APP_CLIENT_ID
      },
      resources: [
        {
          type: ResourceType.API,
          name: "default",
          properties: {
            endpoint: process.env.REACT_APP_FUNC_ENDPOINT
          }
        }
      ]
    });
    const credential = new TeamsUserCredential();
    // Get the user info from access token
    const userInfo = await credential.getUserInfo();

    this.setState({
      userInfo: userInfo
    });

    this.credential = credential;
    this.scope = ["User.Read", "User.ReadBasic.All"];
    this.channelOrChatId = await this.getChannelOrChatId();
  }

  async initData() {
    if (!await this.checkIsConsentNeeded()) {
      await this.getItems();
    }
  }

  async loginBtnClick() {
    try {
      // Popup login page to get user's access token
      await this.credential.login(this.scope);
    } catch (err) {
      alert("Login failed: " + err);
      return;
    }
    await this.initData();
  }

  async checkIsConsentNeeded() {
    try {
      await this.credential.getToken(this.scope);
    } catch (error) {
      this.setState({
        showLoginPage: true
      });
      return true;
    }
    this.setState({
      showLoginPage: false
    });
    return false;
  }
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1RDUKso" id="image3-146">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.31.12-pm-876x972.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Provide consent</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1S1mqK6" id="image3-147">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.31.30-pm-1836x1357.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">If no tasks to display</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-syM8dW3DMx" id="content7-14i">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>An extract from Tab.js</strong></h5>

<pre class="language-clike"><code><!--         
              {this.state.initialized && !this.state.items.length && !this.state.isAddingItem && <div className="no-item">
                <div>
                  <img src={noItemimage} alt="no item" />
                </div>
                <div>
                  <h2>No tasks</h2>
                  <p>Add more tasks to make you day productive.</p>
                </div>
              </div>}
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1SVLfQi" id="image3-149">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.32.02-pm-1740x328.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Add task (press enter)</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-syM90wHvdz" id="content7-14k">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>An extract from Tab.js</strong></h5>

<pre class="language-clike"><code><!--         
              {this.state.isAddingItem && <div className="item add">
                <div className="complete">
                  <Checkbox
                    disabled
                    className="is-completed-input"
                  />
                </div>
                <div className="description">
                  <Input
                    autoFocus
                    type="text"
                    value={this.state.newItemDescription}
                    onChange={(e) => this.setState({ newItemDescription: e.target.value })}
                    onKeyDown={(e) => {
                      if (e.key === 'Enter') {
                        this.onAddItem();
                      }
                    }}
                    onBlur={() => {
                      if (this.state.newItemDescription) {
                        this.onAddItem();
                      }
                      this.setState({
                        isAddingItem: false,
                      });
                    }}
                    className="text"
                  />
                </div>
              </div>}
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM1Sn9041" id="image3-148">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.32.16-pm-1758x462.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">using map to render all of the tasks</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-syM9xT8c4d" id="content7-14l">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>An extract from Tab.js</strong></h5>

<pre class="language-clike"><code><!--         
const items = this.state.items?.map((item, index) =>
      <div key={index} className="item">
        <div className="complete">
          <Checkbox
            checked={this.state.items[index].isCompleted}
            onChange={(e, { checked }) => this.onCompletionStatusChange(item.id, index, checked)}
            className="is-completed-input"
          />
        </div>
        <div className="description">
          <Input
            value={this.state.items[index].description}
            onChange={(e) => this.handleInputChange(index, "description", e.target.value)}
            onKeyDown={(e) => {
              if (e.key === 'Enter') {
                this.onUpdateItem(item.id, this.state.items[index].description);
                e.target.blur();
              }
            }}
            onBlur={() => this.onUpdateItem(item.id, this.state.items[index].description)}
            className={"text" + (this.state.items[index].isCompleted ? " is-completed" : "")}
          />
        </div>
        <Creator objectId={item.objectId} credential={this.credential} scope={this.scope} />
        <div className="action">
          <MenuButton
            trigger={<Button content="..." />}
            menu={[
              {
                content: 'Delete',
                onClick: () => this.onDeleteItem(item.id)
              }
            ]}
            on="click"
          />
        </div>
      </div>
    );

--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM2wrdR2W" id="image3-14b">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.35.11-pm-1836x977.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">A row has been added to the database</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM2wVijPf" id="image3-14c">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.42.13-pm-1836x1181.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">The function app is used to implement a REST api</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-syMaqYkasA" id="content7-14m">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>index.js</strong></h5>

<pre class="language-clike"><code><!--         
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.

const {
    loadConfiguration,
    OnBehalfOfUserCredential,
    DefaultTediousConnectionConfiguration,
} = require("@microsoft/teamsfx");
const { Connection, Request } = require('tedious');

/**
 * This function handles requests sent from teamsfx client SDK.
 * The HTTP request should contain an SSO token in the header and any content in the body.
 * The SSO token should be queried from Teams client by teamsfx client SDK.
 * Before trigger this function, teamsfx binding would process the SSO token and generate teamsfx configuration.
 *
 * This function initializes the teamsfx Server SDK with the configuration and calls these APIs:
 * - getUserInfo() - Get the user's information from the received SSO token.
 * - getMicrosoftGraphClientWithUserIdentity() - Get a graph client to access user's Microsoft 365 data.
 *
 * The response contains multiple message blocks constructed into a JSON object, including:
 * - An echo of the request body.
 * - The display name encoded in the SSO token.
 * - Current user's Microsoft 365 profile if the user has consented.
 *
 * @param {Context} context - The Azure Functions context object.
 * @param {HttpRequest} req - The HTTP request.
 * @param {teamsfxConfig} config - The teamsfx configuration generated by teamsfx binding.
 */
module.exports = async function (context, req, config) {
    let connection;
    // Initialize configuration from environment variables and set the global instance
    loadConfiguration()
    try {
        connection = await getSQLConnection();
        const method = req.method.toLowerCase();
        const accessToken = config.AccessToken;
        const credential = new OnBehalfOfUserCredential(accessToken);
        // Get the user info from access token
        const currentUser = await credential.getUserInfo();
        const objectId = currentUser.objectId;
        var query;

        switch (method) {
            case "get":
                query = `select id, description, isCompleted, objectId from dbo.Todo where channelOrChatId = '${req.query.channelOrChatId}'`;
                break;
            case "put":
                if (req.body.description) {
                    query = `update dbo.Todo set description = N'${req.body.description}' where id = ${req.body.id}`;
                } else {
                    query = `update dbo.Todo set isCompleted = ${req.body.isCompleted ? 1 : 0} where id = ${req.body.id}`;
                }
                break;
            case "post":
                query = `insert into dbo.Todo (description, objectId, isCompleted, channelOrChatId) values (N'${req.body.description}','${objectId}',${req.body.isCompleted ? 1 : 0},'${req.body.channelOrChatId}')`;
                break;
            case "delete":
                query = "delete from dbo.Todo where " + (req.body ? `id = ${req.body.id}` : `objectId = '${objectId}'`);
                break;
        }
        // Execute SQL through TeamsFx server SDK generated connection and return result
        const result = await execQuery(query, connection);
        return {
            status: 200,
            body: result
        }
    }
    catch (err) {
        return {
            status: 500,
            body: {
                error: err.message
            }
        }
    }
    finally {
        if (connection) {
            connection.close();
        }
    }
}

async function getSQLConnection() {
    const sqlConnectConfig = new DefaultTediousConnectionConfiguration();
    const config = await sqlConnectConfig.getConfig();
    const connection = new Connection(config);
    return new Promise((resolve, reject) => {
        connection.on('connect', err => {
            if (err) {
                reject(err);
            }
            resolve(connection);
        })
        connection.on('debug', function (err) {
            console.log('debug:', err);
        });
    })
}

async function execQuery(query, connection) {
    return new Promise((resolve, reject) => {
        const res = [];
        const request = new Request(query, (err) => {
            if (err) {
                reject(err);
            }
        });

        request.on('row', columns => {
            const row = {};
            columns.forEach(column => {
                row[column.metadata.colName] = column.value;
            });
            res.push(row)
        });

        request.on('requestCompleted', () => {
            resolve(res)
        });

        request.on("error", err => {
            reject(err);
        });

        connection.execSql(request);
    })
}

--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-syM2xhcNHP" id="image3-14d">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-05-29-at-4.45.25-pm-1836x1182.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Tab.js</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="features13 cid-syLWMXbrJD" id="features14-133">
    

    
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h3 class="mbr-section-title align-center mb-4 mbr-fonts-style display-2"><strong>References</strong></h3>
            </div>
            <div class="card col-12 col-md-4 col-lg-2 p-3">
                <div class="card-wrapper">
                    <div class="card-box align-center">
                        <span class="mbr-iconfont mbri-pages"></span>
                        <h4 class="card-title align-center mbr-black mbr-fonts-style display-7"><strong><a href="https://docs.microsoft.com/en-us/microsoftteams/platform/get-started/prerequisites?tabs=vscode" class="text-primary" target="_blank">Teams Toolkit</a></strong></h4>
                    </div>
                </div>
            </div>
            
            
            
            
            
        </div>
    </div>
</section><section class="display-7" style="padding: 0;align-items: center;justify-content: center;flex-wrap: wrap;    align-content: center;display: flex;position: relative;height: 4rem;"><a href="https://mobiri.se/2350277" style="flex: 1 1;height: 4rem;position: absolute;width: 100%;z-index: 1;"><img alt="" style="height: 4rem;" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="></a><p style="margin: 0;text-align: center;" class="display-7">Made with Mobirise &#8204;</p><a style="z-index:1" href="https://mobirise.com/html-builder.html">HTML Site Builder</a></section><script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>  <script src="assets/smoothscroll/smooth-scroll.js"></script>  <script src="assets/ytplayer/index.js"></script>  <script src="assets/dropdown/js/navbar-dropdown.js"></script>  <script src="assets/theme/js/script.js"></script>  
  <script src="prism.js"></script>
<script src="webcomponents/howtoTooltip.js"></script>
  
</body>
</html>