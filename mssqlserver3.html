<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v5.9.4, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v5.9.4, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/15018162-128x128.png" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>Microsoft SQL Server (Part 3)</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">

  
  <link href="prism.css" rel="stylesheet" />
<!-- include A-Frame obviously -->
<script src="aframe.min.js"></script>
<!-- include ar.js for A-Frame -->
<script src="aframe-ar.js"></script>



  
</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu3 cid-suvjaDKbAp" once="menu" id="menu3-sr">
    
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-black text-primary display-7" href="index.html">Neil Haddley</a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="posts.html">
                            Blog Posts</a></li></ul>
                <div class="icons-menu">
                    <a class="iconfont-wrapper" href="https://www.linkedin.com/in/neil-haddley/" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-linkedin socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://github.com/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mbrib-github"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://www.npmjs.com/~haddley" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-npm socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://hub.docker.com/u/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mobi-mbri-delivery mobi-mbri"></span>
                    </a>
                </div>
                
            </div>
        </div>
    </nav>
</section>

<section class="content4 cid-suvjaEbaQB" id="content4-ss">
    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-2">
                    <strong>Microsoft SQL Server (Part 3)</strong></h3>
                <h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5">A Node, React and MS SQL Server App.</h4>
                
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suvjaEklfg" id="image3-st">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <a href="mssqlserver.html"><img src="assets/images/ads.svg" alt=""></a>
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4"><a href="https://github.com/microsoft/azuredatastudio/blob/main/extensions/sql-migration/media/ads.svg" class="text-primary">ads</a>&nbsp;by&nbsp;<a href="https://www.microsoft.com" class="text-primary">Microsoft Corporation</a>&nbsp;is licensed under&nbsp;<a rel="nofollow" class="external text" href="https://github.com/microsoft/azuredatastudio/blob/main/LICENSE.txt">Source EULA</a></p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvjaEvmdq" id="content5-su">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Create Database</h4>
                <p class="mbr-text mbr-fonts-style display-7">Start by creating the SQL Server Database</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suvjaENcyE" id="content7-sw">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>Create Database</strong></h5>

<pre class="language-clike"><code><!--         
-- Create a new database called 'ToDo'
-- Connect to the 'master' database to run this snippet
USE master
GO
-- Create the new database if it does not exist already
IF NOT EXISTS (
    SELECT [name]
        FROM sys.databases
        WHERE [name] = N'ToDo'
)
CREATE DATABASE ToDo
GO
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvjaEVW7a" id="content5-sx">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Use ToDo</h4>
                <p class="mbr-text mbr-fonts-style display-7">Switch to ToDo Database</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suvjaF6he2" id="content7-sy">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>Use ToDo</strong></h5>

<pre class="language-clike"><code><!--         
Use ToDo;
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvjaFccze" id="content5-sz">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Create Table</h4>
                <p class="mbr-text mbr-fonts-style display-7">Create Tasks Table<br></p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suvjaFthPN" id="content7-t1">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>Create Table</strong></h5>

<pre class="language-clike"><code><!--         
-- Create a new table called '[Tasks]' in schema '[dbo]'
-- Drop the table if it already exists
IF OBJECT_ID('[dbo].[Tasks]', 'U') IS NOT NULL
DROP TABLE [dbo].[Tasks]
GO
-- Create the table in the specified schema
CREATE TABLE [dbo].[Tasks]
(
    [Id] INT IDENTITY PRIMARY KEY, -- Primary Key column
    [UserId] NVARCHAR(50) NOT NULL,
    [Title] NVARCHAR(50) NOT NULL,
    [Description] NVARCHAR(1000) NOT NULL,
    [DueDate] date NOT NULL,
    [DueTime] time(0) NULL,
    [IsDone] BIT default 'FALSE',
    INDEX idx_tasks_userId (UserId)
);
GO
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvjaFA5L6" id="content5-t2">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Add Sample Rows</h4>
                <p class="mbr-text mbr-fonts-style display-7">Add sample rows to the Tasks table.</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suvpdGJsJ7" id="content7-tk">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>Insert into Tasks</strong></h5>

<pre class="language-clike"><code><!--         
-- Insert rows into table 'Tasks' in schema '[dbo]'
INSERT INTO [dbo].[Tasks]
( -- Columns to insert data into
 [UserId], [Title], [Description], [DueDate], [DueTime]
)
VALUES
( -- First row: values for the columns in the list above
 'Doe', N'Shopping', N'Dinner Party Supplies','2021-12-31','19:00'
),
( -- Second row: values for the columns in the list above
'Doe', N'Yardwork', N'Mow Lawn','2021-12-15',null
)
-- Add more rows here
GO
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvNHBnULs" id="content5-tl">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">npm init</h4>
                <p class="mbr-text mbr-fonts-style display-7">npm init -y<br></p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvP82dntp" id="content5-tm">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">hapi</h4>
                <p class="mbr-text mbr-fonts-style display-7">npm install @hapi/hapi</p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvPuaSKv9" id="content5-tn">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">eslint</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ npm install eslint --save-dev<br>$CONTENT$nbsp;npx eslint --init<br>&gt; To check syntax, find problems, and enforce code style<br>&gt; CommonJS (require/exports)<br><strong>React</strong><br>&gt;&nbsp;Does your project use TypeScript? <br><strong>No</strong> / Yes<br>&gt; Where does your code run? <br><strong>Node</strong><br>&gt; Use a popular style guide<br><strong>Answer questions about your style</strong><br>&gt;&nbsp;What format do you want your config file to be in?<br><strong>JavaScript</strong><br>&gt; What style of indentation do you use?<br><strong>Tabs</strong><br>&gt;&nbsp;What quotes do you use for strings?<br><strong>Double</strong><br>&gt; What line endings do you use? <br><strong>Unix</strong><br>&gt; Do you require semicolons?<br><strong>No</strong><br></p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvUqLJQNC" id="content5-to">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/index.js</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ mkdir src<br>$ cd src<br>$ touch index.js<br><br></p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suw4f6ZvCZ" id="content7-tu">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/index.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const server = require("./server");

const startServer = async () => {
    try {
        const config = {
            host: "localhost",
            port: "8080"
        };
        const app = await server(config);
        await app.start();

        console.log(`Server running at http://${config.host}:${config.port}`);
    } catch (err) {
        console.log("startup error", err);
    }
};

startServer();
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suvWZ5X5xB" id="content5-tp">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/server.js</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ touch server.js</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suw4g861JL" id="content7-tv">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/server.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const hapi = require("@hapi/hapi");
const routes = require("./routes");

const app = async config => {
    const { host, port } = config;
    const server = hapi.server({ host, port });
    server.app.config = config;
    await routes.register(server);
    return server;
};

module.exports = app;
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suw1TpSwr3" id="content5-tq">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/routes/index.js</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ mkdir routes<br>$ cd routes<br>$ touch index.js</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suw4h2cZdU" id="content7-tw">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/routes/index.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

module.exports.register = async server => {
    server.route({
        method: "GET",
        path: "/",
        handler: async (request, h) => {
            return "Hapi server";
        }
    })
}
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suw2TItP0I" id="content5-tr">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">package.json</h4>
                <p class="mbr-text mbr-fonts-style display-7">"main": "src/index.js",<br></p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suw3q4z3Oq" id="content5-ts">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Run and test</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ node .<br><br>navigate to http://localhost:8080</p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suw44hZffw" id="content5-tt">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">.env</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ npm install dotenv<br>$ touch .env</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-sux3xTtVXC" id="content7-ty">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>.env</strong></h5>

<pre class="language-clike"><code><!--         
# hapi
PORT=8080
HOST=localhost
HOST_URL=http://localhost:8080

# sql
SQL_USER=sa
SQL_PASSWORD=Passw0rd123
SQL_DATABASE=ToDo
SQL_SERVER=192.168.68.109
# true for Azure SQL Server
SQL_ENCRYPT=false

# azure active directory
AZURE_APP_CLIENT_ID=63fe01c7-f396-484e-8a48-760f********
AZURE_DIR_TENANT_ID=1661e837-0a95-4bc6-a655-8653********
AZURE_CLIENT_SECRET=-~nGgWS3F7y~-o2etNGc0BW_ik_*******
AZURE_CLOUD_INSTANCE_ID=https://microsoftonline.com
AZURE_GRAPH_ENDPOINT=https://graph.microsoft.com
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sux3idlMf3" id="content5-tx">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/config.js</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ cd src<br>$ touch config.js</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-sux3yWy1Jw" id="content7-tz">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/config.js</strong><strong><br></strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const dotenv = require("dotenv");
const assert = require("assert");

dotenv.config();

const {
    PORT,
    HOST,
    HOST_URL,
    SQL_SERVER,
    SQL_DATABASE,
    SQL_USER,
    SQL_PASSWORD
} = process.env;

const sqlEncrypt = process.env.SQL_ENCRYPT === "true";

assert(PORT,"Port is required");
assert(HOST,"HOST is required");
assert(HOST_URL,"HOST_URL is required");
assert(SQL_SERVER,"SQL_SERVER is required");
assert(SQL_DATABASE,"SQL_DATABASE is required");
assert(SQL_USER,"SQL_USER is required");
assert(SQL_PASSWORD,"SQL_PASSWORD is required");

module.exports = {
    port: PORT,
    host: HOST,
    database: SQL_DATABASE,
    url: HOST_URL,
    sql: {
        server: SQL_SERVER,
        user: SQL_USER,
        password: SQL_PASSWORD,
        options: {
            encrypt: sqlEncrypt,
            enableArithAbort:true
        }
    }
}
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sux8cNzxy1" id="content5-u0">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">mssql fs-extra</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ npm install mssql<br>$ npm install fs-extra<br><br></p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sux9U15ogj" id="content5-u1">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">data access</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ cd src<br>$ mkdir data<br>$ cd data<br>$ touch index.js<br><br></p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suxa7wSTD8" id="content7-u2">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/data/index.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const tasks = require("./tasks");
const sql = require("mssql");

const client = async (server, config) => {
    let pool = null;

    const closePool = async () => {
        try {
            await pool.close();
            pool = null;
        } catch (err) {
            console.log(err);
        }
    };

    const getConnection = async () => {
        try {
            if (pool) {
                return pool;
            }
            pool = await sql.connect(config) // was connect() in previous version of mssql library
            pool.on("error", async err => {
                console.log(err);
                await closePool();
            })
            return pool;
        } catch (err) {
            console.log(err);
            pool = null;
        }
    };

    return {
        tasks: await tasks.register({ sql, getConnection })
    }

};

module.exports = client;
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suAysmnQvf" id="content5-u5">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/data/utils.js</h4>
                <p class="mbr-text mbr-fonts-style display-7">Maintain sql statements as .sql files in src/data/... subfolders and read at runtime.<br><br>$ touch utils.js</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suBKOwgtUp" id="content7-uc">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/data/utils.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const fs=require("fs-extra");
const {join}=require("path");

const loadSqlQueries=async folderName=>{

    const filePath = join(process.cwd(),"src","data",folderName);
    const files = await fs.readdir(filePath);
    const sqlFiles = files.filter( f=> f.endsWith(".sql"))
    const queries  = {};
    for(const sqlFile of sqlFiles){
        const query=fs.readFileSync(join(filePath,sqlFile),{encoding:"UTF-8"});
        queries[sqlFile.replace(".sql","")] = query;
    }
    return queries;
}

module.exports = {
    loadSqlQueries
};
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suAQ5uC4Lt" id="content5-u6">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/data/tasks folder</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ mkdir tasks<br>$ cd tasks<br>$ touch getTasks.sql<br>$CONTENT$nbsp;touch index.js</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suBLLlhhqo" id="content7-uh">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/data/tasks/getTasks.sql</strong></h5>

<pre class="language-clike"><code><!--         
SELECT TOP (1000) [Id],
	[UserId],
	[Title],
	[Description],
	[DueDate],
	[DueTime],
	[IsDone]
FROM [ToDo].[dbo].[Tasks]
WHERE [UserId] = @userId
ORDER BY [DueDate],
	[DueTime]
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suBKRRfsXJ" id="content7-ud">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/data/tasks/index.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const utils = require("../utils");

const register = async ({ sql, getConnection }) => {
    const sqlQueries = await utils.loadSqlQueries("tasks");
    const getTasks = async userId => {
        const cnx = await getConnection();
        const request = await cnx.request();
        request.input("userId", sql.VarChar(50), userId);
        return request.query(sqlQueries.getTasks);
    }

    return {
        getTasks
    };
};

module.exports = { register };
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suAYxJoMlr" id="content5-u7">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/plugins</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ mkdir plugins<br>$ cd plugins<br>$ touch index.js<br>$ touch sql.js</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suBMetnAss" id="content7-ui">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/plugins/index.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const sql=require("./sql");

module.exports.register = async server=>{
    await server.register(sql);
};
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suBKTmMwxF" id="content7-ue">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/plugins/sql.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const dataClient = require("../data");

module.exports={
    name:"sql",
    version:"1.0.0",
    register:async server=>{
        const config= server.app.config.sql;
        const client = await dataClient(server,config);
        server.expose("client",client);
    }
}
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suB0iAqymX" id="content5-u8">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">src/routes/api</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ mkdir api<br>$ cd api<br>$ touch index.js<br>$ touch tasks.js</p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suBKUsVZyS" id="content7-uf">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/routes/api/index.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

const tasks = require("./tasks");

module.exports.register=async server=>{
    await tasks.register(server)
};
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-suBLrI3Epy" id="content7-ug">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>src/routes/api/tasks.js</strong></h5>

<pre class="language-clike"><code><!--         
"use strict";

module.exports.register = async server => {
    server.route({
        method: "GET",
        path: "/api/tasks",
        handler: async request => {
            try {
    const db = request.server.plugins.sql.client;
                const userId = "Doe";
                const res = await db.tasks.getTasks(userId);
                return res.recordset;
            } catch (err) {
                console.log(err); 
            }
        }
    });
};
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suBNkejd31" id="content5-uj">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Run and test</h4>
                <p class="mbr-text mbr-fonts-style display-7">$ node .</p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suMn0ICo9L" id="content5-un">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">okta</h4>
                <p class="mbr-text mbr-fonts-style display-7">okta is a service that simplifies identity management</p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suMoE8Mygx" id="image3-up">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-04-17-at-8.02.48-am-1836x926.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suMqQpkzSQ" id="content5-us">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">register app</h4>
                <p class="mbr-text mbr-fonts-style display-7">https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app<br><br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suMqS6O2dF" id="image3-ut">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-04-17-at-8.54.33-am-1130x744.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suMqSMxtyD" id="image3-uu">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-04-17-at-8.56.43-am-1678x964.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suMqThZDf4" id="image3-uv">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suMwfZpLOW" id="content5-uz">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">workbench.aspx</h4>
                <p class="mbr-text mbr-fonts-style display-7">https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationMenuBlade/Quickstart/quickStartType//sourceType/Microsoft_AAD_IAM/appId/c03242fe-84f5-4069-9507-3667965ba3af/objectId/3305d263-36f4-4639-899d-e5d34fd020df/isMSAApp//defaultBlade/Overview/appSignInAudience/AzureADandPersonalMicrosoftAccount/servicePrincipalCreated/true<br><br><br><br><br><br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suMsvqvX1K" id="image3-uw">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suMswliD5o" id="image3-uy">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suMsvWkZnG" id="image3-ux">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suMmryr9mD" id="content5-um">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">okta - Add an external Identity Provider</h4>
                <p class="mbr-text mbr-fonts-style display-7">https://developer.okta.com/docs/guides/add-an-external-idp/microsoft/create-an-app-at-idp/<br><br><br></p>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suB4803Nv3" id="content5-u9">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">&lt;TO DISCUSS&gt;</h4>
                <p class="mbr-text mbr-fonts-style display-7">NAMING CONVENTION FOR TABLE AND TABLE COLUMN NAMES (SQL Server or JavaScript friendly?)<br><br>1:26:50</p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-suBdfhNLNB" id="image3-ub">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">esp8266</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-suBd7wRq3a" id="content5-ua">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">error handling</h4>
                <p class="mbr-text mbr-fonts-style display-7">// in production use hapi-pino, winston?<br></p>
            </div>
        </div>
    </div>
</section>

<section class="features13 cid-suxfxv4Qaw" id="features14-u4">
    

    
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h3 class="mbr-section-title align-center mb-4 mbr-fonts-style display-2"><strong>References</strong></h3>
            </div>
            <div class="card col-12 col-md-4 col-lg-2 p-3">
                <div class="card-wrapper">
                    <div class="card-box align-center">
                        <span class="mbr-iconfont mbri-pages"></span>
                        <h4 class="card-title align-center mbr-black mbr-fonts-style display-7"><strong><a href="https://www.youtube.com/watch?v=XJpYH7K7TGM" class="text-primary" target="_blank">Build a Secure Node.js App with SQL Server</a></strong></h4>
                    </div>
                </div>
            </div>
            
            
            
            
            
        </div>
    </div>
</section><section class="display-7" style="padding: 0;align-items: center;justify-content: center;flex-wrap: wrap;    align-content: center;display: flex;position: relative;height: 4rem;"><a href="https://mobiri.se/2350277" style="flex: 1 1;height: 4rem;position: absolute;width: 100%;z-index: 1;"><img alt="" style="height: 4rem;" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="></a><p style="margin: 0;text-align: center;" class="display-7">&#8204;</p><a style="z-index:1" href="https://mobirise.com/builder/landing-page-builder.html">Landing Page Maker</a></section><script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>  <script src="assets/smoothscroll/smooth-scroll.js"></script>  <script src="assets/ytplayer/index.js"></script>  <script src="assets/dropdown/js/navbar-dropdown.js"></script>  <script src="assets/theme/js/script.js"></script>  
  <script src="prism.js"></script>
<script src="webcomponents/howtoTooltip.js"></script>
  
</body>
</html>