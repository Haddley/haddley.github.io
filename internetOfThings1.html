<!DOCTYPE html>
<html  >
<head>
  
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/15018162-128x128.png" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>Internet of Things (Part 1)</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css?v=8v5qxZ"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css?v=8v5qxZ" type="text/css">

  
  <link href="prism.css" rel="stylesheet" />
<!-- include A-Frame obviously -->
<script src="aframe.min.js"></script>
<!-- include ar.js for A-Frame -->
<script src="aframe-ar.js"></script>



  
</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu3 cid-sqD0i9BP6U" once="menu" id="menu3-fe">
    
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-black text-primary display-7" href="index.html">Neil Haddley</a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="posts.html">
                            Blog Posts</a></li></ul>
                <div class="icons-menu">
                    <a class="iconfont-wrapper" href="https://www.linkedin.com/in/neil-haddley/" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-linkedin socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://github.com/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mbrib-github"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://www.npmjs.com/~haddley" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-npm socicon"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://hub.docker.com/u/haddley" target="_blank">
                        <span class="p-2 mbr-iconfont mobi-mbri-delivery mobi-mbri"></span>
                    </a>
                </div>
                
            </div>
        </div>
    </nav>
</section>

<section class="content4 cid-sqD0iahlAI" id="content4-ff">
    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-2">
                    <strong>Internet of Things (Part 1)</strong></h3>
                <h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5">ESP8266 is a low-cost Wi-Fi microchip, with a full TCP/IP stack and microcontroller capability.
                </h4>
                
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqD0iaCQi6" id="image3-fg">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/iot-microchip.svg" alt="Electron">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4"><a rel="nofollow" href="https://thenounproject.com/term/iot-microchip/2546028/"><br>            iot microchip</a>&nbsp;by&nbsp;<a rel="nofollow" href="/masteroficon">Philipp Petzka</a>&nbsp;is licensed under&nbsp;<a rel="nofollow" class="external text" href="https://creativecommons.org/licenses/by/2.0/">CC<br></a></p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqF8FOkWVJ" id="content5-gd">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Breadboard</h4>
                <p class="mbr-text mbr-fonts-style display-7">Here an ESP8266 device is connected to a&nbsp;DHT11 temperature and humidity sensor.<br><br>With the Hardware assembled we can create and configure the Internet of Things (IoT) software.<br><br>An MQTT publish/subscribe broker will be at the center of the software configuration. We will upload code to the ESP8266 that will allow the ESP8266 device to communicate with other devices via the MQTT broker.</p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqF7BO7DP8" id="image3-gc">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/esp8266-512x384.png" alt="esp8266">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">
                        ESP8266 with DHT Sensor</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqRwte7GjI" id="content5-gr">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Arduino IDE setup</h4>
                <p class="mbr-text mbr-fonts-style display-7">The Arduino Integrated Development Environment (IDE) can be used to create and upload C++ code to an ESP8266.<br><br>To add support for ESP8266 boards to the Arduino IDE select the "Arduino|Preferences..." menu item and add this url to the "additional boards manager" text box:<br><br>http://arduino.esp8266.com/stable/package_esp8266com_index.json<br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqRFnkwRAK" id="image3-gt">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.23.14-pm-1592x1116.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">
                        Arduino IDE Preferences</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqRRfC4ygG" id="content5-h2">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Support for the ESP8266 board</h4>
                <p class="mbr-text mbr-fonts-style display-7">Use the&nbsp;"Tools|Board|Boards Manager..." menu item to install support for the ESP8266 boards.<br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqRGJmrLIm" id="image3-gu">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.28.06-pm-1108x122.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">
                        Boards Manager...</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqRGQO1OuE" id="image3-gv">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.28.36-pm-1596x894.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Boards package</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqRHsKmhNw" id="content5-gw">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">GitHub boards</h4>
                <p class="mbr-text mbr-fonts-style display-7">The ESP8266 boards information is maintained in a GitHub repository<br><br><a href="https://github.com/esp8266/Arduino" class="text-primary" target="_blank">https://github.com/esp8266/Arduino</a><br><br>Once the boards package is installed the correct ESP8266 board can be selected.<a href="https://github.com/esp8266/Arduino" class="text-primary" target="_blank"><br></a><br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqRIp40ax5" id="image3-gx">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.36.46-pm-1512x318.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Selecting "NodeMCU (ESP-12E Module)"</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqRINNqHVc" id="content5-gy">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">ESP8622 Libraries</h4>
                <p class="mbr-text mbr-fonts-style display-7">Arduino libraries can downloaded to the Arduino IDE using the "Tools|Manage Libraries..." menu item.<br><br>The PubSubClient library allows the ESP8266 to connect to an MQTT broker.</p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqRJ6wiy2V" id="image3-gz">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.55.43-pm-1596x902.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">PubSubClient Library</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqRKsPqCoB" id="content5-h0">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">PubSubLibrary example</h4>
                <p class="mbr-text mbr-fonts-style display-7"><a href="https://github.com/knolleary/pubsubclient" class="text-primary" target="_blank">knolleary/pubsubclient</a> is licensed under the MIT License.<br><br>Once the PubSubClient Library is installed the mqtt_esp8266 example sketch is added&nbsp;to the "File|Examples" Menu.<br></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqRO0x0eLJ" id="image3-h1">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-9.58.23-pm-906x374.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">An example ESP8266 sketch</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqRSQ0flzL" id="content5-h3">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">The mqtt_esp8266 example sketch</h4>
                <p class="mbr-text mbr-fonts-style display-7">The mqtt_esp8266 example sketch subscribes to an MQTT server's "inTopic" messages.<br><br>When an "inTopic" message is received by the ESP8266 the example code's "callback" function is executed. If the payload of the "inTopic" message is the string "1" the ESP8266's builtin LED is turned on.<br><br>Every two seconds the example sketch publishes a "hello world" message to "outTopic".<br></p>
            </div>
        </div>
    </div>
</section>

<section class="content7 cid-sqS7FDaE6Z" id="content7-i3">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong><a href="https://github.com/knolleary/pubsubclient/blob/master/examples/mqtt_esp8266/mqtt_esp8266.ino" class="text-primary" target="_blank">mqtt_esp8266.ino</a></strong></h5>

<pre class="language-clike"><code><!--         
/*
 Basic ESP8266 MQTT example
 This sketch demonstrates the capabilities of the pubsub library in combination
 with the ESP8266 board/library.
 It connects to an MQTT server then:
  - publishes "hello world" to the topic "outTopic" every two seconds
  - subscribes to the topic "inTopic", printing out any messages
    it receives. NB - it assumes the received payloads are strings not binary
  - If the first character of the topic "inTopic" is an 1, switch ON the ESP Led,
    else switch it off
 It will reconnect to the server if the connection is lost using a blocking
 reconnect function. See the 'mqtt_reconnect_nonblocking' example for how to
 achieve the same result without blocking the main loop.
 To install the ESP8266 board, (using Arduino 1.6.4+):
  - Add the following 3rd party board manager under "File -> Preferences -> Additional Boards Manager URLs":
       http://arduino.esp8266.com/stable/package_esp8266com_index.json
  - Open the "Tools -> Board -> Board Manager" and click install for the ESP8266"
  - Select your ESP8266 in "Tools -> Board"
*/

/**/

#include <ESP8266WiFi.h>
#include <PubSubClient.h>

// Update these with values suitable for your network.

const char* ssid = "........";
const char* password = "........";
const char* mqtt_server = "broker.mqtt-dashboard.com";

WiFiClient espClient;
PubSubClient client(espClient);
unsigned long lastMsg = 0;
#define MSG_BUFFER_SIZE	(50)
char msg[MSG_BUFFER_SIZE];
int value = 0;

void setup_wifi() {

  delay(10);
  // We start by connecting to a WiFi network
  Serial.println();
  Serial.print("Connecting to ");
  Serial.println(ssid);

  WiFi.mode(WIFI_STA);
  WiFi.begin(ssid, password);

  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  randomSeed(micros());

  Serial.println("");
  Serial.println("WiFi connected");
  Serial.println("IP address: ");
  Serial.println(WiFi.localIP());
}

void callback(char* topic, byte* payload, unsigned int length) {
  Serial.print("Message arrived [");
  Serial.print(topic);
  Serial.print("] ");
  for (int i = 0; i < length; i++) {
    Serial.print((char)payload[i]);
  }
  Serial.println();

  // Switch on the LED if an 1 was received as first character
  if ((char)payload[0] == '1') {
    digitalWrite(BUILTIN_LED, LOW);   // Turn the LED on (Note that LOW is the voltage level
    // but actually the LED is on; this is because
    // it is active low on the ESP-01)
  } else {
    digitalWrite(BUILTIN_LED, HIGH);  // Turn the LED off by making the voltage HIGH
  }

}

void reconnect() {
  // Loop until we're reconnected
  while (!client.connected()) {
    Serial.print("Attempting MQTT connection...");
    // Create a random client ID
    String clientId = "ESP8266Client-";
    clientId += String(random(0xffff), HEX);
    // Attempt to connect
    if (client.connect(clientId.c_str())) {
      Serial.println("connected");
      // Once connected, publish an announcement...
      client.publish("outTopic", "hello world");
      // ... and resubscribe
      client.subscribe("inTopic");
    } else {
      Serial.print("failed, rc=");
      Serial.print(client.state());
      Serial.println(" try again in 5 seconds");
      // Wait 5 seconds before retrying
      delay(5000);
    }
  }
}

void setup() {
  pinMode(BUILTIN_LED, OUTPUT);     // Initialize the BUILTIN_LED pin as an output
  Serial.begin(115200);
  setup_wifi();
  client.setServer(mqtt_server, 1883);
  client.setCallback(callback);
}

void loop() {

  if (!client.connected()) {
    reconnect();
  }
  client.loop();

  unsigned long now = millis();
  if (now - lastMsg > 2000) {
    lastMsg = now;
    ++value;
    snprintf (msg, MSG_BUFFER_SIZE, "hello world #%ld", value);
    Serial.print("Publish message: ");
    Serial.println(msg);
    client.publish("outTopic", msg);
  }
}
--></code></pre>
                    

                    
</blockquote>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqD0iaTSkc" id="content5-fi">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">MQTT</h4>
                <p class="mbr-text mbr-fonts-style display-7">MQTT is a publish/subscribe messaging system commonly used by IoT devices.<br><br>The 'eclipse-mosquitto' Docker container image can be used to establish a test MQTT broker.<br><br><strong>$ docker run -it -p 1883:1883 -p 9001:9001 eclipse-mosquitto:1.4.8</strong></p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqF38lY4mo" id="image3-gb">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-04-at-5.36.09-pm-1132x734.png" alt="eclipse-mosquitto">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">eclipse-mosquitto <a href="docker.html" class="text-primary">Docker</a> image</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content5 cid-sqFexGfLvy" id="content5-gi">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">MQTT Explorer</h4>
                <p class="mbr-text mbr-fonts-style display-7">Desktop and mobile applications are able to connect to an MQTT broker showing messages that are being published. Desktop and mobile applications allow users to manually publish messages to an MQTT broker.</p>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqFeZQGheJ" id="image3-gj">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-04-at-6.25.29-pm-1836x1286.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">
                        MQTT Explorer connecting to the MQTT broker</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqS8kyNn8I" id="image3-i4">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-11.11.07-pm-622x362.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">ESP8266 is publishing "outTopic" messages to the MQTT broker</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="image3 cid-sqS91esNkN" id="image3-i6">
    

    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/screen-shot-2021-03-06-at-11.21.28-pm-1616x930.png" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">MQTT explorer publishes an "inTopic" message with payload "1" to the MQTT broker and the ESP8266's LED turns on.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="content12 cid-sqWdQW6iIT" id="content12-iz">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                <div class="mbr-section-btn align-center"><a class="btn btn-primary display-4" href="internetOfThings2.html">Internet of Things (Part 2)</a></div>
            </div>
        </div>
    </div>
</section>

<section class="features13 cid-sqQvR2ltD2" id="features14-gq">
    

    
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h3 class="mbr-section-title align-center mb-4 mbr-fonts-style display-2"><strong>References</strong></h3>
            </div>
            <div class="card col-12 col-md-4 col-lg-2 p-3">
                <div class="card-wrapper">
                    <div class="card-box align-center">
                        <span class="mbr-iconfont mbri-pages"></span>
                        <h4 class="card-title align-center mbr-black mbr-fonts-style display-7"><strong><a href="https://www.youtube.com/watch?v=NjKK5ab0-Kk" class="text-primary" target="_blank">Understanding MQTT: How Smart Home Devices Communicate</a></strong></h4>
                    </div>
                </div>
            </div>
            
            
            
            
            
        </div>
    </div>
</section>


<script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/ytplayer/index.js"></script>
  <script src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="assets/theme/js/script.js"></script>
  
  <script src="prism.js"></script>
<script src="webcomponents/howtoTooltip.js"></script>
  
</body>
</html>