1:"$Sreact.fragment"
2:I[9379,["619","static/chunks/619-ba102abea3e3d0e4.js","177","static/chunks/app/layout-b6140098d4dc0e33.js"],"default"]
3:I[9766,[],""]
4:I[8924,[],""]
6:I[4431,[],"OutletBoundary"]
8:I[5278,[],"AsyncMetadataOutlet"]
a:I[4431,[],"ViewportBoundary"]
c:I[4431,[],"MetadataBoundary"]
d:"$Sreact.suspense"
f:I[7150,[],""]
:HL["/_next/static/media/949adacb6381283a-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/9dd75fadc5b3df29-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/a7d33c8790143d66.css","style"]
0:{"P":null,"b":"RJUMHoOpO5HDs1LInqYrA","p":"","c":["","posts","MicrosoftGraph",""],"i":false,"f":[[["",{"children":["posts",{"children":[["slug","MicrosoftGraph","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/a7d33c8790143d66.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"stylesheet","href":"/assets/web/assets/mobirise-icons2/mobirise2.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/bootstrap/css/bootstrap.min.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/bootstrap/css/bootstrap-grid.min.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/bootstrap/css/bootstrap-reboot.min.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/dropdown/css/style.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/socicon/css/styles.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/theme/css/style.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/mobirise/css/mbr-additional.css"}],["$","link",null,{"rel":"stylesheet","href":"/prism.css"}]]}],["$","body",null,{"className":"__className_2cd903 antialiased","children":[["$","$L2",null,{}],["$","main",null,{"children":["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]]}]]}],{"children":["posts",["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","MicrosoftGraph","d"],["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L5",null,["$","$L6",null,{"children":["$L7",["$","$L8",null,{"promise":"$@9"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$La",null,{"children":"$Lb"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$Lc",null,{"children":["$","div",null,{"hidden":true,"children":["$","$d",null,{"fallback":null,"children":"$Le"}]}]}]]}],false]],"m":"$undefined","G":["$f",[]],"s":false,"S":true}
10:I[2619,["619","static/chunks/619-ba102abea3e3d0e4.js","356","static/chunks/356-1fcf197c11312f1f.js","858","static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js"],""]
11:I[8889,["619","static/chunks/619-ba102abea3e3d0e4.js","356","static/chunks/356-1fcf197c11312f1f.js","858","static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js"],"default"]
12:T1ba8,
# Microsoft Graph

## Explore Microsoft 365

![](/assets/images/microsoftgraph/office-365-icon-500x500.png)
*Microsoft_Office_logo by Microsoft is licensed under CC*


## Graph Explorer

[Microsoft Graph](https://docs.microsoft.com/en-us/graph/overview) is a REST API that can be used to access: Microsoft 365, Azure Active Directory, Windows and Dynamics 365.

[Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer) is a developer tool that allows a developer to make Microsoft Graph REST API requests and view corresponding responses.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.26.35-am-1235x617.png)
*Here I am using the Graph Explorer without signing in to my Active Directory account (using a sample account)*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.29.31-am-485x209.png)
*Here I am signing into my Microsoft 365 E5 developer subscription pre-provisioned with Microsoft 365 apps*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.29.46-am-485x189.png)
*Here I am entering my password*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.30.14-am-484x195.png)
*I am required to approve the sign in request using my mobile phone (two factor authentication)*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.30.49-am-1234x619.png)
*I can retrieve my profile details using a "/me/" request. GET my profile - https://graph.microsoft.com/v1.0/me/*


## Graph Explorer permissions

Before the Graph Explorer is able to retrieve email messages using Microsoft Graph the user (or an administrator) has to provide consent. The user is agreeing that the client application (Graph Explorer in this case) can access parts of the Microsoft Graph on their behalf.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.31.38-am-1234x618.png)
*access denied - https://graph.microsoft.com/v1.0/me/messages*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.33.13-am-1400x657.png)
*Here the administrator grants this application (Graph Explorer) permission to access a user's email messages (on that user's behalf).*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.33.49-am-1400x655.png)
*GET my mail - https://graph.microsoft.com/v1.0/me/messages*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.34.16-am-1401x656.png)
*A second consent is needed to allow this application (Graph Explorer) to access a user's One drive and SharePoint online files (on that user's behalf) - https://graph.microsoft.com/v1.0/me/drive/root/children*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.36.19-am-1401x657.png)
*Here the administrator grants this application (Graph Explorer) permission to access the user's (One drive and SharePoint online) files*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-6.18.08-pm-1401x792.png)
*GET all the items in my (one) drive (root folder) - https://graph.microsoft.com/v1.0/me/drive/root/children*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-9.40.21-am-1401x656.png)
*At this time there were no files in my one drive's root folder*


## Teams/SharePoint Online/One Drive files

Microsoft Teams channels include a "Files" tab.

Files uploaded to the Team's channel are stored in SharePoint Online.

All files uploaded to all public channels are stored in a shared Document Library in a Team specific SharePoint Online Site (Site Collection).

This SharePoint online Document Library can also be accessed using the One Drive application.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.04.41-am-1399x654.png)
*The Mark 8 Project Team's Team includes a General and a Design channel.*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.05.14-am-1398x653.png)
*The Design channel's files can be accessed without leaving the Teams application. The Design channel's files can also be accessed using the SharePoint user interface (using the "Open in SharePoint" menu item)*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.05.42-am-1400x578.png)
*In the SharePoint user interface it is clear that the Design channel's files are stored a the "Design" Folder in the shared "Documents" Document Library in the "Mark 8 Project Team" SharePoint site*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.06.40-am-1400x574.png)
*The "Documents" Document Library in the "Mark 8 Project Team" site can also be accessed using the One Drive user interface.*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-6.52.10-pm-1398x792.png)
*The One Drive user interface can be used to show that there is a second "Confidential" Document Library in the "Mark 8 Project Team" Site.*


## Using Microsoft Graph to access Teams/SharePoint Online/One Drive files

Graph explorer can be used to access [Teams/SharePoint Online/One Drive files](https://docs.microsoft.com/en-us/graph/api/driveitem-list-children?view=graph-rest-1.0&tabs=http)

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.20.13-am-1399x618.png)
*GET SharePoint site based on relative path to (the "Mark8Project") site - https://graph.microsoft.com/v1.0/sites/{host-name}:/{server-relative-path} - https://graph.microsoft.com/v1.0/sites/p8lf.sharepoint.com:/sites/Mark8ProjectTeam*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.22.54-am-1397x617.png)
*GET enumerate the document libraries under the (the "Mark8Project") site - https://graph.microsoft.com/v1.0/sites/{siteid}/drives - https://graph.microsoft.com/v1.0/sites/p8lf.sharepoint.com,93621faf-8562-41e0-ac8c-13117ad3494a,c62f05b5-b3b9-45af-9935-0d5adca1a908/drives*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.31.55-am-1401x618.png)
*GET all the items in specified drive - https://graph.microsoft.com/v1.0/drives/{driveid}/root/children -https://graph.microsoft.com/v1.0/drives/b!rx9ik2KF4EGsjBMRetNJSrUFL8a5s69FmTUNWtyhqQioATjXxIu7Q6WHB3PuAtBi/root/children*

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-7.47.54-pm-1397x793.png)
*GET all the items in specified folder in the specified drive - https://graph.microsoft.com/v1.0/drives/{driveid}/items/{folderid}/childrenhttps://graph.microsoft.com/v1.0/drives/b!rx9ik2KF4EGsjBMRetNJSrUFL8a5s69FmTUNWtyhqQioATjXxIu7Q6WHB3PuAtBi/items/0165QRNMIDD63SJ6RBTFHZY2G4LDYN6K7M/children*


## Items trending around me

M365 is able to keep track of documents a user has recently accessed.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.14.25-am-1396x576.png)
*recently accessed*


## Items trending

Items trending around me can also be accessed using Microsoft Graph.

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.15.34-am-1398x618.png)
*GET items trending around me - https://graph.microsoft.com/beta/me/insights/trending*


## Code snippets

Graph Explorer is also able to provide sample JavaScript code that could be used to access Microsoft Graph

![](/assets/images/microsoftgraph/screen-shot-2022-05-26-at-10.39.30-am-1399x733.png)
*Sample JavaScipt code*
5:[["$","section",null,{"className":"content4 cid-uBU3VQlp0E","id":"content4-cru","children":["$","div",null,{"className":"container","children":["$","div",null,{"className":"row justify-content-center","children":["$","div",null,{"className":"title col-md-12 col-lg-10","children":[["$","h3",null,{"className":"mbr-section-title mbr-fonts-style align-center mb-4 display-2","children":["$","strong",null,{"children":"Microsoft Graph"}]}],["$","h4",null,{"className":"mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5","children":"Explore Microsoft 365"}]]}]}]}]}],["$","section",null,{"className":"content1 cid-content","id":"content1-breadcrumb","children":["$","div",null,{"className":"container","children":["$","div",null,{"className":"row justify-content-center","children":["$","div",null,{"className":"col-md-12 col-lg-10","children":["$","div",null,{"className":"mb-4","children":["$","$L10",null,{"href":"/posts","className":"link text-primary display-7","children":"← Back to Posts"}]}]}]}]}]}],["$","$L11",null,{"markdownContent":"$12"}]]
b:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
7:null
13:I[622,[],"IconMark"]
9:{"metadata":[["$","title","0",{"children":"Neil Haddley - Developer & Technical Consultant"}],["$","meta","1",{"name":"description","content":"I help organizations to connect with clients, comply with regulations, and automate workflows."}],["$","meta","2",{"name":"author","content":"Neil Haddley"}],["$","meta","3",{"name":"keywords","content":"developer, consultant, Azure, Angular, Business Central, automation"}],["$","meta","4",{"name":"creator","content":"Neil Haddley"}],["$","meta","5",{"property":"og:title","content":"Neil Haddley - Developer & Technical Consultant"}],["$","meta","6",{"property":"og:description","content":"I help organizations to connect with clients, comply with regulations, and automate workflows."}],["$","meta","7",{"property":"og:url","content":"https://haddley.github.io/"}],["$","meta","8",{"property":"og:site_name","content":"Neil Haddley"}],["$","meta","9",{"property":"og:locale","content":"en_US"}],["$","meta","10",{"property":"og:type","content":"website"}],["$","meta","11",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","12",{"name":"twitter:title","content":"Neil Haddley - Developer & Technical Consultant"}],["$","meta","13",{"name":"twitter:description","content":"I help organizations to connect with clients, comply with regulations, and automate workflows."}],["$","link","14",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","$L13","15",{}]],"error":null,"digest":"$undefined"}
e:"$9:metadata"
