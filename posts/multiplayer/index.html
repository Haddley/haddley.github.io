<!DOCTYPE html><!--RJUMHoOpO5HDs1LInqYrA--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/949adacb6381283a-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/9dd75fadc5b3df29-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/a7d33c8790143d66.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-4c42975394ce1617.js"/><script src="/_next/static/chunks/4bd1b696-c023c6e3521b1417.js" async=""></script><script src="/_next/static/chunks/255-fe5c522e6d28d73f.js" async=""></script><script src="/_next/static/chunks/main-app-f50e9b07a96b5107.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/app/layout-b6140098d4dc0e33.js" async=""></script><script src="/_next/static/chunks/356-1fcf197c11312f1f.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js" async=""></script><meta name="next-size-adjust" content=""/><title>Neil Haddley - Developer &amp; Technical Consultant</title><meta name="description" content="I help organizations to connect with clients, comply with regulations, and automate workflows."/><meta name="author" content="Neil Haddley"/><meta name="keywords" content="developer, consultant, Azure, Angular, Business Central, automation"/><meta name="creator" content="Neil Haddley"/><meta property="og:title" content="Neil Haddley - Developer &amp; Technical Consultant"/><meta property="og:description" content="I help organizations to connect with clients, comply with regulations, and automate workflows."/><meta property="og:url" content="https://haddley.github.io/"/><meta property="og:site_name" content="Neil Haddley"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Neil Haddley - Developer &amp; Technical Consultant"/><meta name="twitter:description" content="I help organizations to connect with clients, comply with regulations, and automate workflows."/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><link rel="stylesheet" href="/assets/web/assets/mobirise-icons2/mobirise2.css"/><link rel="stylesheet" href="/assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css"/><link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css"/><link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-grid.min.css"/><link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-reboot.min.css"/><link rel="stylesheet" href="/assets/dropdown/css/style.css"/><link rel="stylesheet" href="/assets/socicon/css/styles.css"/><link rel="stylesheet" href="/assets/theme/css/style.css"/><link rel="stylesheet" href="/assets/mobirise/css/mbr-additional.css"/><link rel="stylesheet" href="/prism.css"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_2cd903 antialiased"><div hidden=""><!--$--><!--/$--></div><section class="menu menu3 cid-uBU3VPzqgj" id="menu3-crt"><nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg"><div class="container"><div class="navbar-brand"><span class="navbar-caption-wrap"><a class="navbar-caption text-black text-primary display-7" href="/">Neil Haddley</a></span></div><button class="navbar-toggler" type="button" aria-expanded="false" aria-label="Toggle navigation"><div class="hamburger"><span></span><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse " id="navbarSupportedContent"><ul class="navbar-nav nav-dropdown nav-right"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="/posts/">Blog Posts</a></li></ul><div class="icons-menu"><a class="iconfont-wrapper" href="https://www.linkedin.com/in/neil-haddley/" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont socicon-linkedin socicon"></span></a><a class="iconfont-wrapper" href="https://github.com/haddley" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont mbrib-github"></span></a><a class="iconfont-wrapper" href="https://www.npmjs.com/~haddley" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont socicon-npm socicon"></span></a><a class="iconfont-wrapper" href="https://hub.docker.com/u/haddley" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont mobi-mbri-delivery mobi-mbri"></span></a></div></div></div></nav></section><main><section class="content4 cid-uBU3VQlp0E" id="content4-cru"><div class="container"><div class="row justify-content-center"><div class="title col-md-12 col-lg-10"><h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-2"><strong>Firebase Realtime Database</strong></h3><h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5">Multiplayer Game</h4></div></div></div></section><section class="content1 cid-content" id="content1-breadcrumb"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><div class="mb-4"><a class="link text-primary display-7" href="/posts/">← Back to Posts</a></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Multiplayer Game</h4></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="This file is licensed under the Creative Commons Attribution 4.0 International license." loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/multiplayer/logo-lockup-firebase-vertical.svg"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">This file is licensed under the Creative Commons Attribution 4.0 International license.</p></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Creating a new firebase project</h4></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><p class="mbr-text mbr-fonts-style display-7"><span>I created a firebase project using https://console.firebase.google.com<br/><br/></span><span>I deployed [Drew Conley&#x27;s Multiplayer Game](https://www.youtube.com/watch?v=xhURh2RDzzg) to Firebase.</span></p></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="https://haddley-multiplayer.web.app/" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/multiplayer/screen-shot-2023-05-09-at-9.26.22-am-1814x1582.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">https://haddley-multiplayer.web.app/</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="Firebase project settings" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/multiplayer/screen-shot-2023-05-09-at-9.59.28-am-1536x959.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Firebase project settings</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="firebase initfirebase deploy" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/multiplayer/screen-shot-2023-05-08-at-5.19.41-pm-1470x786.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">firebase initfirebase deploy</p></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Responding to updated state</h4></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><p class="mbr-text mbr-fonts-style display-7"><span>The state of the games is maintained in a Firebase Realtime Database.<br/><br/></span><span>The allPlayersRef.on(&quot;XXX&quot;, (snapshot) =&gt; {...}) functions are called when a player joins the game, leaves the game or moves.<br/><br/></span><span>The   allCoinsRef.on(&quot;value&quot;, (snapshot) =&gt; {...}) functions are called when coins are created or collected.</span></p></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="Realtime Database" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/multiplayer/screen-shot-2023-05-09-at-9.39.39-am-1836x1151.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Realtime Database</p></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">ChatGPT&#x27;s commentary</h4></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><p class="mbr-text mbr-fonts-style display-7"><span>This code appears to be a JavaScript implementation of a game that involves players moving characters on a map and collecting coins. Let&#x27;s go through the code and explain its different parts:<br/><br/></span><span>1. The mapData object defines the boundaries of the game map (minX, maxX, minY, maxY) and the coordinates of blocked spaces on the map (blockedSpaces).<br/><br/></span><span>2. The playerColors array contains different colors that can be assigned to players in the game.<br/><br/></span><span>3. The randomFromArray function takes an array as input and returns a random element from that array.<br/><br/></span><span>4. The getKeyString function takes x and y coordinates and returns a string in the format &quot;x:y&quot;.<br/><br/></span><span>5. The createName function generates a random name for a player by combining a random prefix and a random animal name.<br/><br/></span><span>6. The isSolid function checks if a given coordinate (x, y) represents a solid space on the map. It returns true if the space is blocked or if the coordinates are outside the map boundaries.<br/><br/></span><span>7. The getRandomSafeSpot function returns a random coordinate from a predefined set of safe spots on the map where players can initially spawn.<br/><br/></span><span>8. The code then defines an immediately-invoked function expression (IIFE) that encapsulates the game logic. Inside this function, various variables are declared and initialized:<br/><br/></span><span>playerId and playerRef represent the unique ID and reference for the current player.<br/><br/></span><span>players is an object that stores information about all the players in the game.<br/><br/></span><span>playerElements is an object that stores references to DOM elements representing each player&#x27;s character.<br/><br/></span><span>coins is an object that stores information about the coins present on the map.<br/><br/></span><span>coinElements is an object that stores references to DOM elements representing each coin.<br/><br/></span><span>9. The code selects relevant DOM elements using document.querySelector.<br/><br/></span><span>10. The placeCoin function is responsible for randomly placing a coin on the map. It selects a safe spot using getRandomSafeSpot, creates a reference to the coin in the Firebase database, and schedules a recursive call to placeCoin after a random timeout.<br/><br/></span><span>11. The attemptGrabCoin function is called when a player moves to a new coordinate. It checks if there is a coin at the given coordinates and, if so, removes the coin from the database and increments the player&#x27;s coin count.<br/><br/></span><span>12. The handleArrowPress function is called when a player presses an arrow key to move their character. It calculates the new coordinates based on the current position and the arrow key pressed. If the new coordinates represent a valid move (not blocked by a solid space), it updates the player&#x27;s position, direction, and saves the changes to the database. It also calls attemptGrabCoin to check if the player grabbed a coin at the new position.<br/><br/></span><span>13. The initGame function initializes the game by adding event listeners for arrow key presses, setting up database listeners for player and coin updates, and creating DOM elements for players and coins.<br/><br/></span><span>14. The code sets up Firebase authentication using anonymous sign-in (firebase.auth().signInAnonymously()) and handles the authentication state change using firebase.auth().onAuthStateChanged. When a user is authenticated, the game initializes by generating a random name for the player, setting up the player&#x27;s initial position, and adding the player to the database. It also sets up a disconnection handler to remove the player&#x27;s data from the database when they disconnect.<br/><br/></span><span>15. Finally, the IIFE is invoked immediately, starting the execution of the game code.<br/><br/></span><span>In summary, this JavaScript code sets up a multiplayer game where players can control characters on a map. The game uses Firebase for real-time data synchronization. Players can move their characters using arrow keys, collect coins, and see the positions and coin counts of other players. The code initializes the game, handles player authentication, updates player and coin data in the database, and manages the rendering of player and coin elements in the game interface.</span></p></div></div></div></section><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-4c42975394ce1617.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[9379,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"177\",\"static/chunks/app/layout-b6140098d4dc0e33.js\"],\"default\"]\n3:I[9766,[],\"\"]\n4:I[8924,[],\"\"]\n6:I[4431,[],\"OutletBoundary\"]\n8:I[5278,[],\"AsyncMetadataOutlet\"]\na:I[4431,[],\"ViewportBoundary\"]\nc:I[4431,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[7150,[],\"\"]\n:HL[\"/_next/static/media/949adacb6381283a-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/9dd75fadc5b3df29-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/a7d33c8790143d66.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"RJUMHoOpO5HDs1LInqYrA\",\"p\":\"\",\"c\":[\"\",\"posts\",\"multiplayer\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"multiplayer\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a7d33c8790143d66.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/web/assets/mobirise-icons2/mobirise2.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/bootstrap/css/bootstrap.min.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/bootstrap/css/bootstrap-grid.min.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/bootstrap/css/bootstrap-reboot.min.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/dropdown/css/style.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/socicon/css/styles.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/theme/css/style.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/mobirise/css/mbr-additional.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/prism.css\"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_2cd903 antialiased\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"multiplayer\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:I[2619,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"356\",\"static/chunks/356-1fcf197c11312f1f.js\",\"858\",\"static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js\"],\"\"]\n11:I[8889,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"356\",\"static/chunks/356-1fcf197c11312f1f.js\",\"858\",\"static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js\"],\"default\"]\n12:T1440,"])</script><script>self.__next_f.push([1,"\n# Multiplayer Game\n\n## Multiplayer Game\n\n![](/assets/images/multiplayer/logo-lockup-firebase-vertical.svg)\n*This file is licensed under the Creative Commons Attribution 4.0 International license.*\n\n\n## Creating a new firebase project\n\nI created a firebase project using https://console.firebase.google.com\n\nI deployed [Drew Conley's Multiplayer Game](https://www.youtube.com/watch?v=xhURh2RDzzg) to Firebase.\n\n![](/assets/images/multiplayer/screen-shot-2023-05-09-at-9.26.22-am-1814x1582.png)\n*https://haddley-multiplayer.web.app/*\n\n![](/assets/images/multiplayer/screen-shot-2023-05-09-at-9.59.28-am-1536x959.png)\n*Firebase project settings*\n\n![](/assets/images/multiplayer/screen-shot-2023-05-08-at-5.19.41-pm-1470x786.png)\n*firebase initfirebase deploy*\n\n\n## Responding to updated state\n\nThe state of the games is maintained in a Firebase Realtime Database.\n\nThe allPlayersRef.on(\"XXX\", (snapshot) =\u003e {...}) functions are called when a player joins the game, leaves the game or moves.\n\nThe   allCoinsRef.on(\"value\", (snapshot) =\u003e {...}) functions are called when coins are created or collected.\n\n![](/assets/images/multiplayer/screen-shot-2023-05-09-at-9.39.39-am-1836x1151.png)\n*Realtime Database*\n\n\n## ChatGPT's commentary\n\nThis code appears to be a JavaScript implementation of a game that involves players moving characters on a map and collecting coins. Let's go through the code and explain its different parts:\n\n1. The mapData object defines the boundaries of the game map (minX, maxX, minY, maxY) and the coordinates of blocked spaces on the map (blockedSpaces).\n2. The playerColors array contains different colors that can be assigned to players in the game.\n3. The randomFromArray function takes an array as input and returns a random element from that array.\n4. The getKeyString function takes x and y coordinates and returns a string in the format \"x:y\".\n5. The createName function generates a random name for a player by combining a random prefix and a random animal name.\n6. The isSolid function checks if a given coordinate (x, y) represents a solid space on the map. It returns true if the space is blocked or if the coordinates are outside the map boundaries.\n7. The getRandomSafeSpot function returns a random coordinate from a predefined set of safe spots on the map where players can initially spawn.\n8. The code then defines an immediately-invoked function expression (IIFE) that encapsulates the game logic. Inside this function, various variables are declared and initialized:\nplayerId and playerRef represent the unique ID and reference for the current player.\nplayers is an object that stores information about all the players in the game.\nplayerElements is an object that stores references to DOM elements representing each player's character.\ncoins is an object that stores information about the coins present on the map.\ncoinElements is an object that stores references to DOM elements representing each coin.\n9. The code selects relevant DOM elements using document.querySelector.\n10. The placeCoin function is responsible for randomly placing a coin on the map. It selects a safe spot using getRandomSafeSpot, creates a reference to the coin in the Firebase database, and schedules a recursive call to placeCoin after a random timeout.\n11. The attemptGrabCoin function is called when a player moves to a new coordinate. It checks if there is a coin at the given coordinates and, if so, removes the coin from the database and increments the player's coin count.\n12. The handleArrowPress function is called when a player presses an arrow key to move their character. It calculates the new coordinates based on the current position and the arrow key pressed. If the new coordinates represent a valid move (not blocked by a solid space), it updates the player's position, direction, and saves the changes to the database. It also calls attemptGrabCoin to check if the player grabbed a coin at the new position.\n13. The initGame function initializes the game by adding event listeners for arrow key presses, setting up database listeners for player and coin updates, and creating DOM elements for players and coins.\n14. The code sets up Firebase authentication using anonymous sign-in (firebase.auth().signInAnonymously()) and handles the authentication state change using firebase.auth().onAuthStateChanged. When a user is authenticated, the game initializes by generating a random name for the player, setting up the player's initial position, and adding the player to the database. It also sets up a disconnection handler to remove the player's data from the database when they disconnect.\n15. Finally, the IIFE is invoked immediately, starting the execution of the game code.\n\nIn summary, this JavaScript code sets up a multiplayer game where players can control characters on a map. The game uses Firebase for real-time data synchronization. Players can move their characters using arrow keys, collect coins, and see the positions and coin counts of other players. The code initializes the game, handles player authentication, updates player and coin data in the database, and manages the rendering of player and coin elements in the game interface.\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"section\",null,{\"className\":\"content4 cid-uBU3VQlp0E\",\"id\":\"content4-cru\",\"children\":[\"$\",\"div\",null,{\"className\":\"container\",\"children\":[\"$\",\"div\",null,{\"className\":\"row justify-content-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"title col-md-12 col-lg-10\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"mbr-section-title mbr-fonts-style align-center mb-4 display-2\",\"children\":[\"$\",\"strong\",null,{\"children\":\"Firebase Realtime Database\"}]}],[\"$\",\"h4\",null,{\"className\":\"mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5\",\"children\":\"Multiplayer Game\"}]]}]}]}]}],[\"$\",\"section\",null,{\"className\":\"content1 cid-content\",\"id\":\"content1-breadcrumb\",\"children\":[\"$\",\"div\",null,{\"className\":\"container\",\"children\":[\"$\",\"div\",null,{\"className\":\"row justify-content-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"col-md-12 col-lg-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mb-4\",\"children\":[\"$\",\"$L10\",null,{\"href\":\"/posts\",\"className\":\"link text-primary display-7\",\"children\":\"← Back to Posts\"}]}]}]}]}]}],[\"$\",\"$L11\",null,{\"markdownContent\":\"$12\"}]]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"13:I[622,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Neil Haddley - Developer \u0026 Technical Consultant\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"I help organizations to connect with clients, comply with regulations, and automate workflows.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"Neil Haddley\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"developer, consultant, Azure, Angular, Business Central, automation\"}],[\"$\",\"meta\",\"4\",{\"name\":\"creator\",\"content\":\"Neil Haddley\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Neil Haddley - Developer \u0026 Technical Consultant\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"I help organizations to connect with clients, comply with regulations, and automate workflows.\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:url\",\"content\":\"https://haddley.github.io/\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:site_name\",\"content\":\"Neil Haddley\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:title\",\"content\":\"Neil Haddley - Developer \u0026 Technical Consultant\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:description\",\"content\":\"I help organizations to connect with clients, comply with regulations, and automate workflows.\"}],[\"$\",\"link\",\"14\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"$L13\",\"15\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"e:\"$9:metadata\"\n"])</script></body></html>