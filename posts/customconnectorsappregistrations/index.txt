1:"$Sreact.fragment"
2:I[9379,["619","static/chunks/619-ba102abea3e3d0e4.js","177","static/chunks/app/layout-b6140098d4dc0e33.js"],"default"]
3:I[9766,[],""]
4:I[8924,[],""]
6:I[4431,[],"OutletBoundary"]
8:I[5278,[],"AsyncMetadataOutlet"]
a:I[4431,[],"ViewportBoundary"]
c:I[4431,[],"MetadataBoundary"]
d:"$Sreact.suspense"
f:I[7150,[],""]
:HL["/_next/static/media/949adacb6381283a-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/9dd75fadc5b3df29-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/a7d33c8790143d66.css","style"]
0:{"P":null,"b":"RJUMHoOpO5HDs1LInqYrA","p":"","c":["","posts","customconnectorsappregistrations",""],"i":false,"f":[[["",{"children":["posts",{"children":[["slug","customconnectorsappregistrations","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/a7d33c8790143d66.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"stylesheet","href":"/assets/web/assets/mobirise-icons2/mobirise2.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/bootstrap/css/bootstrap.min.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/bootstrap/css/bootstrap-grid.min.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/bootstrap/css/bootstrap-reboot.min.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/dropdown/css/style.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/socicon/css/styles.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/theme/css/style.css"}],["$","link",null,{"rel":"stylesheet","href":"/assets/mobirise/css/mbr-additional.css"}],["$","link",null,{"rel":"stylesheet","href":"/prism.css"}]]}],["$","body",null,{"className":"__className_2cd903 antialiased","children":[["$","$L2",null,{}],["$","main",null,{"children":["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]]}]]}],{"children":["posts",["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","customconnectorsappregistrations","d"],["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L5",null,["$","$L6",null,{"children":["$L7",["$","$L8",null,{"promise":"$@9"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$La",null,{"children":"$Lb"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$Lc",null,{"children":["$","div",null,{"hidden":true,"children":["$","$d",null,{"fallback":null,"children":"$Le"}]}]}]]}],false]],"m":"$undefined","G":["$f",[]],"s":false,"S":true}
10:I[2619,["619","static/chunks/619-ba102abea3e3d0e4.js","356","static/chunks/356-1fcf197c11312f1f.js","858","static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js"],""]
11:I[8889,["619","static/chunks/619-ba102abea3e3d0e4.js","356","static/chunks/356-1fcf197c11312f1f.js","858","static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js"],"default"]
12:T3484,
# Power Apps, Custom Connectors and Application Registrations

## Power Apps, Custom Connectors and Application Registrations

![](/assets/images/customconnectorsappregistrations/office-365-icon-500x500.png)
*Microsoft_Office_logo by Microsoft is licensed under CC*


## Creating a Custom Connector

To create a PowerApps Azure Active Directory Custom Connector the following values must be provided:

**Client id
Client secret**; and
**Resource URL**

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-10.32.46-am-1836x1170.png)
*Custom Connector OAuth 2.0 Active Directory settings*


## The Custom Connector is the Client Application

In OAuth 2 an application accesses a resource on behalf of a user. 

In OAuth 2 the application does **not** store the user's username and password.

When setting up a Power Apps Custom Connector that will allow a user to access an API Service the Client Application is the Custom Connector and the Resource (Application) is the API Service.

Only three values are needed to create a Power Apps Custom Connector.

The three values needed to create a Power Apps Custom Connector are: the **Client id **(the client application registration ID), the **Client secret **(password); and the **Resource URL **(the resource application registration ID)

Here I will extend the [Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api) tutorial to show how to configure a Power Apps Custom Connector using Azure application registrations.

![](/assets/images/customconnectorsappregistrations/topology-callapi-631x362.png)
*topology_callapi by Doğan Erişen is licensed under MIT License*


## A JavaScript tutorial using MSAL

The [Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api) tutorial demonstrates how to configure Azure Application Registrations for an API and for a Single Page Web Application (SPA) that calls an Application Programming Interface Service (API).

I cloned the git repository using this command:

```bash
% git clone https://github.com/Azure-Samples/ms-identity-javascript-tutorial.git
```

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.41.51-am-1836x1739.png)
*esp8266*


## Resource application registration

Before updating the Application Programming Interface (API) Service I needed to create the **resource application registration**.

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.44.28-am-1704x396.png)
*Create the resource application registration*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.45.27-am-1704x1642.png)
*Provide the resource name*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-11.46.24-am-1062x294.png)
*Copy the "Application (client) ID" value.*


## Resource URL

The "Application (client) ID" value from the resource application registration is the **Resource URL** value we will need later to create the custom connector.

**be70217c-6a30-4023-b667-d88bf222b94a**

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.09.35-pm-536x70.png)
*This resource is an API Service so click the "Expose an API" menu item*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.14.23-pm-1042x146.png)
*Click the Set link*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.14.33-pm-1194x318.png)
*Save the generated Application ID URI (the URI api:// followed by the resource application client ID)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.15.06-pm-1144x154.png)
*esp8266*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.15.46-pm-1144x286.png)
*The resource must provide at least one scope*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.17.38-pm-1702x1634.png)
*I added the "access_as_user" scope.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.18.10-pm-204x64.png)
*I updated the application registration manifest*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.18.33-pm-1708x1630.png)
*The application registration manifest provides a way to export and update application registration settings.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.21.33-pm-1046x142.png)
*The Directory (tenant) ID is a tenant wide setting (by definition)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-08-at-12.26.20-pm-1836x790.png)
*The sample API code has been updated to include the tenantID and the clientID.*


## Client application registration

If I was following the [Vanilla JavaScript single-page application (SPA) using MSAL.js to authorize users for calling a protected web API on Azure AD](https://github.com/Azure-Samples/ms-identity-javascript-tutorial/tree/main/3-Authorization-II/1-call-api) tutorial I would create the client application registration for a Single Page Application (SPA) next.

Instead I will create a client application registration for the Power Apps Custom Connector.

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.24.37-pm-1832x1444.png)
*Notice that the redirect url has been set to https://global.consent.azure-apim.net/redirect*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.25.12-pm-1194x166.png)
*Copy the Application (client) ID*


## Client id

The "Application (client) ID" value from the **client application registration** is the **Client id** we will need later to create the custom connector.

**59259fa1-c2e1-486d-a8e6-92209abf090c**

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.26.25-pm-532x68.png)
*The client application will be allowed to access the resource application registration (the API)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.26.45-pm-1252x330.png)
*Click the + Add a permission link*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.02-pm-1596x428.png)
*Select the "My APIs" tab*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.13-pm-1628x92.png)
*Select the resource application registration (the API)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.34-pm-1824x1444.png)
*Click the access_as_user checkbox*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.27.58-pm-1258x640.png)
*The access_as_user scope has been added*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.29.09-pm-1830x506.png)
*Click the Authentication menu item and enable "Access tokens"*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.29.47-pm-1832x528.png)
*Click on the Certificates & secrets menu item.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.30.13-pm-1832x1442.png)
*Add a client secret*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.30.27-pm-1830x586.png)
*Copy the "client secret" value*


## Client secret

The generated "Value" is the **Client secret** we will need to create the custom connector.

.ljDa4a7mFqn1tWj0wyPQ6X5L6B_3V.x~f

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.31.36-pm-1834x306.png)
*Create a new custom connector (from blank)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.31.59-pm-672x460.png)
*Provide a name for the custom connector*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.33.43-pm-1836x1239.png)
*Enter the url of the host the API service. Enter the base URL (if applicable)*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.33.59-pm-1482x626.png)
*Select Authentication type OAuth 2.0*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.34.10-pm-1312x378.png)
*Select "Azure Active Directory" as the Identity Provider*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.37.06-pm-1836x1233.png)
*Enter the Client id, Client secret and Resource URL value.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.37.35-pm-560x192.png)
*This API publishes a single action*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.38.05-pm-1836x1234.png)
*Provide a name for each action*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.38.16-pm-1096x368.png)
*Click Import from sample to describe the action*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.39.13-pm-1836x1237.png)
*In this case the path /api/ should return identity information*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.39.29-pm-1836x1234.png)
*The action request has been described*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.39.37-pm-1054x444.png)
*Click the + Add default response link*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.40.20-pm-1836x1238.png)
*Provide an example API response.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.40.56-pm-1836x526.png)
*Click on the tick to create the custom connector*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.41.39-pm-1836x1235.png)
*Click the + New connection link to create a new connection*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.41.50-pm-1836x556.png)
*Click Create*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.42.12-pm-1836x704.png)
*Provide value Azure Active Directory credentials*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.42.42-pm-1836x1242.png)
*Consent*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.43.15-pm-1836x592.png)
*The connection has been created*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-8.06.57-pm-1836x1032.png)
*Test the operation*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.43.39-pm-1836x1238.png)
*Create a PowerApp Canvas app*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.43.57-pm-788x444.png)
*Select the data menu item and click the Add data button*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.44.18-pm-896x540.png)
*Select the Identity connection*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.44.45-pm-1836x1235.png)
*Notice that using the Identity Connection requires a Premium PowerApps license*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.45.42-pm-1836x642.png)
*Add a button to the app screen. Use the ClearCollect operation to call the API.*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.45.54-pm-1836x472.png)
*Run the app*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.46.54-pm-1836x570.png)
*Switch to the Colllections page to see the results of the API call*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-09-at-6.47.52-pm-1836x1026.png)
*Add the collection to a Vertical gallery control*


## Enterprise Applications

A service principal is created in each tenant where the application is used.

The service principle in each tenant references the globally unique application registration.

The service principal defines what the app can do in the specific tenant, who can access the app, and what resources the app can access.

The service principal objects are what you see when you select the Enterprise applications page.

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.44.26-am-1836x949.png)
*The Service Principal Objects are what you see when you select the Enterprise applications page*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.44.49-am-1836x950.png)
*The API's Enterprise Application configuration*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.46.54-am-1836x947.png)
*The Custom Connector's Enterprise Application configuration*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.47.20-am-1836x946.png)
*The Custom Connector's Permissions*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-11.32.02-am-1836x946.png)
*Permission Details*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-10.51.31-am-1836x948.png)
*The Custom Connector's Users and Groups*

![](/assets/images/customconnectorsappregistrations/screen-shot-2021-08-10-at-11.01.26-am-1836x946.png)
*The Custom Connector's Properties*
5:[["$","section",null,{"className":"content4 cid-uBU3VQlp0E","id":"content4-cru","children":["$","div",null,{"className":"container","children":["$","div",null,{"className":"row justify-content-center","children":["$","div",null,{"className":"title col-md-12 col-lg-10","children":[["$","h3",null,{"className":"mbr-section-title mbr-fonts-style align-center mb-4 display-2","children":["$","strong",null,{"children":"Power Apps (Part 5)"}]}],["$","h4",null,{"className":"mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5","children":"A comprehensive guide covering customconnectorsappregistrations"}]]}]}]}]}],["$","section",null,{"className":"content1 cid-content","id":"content1-breadcrumb","children":["$","div",null,{"className":"container","children":["$","div",null,{"className":"row justify-content-center","children":["$","div",null,{"className":"col-md-12 col-lg-10","children":["$","div",null,{"className":"mb-4","children":["$","$L10",null,{"href":"/posts","className":"link text-primary display-7","children":"← Back to Posts"}]}]}]}]}]}],["$","$L11",null,{"markdownContent":"$12"}]]
b:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
7:null
13:I[622,[],"IconMark"]
9:{"metadata":[["$","title","0",{"children":"Neil Haddley - Developer & Technical Consultant"}],["$","meta","1",{"name":"description","content":"I help organizations to connect with clients, comply with regulations, and automate workflows."}],["$","meta","2",{"name":"author","content":"Neil Haddley"}],["$","meta","3",{"name":"keywords","content":"developer, consultant, Azure, Angular, Business Central, automation"}],["$","meta","4",{"name":"creator","content":"Neil Haddley"}],["$","meta","5",{"property":"og:title","content":"Neil Haddley - Developer & Technical Consultant"}],["$","meta","6",{"property":"og:description","content":"I help organizations to connect with clients, comply with regulations, and automate workflows."}],["$","meta","7",{"property":"og:url","content":"https://haddley.github.io/"}],["$","meta","8",{"property":"og:site_name","content":"Neil Haddley"}],["$","meta","9",{"property":"og:locale","content":"en_US"}],["$","meta","10",{"property":"og:type","content":"website"}],["$","meta","11",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","12",{"name":"twitter:title","content":"Neil Haddley - Developer & Technical Consultant"}],["$","meta","13",{"name":"twitter:description","content":"I help organizations to connect with clients, comply with regulations, and automate workflows."}],["$","link","14",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","$L13","15",{}]],"error":null,"digest":"$undefined"}
e:"$9:metadata"
