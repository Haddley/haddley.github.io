<!DOCTYPE html><!--RJUMHoOpO5HDs1LInqYrA--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/949adacb6381283a-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/9dd75fadc5b3df29-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/a7d33c8790143d66.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-4c42975394ce1617.js"/><script src="/_next/static/chunks/4bd1b696-c023c6e3521b1417.js" async=""></script><script src="/_next/static/chunks/255-fe5c522e6d28d73f.js" async=""></script><script src="/_next/static/chunks/main-app-f50e9b07a96b5107.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/app/layout-b6140098d4dc0e33.js" async=""></script><script src="/_next/static/chunks/356-1fcf197c11312f1f.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js" async=""></script><meta name="next-size-adjust" content=""/><title>Neil Haddley - Developer &amp; Technical Consultant</title><meta name="description" content="I help organizations to connect with clients, comply with regulations, and automate workflows."/><meta name="author" content="Neil Haddley"/><meta name="keywords" content="developer, consultant, Azure, Angular, Business Central, automation"/><meta name="creator" content="Neil Haddley"/><meta property="og:title" content="Neil Haddley - Developer &amp; Technical Consultant"/><meta property="og:description" content="I help organizations to connect with clients, comply with regulations, and automate workflows."/><meta property="og:url" content="https://haddley.github.io/"/><meta property="og:site_name" content="Neil Haddley"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Neil Haddley - Developer &amp; Technical Consultant"/><meta name="twitter:description" content="I help organizations to connect with clients, comply with regulations, and automate workflows."/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><link rel="stylesheet" href="/assets/web/assets/mobirise-icons2/mobirise2.css"/><link rel="stylesheet" href="/assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css"/><link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css"/><link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-grid.min.css"/><link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-reboot.min.css"/><link rel="stylesheet" href="/assets/dropdown/css/style.css"/><link rel="stylesheet" href="/assets/socicon/css/styles.css"/><link rel="stylesheet" href="/assets/theme/css/style.css"/><link rel="stylesheet" href="/assets/mobirise/css/mbr-additional.css"/><link rel="stylesheet" href="/prism.css"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_2cd903 antialiased"><div hidden=""><!--$--><!--/$--></div><section class="menu menu3 cid-uBU3VPzqgj" id="menu3-crt"><nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg"><div class="container"><div class="navbar-brand"><span class="navbar-caption-wrap"><a class="navbar-caption text-black text-primary display-7" href="/">Neil Haddley</a></span></div><button class="navbar-toggler" type="button" aria-expanded="false" aria-label="Toggle navigation"><div class="hamburger"><span></span><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse " id="navbarSupportedContent"><ul class="navbar-nav nav-dropdown nav-right"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="/posts/">Blog Posts</a></li></ul><div class="icons-menu"><a class="iconfont-wrapper" href="https://www.linkedin.com/in/neil-haddley/" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont socicon-linkedin socicon"></span></a><a class="iconfont-wrapper" href="https://github.com/haddley" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont mbrib-github"></span></a><a class="iconfont-wrapper" href="https://www.npmjs.com/~haddley" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont socicon-npm socicon"></span></a><a class="iconfont-wrapper" href="https://hub.docker.com/u/haddley" target="_blank" rel="noopener noreferrer"><span class="p-2 mbr-iconfont mobi-mbri-delivery mobi-mbri"></span></a></div></div></div></nav></section><main><section class="content4 cid-uBU3VQlp0E" id="content4-cru"><div class="container"><div class="row justify-content-center"><div class="title col-md-12 col-lg-10"><h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-2"><strong>VB.NET Console SQL Server Unit Tests</strong></h3><h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5">A comprehensive guide covering  v b n e t console s q l server unit tests</h4></div></div></div></section><section class="content1 cid-content" id="content1-breadcrumb"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><div class="mb-4"><a class="link text-primary display-7" href="/posts/">‚Üê Back to Posts</a></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Test driven development</h4></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="Microsoft Dotnet Logo by Microsoft Corporation is licensed under Creative Commons CC0 1.0 Universal Public Domain Dedication" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/net-logo.svg"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Microsoft Dotnet Logo by Microsoft Corporation is licensed under Creative Commons CC0 1.0 Universal Public Domain Dedication</p></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Unit Tests</h4></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><p class="mbr-text mbr-fonts-style display-7"><span>Unit tests are automated tests written and run by software developers to ensure that a section of an application (known as the &quot;unit&quot;) meets its design and behaves as intended.<br/><br/></span><span>I wanted to add unit tests to a Visual Basic Console App that fetched data from a database using SqlConnection, SqlCommand, SqlDataAdapter and DataTable classes.<br/><br/></span><span>In any case it is best practice is for Unit Tests to run independent of a running database server.</span></p></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I created a new project (in a new solution)" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000001-890x625.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I created a new project (in a new solution)</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I selected the .NET Framework (old school)" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000002-889x626.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I selected the .NET Framework (old school)</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I selected .NET Framework 4.7.2" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000003-890x624.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I selected .NET Framework 4.7.2</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="Main" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000004-1325x674.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Main</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I added Hello World code" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000005-1363x382.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I added Hello World code</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I updated the Console Application to connect to a database and display the contents of a Tasks table" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000006-1359x567.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I updated the Console Application to connect to a database and display the contents of a Tasks table</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I added a second project to the solution. I selected the Unit Test Project (.NET Framework) template" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000017-1361x656.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I added a second project to the solution. I selected the Unit Test Project (.NET Framework) template</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I accepted the defaults" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000018-1362x683.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I accepted the defaults</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="I added a reference to the Test project" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000019-1360x250.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">I added a reference to the Test project</p></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">ChatGPT</h4></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><p class="mbr-text mbr-fonts-style display-7"><span>I asked ChatGPT to generate unit tests for the code.<br/><br/></span><span>**Write Unit Tests for this code<br/><br/></span><span>Imports System.Data.SqlClient<br/><br/></span><span>Module Module1<br/><br/></span><span>...**<br/><br/></span><span>To write unit tests for the given code, you can use a testing framework such as NUnit or xUnit. However, since the code primarily consists of database interactions and console output, it may not be feasible to write traditional unit tests for it.<br/><br/></span><span>Instead, you can consider refactoring the code to improve testability by separating concerns. One approach could be to move the database-related code into a separate class or method that returns the result DataTable. Then, you can write unit tests specifically for that database-related code.<br/><br/></span><span>Here&#x27;s an example of how you can refactor the code and write unit tests for the database interaction part using NUnit:<br/><br/></span><span>...</span></p></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="Database Tests" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/database-unit-test-1366x728.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Database Tests</p></div></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Refactoring the code with testing in mind</h4></div></div></div></section><section class="content5 cid-content5" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><p class="mbr-text mbr-fonts-style display-7"><span>As ChatGPT explained it is hard to create Unit Tests for the database and Console code contained in the Module1.vb.<br/><br/></span><span>It does not help that the database access and Console.WriteLine code is mixed together in a single block.<br/><br/></span><span>I extracted the WriteDataTable code to create a function that was easier to create Unit Tests for.<br/><br/></span><span>I wrote the UnitTestProject2 tests with the help of ChatGPT.</span></p></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="The WriteDataTable function expects to be passed a DataTable." loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000020-1098x244.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">The WriteDataTable function expects to be passed a DataTable.</p></div></div></div></div></section><section class="image3 cid-image3" data-bs-version="5.1"><div class="container"><div class="row justify-content-center"><div class="col-12 col-lg-10"><div class="image-wrapper"><img alt="Running the Unit Tests" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" class="img-fluid" style="color:transparent;width:100%;height:auto" src="/assets/images/vbnetconsolesqlserverunittests/mixed-unit-tests-1366x728.png"/><p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Running the Unit Tests</p></div></div></div></div></section><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-4c42975394ce1617.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[9379,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"177\",\"static/chunks/app/layout-b6140098d4dc0e33.js\"],\"default\"]\n3:I[9766,[],\"\"]\n4:I[8924,[],\"\"]\n6:I[4431,[],\"OutletBoundary\"]\n8:I[5278,[],\"AsyncMetadataOutlet\"]\na:I[4431,[],\"ViewportBoundary\"]\nc:I[4431,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[7150,[],\"\"]\n:HL[\"/_next/static/media/949adacb6381283a-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/9dd75fadc5b3df29-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/a7d33c8790143d66.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"RJUMHoOpO5HDs1LInqYrA\",\"p\":\"\",\"c\":[\"\",\"posts\",\"VBNETConsoleSQLServerUnitTests\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"VBNETConsoleSQLServerUnitTests\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a7d33c8790143d66.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/web/assets/mobirise-icons2/mobirise2.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/bootstrap/css/bootstrap.min.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/bootstrap/css/bootstrap-grid.min.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/bootstrap/css/bootstrap-reboot.min.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/dropdown/css/style.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/socicon/css/styles.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/theme/css/style.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/assets/mobirise/css/mbr-additional.css\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"/prism.css\"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_2cd903 antialiased\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"VBNETConsoleSQLServerUnitTests\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:I[2619,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"356\",\"static/chunks/356-1fcf197c11312f1f.js\",\"858\",\"static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js\"],\"\"]\n11:I[8889,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"356\",\"static/chunks/356-1fcf197c11312f1f.js\",\"858\",\"static/chunks/app/posts/%5Bslug%5D/page-313a7831d907d705.js\"],\"default\"]\n12:Te28,"])</script><script>self.__next_f.push([1,"\n# VB.NET Console SQL Server Unit Tests\n\n## Test driven development\n\n![](/assets/images/vbnetconsolesqlserverunittests/net-logo.svg)\n*Microsoft Dotnet Logo by Microsoft Corporation is licensed under Creative Commons CC0 1.0 Universal Public Domain Dedication*\n\n\n## Unit Tests\n\nUnit tests are automated tests written and run by software developers to ensure that a section of an application (known as the \"unit\") meets its design and behaves as intended.\n\nI wanted to add unit tests to a Visual Basic Console App that fetched data from a database using SqlConnection, SqlCommand, SqlDataAdapter and DataTable classes.\n\nIn any case it is best practice is for Unit Tests to run independent of a running database server.\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000001-890x625.png)\n*I created a new project (in a new solution)*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000002-889x626.png)\n*I selected the .NET Framework (old school)*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000003-890x624.png)\n*I selected .NET Framework 4.7.2*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000004-1325x674.png)\n*Main*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000005-1363x382.png)\n*I added Hello World code*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000006-1359x567.png)\n*I updated the Console Application to connect to a database and display the contents of a Tasks table*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000017-1361x656.png)\n*I added a second project to the solution. I selected the Unit Test Project (.NET Framework) template*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000018-1362x683.png)\n*I accepted the defaults*\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000019-1360x250.png)\n*I added a reference to the Test project*\n\n\n## ChatGPT\n\nI asked ChatGPT to generate unit tests for the code.\n\n**Write Unit Tests for this code\n\nImports System.Data.SqlClient\n\nModule Module1\n...**\n\nTo write unit tests for the given code, you can use a testing framework such as NUnit or xUnit. However, since the code primarily consists of database interactions and console output, it may not be feasible to write traditional unit tests for it.\n\nInstead, you can consider refactoring the code to improve testability by separating concerns. One approach could be to move the database-related code into a separate class or method that returns the result DataTable. Then, you can write unit tests specifically for that database-related code.\n\nHere's an example of how you can refactor the code and write unit tests for the database interaction part using NUnit:\n\n...\n\n![](/assets/images/vbnetconsolesqlserverunittests/database-unit-test-1366x728.png)\n*Database Tests*\n\n\n## Refactoring the code with testing in mind\n\nAs ChatGPT explained it is hard to create Unit Tests for the database and Console code contained in the Module1.vb. \n\nIt does not help that the database access and Console.WriteLine code is mixed together in a single block.\n\nI extracted the WriteDataTable code to create a function that was easier to create Unit Tests for.\n\nI wrote the UnitTestProject2 tests with the help of ChatGPT.\n\n![](/assets/images/vbnetconsolesqlserverunittests/capture-unit-test-aaa-0000020-1098x244.png)\n*The WriteDataTable function expects to be passed a DataTable.*\n\n![](/assets/images/vbnetconsolesqlserverunittests/mixed-unit-tests-1366x728.png)\n*Running the Unit Tests*\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"section\",null,{\"className\":\"content4 cid-uBU3VQlp0E\",\"id\":\"content4-cru\",\"children\":[\"$\",\"div\",null,{\"className\":\"container\",\"children\":[\"$\",\"div\",null,{\"className\":\"row justify-content-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"title col-md-12 col-lg-10\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"mbr-section-title mbr-fonts-style align-center mb-4 display-2\",\"children\":[\"$\",\"strong\",null,{\"children\":\"VB.NET Console SQL Server Unit Tests\"}]}],[\"$\",\"h4\",null,{\"className\":\"mbr-section-subtitle align-center mbr-fonts-style mb-4 display-5\",\"children\":\"A comprehensive guide covering  v b n e t console s q l server unit tests\"}]]}]}]}]}],[\"$\",\"section\",null,{\"className\":\"content1 cid-content\",\"id\":\"content1-breadcrumb\",\"children\":[\"$\",\"div\",null,{\"className\":\"container\",\"children\":[\"$\",\"div\",null,{\"className\":\"row justify-content-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"col-md-12 col-lg-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mb-4\",\"children\":[\"$\",\"$L10\",null,{\"href\":\"/posts\",\"className\":\"link text-primary display-7\",\"children\":\"‚Üê Back to Posts\"}]}]}]}]}]}],[\"$\",\"$L11\",null,{\"markdownContent\":\"$12\"}]]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"13:I[622,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Neil Haddley - Developer \u0026 Technical Consultant\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"I help organizations to connect with clients, comply with regulations, and automate workflows.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"Neil Haddley\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"developer, consultant, Azure, Angular, Business Central, automation\"}],[\"$\",\"meta\",\"4\",{\"name\":\"creator\",\"content\":\"Neil Haddley\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Neil Haddley - Developer \u0026 Technical Consultant\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"I help organizations to connect with clients, comply with regulations, and automate workflows.\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:url\",\"content\":\"https://haddley.github.io/\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:site_name\",\"content\":\"Neil Haddley\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:title\",\"content\":\"Neil Haddley - Developer \u0026 Technical Consultant\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:description\",\"content\":\"I help organizations to connect with clients, comply with regulations, and automate workflows.\"}],[\"$\",\"link\",\"14\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"$L13\",\"15\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"e:\"$9:metadata\"\n"])</script></body></html>